var CameraMovement=pc.createScript("cameraMovement");CameraMovement.attributes.add("rayEnd",{type:"entity"}),CameraMovement.attributes.add("player",{type:"entity"}),CameraMovement.attributes.add("CameraMovement",{type:"entity"}),CameraMovement.prototype.initialize=function(){this.touchCameraMovement=this.entity.parent.parent.script.touchCameraMovement,this.eulers=new pc.Vec3,this.touchCoords=new pc.Vec2;var t=this.app;this.isMobile=!1,t.touch&&(this.isMobile=!0),t.mouse.on("mousemove",this.onMouseMove,this),t.mouse.on("mousedown",(function(){!0===cursorIsLooked&&t.mouse.enablePointerLock()}),this),this.eulers.y=360,this.movingcamera=!1,this.movingcamera2=!1,this.timer=0,this.x=0,this.mouseSpeed=4,this.UpdateSens()},CameraMovement.prototype.UpdateSens=function(){var t=4;try{"Sensitivity"in localStorage&&(t=.1*localStorage.getItem("Sensitivity"))}catch(t){console.log("storage is disabled")}this.mouseSpeed=t,this.entity.parent.parent.script.touchCameraMovement.touchSensitivity=1.35*t,this.entity.parent.parent.script.touchCameraMovement.touchSensitivity>=8&&(this.entity.parent.parent.script.touchCameraMovement.touchSensitivity=8)},CameraMovement.prototype.update=function(t){this.timer+=t,this.timer>.3&&(!1===this.movingcamera&&(this.x=0),this.timer=0),this.app.touch&&(this.eulers.x=this.touchCameraMovement.eulers.x,this.eulers.y=-this.touchCameraMovement.eulers.y)},CameraMovement.prototype.postUpdate=function(t){var e=this.entity.parent,i=this.eulers.x+180,s=this.eulers.y,o=new pc.Vec3(-s,i,0);e.setEulerAngles(o),this.rayEnd.setLocalPosition(this.rayEnd.getLocalPosition().x,.75,1.75),!0===this.player.script.playerMovement.slide?this.rayEnd.setLocalPosition(this.rayEnd.getLocalPosition().x,.25,3):!0===this.player.script.playerMovement.isrunning?this.rayEnd.setLocalPosition(this.rayEnd.getLocalPosition().x,.75,2.5):!0===this.player.script.playerMovement.firstfly?this.rayEnd.setLocalPosition(this.rayEnd.getLocalPosition().x,.75,4):!0===this.player.script.playerMovement.dying&&this.rayEnd.setLocalPosition(this.rayEnd.getLocalPosition().x,.1,3.75);const n=this.entity.getPosition();n.lerp(this.entity.getPosition(),this.getWorldPoint(),8*t),this.entity.setPosition(n)},CameraMovement.prototype.onMouseMove=function(t){let e=this.mouseSpeed,i=.5,s=.72;!0===this.isMobile&&(i=.48,s=.52),this.player.script.weaponManager.currentweapon&&!0===this.player.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&(!0===this.player.script.weaponManager.currentweapon.script.gunBehaviour.sniper?e*=i:e*=s),pc.Mouse.isPointerLocked()&&(this.x+=e*t.dx,!1===this.movingcamera&&(this.movingcamera=!0,setTimeout(function(){this.movingcamera=!1}.bind(this),500)),this.eulers.x-=e*t.dx/60%360,this.eulers.y+=e*t.dy/60%360,this.eulers.x<0&&(this.eulers.x+=360),this.eulers.y<0&&(this.eulers.y+=360),this.eulers.y<272&&(this.eulers.y=272),this.eulers.y>448&&(this.eulers.y=448))},CameraMovement.prototype.getWorldPoint=function(){var t=this.entity.parent.getPosition(),e=this.rayEnd.getPosition(),i=this.app.systems.rigidbody.raycastFirst(t,e);return i?i.point:e};var PlayerAnimationHandler=pc.createScript("playerAnimationHandler");PlayerAnimationHandler.attributes.add("blendTime",{type:"number",default:.2}),PlayerAnimationHandler.attributes.add("player",{type:"entity",default:!1}),PlayerAnimationHandler.prototype.initialize=function(){var t=this.app;t.keyboard.on(pc.EVENT_KEYDOWN,this.keyChange,this),t.keyboard.on(pc.EVENT_KEYUP,this.keyChange,this),this.touchPlayerMovement=this.entity.parent.script.touchPlayerMovement,this.direction="Rifle Idle",this.setDirection("Rifle Idle"),this.entity.on("animation:end",this.onAnimationEnd,this),this.timer=0,this.animtime=1,this.currentspeed=.85},PlayerAnimationHandler.prototype.checkButtons=function(){},PlayerAnimationHandler.prototype.update=function(t){var i=this.app;this.currentspeed=.85;var e=this.direction,n=i.keyboard.isPressed(pc.KEY_W),r=i.keyboard.isPressed(pc.KEY_A),a=i.keyboard.isPressed(pc.KEY_S),s=i.keyboard.isPressed(pc.KEY_D);if(!1!==cursorIsLooked&&!0!==chatInputGameEnabled||(n=!1,r=!1,a=!1,s=!1),this.animtime>0?this.animtime-=t:this.animtime=0,("Dying"===this.entity.parent.script.playerMovement.dying||!0===this.entity.parent.script.weaponManager.punching||!0===this.entity.parent.script.playerMovement.slide||!1===this.entity.parent.script.playerMovement.grounded||!0===this.entity.parent.script.weaponManager.takingweaponAnim||this.entity.parent.script.playerMovement.timeInAir>=1||!0===this.entity.parent.script.playerMovement.landing||!0===this.entity.parent.script.playerMovement.hardlanding)&&(this.animtime=0),this.animtime<=0){if(this.animtime=.2,this.direction=n&&!a?r&&!s?"Run Forward Left":s&&!r?"Run Forward Right":"Run Forward":a&&!n?r&&!s?"Run Backward Left":s&&!r?"Run Backward Right":"Run Backward":r?"Run Left":s?"Run Right":"Rifle Idle",i.touch){this.direction="Rifle Idle";let t=this.touchPlayerMovement.Force.x,i=this.touchPlayerMovement.Force.z;(t>0||t<0||i>0||i<0)&&(this.direction="Run Forward"),!0===this.entity.parent.script.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting&&0===t&&0===i&&(this.direction="Idle Aiming")}!0===this.entity.parent.script.playerMovement.isrunningL?this.direction="RunR":!0===this.entity.parent.script.playerMovement.isrunningR?this.direction="RunL":!0===this.entity.parent.script.playerMovement.isrunning&&(this.direction="Fast Run"),(!1===this.entity.parent.script.playerMovement.grounded&&this.entity.parent.script.playerMovement.timeInAir>=.2||!0===waitingJump)&&(this.direction="Jump"),!0===this.entity.parent.script.playerMovement.slide&&(this.direction="Slide"),this.entity.parent.script.weaponManager.currentweapon&&(("Rifle Idle"==this.direction&&timePressedLeftClick2>=.2||"Rifle Idle"==this.direction&&!0===this.entity.parent.script.weaponManager.currentweapon.script.gunBehaviour.staticAimAnim)&&(this.direction="Idle Aiming"),this.player.script.playerMovement.Camera.script.cameraMovement.x>500&&"Rifle Idle"==this.direction&&(this.direction="Right Turn"),this.player.script.playerMovement.Camera.script.cameraMovement.x<-500&&"Rifle Idle"==this.direction&&(this.direction="Left Turn")),!0===this.entity.parent.script.weaponManager.punching&&(this.direction="Axe"),!0===this.entity.parent.script.weaponManager.throwing&&(this.direction="Grenade Idle"),this.entity.parent.script.weaponManager.currentweapon&&!0===this.entity.parent.script.weaponManager.currentweapon.script.gunBehaviour.reloading&&("Rifle Idle"==this.direction||"Idle Aiming"==this.direction?this.direction="Reloading":"Jump"==this.direction?this.direction="Jump":this.direction="ReloadForward"),!0===this.entity.parent.script.weaponManager.takingweaponAnim&&(this.direction="Grab Rifle And Put Back3"),!1===this.entity.parent.script.weaponManager.Jetpack.enabled&&(this.entity.parent.script.playerMovement.timeInAir>=1&&(this.direction="Falling Idle",!0===this.entity.parent.script.playerMovement.firstfly&&(this.direction="Fly")),!0===this.entity.parent.script.playerMovement.hardlanding?this.direction="Hard Landing":!0===this.entity.parent.script.playerMovement.landing&&(this.direction="Falling To Landing")),"Jump"===this.direction&&(this.currentspeed=.9),this.entity.animation.loop=!0,!0===this.entity.parent.script.playerMovement.dying&&(this.direction="Dying",this.entity.animation.loop=!1),this.entity.animation.speed=this.currentspeed,e!==this.direction&&this.setDirection(this.direction)}},PlayerAnimationHandler.prototype.keyChange=function(t){},PlayerAnimationHandler.prototype.setDirection=function(t){this.direction=t,this.entity.animation.play(t,this.blendTime)};var PlayerMovement=pc.createScript("playerMovement");PlayerMovement.attributes.add("weaponmanager",{type:"entity"}),PlayerMovement.attributes.add("speed",{type:"number",default:.09}),PlayerMovement.attributes.add("Camera",{type:"entity",default:null}),PlayerMovement.attributes.add("Model",{type:"entity",default:null}),PlayerMovement.prototype.initialize=function(){this.touchPlayerMovement=this.entity.script.touchPlayerMovement,this.shootingPressed=!1,this.jumpingPressed=!1,this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this),this.entity.collision.on("contact",this.onContact,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMousewheel,this),this.GameManager=this.app.root.findByName("GameManager"),this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,this.ReInit()},PlayerMovement.prototype.ReInit=function(){this.fix=!1,this.pressingJetpackFire=!1,this.jetpackparticletimer=0,this.jetpackflametimer=0,this.jetpackflame_first=!1,this.currentGravity=-30,this.app.systems.rigidbody.setGravity(0,-30,0),this.GameManager.script.gameUi.fadingout(),!0===this.GameManager.script.gameManager.singleplayer&&(this.Health=150),this.lastGroundCollision=0,this.newJumpAllowedAt=0,this.footstepTimer=0,this.force=new pc.Vec3,this.timeInAir=1.1,this.waitinghardlanding=!1,this.hardlanding=!1,this.waitinglanding=!1,this.landing=!1,this.isrunningkeypressed=!1,this.isrunning=!1,this.isrunningL=!1,this.isrunningR=!1,this.slide=!1,this.canslide=!0,this.fly=!1,this.slidetiming=0,this.firstfly=!0,this.firstflysound=!1,this.detectraycastjump=!1,this.entity.rigidbody.friction=.75,this.grounded_e=null,this.dying=!1},PlayerMovement.prototype.ReceiveDamage=function(t,i){!0===this.slide&&!1===i||(this.Health-=t,this.Health<=0?this.Health=0:this.GameManager.script.gameUi.bloodscreen())};var _transformedForward=new pc.Vec3;PlayerMovement.prototype.getYaw=function(t){var i=_transformedForward;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},PlayerMovement.attributes.add("grounded",{type:"boolean",default:!0});var _x=0,_z=0;PlayerMovement.attributes.add("ray",{type:"entity"}),PlayerMovement.prototype.RequestCommercial=function(t){if(!0===watchingAds)return;let i=cursorIsLooked,e=gamePlay;this.GameManager.script.gameManager.MuteAudio(!0),this.GameManager.script.gameManager.SetLookCursor(!1),this.GameManager.script.gameManager.SetGamePlay(!1),watchingAds=!0,PokiSDK.commercialBreak().then((()=>{console.log("Commercial break finished, proceeding to game"),this.GameManager.script.gameManager.MuteAudio(!1),this.GameManager.script.gameManager.SetLookCursor(i),this.GameManager.script.gameManager.SetGamePlay(e),watchingAds=!1,t&&t()}))};var currentkeydown,lastPos=null;PlayerMovement.prototype.update=function(t){if(!0!==this.landing&&!0!==this.hardlanding){if(this.Health<=0)return!1===this.dying&&(this.dying=!0,this.GameManager.script.gameManager.SetGamePlay(!1),!0===this.GameManager.script.gameManager.singleplayer?(this.GameManager.script.gameUi.ShowRankScreenBattleRoyale(!1),this.GameManager.script.gameManager.AIManager.script.aimanager.ranks-=1):(setTimeout(function(){let t=function(){this.GameManager.script.gameManager.PlayAgain()}.bind(this);this.RequestCommercial(t)}.bind(this),2500),this.fix=!0,setTimeout(function(){this.fix=!1}.bind(this),3500))),this.GameManager.script.gameUi.Crosshair2.enabled=!1,this.GameManager.script.gameUi.SniperScope.enabled=!1,this.GameManager.script.gameUi.DynamicCrosshair.enabled=!1,void(this.GameManager.script.gameUi.RPGCrosshair.enabled=!1);if(this.dying=!1,!0!==watchingAds&&!0!==this.fix){this.GameManager.script.gameManager.minimap.setPosition(this.entity.getPosition().x,this.GameManager.script.gameManager.minimap.getPosition().y,this.entity.getPosition().z),this.GameManager.script.gameManager.minimap.setEulerAngles(-90,this.getYaw(this.Camera.getRotation()),0),this.Crosshair();var i=this.app,e=this.Camera.forward,s=this.Camera.right,n=0,a=0;this.moving=!1,!0===this.firstfly&&this.timeInAir>=1&&!1===this.firstflysound&&(this.firstflysound=!0,this.entity.sound.play("Fly")),!0===this.grounded||!0===this.firstfly?(i.keyboard.isPressed(pc.KEY_A)&&i.keyboard.isPressed(pc.KEY_D)||(i.keyboard.isPressed(pc.KEY_A)?(n-=s.x,a-=s.z,_x=n,_z=a,this.moving=!0):i.keyboard.isPressed(pc.KEY_D)&&(n+=s.x,a+=s.z,_x=n,_z=a,this.moving=!0)),i.keyboard.isPressed(pc.KEY_W)&&(n+=e.x,a+=e.z,_x=n,_z=a,this.moving=!0),i.keyboard.isPressed(pc.KEY_S)&&(n-=e.x,a-=e.z,_x=n,_z=a,this.moving=!0)):(i.keyboard.isPressed(pc.KEY_A)?(_x-=.1*s.x,_z-=.1*s.z):i.keyboard.isPressed(pc.KEY_D)?(_x+=.1*s.x,_z+=.1*s.z):i.keyboard.isPressed(pc.KEY_W)?(_x+=.1*e.x,_z+=.1*e.z):i.keyboard.isPressed(pc.KEY_S)&&(_x-=.1*e.x,_z-=.1*e.z),n=_x,a=_z),i.touch&&(this.touchPlayerMovement.Force=new pc.Vec3,this.touchPlayerMovement.forceX.copy(s).scale(this.touchPlayerMovement.velX),this.touchPlayerMovement.forceZ.copy(e).scale(-this.touchPlayerMovement.velZ),this.touchPlayerMovement.Force.add2(this.touchPlayerMovement.forceX,this.touchPlayerMovement.forceZ).normalize().scale(80),n=this.touchPlayerMovement.Force.x,a=this.touchPlayerMovement.Force.z),!1!==cursorIsLooked&&!0!==chatInputGameEnabled||(n=0,a=0,this.moving=!1),!0===this.entity.script.weaponManager.throwing&&(n=0,a=0,this.moving=!1),this.pressingJetpackFire=!1,!0===this.entity.script.weaponManager.Jetpack.enabled&&this.timeInAir<=3&&(i.keyboard.isPressed(pc.KEY_SPACE)||!0===this.jumpingPressed)?(this.force.copy(this.Camera.forward).scale(20),this.force.y=9,this.pressingJetpackFire=!0,this.jetpackparticletimer>=0?(this.jetpackparticletimer=-.5,this.entity.script.weaponManager.JetpackFlameParticle1.particlesystem.reset(),this.entity.script.weaponManager.JetpackFlameParticle1.particlesystem.play(),this.entity.script.weaponManager.JetpackFlameParticle2.particlesystem.reset(),this.entity.script.weaponManager.JetpackFlameParticle2.particlesystem.play()):this.jetpackparticletimer+=t,this.jetpackflametimer>=0?(this.jetpackflametimer=-.25,!1===this.jetpackflame_first?(this.entity.sound.play("Flame"),this.jetpackflame_first=!0):this.entity.sound.play("Flame2")):this.jetpackflametimer+=t,this.entity.rigidbody.linearVelocity=this.force):(this.jetpackparticletimer=0,this.jetpackflametimer=0,this.jetpackflame_first=!1),this.isrunningkeypressed=!1,i.keyboard.isPressed(pc.KEY_SHIFT)&&(this.isrunningkeypressed=!0),null===i.touch&&(this.isrunning=!1),this.isrunningL=!1,this.isrunningR=!1,i.keyboard.isPressed(pc.KEY_SHIFT)&&!0===this.grounded&&!1===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.reloading&&!1===this.entity.script.weaponManager.punching&&!1===this.entity.script.weaponManager.throwing&&!1===this.landing&&!1===this.hardlanding&&!1===this.slide&&!1===this.fly&&(i.keyboard.isPressed(pc.KEY_A)&&i.keyboard.isPressed(pc.KEY_W)?(this.isrunningL=!0,this.isrunningR=!1,this.isrunning=!0):i.keyboard.isPressed(pc.KEY_D)&&i.keyboard.isPressed(pc.KEY_W)?(this.isrunningR=!0,this.isrunningL=!1,this.isrunning=!0):i.keyboard.isPressed(pc.KEY_W)&&(this.isrunning=!0)),null===i.touch&&!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&(this.isrunning=!1);var r=this.speed;!0===this.isrunning&&!1===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.reloading&&(r=1.25*this.speed),!0===this.slide?(this.slidetiming<=0&&(this.slidetiming=1),this.slidetiming-=.5*t,n+=e.x,a+=e.z,this.moving=!0,r=1.5*this.speed*this.slidetiming):this.slidetiming=0,!0===this.firstfly&&(r=2*this.speed),this.GameManager.script.gameManager.minimap.camera.enabled=!0,!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.sniper&&!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&(this.GameManager.script.gameManager.minimap.camera.enabled=!1);var o=this.entity.getPosition(),h=new pc.Vec3(o.x,o.y-1,o.z);this.grounded=!1,this.grounded_e=null;var p=this.app.systems.rigidbody.raycastFirst(o,h);p?(this.grounded=!0,this.grounded_e=p.entity,!0===p.entity.tags.has("Player")&&(this.grounded=!1),lastPos=new pc.Vec3(this.entity.getPosition().x,this.entity.getPosition().y,this.entity.getPosition().z)):lastPos&&this.entity.getPosition().y<-10&&this.entity.rigidbody.teleport(new pc.Vec3(lastPos.x,lastPos.y+3,lastPos.z),this.entity.getRotation()),this.grounded_e&&this.grounded_e.tags.has("Ladder")&&(r=1.5*this.speed),!0===this.entity.script.weaponManager.punching&&(r=.4*this.speed),!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&(r=.64*this.speed,i.touch&&(r=.6*this.speed));var c=new pc.Vec3(n*t,0,a*t);c.normalize().scale(r),c.add(this.entity.getPosition());l=this.Camera.script.cameraMovement.eulers.x,y=new pc.Vec3(0,l,0);if(this.Model.setEulerAngles(y),this.entity.rigidbody.applyForce(c),!0===this.entity.script.weaponManager.takingweapon)return this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting=!1,void(this.entity.script.weaponManager.currentweapon.script.gunBehaviour.buttonleftpressing=!1);var g=this.app.systems.rigidbody.raycastFirst(o,this.ray.getPosition());if(g&&!0===this.grounded&&!0===this.moving&&!0===g.entity.tags.has("Map")&&!1===this.detectraycastjump&&(this.detectraycastjump=!0,this.force.copy(this.Camera.forward).scale(2),this.force.y=5,this.entity.rigidbody.linearVelocity=this.force,this.entity.rigidbody.friction=.1,setTimeout(function(){this.entity.rigidbody.friction=.75}.bind(this),300),setTimeout(function(){this.detectraycastjump=!1}.bind(this),1e3)),!0===this.grounded?(!1===this.onetime&&(this.onetime=!0,this.timeInAir>=.2&&this.entity.sound.play("Land")),this.timeInAir=0):(this.onetime=!1,this.timeInAir+=t),!1===this.entity.script.weaponManager.Jetpack.enabled&&(this.timeInAir>=2?!1===this.waitinghardlanding&&(this.waitinghardlanding=!0):this.timeInAir>=1&&!1===this.waitinglanding&&(this.waitinglanding=!0)),this.timeInAir>=3?-45!==this.currentGravity&&(this.currentGravity=-45,i.systems.rigidbody.setGravity(0,-45,0)):this.timeInAir>=2?-40!==this.currentGravity&&(this.currentGravity=-40,i.systems.rigidbody.setGravity(0,-40,0)):this.timeInAir>=1?-35!==this.currentGravity&&(this.currentGravity=-35,i.systems.rigidbody.setGravity(0,-35,0)):-30!==this.currentGravity&&(this.currentGravity=-30,i.systems.rigidbody.setGravity(0,-30,0)),this.entity.script.weaponManager.currentweapon&&(null===i.touch&&(i.mouse.isPressed(pc.MOUSEBUTTON_LEFT)?!1===this.grounded?(this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting=!1,this.entity.script.weaponManager.currentweapon.script.gunBehaviour.buttonleftpressing=!1):(this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting=!0,this.entity.script.weaponManager.currentweapon.script.gunBehaviour.buttonleftpressing=!0):(this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting=!1,this.entity.script.weaponManager.currentweapon.script.gunBehaviour.buttonleftpressing=!1)),!0===this.grounded&&!1===this.slide&&!1===this.isrunning&&!1===this.fly&&!1===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.reloading&&!1===this.landing&&!1===this.hardlanding&&(i.mouse.isPressed(pc.MOUSEBUTTON_RIGHT)&&!1===this.entity.script.weaponManager.takingweapon?(!1===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.sniper&&this.GameManager.script.gameManager.PlayWeaponFireSound("SniperAim"),this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming=!0):(!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.sniper&&this.GameManager.script.gameManager.PlayWeaponFireSound("SniperAimOff"),this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming=!1))),!0===this.moving&&!0===this.grounded&&!1===this.slide){this.footstepTimer+=t;var d=.3;!0===this.isrunning&&(d=.28),this.footstepTimer>d&&(this.soundname="Footstep01",this.ran=this.random(1,4),1===this.ran?this.soundname="Footstep01":2===this.ran?this.soundname="Footstep02":3===this.ran&&(this.soundname="Footstep03"),this.entity.sound.play(this.soundname),this.footstepTimer=0)}this.GameManager.script.gameUi.PlayerHP.element.text=this.Health+" HP"}else this.dying=!0}else{var l=this.Camera.script.cameraMovement.eulers.x,y=new pc.Vec3(0,l,0);this.Model.setEulerAngles(y)}},PlayerMovement.attributes.add("DC_left",{type:"entity",default:null}),PlayerMovement.attributes.add("DC_right",{type:"entity",default:null}),PlayerMovement.attributes.add("DC_up",{type:"entity",default:null}),PlayerMovement.attributes.add("DC_down",{type:"entity",default:null}),PlayerMovement.prototype.Crosshair=function(){if(this.GameManager.script.gameUi.Crosshair2.enabled=!1,this.GameManager.script.gameUi.SniperScope.enabled=!1,this.GameManager.script.gameUi.DynamicCrosshair.enabled=!1,this.GameManager.script.gameUi.RPGCrosshair.enabled=!1,!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.shotgun)this.GameManager.script.gameUi.Crosshair2.enabled=!0;else if(!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.rpg)this.GameManager.script.gameUi.RPGCrosshair.enabled=!0;else{this.GameManager.script.gameUi.DynamicCrosshair.enabled=!0;var t=500*timePressedLeftClick3;t<=8&&(t=8);var i=3.2*this.entity.script.weaponManager.currentweapon.script.gunBehaviour.errorAngle;(t>=i||!0===this.isrunning||!1===this.grounded||!0===this.slide)&&(t=i),!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.sniper&&(t=8),this.DC_left.setLocalPosition(new pc.Vec3(-t,0,0)),this.DC_right.setLocalPosition(new pc.Vec3(t,0,0)),this.DC_up.setLocalPosition(new pc.Vec3(0,t,0)),this.DC_down.setLocalPosition(new pc.Vec3(0,-t,0)),!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.sniper&&!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&(this.GameManager.script.gameUi.DynamicCrosshair.enabled=!1,this.GameManager.script.gameUi.SniperScope.enabled=!0)}},PlayerMovement.prototype.random=function(t,i){return t=Math.ceil(t),i=Math.floor(i),Math.floor(Math.random()*(i-t+1))+t},PlayerMovement.prototype.mouseDown=function(t){if(!1!==this.entity.enabled){this.app;this.entity.script.weaponManager.currentweapon&&!0===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.singleShot&&!0===this.grounded&&t.button===pc.MOUSEBUTTON_LEFT&&this.entity.script.weaponManager.currentweapon.script.gunBehaviour.firesingleshot()}},PlayerMovement.prototype.onKeyUp=function(t){currentkeydown=null};var canJump=!0,waitingJump=!1;PlayerMovement.prototype.Jump_=function(){!0===canJump&&!1===waitingJump&&this.grounded&&!1===this.entity.script.weaponManager.punching&&!1===this.entity.script.weaponManager.throwing&&!1===this.landing&&!1===this.hardlanding&&!1===this.slide&&!1===this.fly&&(waitingJump=!0,canJump=!1,this.lastGroundCollision=0,this.newJumpAllowedAt=pc.now()+100,!0===this.isrunning?(this.force.copy(this.Camera.forward).scale(10),this.force.y=15,this.entity.rigidbody.linearVelocity=this.force):this.app.keyboard.isPressed(pc.KEY_W)?(this.force.copy(this.Camera.forward).scale(6),this.force.y=15,this.entity.rigidbody.linearVelocity=this.force):this.app.keyboard.isPressed(pc.KEY_S)?(this.force.copy(this.Camera.forward).scale(-6),this.force.y=15,this.entity.rigidbody.linearVelocity=this.force):this.app.keyboard.isPressed(pc.KEY_D)?(this.force.copy(this.Camera.right).scale(3),this.force.y=15,this.entity.rigidbody.linearVelocity=this.force):this.app.keyboard.isPressed(pc.KEY_A)?(this.force.copy(this.Camera.right).scale(-3),this.force.y=15,this.entity.rigidbody.linearVelocity=this.force):(this.force.copy(this.Camera.forward).scale(6),this.force.y=15,this.entity.rigidbody.linearVelocity=this.force))},PlayerMovement.prototype.onKeyDown=function(t){!1!==this.entity.enabled&&!0!==this.dying&&!1!==cursorIsLooked&&!0!==chatInputGameEnabled&&currentkeydown!==t.key&&(currentkeydown=t.key,t.key===pc.KEY_SPACE&&this.Jump_())},PlayerMovement.prototype.onMousewheel=function(t){!1!==this.entity.enabled&&!0===this.canslide&&!1===this.entity.script.weaponManager.currentweapon.script.gunBehaviour.reloading&&!1===this.slide&&!1===this.landing&&!1===this.hardlanding&&!1===this.waitinghardlanding&&!1===this.waitinglanding&&!1===this.fly&&(!0===this.entity.script.weaponManager.Jetpack.enabled&&!1===this.grounded||(this.slide=!0,setTimeout(function(){this.slide=!1}.bind(this),1300),this.canslide=!1,setTimeout(function(){this.canslide=!0}.bind(this),2500),this.GameManager.script.gameManager.PlayWeaponFireSound("Slide")))},PlayerMovement.prototype.onContact=function(t){for(var i=t.contacts,e=i.length,s=!1,n=0;n<e;n++){if(i[n].normal.equals(pc.Vec3.UP)){s=!0;break}s=!0}s&&(this.lastGroundCollision=pc.now()),!0===this.firstflysound&&(firstflysound=!1,this.entity.sound.stop("Fly")),this.firstfly=!1,!0===waitingJump&&pc.now()>=this.newJumpAllowedAt&&(waitingJump=!1,setTimeout(function(){canJump=!0}.bind(this),400)),!0===this.waitinghardlanding?(this.hardlanding=!0,setTimeout(function(){this.hardlanding=!1,this.waitinghardlanding=!1,this.landing=!1,this.waitinglanding=!1,!0===this.GameManager.script.gameManager.hadJetpack&&(this.entity.script.weaponManager.Jetpack.enabled=!0)}.bind(this),1600)):!0===this.waitinglanding&&(this.landing=!0,setTimeout(function(){this.hardlanding=!1,this.waitinghardlanding=!1,this.landing=!1,this.waitinglanding=!1}.bind(this),500))};var GunBehaviour=pc.createScript("gunBehaviour");GunBehaviour.attributes.add("isShooting",{type:"boolean",default:!1}),GunBehaviour.attributes.add("isAiming",{type:"boolean",default:!1}),GunBehaviour.attributes.add("staticAimAnim",{type:"boolean",default:!1}),GunBehaviour.attributes.add("fireRate",{type:"number",default:.2}),GunBehaviour.attributes.add("fireRange",{type:"number",default:100}),GunBehaviour.attributes.add("aimFov",{type:"number",default:10}),GunBehaviour.attributes.add("baseHitDamage",{type:"number",default:20}),GunBehaviour.attributes.add("singleShot",{type:"boolean",default:!1}),GunBehaviour.attributes.add("owner",{type:"entity",default:null}),GunBehaviour.attributes.add("barrel",{type:"entity",default:null}),GunBehaviour.attributes.add("CameraRaycast",{type:"entity",default:null}),GunBehaviour.attributes.add("muzzle",{type:"entity",default:null}),GunBehaviour.attributes.add("errorAngle",{type:"number",default:5}),GunBehaviour.attributes.add("sniper",{type:"boolean",default:!1}),GunBehaviour.attributes.add("rpg",{type:"boolean",default:!1}),GunBehaviour.attributes.add("shotgun",{type:"boolean",default:!1}),GunBehaviour.attributes.add("player",{type:"entity",default:!1}),GunBehaviour.attributes.add("Model",{type:"entity",default:!1}),GunBehaviour.attributes.add("Axe",{type:"entity",default:!1});var timePressedLeftClick=0,timePressedLeftClick2=0,timePressedLeftClick3=0;GunBehaviour.prototype.initialize=function(){this.GameManager=this.app.root.findByName("GameManager"),this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,this.playerMovement=this.player.script.playerMovement,this.weaponManager=this.player.script.weaponManager,this.camera=this.player.script.playerMovement.Camera,this.camera&&(this.width=document.getElementById("application-canvas").width,this.height=document.getElementById("application-canvas").height),this.modely=this.Model.getLocalPosition().y,this.ReInit()},GunBehaviour.prototype.ReInit=function(){this.changingmesh=!0,this.nextShootAllowedAt=0,this.force=new pc.Vec3,this.reloading=!1,this.shooting=!1,this.shotidleanim=!1,this.cansingleshot=!0,this.buttonleftpressing=!1,this.currentraydistance=0,this.grenadepressedtime=0,this.isAiming=!1,this.changingmesh=!0,this.entity.children[0].enabled=!1,this.RestartAmmo(),setTimeout(function(){this.entity.children[0].enabled=!0,this.changingmesh=!1}.bind(this),200)},GunBehaviour.prototype.GetCurrentDistance=function(){var e=this.DoRaycast(1e3);if(e){var t=this.barrel.getPosition(),i=e.point,a=t.distance(i);this.currentraydistance=a}},GunBehaviour.prototype.update=function(e){if(!0===this.playerMovement.dying)return!1===this.Model.model.enabled&&(this.Model.model.enabled=!0),this.posX=pc.math.lerp(this.camera.camera.fov,60,20*e),void(this.camera.camera.fov=this.posX);if(!1!==cursorIsLooked){var t=this.app;this.shooting=this.isShooting,this.shotidleanim=!1,!1===this.changingmesh&&(this.entity.children[0].enabled=!0,this.Axe.enabled=!1,!1===this.reloading&&(!0===this.playerMovement.isrunning||!0===this.playerMovement.isrunningL||!0===this.playerMovement.isrunningR||!0===this.playerMovement.slide||!0===this.weaponManager.punching?(this.entity.children[0].enabled=!1,!0===this.weaponManager.punching&&(this.Axe.enabled=!0)):!1===this.Model.model.enabled&&(this.entity.children[0].enabled=!1))),(!0===this.playerMovement.slide||!0===this.playerMovement.isrunning||!0===this.reloading||this.LoadedBullets<=0||!0===this.weaponManager.punching||!0===this.weaponManager.throwing||!0===this.playerMovement.landing||!0===this.playerMovement.hardlanding||!1===this.playerMovement.grounded)&&(this.shooting=!1),t.mouse.isPressed(pc.MOUSEBUTTON_LEFT)?((timePressedLeftClick+=4*e)>=1&&(timePressedLeftClick=1),timePressedLeftClick2=.5,timePressedLeftClick3+=e):(timePressedLeftClick=.25,(timePressedLeftClick2-=e)<=0&&(timePressedLeftClick2=0),(timePressedLeftClick3-=e)<=0&&(timePressedLeftClick3=0)),!0===this.weaponManager.throwing&&t.keyboard.isPressed(pc.KEY_G)&&(this.grenadepressedtime+=e),!1===this.singleShot&&(this.nextShootAllowedAt-=e,this.nextShootAllowedAt<0&&(this.LoadedBullets<=0&&this.BulletInventory<=0&&!0===this.isShooting?(this.entity.sound.play("NoAmmo"),this.nextShootAllowedAt=this.fireRate):this.shooting&&(this.shoot(),this.nextShootAllowedAt=this.fireRate))),!1===this.reloading&&this.LoadedBullets<=0&&this.BulletInventory>0&&this.LoadedBullets<this.MagazineSize&&!1===this.rpg&&this.reload(),this.currentfov=60,t.touch&&(this.currentfov=50),!0===this.playerMovement.fly&&(this.currentfov=75),this.Model.model.enabled=!0,!0===this.weaponManager.Jetpack.enabled&&(this.weaponManager.Jetpack.children[0].enabled=!0),(!0===this.playerMovement.landing||!0===this.playerMovement.hardlanding||!0===this.weaponManager.punching||!0===this.reloading||!0===this.weaponManager.throwing||!0===this.playerMovement.isrunning||!0===this.playerMovement.isrunningL||!0===this.playerMovement.isrunningR||!0===this.playerMovement.slide||!1===this.playerMovement.grounded&&this.playerMovement.timeInAir>=.2)&&(this.isAiming=!1),!0===this.playerMovement.aimingPressed&&(this.isAiming=!0),this.isAiming&&!1===this.reloading&&(this.currentfov=this.aimFov,!0===this.sniper&&(this.Model.model.enabled=!1,!0===this.weaponManager.Jetpack.enabled&&(this.weaponManager.Jetpack.children[0].enabled=!1))),!0===this.playerMovement.aimingPressed&&(!0===this.sniper?this.currentfov=12:this.currentfov=18),this.posX=pc.math.lerp(this.camera.camera.fov,this.currentfov,20*e),this.camera.camera.fov=this.posX,t.keyboard.isPressed(pc.KEY_R)&&this.reload(),!0===this.shooting&&this.GetCurrentDistance()}},GunBehaviour.prototype.reload=function(){!1!==cursorIsLooked&&!0!==chatInputGameEnabled&&!1===this.reloading&&this.BulletInventory>0&&this.LoadedBullets<this.MagazineSize&&!1===this.rpg&&!1===this.playerMovement.slide&&!1===this.playerMovement.fly&&(this.reloading=!0,this.entity.sound.play("Reload"),setTimeout(function(){this.LoadMagazine(),this.reloading=!1}.bind(this),1800))},GunBehaviour.attributes.add("recoilForce",{type:"number",default:.03,description:"Seconds between shots"}),GunBehaviour.prototype.shoot=function(){!1!==cursorIsLooked&&(!0===this.rpg&&!1===this.canshotprojectile()||(this.weaponManager.DoRecoil(this.recoilForce),this.playerMovement.GameManager.script.gameManager.PlayWeaponFireSound(this.entity.name),this.Consume(),!0!==this.rpg?(this.muzzleFlash(),!0===this.shotgun?(this.RaycastBullet(),this.RaycastBullet(),this.RaycastBullet(),this.RaycastBullet(),this.RaycastBullet()):this.RaycastBullet(),"AWP"!==this.entity.name&&"Barrett"!==this.entity.name&&"M3"!==this.entity.name&&"XM1014"!==this.entity.name||this.SmartFoxServer.SendSingleShot()):this.missile()))},GunBehaviour.prototype.RaycastBullet=function(){var e=this.DoRaycast(1e3);e&&(e.entity.tags.has("Map")?this.playerMovement.GameManager.script.gameManager.ImpactBullet(e.point,this.camera.getEulerAngles()):e.entity.tags.has("BotHitbox")||e.entity.tags.has("BotAI")?(this.playerMovement.GameManager.script.gameManager.ImpactBlood(e.point,this.camera.getEulerAngles()),this.DoDamage(e)):e.entity.tags.has("Hitbox")&&(this.playerMovement.GameManager.script.gameManager.ImpactBlood(e.point,this.camera.getEulerAngles()),this.DoDamageRemote(e)))},GunBehaviour.prototype.DoDamageRemote=function(e){if(!0!==this.playerMovement.dying&&e){let t=1,i=this.baseHitDamage;"Head"===e.entity.name&&(t=1.7);let a=this.entity.name;!0===this.Axe.enabled&&(a="Axe",this.GameManager.sound.play("BloodHit"),i=100);let s=e.entity.script.hitboxInfo;if(s&&s.Player.tags.has("Remote")){let e=this.SmartFoxServer.GetUserKey(s.Player.name);if(null!==e&&null!==e.user){let t=!0;if(e.entity){let a=e.entity.script.remotePlayer;!1===a.receivedamage||!1===a.receivedamage2||"Dying"===a.currentAnimation?t=!1:(a.fake_health>=1&&a.fake_health-Math.floor(i*s.factor)<=0&&this.GameManager.sound.play("Kill"),a.fake_health-=Math.floor(i*s.factor))}!0===t&&(this.SmartFoxServer.SendDamage(a,s.factor,e.user.id),this.GameManager.script.gameUi.hitmark())}}}},GunBehaviour.prototype.DoDamage=function(e){if(!0!==this.playerMovement.dying&&e){let t=1,i=this.baseHitDamage;if("Head"===e.entity.name&&(t=1.7),!0===this.Axe.enabled&&(this.GameManager.sound.play("BloodHit"),i=100),e.entity.script.hitboxInfo){if(e.entity.script.hitboxInfo.Player.tags.has("BotAI")){let a=e.entity.script.hitboxInfo.Player.script.botAi.health_;if(e.entity.script.hitboxInfo.Player.script.botAi.ReceiveDamage(Math.floor(i*t)),e.entity.script.hitboxInfo.Player.script.botAi.SetForceTarget(),e.entity.script.hitboxInfo.Player.script.botAi.target=this.player,e.entity.script.hitboxInfo.Player.script.botAi.health_<=0&&a>=1){console.log("Bot Killed"),this.GameManager.sound.play("Kill"),this.GameManager.script.gameManager.singleplayerKills+=1,e.entity.script.hitboxInfo.Player.script.botAi.currentWeapon&&this.GameManager.script.gameManager.SpawnPickup(e.entity.script.hitboxInfo.Player.script.botAi.currentWeapon.name,new pc.Vec3(e.entity.script.hitboxInfo.Player.getPosition().x,e.entity.script.hitboxInfo.Player.getPosition().y+.1,e.entity.script.hitboxInfo.Player.getPosition().z),13e3),this.app.touch?this.playerMovement.Health+=60:this.playerMovement.Health+=20;let t=100;!0===this.GameManager.script.gameManager.singleplayer&&(t=150),this.playerMovement.Health>=t&&(this.playerMovement.Health=t)}}}else if(e.entity.tags.has("BotAI")){let a=e.entity.script.botAi.health_;if(e.entity.script.botAi.ReceiveDamage(Math.floor(i*t)),e.entity.script.botAi.health_<=0&&a>=1){console.log("Bot Killed"),this.GameManager.sound.play("Kill"),this.GameManager.script.gameManager.singleplayerKills+=1,e.entity.script.botAi.currentWeapon&&this.GameManager.script.gameManager.SpawnPickup(e.entity.script.botAi.currentWeapon.name,new pc.Vec3(e.entity.getPosition().x,e.entity.getPosition().y+.1,e.entity.getPosition().z),13e3),this.app.touch?this.playerMovement.Health+=60:this.playerMovement.Health+=20;let t=100;!0===this.GameManager.script.gameManager.singleplayer&&(t=150),this.playerMovement.Health>=t&&(this.playerMovement.Health=t)}}this.GameManager.script.gameUi.hitmark()}},GunBehaviour.prototype.DoRaycast=function(e){this.barrel.setLocalPosition(new pc.Vec3(this.CameraRaycast.getLocalPosition().x,this.CameraRaycast.getLocalPosition().y,0));var t=this.app.renderer.device.maxPixelRatio,i=this.app.graphicsDevice.height/t,a=this.app.graphicsDevice.width/t;this.distance=this.camera.camera.screenToWorld(a/2,i/2,e);var s=.03;s=!0===this.playerMovement.ismoving?.03:.025,!0===this.playerMovement.crouch&&(s=!0===this.playerMovement.ismoving?.025:.02);var n=this.errorAngle*this.currentraydistance*s;!1===this.shotgun&&(n*=timePressedLeftClick),!0===this.isAiming&&(n*=.8),this.randY=random(-1*n,1*n),this.randZ=random(-1*n,1*n),this.barrel.setLocalPosition(this.barrel.getLocalPosition().x+.1*this.randZ,this.barrel.getLocalPosition().y+.1*this.randY,this.barrel.getLocalPosition().z);var r=this.app.systems.rigidbody.raycastFirst(this.barrel.getPosition(),this.distance);return r?((r.entity.tags.has("StaticWeaponsTrigger")||r.entity.tags.has("StormCollider")||r.entity.tags.has("Player"))&&(r=this.app.systems.rigidbody.raycastFirst(r.point,this.distance)),r):null},GunBehaviour.prototype.muzzleFlash=function(){this.muzzle&&(this.muzzle.particlesystem.reset(),this.muzzle.enabled=!0,setTimeout(function(){this.muzzle.particlesystem.reset(),this.muzzle.enabled=!1}.bind(this),30))},GunBehaviour.prototype.projectile=function(){if(!1!==cursorIsLooked){this.playerMovement.GameManager.script.gameManager.EnableColliders(),this.barrel.setLocalPosition(new pc.Vec3(this.CameraRaycast.getLocalPosition().x,this.CameraRaycast.getLocalPosition().y,-.5));var e=this.barrel.getPosition(),t=this.barrel.forward,i=this.barrel.getRotation(),a=2+.01*this.player.rigidbody.linearVelocity.length();this.force=37,this.grenadepressedtime>=.45?this.force=57:this.grenadepressedtime>=.27&&(this.force=47),this.playerMovement.GameManager.script.gameManager.Grenade_(e.x,e.y,e.z,t.x,t.y,t.z,i.x,i.y,i.z,i.w,a,this.force,!0),!1===this.GameManager.script.gameManager.singleplayer&&this.SmartFoxServer.SendGrenade(e.x,e.y,e.z,t.x,t.y,t.z,i.x,i.y,i.z,i.w,a,this.force)}},GunBehaviour.prototype.canshotprojectile=function(){var e=this.DoRaycast(5);return!e||!e.entity.tags.has("Map")},GunBehaviour.prototype.missile=function(){if(!1!==cursorIsLooked){this.playerMovement.GameManager.script.gameManager.EnableColliders(),this.barrel.setLocalPosition(new pc.Vec3(this.CameraRaycast.getLocalPosition().x,this.CameraRaycast.getLocalPosition().y,-.5));var e=this.barrel.getPosition(),t=this.barrel.forward,i=this.barrel.getRotation(),a=2+.01*this.player.rigidbody.linearVelocity.length();this.playerMovement.GameManager.script.gameManager.GrenadeLauncher_(e.x,e.y,e.z,t.x,t.y,t.z,i.x,i.y,i.z,i.w,a,!0),!1===this.GameManager.script.gameManager.singleplayer&&this.SmartFoxServer.SendGrenadeLauncher(e.x,e.y,e.z,t.x,t.y,t.z,i.x,i.y,i.z,i.w,a)}},GunBehaviour.prototype.punch=function(){!1!==cursorIsLooked&&setTimeout(function(){let e=this.DoRaycast(5);e&&(e.entity.tags.has("BotHitbox")||e.entity.tags.has("BotAI")?(this.playerMovement.GameManager.script.gameManager.ImpactBlood(e.point,this.camera.getEulerAngles()),this.DoDamage(e)):e.entity.tags.has("Hitbox")&&(this.playerMovement.GameManager.script.gameManager.ImpactBlood(e.point,this.camera.getEulerAngles()),this.DoDamageRemote(e)))}.bind(this),400)},GunBehaviour.prototype.firesingleshot=function(){!1!==this.entity.enabled&&!1!==cursorIsLooked&&!0!==this.playerMovement.dying&&(!1===this.singleShot&&!1===this.cansingleshot||(this.cansingleshot=!1,this.canshot=!0,(!0===this.reloading||this.LoadedBullets<=0||!0===this.weaponManager.punching||!0===this.weaponManager.throwing||!0===this.playerMovement.slide)&&(this.canshot=!1),this.LoadedBullets<=0&&this.BulletInventory<=0?this.entity.sound.play("NoAmmo"):!0===this.canshot&&this.shoot(),setTimeout(function(){this.cansingleshot=!0}.bind(this),1e3*this.fireRate)))},GunBehaviour.attributes.add("MagazineSize",{type:"number",default:10}),GunBehaviour.attributes.add("LoadedBullets",{type:"number",default:10}),GunBehaviour.attributes.add("BulletInventory",{type:"number",default:1e4}),GunBehaviour.attributes.add("_MagazineSize",{type:"number",default:10}),GunBehaviour.attributes.add("_LoadedBullets",{type:"number",default:10}),GunBehaviour.attributes.add("_BulletInventory",{type:"number",default:1e4}),GunBehaviour.prototype.Consume=function(){this.LoadedBullets-=1},GunBehaviour.prototype.RestartAmmo=function(){this.MagazineSize=this._MagazineSize,this.LoadedBullets=this._LoadedBullets,this.BulletInventory=this._BulletInventory},GunBehaviour.prototype.LoadAmmo=function(){this.LoadedBullets=this._LoadedBullets,this.BulletInventory=.5*this._BulletInventory},GunBehaviour.prototype.LoadMagazine=function(){this.BulletInventory>0&&this.LoadedBullets<this.MagazineSize&&(this.BulletInventory>=this.MagazineSize-this.LoadedBullets&&(this.BulletInventory-=this.MagazineSize-this.LoadedBullets,this.LoadedBullets=this.MagazineSize),this.BulletInventory<this.MagazineSize-this.LoadedBullets&&(this.LoadedBullets+=this.BulletInventory,this.BulletInventory=0))};var currentkeydown2,WeaponManager=pc.createScript("weaponManager");WeaponManager.attributes.add("currentweapon",{type:"entity"}),WeaponManager.attributes.add("Jetpack",{type:"entity"}),WeaponManager.attributes.add("Axe",{type:"entity"}),WeaponManager.prototype.initialize=function(){this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.keyboard.on(pc.EVENT_KEYUP,this.onKeyUp,this),this.SetupWeapons(),this.ReInit()},WeaponManager.prototype.RemoveAllWeapons=function(){this.Weapon1=null,this.Weapon2=null,this.Weapon3=null,this.Weapon4=null,this.G36C.script.gunBehaviour.ReInit(),this.AUG.script.gunBehaviour.ReInit(),this.P90.script.gunBehaviour.ReInit(),this.AWP.script.gunBehaviour.ReInit(),this.Barrett.script.gunBehaviour.ReInit(),this.SCAR.script.gunBehaviour.ReInit(),this.M110.script.gunBehaviour.ReInit(),this.M3.script.gunBehaviour.ReInit(),this.M4.script.gunBehaviour.ReInit(),this.M249.script.gunBehaviour.ReInit(),this.MP5.script.gunBehaviour.ReInit(),this.XM1014.script.gunBehaviour.ReInit(),this.RPG.script.gunBehaviour.ReInit(),this.G36C.enabled=!1,this.AUG.enabled=!1,this.P90.enabled=!1,this.AWP.enabled=!1,this.Barrett.enabled=!1,this.SCAR.enabled=!1,this.M110.enabled=!1,this.M3.enabled=!1,this.M4.enabled=!1,this.M249.enabled=!1,this.MP5.enabled=!1,this.XM1014.enabled=!1,this.RPG.enabled=!1},WeaponManager.prototype.GetRandomWeapon=function(){var e=this.G36C,t=random(1,13);return 1===t?e=this.G36C:2===t?e=this.AUG:3===t?e=this.P90:4===t||5===t?e=this.AWP:6===t?e=this.Barrett:7===t?e=this.SCAR:8===t?e=this.M110:9===t||10===t?e=this.M3:11===t?e=this.M4:12===t?e=this.M249:13===t&&(e=this.XM1014),e},WeaponManager.prototype.ReInit=function(){this.currentweapon=null,this.RemoveAllWeapons(),this.AddWeapon(this.MP5),!1===this.entity.script.playerMovement.GameManager.script.gameManager.singleplayer&&this.AddWeapon(this.GetRandomWeapon()),this.app.touch&&!0===this.entity.script.playerMovement.GameManager.script.gameManager.singleplayer&&this.AddWeapon(this.AWP),this.currentSlot=1,this.Weapon1&&this.Switch(this.Weapon1),this.takingweapon=!1,this.takingweaponAnim=!1,this.Spine=this.entity.findByName("mixamorig:Spine"),this.Jetpack.reparent(this.Spine),this.Jetpack.enabled=!1,this.JetpackFlameParticle1=this.Jetpack.findByName("FlameParticle1"),this.JetpackFlameParticle2=this.Jetpack.findByName("FlameParticle2"),this.punching=!1,this.canpunching=!0,this.throwing=!1,this.throwingidle=!1,this.grenadeCount=8,this.takenammo=!1,this.recoil=!1,this.recoilRotation=new pc.Vec3,this.recoilforce=.03},WeaponManager.prototype.update=function(e){if(this.currentweapon&&(this.entity.script.playerMovement.GameManager.script.gameUi.PlayerGrenadeAmmo.element.text=Math.floor(this.grenadeCount),this.entity.script.playerMovement.GameManager.script.gameUi.PlayerAmmo.element.text=Math.floor(this.currentweapon.script.gunBehaviour.LoadedBullets)+"/"+Math.floor(this.currentweapon.script.gunBehaviour.BulletInventory),!0===this.currentweapon.script.gunBehaviour.rpg&&(this.entity.script.playerMovement.GameManager.script.gameUi.PlayerAmmo.element.text=Math.floor(this.currentweapon.script.gunBehaviour.LoadedBullets))),this.CurrentPickup&&(this.Weapon1&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon1.name&&this.TakePickup(),this.Weapon2&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon2.name&&this.TakePickup(),this.Weapon3&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon3.name&&this.TakePickup(),this.Weapon4&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon4.name&&this.TakePickup()),!0===this.recoil){var t=.7;!0===this.currentweapon.script.gunBehaviour.isAiming&&(t=.5),this.targetRotation=new pc.Vec3(this.entity.script.playerMovement.Camera.script.cameraMovement.eulers.x-this.recoilforce*t*.3,this.entity.script.playerMovement.Camera.script.cameraMovement.eulers.y-this.recoilforce*t,0),this.recoilRotation.lerp(this.entity.script.playerMovement.Camera.script.cameraMovement.eulers,this.targetRotation,1),this.entity.script.playerMovement.Camera.script.cameraMovement.eulers=this.recoilRotation}else this.recoilalpha=0;if(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1.enabled=!1,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2.enabled=!1,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3.enabled=!1,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4.enabled=!1,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolordefault,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolordefault,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolordefault,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolordefault,this.Weapon1){if(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1.enabled=!0,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1_ammo.element.text=Math.floor(this.Weapon1.script.gunBehaviour.LoadedBullets)+"/"+Math.floor(this.Weapon1.script.gunBehaviour.BulletInventory),this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1_icon_temp!==this.Weapon1.name)this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1_icon_temp=this.Weapon1.name,(i=this.app.assets.find(this.Weapon1.name+"_icon.png","texture"))&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1_icon.element.texture=i.resource);this.currentweapon===this.Weapon1&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon1_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolorselected)}if(this.Weapon2){if(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2.enabled=!0,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2_ammo.element.text=Math.floor(this.Weapon2.script.gunBehaviour.LoadedBullets)+"/"+Math.floor(this.Weapon2.script.gunBehaviour.BulletInventory),this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2_icon_temp!==this.Weapon2.name)this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2_icon_temp=this.Weapon2.name,(i=this.app.assets.find(this.Weapon2.name+"_icon.png","texture"))&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2_icon.element.texture=i.resource);this.currentweapon===this.Weapon2&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon2_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolorselected)}if(this.Weapon3){if(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3.enabled=!0,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3_ammo.element.text=Math.floor(this.Weapon3.script.gunBehaviour.LoadedBullets)+"/"+Math.floor(this.Weapon3.script.gunBehaviour.BulletInventory),this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3_icon_temp!==this.Weapon3.name)this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3_icon_temp=this.Weapon3.name,(i=this.app.assets.find(this.Weapon3.name+"_icon.png","texture"))&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3_icon.element.texture=i.resource);this.currentweapon===this.Weapon3&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon3_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolorselected)}if(this.Weapon4){var i;if(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4.enabled=!0,this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4_ammo.element.text=Math.floor(this.Weapon4.script.gunBehaviour.LoadedBullets)+"/"+Math.floor(this.Weapon4.script.gunBehaviour.BulletInventory),this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4_icon_temp!==this.Weapon4.name)this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4_icon_temp=this.Weapon4.name,(i=this.app.assets.find(this.Weapon4.name+"_icon.png","texture"))&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4_icon.element.texture=i.resource);this.currentweapon===this.Weapon4&&(this.entity.script.playerMovement.GameManager.script.gameUi.Weapon4_bg.element.color=this.entity.script.playerMovement.GameManager.script.gameUi.currentweaponcolorselected)}},WeaponManager.attributes.add("Weapon1",{type:"entity"}),WeaponManager.attributes.add("Weapon2",{type:"entity"}),WeaponManager.attributes.add("Weapon3",{type:"entity"}),WeaponManager.attributes.add("Weapon4",{type:"entity"}),WeaponManager.prototype.PickUpWeapon=function(e){var t;"G36C"===e?t=this.G36C:"AUG"===e?t=this.AUG:"P90"===e?t=this.P90:"AWP"===e?t=this.AWP:"Barrett"===e?t=this.Barrett:"SCAR"===e?t=this.SCAR:"M110"===e?t=this.M110:"M3"===e?t=this.M3:"M4"===e?t=this.M4:"M249"===e?t=this.M249:"MP5"===e?t=this.MP5:"XM1014"===e?t=this.XM1014:"RPG"===e&&(t=this.RPG),t&&this.AddWeapon(t)},WeaponManager.attributes.add("G36C",{type:"entity"}),WeaponManager.attributes.add("AUG",{type:"entity"}),WeaponManager.attributes.add("P90",{type:"entity"}),WeaponManager.attributes.add("AWP",{type:"entity"}),WeaponManager.attributes.add("Barrett",{type:"entity"}),WeaponManager.attributes.add("SCAR",{type:"entity"}),WeaponManager.attributes.add("M110",{type:"entity"}),WeaponManager.attributes.add("M3",{type:"entity"}),WeaponManager.attributes.add("M4",{type:"entity"}),WeaponManager.attributes.add("M249",{type:"entity"}),WeaponManager.attributes.add("MP5",{type:"entity"}),WeaponManager.attributes.add("XM1014",{type:"entity"}),WeaponManager.attributes.add("RPG",{type:"entity"}),WeaponManager.prototype.SetupWeapons=function(){this.RightHand=this.entity.findByName("mixamorig:RightHand"),this.Axe.reparent(this.RightHand),this.G36C.reparent(this.RightHand),this.AUG.reparent(this.RightHand),this.P90.reparent(this.RightHand),this.AWP.reparent(this.RightHand),this.Barrett.reparent(this.RightHand),this.SCAR.reparent(this.RightHand),this.M110.reparent(this.RightHand),this.M3.reparent(this.RightHand),this.M4.reparent(this.RightHand),this.M249.reparent(this.RightHand),this.MP5.reparent(this.RightHand),this.XM1014.reparent(this.RightHand),this.RPG.reparent(this.RightHand),this.G36C.enabled=!1,this.AUG.enabled=!1,this.P90.enabled=!1,this.AWP.enabled=!1,this.Barrett.enabled=!1,this.SCAR.enabled=!1,this.M110.enabled=!1,this.M3.enabled=!1,this.M4.enabled=!1,this.M249.enabled=!1,this.MP5.enabled=!1,this.XM1014.enabled=!1,this.RPG.enabled=!1},WeaponManager.prototype.AddWeapon=function(e){return e===this.Weapon1?(this.Weapon1.script.gunBehaviour.LoadAmmo(),void console.log("add ammo to "+this.Weapon1.name)):e===this.Weapon2?(this.Weapon2.script.gunBehaviour.LoadAmmo(),void console.log("add ammo to "+this.Weapon2.name)):e===this.Weapon3?(this.Weapon3.script.gunBehaviour.LoadAmmo(),void console.log("add ammo to "+this.Weapon3.name)):e===this.Weapon4?(this.Weapon4.script.gunBehaviour.LoadAmmo(),void console.log("add ammo to "+this.Weapon4.name)):(null===this.Weapon1?this.Weapon1=e:null===this.Weapon2?this.Weapon2=e:null===this.Weapon3?this.Weapon3=e:null===this.Weapon4?this.Weapon4=e:1===this.currentSlot?this.Weapon1=e:2===this.currentSlot?this.Weapon2=e:3===this.currentSlot?this.Weapon3=e:4===this.currentSlot&&(this.Weapon4=e),void this.Switch(e))},WeaponManager.prototype.Switch=function(e){this.currentweapon&&this.currentweapon.sound.stop(),e===this.Weapon1?this.currentSlot=1:e===this.Weapon2?this.currentSlot=2:e===this.Weapon3?this.currentSlot=3:e===this.Weapon4&&(this.currentSlot=4),this.G36C.enabled=!1,this.AUG.enabled=!1,this.P90.enabled=!1,this.AWP.enabled=!1,this.Barrett.enabled=!1,this.SCAR.enabled=!1,this.M110.enabled=!1,this.M3.enabled=!1,this.M4.enabled=!1,this.M249.enabled=!1,this.MP5.enabled=!1,this.XM1014.enabled=!1,this.RPG.enabled=!1,e.enabled=!0,this.currentweapon=e,this.takingweapon=!0,setTimeout(function(){this.takingweapon=!1}.bind(this),400),this.takingweaponAnim=!0,setTimeout(function(){this.takingweaponAnim=!1}.bind(this),10),this.entity.script.playerMovement.GameManager.script.gameManager.PlayWeaponFireSound("WeaponSwitch")},WeaponManager.prototype.onKeyUp=function(e){currentkeydown2=null},WeaponManager.prototype.onKeyDown=function(e){!1!==cursorIsLooked&&!0!==chatInputGameEnabled&&!0!==this.takingweapon&&!1!==this.entity.script.playerMovement.grounded&&!0!==this.entity.script.playerMovement.slide&&!0!==this.entity.script.playerMovement.fly&&(e.key===pc.KEY_1&&this.Weapon1&&this.Weapon1!==this.currentweapon&&this.Switch(this.Weapon1),e.key===pc.KEY_2&&this.Weapon2&&this.Weapon2!==this.currentweapon&&this.Switch(this.Weapon2),e.key===pc.KEY_3&&this.Weapon3&&this.Weapon3!==this.currentweapon&&this.Switch(this.Weapon3),e.key===pc.KEY_4&&this.Weapon4&&this.Weapon4!==this.currentweapon&&this.Switch(this.Weapon4),e.key===pc.KEY_F&&this.PickUp_(),currentkeydown2===e.key||(currentkeydown2=e.key,this.currentweapon&&(e.key===pc.KEY_E&&this.Axe_(),e.key===pc.KEY_G&&this.Grenade_())))},WeaponManager.prototype.Grenade_=function(){!0===this.entity.script.playerMovement.grounded&&this.grenadeCount>0&&!1===this.throwing&&!1===this.currentweapon.script.gunBehaviour.reloading&&!1===this.entity.script.playerMovement.slide&&this.currentweapon&&!0===this.currentweapon.script.gunBehaviour.canshotprojectile()&&(this.grenadeCount-=1,this.grenadeCount<=0&&(this.grenadeCount=0),this.currentweapon.script.gunBehaviour.grenadepressedtime=0,setTimeout(function(){this.currentweapon&&(this.entity.sound.play("Throw"),this.currentweapon.script.gunBehaviour.projectile())}.bind(this),600),this.throwing=!0,setTimeout(function(){this.throwing=!1}.bind(this),700))},WeaponManager.prototype.Axe_=function(){!1===this.punching&&!0===this.canpunching&&!0===this.entity.script.playerMovement.grounded&&!1===this.currentweapon.script.gunBehaviour.reloading&&!1===this.throwing&&!1===this.entity.script.playerMovement.slide&&(this.entity.sound.play("PunchWhoosh"),this.currentweapon&&this.currentweapon.script.gunBehaviour.punch(),this.punching=!0,setTimeout(function(){this.punching=!1}.bind(this),800),this.canpunching=!1,setTimeout(function(){this.canpunching=!0}.bind(this),1400))},WeaponManager.prototype.DoRecoil=function(e){this.recoilforce=e,this.recoil=!0,setTimeout(function(){this.recoil=!1}.bind(this),70)},WeaponManager.prototype.PickUp_=function(){this.CurrentPickup&&this.TakePickup()},WeaponManager.prototype.TakePickup=function(){if(this.CurrentPickup){var e=this.CurrentPickup.name,t=this.CurrentPickup.parent;if(this.entity.sound.play("Pickup"),this.PickUpWeapon(e),t){var i=t.script;i&&i.applyDestroy&&t.destroy()}this.Weapon1&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon1.name&&this.CurrentPickup.script.weaponPickup.invi(),this.Weapon2&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon2.name&&this.CurrentPickup.script.weaponPickup.invi(),this.Weapon3&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon3.name&&this.CurrentPickup.script.weaponPickup.invi(),this.Weapon4&&this.CurrentPickup&&this.CurrentPickup.name===this.Weapon4.name&&this.CurrentPickup.script.weaponPickup.invi(),this.CurrentPickup=null}},WeaponManager.attributes.add("CurrentPickup",{type:"entity"});var ApplyDestroy=pc.createScript("applyDestroy");ApplyDestroy.attributes.add("timeout",{type:"number"}),ApplyDestroy.prototype.initialize=function(){setTimeout(function(){this.entity.destroy()}.bind(this),this.timeout)};var Grenade=pc.createScript("grenade");Grenade.attributes.add("explodeoncontact",{type:"boolean",default:!1}),Grenade.attributes.add("explosionrangeentity",{type:"entity",default:null}),Grenade.attributes.add("timer",{type:"number",default:1.5}),Grenade.attributes.add("explosionname",{type:"string"}),Grenade.prototype.initialize=function(){this.throwing=!1,this.dodamage=!1,this.exploded=!1,this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.timeinground=0,this.touchground=!1},Grenade.prototype.StartPool=function(t,i,e,n){this.timer=1.7,this.throwing=!0,this.touchground=!1,this.entity.rigidbody.type=pc.BODYTYPE_DYNAMIC,this.entity.rigidbody.teleport(t),this.entity.rigidbody.applyImpulse(e),this.dodamage=n,"BallProjectile_1"===this.entity.name||"BallProjectile_2"===this.entity.name||"BallProjectile_3"===this.entity.name?(this.entity.sound.play("Swoosh"),this.entity.children[0].particlesystem.play(),this.entity.children[1].particlesystem.play()):"GrenadeLauncher"!==this.entity.name&&"Grenade"!==this.entity.name||!0===this.dodamage&&(this.entity.children[0].script.trail.enabled=!0)},Grenade.prototype.RestartPool=function(){this.entity.rigidbody.type=pc.BODYTYPE_KINEMATIC,this.entity.setPosition(0,-1e3,0),this.throwing=!1,this.dodamage=!1,this.exploded=!1,this.timer=1.7,this.touchground=!1,"BallProjectile_1"===this.entity.name||"BallProjectile_2"===this.entity.name||"BallProjectile_3"===this.entity.name?(this.entity.children[0].particlesystem.reset(),this.entity.children[1].particlesystem.reset()):"GrenadeLauncher"!==this.entity.name&&"Grenade"!==this.entity.name||!0===this.dodamage&&(this.entity.children[0].script.trail.enabled=!1)},Grenade.prototype.onCollisionStart=function(t){!0===this.explodeoncontact?t.other.rigidbody&&this.explosion():this.touchground=!0},Grenade.prototype.update=function(t){!0!==this.explodeoncontact&&!1!==this.throwing&&(this.timer-=t,this.timer<0&&this.explosion(),1!==this.entity.rigidbody.mass&&(this.entity.rigidbody.mass=1),this.entity.rigidbody.linearFactor!==pc.Vec3.ZERO&&(this.entity.rigidbody.linearFactor=new pc.Vec3(1,1,1)),!0===this.touchground?(this.timeinground+=t,this.timeinground<=.14?this.entity.rigidbody.mass=5:this.timeinground>=.75?this.entity.rigidbody.mass=11:this.timeinground>=.5?this.entity.rigidbody.mass=9:this.timeinground>=.26?this.entity.rigidbody.mass=7:this.timeinground>=.15&&(this.entity.rigidbody.mass=4)):this.timeinground=1)},Grenade.prototype.explosion=function(t){if(!1!==this.throwing&&!1===this.exploded){this.exploded=!0;var i=this.entity.getPosition(),e=this.dodamage,n=this.explosionname;if(this.RestartPool(),this.entity.enabled=!1,this.app.fire("ObjectPoolExplosion:"+this.explosionname,(function(t){t.setPosition(i),t.sound.play("Explosion"),"GrenadeLauncherExplosion"===n||"GrenadeExplosion"===n?(t.children[0].particlesystem.play(),t.children[1].particlesystem.play()):"BallProjectileExplosion_1"!==n&&"BallProjectileExplosion_2"!==n&&"BallProjectileExplosion_3"!==n||t.children[0].particlesystem.play()})),!0===e){var o=this.explosionrangeentity.clone();this.app.root.addChild(o),o.setPosition(i),o.enabled=!0,o.script.explosionRange.dodamage=e}}};var ExplosionRange=pc.createScript("explosionRange");ExplosionRange.attributes.add("Damage",{type:"number"}),ExplosionRange.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.GameManager=this.app.root.findByName("GameManager"),this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,setTimeout(function(){this.entity.enabled=!1}.bind(this),300)},ExplosionRange.prototype.onTriggerEnter=function(e){if(console.log(e),!0===e.tags.has("BotAI")){let a=e.script.botAi.health_;if(e.script.botAi.ReceiveDamage(this.Damage),e.script.botAi.health_<=0&&a>=1){console.log("Bot Killed"),this.GameManager.sound.play("Kill"),this.GameManager.script.gameManager.singleplayerKills+=1,e.script.botAi.currentWeapon&&this.GameManager.script.gameManager.SpawnPickup(e.script.botAi.currentWeapon.name,new pc.Vec3(e.getPosition().x,e.getPosition().y+1,e.getPosition().z),13),this.app.touch?this.GameManager.script.gameManager.player.script.playerMovement.Health+=100:this.GameManager.script.gameManager.player.script.playerMovement.Health+=60;let a=100;!0===this.GameManager.script.gameManager.singleplayer&&(a=150),this.GameManager.script.gameManager.player.script.playerMovement.Health>=a&&(this.GameManager.script.gameManager.player.script.playerMovement.Health=a)}this.GameManager.script.gameUi.hitmark()}else if(!0===e.tags.has("RemoteMesh")){let a=this.SmartFoxServer.GetUserKey(e.parent.name);if(null!==a&&null!==a.user){let e=!0;if(a.entity){let t=a.entity.script.remotePlayer;!1===t.receivedamage||!1===t.receivedamage2||"Dying"===t.currentAnimation?e=!1:(t.fake_health>=1&&t.fake_health-Math.floor(1*this.Damage)<=0&&this.GameManager.sound.play("Kill"),t.fake_health-=Math.floor(1*this.Damage))}!0===e&&(this.SmartFoxServer.SendDamage("Explosion",1,a.user.id),this.GameManager.script.gameUi.hitmark())}}};var Missile=pc.createScript("missile");Missile.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.onContact,this),this.exploded=!1},Missile.prototype.onContact=function(i){this.explode()},Missile.prototype.explode=function(){if(!1===this.exploded){var i=this.app.root.findByName("MissileExplosion").clone();i.setPosition(this.entity.getPosition()),this.app.root.addChild(i),i.enabled=!0,this.entity.destroy(),this.exploded=!0}};var AspectRatioFitter=pc.createScript("aspectRatioFitter");AspectRatioFitter.attributes.add("fitOnStart",{type:"boolean",default:!0}),AspectRatioFitter.attributes.add("autoAspect",{type:"boolean",default:!0}),AspectRatioFitter.attributes.add("aspect",{type:"number"}),AspectRatioFitter.attributes.add("fitMode",{type:"number",enum:[{Fit:0},{Fill:1}]}),AspectRatioFitter.attributes.add("borderPercent",{type:"number",default:1}),AspectRatioFitter.prototype.postInitialize=function(){this.fitOnStart&&this.fit()},AspectRatioFitter.prototype.fit=function(){var t,e;void 0!==this.entity.parent.element?(t=this.entity.parent.element.width*this.borderPercent,e=this.entity.parent.element.height*this.borderPercent):(t=this.app.graphicsDevice.width*this.borderPercent,e=this.app.graphicsDevice.height*this.borderPercent);var i=this.autoAspect?this.entity.element.texture.width/this.entity.element.texture.height:this.aspect,r=t/e,a=0,s=0;0===this.fitMode?i>r?(a=t,s=t/i):(s=e,a=e*i):i<r?(a=t,s=t/i):(s=e,a=e*i),this.entity.element.width=a,this.entity.element.height=s};var WeaponPickup=pc.createScript("weaponPickup");WeaponPickup.prototype.initialize=function(){this.GameManager=this.app.root.findByName("GameManager").script.gameManager,this.isStatic=!1,this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerLeave,this),this.entity.on("destroy",this.onDestroy,this)},WeaponPickup.prototype.update=function(e){},WeaponPickup.prototype.onTriggerEnter=function(e){if(e.tags.has("Player")&&this.GameManager&&this.GameManager.player)if("Health"===this.entity.name){this.app.touch?this.GameManager.player.script.playerMovement.Health+=100:this.GameManager.player.script.playerMovement.Health+=60;let e=100;!0===this.GameManager.singleplayer&&(e=150),this.GameManager.player.script.playerMovement.Health>=e&&(this.GameManager.player.script.playerMovement.Health=e),this.enable(!1),this.GameManager.player.script.weaponManager.entity.sound.play("Bubble")}else this.GameManager.player.script.weaponManager.CurrentPickup=this.entity},WeaponPickup.prototype.onTriggerLeave=function(e){e.tags.has("Player")&&this.GameManager&&this.GameManager.player&&(this.GameManager.player.script.weaponManager.CurrentPickup=null)},WeaponPickup.prototype.invi=function(){this.enable(!1),setTimeout(function(){this.enable(!0)}.bind(this),2e4)},WeaponPickup.prototype.enable=function(e){!1===e?(this.entity.collision&&(this.entity.collision.enabled=!1),this.entity.model&&(this.entity.model.enabled=!1),this.entity.parent&&this.entity.parent.rigidbody&&(this.entity.parent.rigidbody.type=pc.BODYTYPE_KINEMATIC)):(this.entity.collision&&(this.entity.collision.enabled=!0),this.entity.model&&(this.entity.model.enabled=!0),this.entity.parent&&this.entity.parent.rigidbody&&(this.entity.parent.rigidbody.type=pc.BODYTYPE_DYNAMIC))},WeaponPickup.prototype.onDestroy=function(){this.GameManager&&this.GameManager.player&&this.GameManager.player.script.weaponManager.CurrentPickup&&this.GameManager.player.script.weaponManager.CurrentPickup===this.entity&&(this.GameManager.player.script.weaponManager.CurrentPickup=null)};var Rotate=pc.createScript("rotate");Rotate.prototype.initialize=function(){},Rotate.prototype.update=function(t){this.entity.rotate(0,90*t,0)};var GameManager=pc.createScript("gameManager");GameManager.attributes.add("player",{type:"entity",default:null}),GameManager.attributes.add("minimap",{type:"entity",default:null}),GameManager.attributes.add("minimap2",{type:"entity",default:null}),GameManager.attributes.add("BattleRoyaleAI",{type:"entity"}),GameManager.attributes.add("Map",{type:"entity"}),GameManager.attributes.add("Grass",{type:"entity"}),GameManager.attributes.add("AIManager",{type:"entity"});var poki_init=!1,gamePlay=!1,cursorIsLooked=!1,watchingAds=!1,ShowingAd728x90=!1,ShowingAd320x50=!1,self_gamemanager=this;GameManager.attributes.add("html",{type:"asset",assetType:"html",title:"HTML Asset"}),GameManager.prototype.initialize=function(){this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,this.app.touch&&(this.player.children[2].enabled=!0),self_gamemanager=this,null===this.app.touch&&document.addEventListener("mouseleave",(function(e){!0===self_gamemanager.entity.script.gameUi.InGameUI.enabled&&self_gamemanager.entity.script.gameUi.P(!0)})),this.singleplayerKills=0,this.singleplayer=!1,this.pickupUI=null,this.pickupText=null,this.SpawnPoints=this.app.root.findByTag("SpawnPoint"),this.WeaponPickupsList=this.app.root.findByTag("StaticWeaponSpawnpoint"),this.hadJetpack=!1,setTimeout(function(){this.Map.enabled=!0}.bind(this),1200),this.currentAudioValue=1,this.div=document.createElement("div"),this.div.classList.add("container"),this.div.innerHTML=this.html.resource||"",document.body.appendChild(this.div),PokiSDK&&(PokiSDK.init().then((()=>{console.log("Poki SDK successfully initialized"),poki_init=!0,PokiSDK&&PokiSDK.gameLoadingStart()})).catch((()=>{console.log("Initialized, but the user likely has adblock")})),PokiSDK.setDebug(!1)),setInterval(this.ListenerScreenSize,100);},GameManager.prototype.ListenerScreenSize=function(){if(!1!==poki_init){var e=window.innerWidth;!1===self_gamemanager.MainMenu.enabled||!0===self_gamemanager.entity.script.gameUi.OptionsUI.enabled?self_gamemanager.DestroyAds():e<=1199?(1==ShowingAd728x90&&self_gamemanager.DisplayAd728x90(!1),0==ShowingAd320x50&&self_gamemanager.DisplayAd320x50(!0)):e>=1200&&(0==ShowingAd728x90&&self_gamemanager.DisplayAd728x90(!0),1==ShowingAd320x50&&self_gamemanager.DisplayAd320x50(!1))}},GameManager.prototype.DestroyAds=function(){1==ShowingAd728x90&&self_gamemanager.DisplayAd728x90(!1),1==ShowingAd320x50&&self_gamemanager.DisplayAd320x50(!1)},GameManager.prototype.DisplayAd728x90=function(e){!0===e?PokiSDK&&!1===ShowingAd728x90&&(PokiSDK.displayAd(ad728x90Container,"728x90"),ShowingAd728x90=!0):PokiSDK&&!0===ShowingAd728x90&&(PokiSDK.destroyAd(ad728x90Container),ShowingAd728x90=!1)},GameManager.prototype.DisplayAd320x50=function(e){!0===e?PokiSDK&&!1===ShowingAd320x50&&(self_gamemanager.app.touch?PokiSDK.displayAd(admobile320x50Container,"320x50"):PokiSDK.displayAd(ad320x50Container,"320x50"),ShowingAd320x50=!0):PokiSDK&&!0===ShowingAd320x50&&(self_gamemanager.app.touch?PokiSDK.destroyAd(admobile320x50Container):PokiSDK.destroyAd(ad320x50Container),ShowingAd320x50=!1)},GameManager.prototype.SetGamePlay=function(e){!0===e?!1===gamePlay&&(PokiSDK&&PokiSDK.gameplayStart(),gamePlay=!0):!0===gamePlay&&(PokiSDK&&PokiSDK.gameplayStop(),gamePlay=!1)},GameManager.prototype.RequestCommercial=function(e){if(!0===watchingAds)return;let t=cursorIsLooked,a=gamePlay;this.MuteAudio(!0),this.SetLookCursor(!1),this.SetGamePlay(!1),watchingAds=!0,PokiSDK.commercialBreak().then((()=>{console.log("Commercial break finished, proceeding to game"),this.MuteAudio(!1),this.SetLookCursor(t),this.SetGamePlay(a),watchingAds=!1,e&&e()}))},GameManager.prototype.MuteAudio=function(e){!0===e?(this.currentAudioValue=this.app.systems.sound.volume,this.app.systems.sound.volume=0):this.app.systems.sound.volume=this.currentAudioValue},GameManager.prototype.SetLookCursor=function(e){!0!==watchingAds&&(!0===e?(cursorIsLooked=!0,this.app.mouse.enablePointerLock()):(cursorIsLooked=!1,this.app.mouse.disablePointerLock()))},GameManager.prototype.update=function(e){this.entity.script.gameUi.PickupUI.enabled=!1,this.player.script.weaponManager.CurrentPickup&&(!1===this.entity.script.gameUi.PickupUI.enabled&&(this.entity.script.gameUi.PickupUI.enabled=!0),this.entity.script.gameUi.PickupText.element.text="PRESS F TO PICK UP "+this.player.script.weaponManager.CurrentPickup.name)},GameManager.attributes.add("G36C",{type:"entity"}),GameManager.attributes.add("AUG",{type:"entity"}),GameManager.attributes.add("P90",{type:"entity"}),GameManager.attributes.add("AWP",{type:"entity"}),GameManager.attributes.add("Barrett",{type:"entity"}),GameManager.attributes.add("SCAR",{type:"entity"}),GameManager.attributes.add("M110",{type:"entity"}),GameManager.attributes.add("M3",{type:"entity"}),GameManager.attributes.add("M4",{type:"entity"}),GameManager.attributes.add("M249",{type:"entity"}),GameManager.attributes.add("MP5",{type:"entity"}),GameManager.attributes.add("XM1014",{type:"entity"}),GameManager.attributes.add("RPG",{type:"entity"}),GameManager.attributes.add("Health",{type:"entity"}),GameManager.attributes.add("MainMenu",{type:"entity"}),GameManager.attributes.add("MapLight",{type:"entity"}),GameManager.prototype.PlayAgain=function(){this.entity.sound.play("Button"),this.entity.script.gameUi.BattleRoyaleEndGame.enabled=!1;let e=function(){this.SpawnPlayer()}.bind(this);this.RequestCommercial(e)},GameManager.prototype.LeaveGame=function(){this.SetGamePlay(!1),this.entity.sound.play("Button"),this.entity.script.gameUi.LoadingUI.enabled=!1,this.entity.script.gameUi.PauseUI.enabled=!1,this.entity.script.gameUi.PlayerUI.enabled=!0,this.SetLookCursor(!1),this.player.enabled=!1,this.minimap.enabled=!1,this.minimap2.enabled=!1,roomsList.forEach((e=>{e.destroy()})),roomsList=[],!0===this.singleplayer?(this.entity.script.gameUi.BattleRoyaleEndGame.enabled=!1,this.AIManager.script.aimanager.BattleRoyaleStop()):(this.SmartFoxServer.RemoveAllRemotePlayers(),!1===isSFSDisconnected()&&sfs.disconnect()),this.RemoveAllPickups(),this.RemoveStaticWeapons(),this.MainMenu.enabled=!0,this.entity.script.gameUi.InGameUI.enabled=!1,this.SmartFoxServer.OpenRoomListUI(!0),this.SmartFoxServer.chatInputGame.enabled=!1,this.SmartFoxServer.chatTextGame.element.text="",this.SmartFoxServer.chatTextGame.enabled=!1,ingamechats=[],bestroomscurrentindex=0},GameManager.prototype.SpawnPlayer=function(){!0!==this.MainMenu.enabled&&(this.Grass.setLocalPosition(123.6,-.88,5.915),setTimeout(function(){this.Grass.setLocalPosition(123.6,-.84,5.915)}.bind(this),5e3),this.SetGamePlay(!0),this.SetLookCursor(!0),this.entity.script.gameUi.PlayerUI.enabled=!0,this.entity.script.gameUi.LoadingUI.enabled=!1,this.rand=random(0,this.SpawnPoints.length-1),this.pos=this.SpawnPoints[this.rand].getPosition(),this.rot=this.SpawnPoints[this.rand].getRotation(),this.player.rigidbody.teleport(this.pos,this.rot),this.player.enabled=!0,this.minimap.enabled=!0,this.minimap2.enabled=!0,!1===this.singleplayer&&this.player.script.playerMovement.Health<=0&&this.SmartFoxServer.RequestHealth(),this.player.script.playerMovement.ReInit(),this.player.script.weaponManager.ReInit(),setTimeout(function(){this.player.script.weaponManager.enabled=!0}.bind(this),100),!0===this.singleplayer?(this.singleplayerKills=0,this.RemoveAllPickups(),this.RestartAllStaticWeapons(),this.BattleRoyaleAI.enabled=!0,this.ActionTriggers(!1),this.AIManager.script.aimanager.BattleRoyaleStart(),this.SmartFoxServer.Leader.enabled=!1,this.SmartFoxServer.Timer.enabled=!1,this.SmartFoxServer.Chat.enabled=!1):(this.BattleRoyaleAI.enabled=!1,this.AIManager.script.aimanager.battleRoyaleStart=!1,this.ActionTriggers(!1),this.AIManager.script.aimanager.DisableAllBots(),this.SmartFoxServer.Leader.enabled=!0,this.SmartFoxServer.Timer.enabled=!0,this.SmartFoxServer.Chat.enabled=!0,this.app.touch&&(this.SmartFoxServer.Chat.enabled=!1)))};var EnableColliderHandle,random=function(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e};GameManager.prototype.SpawnPickup=function(e,t,a){this.app.fire("ObjectPoolPickup:"+e,(function(e){e.script.applyPoolingClear.StartPool(a),e.rigidbody.teleport(t)}))},GameManager.prototype.SpawnPickupMap=function(e,t,a){this.pickup=null,"G36C"===e?this.pickup=this.G36C.clone():"AUG"===e?this.pickup=this.AUG.clone():"P90"===e?this.pickup=this.P90.clone():"AWP"===e?this.pickup=this.AWP.clone():"Barrett"===e?this.pickup=this.Barrett.clone():"SCAR"===e?this.pickup=this.SCAR.clone():"M110"===e?this.pickup=this.M110.clone():"M3"===e?this.pickup=this.M3.clone():"M4"===e?this.pickup=this.M4.clone():"M249"===e?this.pickup=this.M249.clone():"MP5"===e?this.pickup=this.MP5.clone():"XM1014"===e?this.pickup=this.XM1014.clone():"RPG"===e?this.pickup=this.RPG.clone():"Health"===e&&(this.pickup=this.Health.clone()),this.pickup&&(this.app.root.addChild(this.pickup),this.pickup.setPosition(t),this.pickup.enabled=!0,!0===static&&(this.pickup.enabled=!1),0!==a&&(this.pickup.addComponent("script"),this.pickup.script.create("applyDestroy",{attributes:{timeout:a}})))},GameManager.prototype.SpawnPickupStatic=function(e,t,a){this.pickup=null,"G36C"===e?this.pickup=this.G36C.clone():"AUG"===e?this.pickup=this.AUG.clone():"P90"===e?this.pickup=this.P90.clone():"AWP"===e?this.pickup=this.AWP.clone():"Barrett"===e?this.pickup=this.Barrett.clone():"SCAR"===e?this.pickup=this.SCAR.clone():"M110"===e?this.pickup=this.M110.clone():"M3"===e?this.pickup=this.M3.clone():"M4"===e?this.pickup=this.M4.clone():"M249"===e?this.pickup=this.M249.clone():"MP5"===e?this.pickup=this.MP5.clone():"XM1014"===e?this.pickup=this.XM1014.clone():"RPG"===e?this.pickup=this.RPG.clone():"Health"===e&&(this.pickup=this.Health.clone()),this.pickup&&(a.addChild(this.pickup),this.pickup.setPosition(t),this.pickup.enabled=!0)},GameManager.prototype.ActionTriggers=function(e){this.app.root.findByTag("StaticWeaponsTrigger").forEach((t=>{t.script.trigger.Action(e)}))},GameManager.prototype.GenerateWeaponsData=function(){var e="";return this.WeaponPickupsList.forEach((t=>{e+=this.GetRandomWeapon()+"|"})),e},GameManager.prototype.LoadWeaponsData=function(e){var t=-1,a=e.split("|"[0]);a.forEach((e=>{(t+=1)>a.length||this.SpawnStaticWeapon(e,t)}))},GameManager.prototype.SpawnStaticWeapon=function(e,t){var a=-1;this.WeaponPickupsList.forEach((i=>{if(t===(a+=1)){var n=new pc.Vec3(i.getPosition().x,i.getPosition().y+.1,i.getPosition().z);this.SpawnPickupStatic(e,n,i)}}))},GameManager.prototype.RemoveAllPickups=function(){this.app.root.findByTag("Pickup").forEach((e=>{!0===e.enabled&&(e.setPosition(0,-1e3,0),e.enabled=!1)}))},GameManager.prototype.RemoveStaticWeapons=function(){let e=this.app.root.findByName("Map");if(e){e.findByTag("PickupMap").forEach((e=>{e.destroy()}))}},GameManager.prototype.RestartAllStaticWeapons=function(){let e=this.app.root.findByName("Map");if(e){e.findByTag("PickupMap").forEach((e=>{e.children[0].script.weaponPickup.enable(!0)}))}},GameManager.prototype.GetRandomWeapon=function(){var e="G36C",t=random(1,230);return!1===this.singleplayer&&(t=random(1,187)),1===t||2===t||3===t||4===t||5===t||6===t||7===t||8===t||9===t?e="G36C":10===t||11===t||12===t||13===t||14===t||15===t||16===t||17===t||18===t?e="P90":19===t||20===t||21===t||22===t||23===t||24===t||25===t||26===t||27===t?e="SCAR":46===t||47===t||48===t||49===t||50===t||51===t||52===t||53===t||54===t?e="M4":55===t||56===t||57===t||58===t||59===t||60===t||61===t||62===t||63===t?e="M249":64===t||65===t||66===t||67===t||68===t||69===t||70===t||71===t||72===t?e="MP5":73===t||74===t||75===t||76===t||77===t||78===t||79===t||80===t||81===t||82===t||83===t||84===t||85===t||86===t?e="AUG":87===t||88===t||89===t||90===t||91===t||92===t||93===t||94===t||95===t||96===t||97===t||98===t||99===t||100===t?e="M110":101===t||102===t||103===t||104===t||105===t||106===t||107===t||108===t||109===t||110===t||111===t||112===t||113===t||114===t||115===t||116===t||117===t||118===t||119===t||120===t||121===t||122===t||123===t||124===t||125===t?e="M3":126===t||127===t||128===t||129===t||130===t||131===t||132===t||133===t||134===t||135===t||136===t||137===t||138===t||139===t||140===t||141===t||142===t||143===t||144===t||145===t||146===t||147===t||148===t||149===t||150===t?e="XM1014":151===t||152===t||153===t||154===t||155===t||156===t||157===t||158===t||159===t||160===t||161===t||162===t||163===t||164===t?e="AWP":165===t||166===t||167===t||168===t||169===t||170===t||171===t||172===t||173===t||174===t||175===t||176===t||177===t||178===t?e="Barrett":179===t||180===t||181===t||182===t||183===t||184===t||185===t||186===t||187===t?e="RPG":t>=188&&(e="Health"),e},GameManager.prototype.ImpactBullet=function(e,t){this.app.fire("ObjectPoolParticle:BulletImpact",(function(a){a.setPosition(e),a.children[0].particlesystem.play(),a.setEulerAngles(t.x,t.y,t.z)}))},GameManager.prototype.PunchImpact=function(e,t){this.app.fire("ObjectPoolParticle:PunchImpact",(function(a){a.setPosition(e),a.setEulerAngles(t.x,t.y,t.z)}))},GameManager.prototype.ImpactBlood=function(e,t){this.app.fire("ObjectPoolParticle:BloodImpact",(function(a){a.setPosition(e),a.children[0].particlesystem.play(),a.setEulerAngles(t.x,t.y,t.z)}))},GameManager.prototype.GrenadeLauncher_=function(e,t,a,i,n,o,r,s,p,l,c,h){var d=new pc.Vec3(e,t,a),m=new pc.Vec3(i,n,o),u=new pc.Quat(r,s,p,l),y=d,g=m,M=new pc.Vec3;M.copy(g),M.scale(1e3);var P=y;P.add(g.scale(c)),this.app.fire("ObjectPoolGrenade:GrenadeLauncher",(function(e){e.script.grenade.StartPool(P,u,M,h)}),u)},GameManager.prototype.Grenade_=function(e,t,a,i,n,o,r,s,p,l,c,h,d){var m=new pc.Vec3(e,t,a),u=new pc.Vec3(i,n,o),y=new pc.Quat(r,s,p,l),g=m,M=u,P=new pc.Vec3;P.copy(M),P.scale(h);var S=g;S.add(M.scale(c));var b=y;this.app.fire("ObjectPoolGrenade:Grenade",(function(e){e.script.grenade.StartPool(S,b,P,d)}))},GameManager.prototype.PlayWeaponFireSound=function(e){this.entity.sound.play(e)};var InEnableColliders=!1;GameManager.prototype.EnableColliders=function(){!0===InEnableColliders&&clearTimeout(EnableColliderHandle),InEnableColliders=!0,!0===this.singleplayer?(this.AIManager.script.aimanager.GetAliveBots().forEach((e=>{e.script.botAi.EnableCollider(!0)})),remotePlayers.forEach((e=>{e.entity.script.remotePlayer.EnableCollider(!0)})),EnableColliderHandle=setTimeout(function(){InEnableColliders=!1,this.AIManager.script.aimanager.GetAliveBots().forEach((e=>{e.script.botAi.EnableCollider(!1)})),remotePlayers.forEach((e=>{e.entity.script.remotePlayer.EnableCollider(!1)}))}.bind(this),3500)):(remotePlayers.forEach((e=>{e.entity.script.remotePlayer.EnableCollider(!0)})),EnableColliderHandle=setTimeout(function(){InEnableColliders=!1,remotePlayers.forEach((e=>{e.entity.script.remotePlayer.EnableCollider(!1)}))}.bind(this),3500))};var GameUi=pc.createScript("gameUi");function iOS(){return["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document}GameUi.attributes.add("StormScreen",{type:"entity"}),GameUi.attributes.add("AIManager",{type:"entity"}),GameUi.attributes.add("BeatenUI",{type:"entity"}),GameUi.attributes.add("PlayerGrenadeAmmo",{type:"entity"}),GameUi.attributes.add("PlayerAmmo",{type:"entity"}),GameUi.attributes.add("PlayerHP",{type:"entity"}),GameUi.attributes.add("PickupText",{type:"entity"}),GameUi.attributes.add("PickupUI",{type:"entity"}),GameUi.attributes.add("Crosshair2",{type:"entity"}),GameUi.attributes.add("DynamicCrosshair",{type:"entity"}),GameUi.attributes.add("SniperScope",{type:"entity"}),GameUi.attributes.add("RPGCrosshair",{type:"entity"}),GameUi.attributes.add("Weapon1",{type:"entity"}),GameUi.attributes.add("Weapon1_icon",{type:"entity"}),GameUi.attributes.add("Weapon1_ammo",{type:"entity"}),GameUi.attributes.add("Weapon1_bg",{type:"entity"}),GameUi.attributes.add("Weapon2",{type:"entity"}),GameUi.attributes.add("Weapon2_icon",{type:"entity"}),GameUi.attributes.add("Weapon2_ammo",{type:"entity"}),GameUi.attributes.add("Weapon2_bg",{type:"entity"}),GameUi.attributes.add("Weapon3",{type:"entity"}),GameUi.attributes.add("Weapon3_icon",{type:"entity"}),GameUi.attributes.add("Weapon3_ammo",{type:"entity"}),GameUi.attributes.add("Weapon3_bg",{type:"entity"}),GameUi.attributes.add("Weapon4",{type:"entity"}),GameUi.attributes.add("Weapon4_icon",{type:"entity"}),GameUi.attributes.add("Weapon4_ammo",{type:"entity"}),GameUi.attributes.add("Weapon4_bg",{type:"entity"}),GameUi.attributes.add("KillsText",{type:"entity"}),GameUi.attributes.add("AliveText",{type:"entity"}),GameUi.attributes.add("InGameUI",{type:"entity"}),GameUi.attributes.add("MainMenu",{type:"entity"}),GameUi.attributes.add("LoadingUI",{type:"entity"}),GameUi.attributes.add("LoadingUI_controls",{type:"entity"}),GameUi.attributes.add("PlayerUI",{type:"entity"}),GameUi.attributes.add("BattleRoyaleEndGame",{type:"entity"}),GameUi.attributes.add("BattleRoyaleEndGame_Victory",{type:"entity"}),GameUi.attributes.add("BattleRoyaleEndGame_Eliminated",{type:"entity"}),GameUi.attributes.add("BattleRoyaleEndGame_Placed",{type:"entity"}),GameUi.attributes.add("BattleRoyaleEndGame_PlayAgain",{type:"entity"}),GameUi.attributes.add("BattleRoyaleEndGame_LeaveGame",{type:"entity"}),GameUi.attributes.add("PauseUI",{type:"entity"}),GameUi.attributes.add("PauseUI_Resume",{type:"entity"}),GameUi.attributes.add("PauseUI_Options",{type:"entity"}),GameUi.attributes.add("PauseUI_LeaveGame",{type:"entity"}),GameUi.attributes.add("OptionsUI",{type:"entity"}),GameUi.attributes.add("OptionsUI_PlayerNameField",{type:"entity"}),GameUi.attributes.add("OptionsUI_save",{type:"entity"}),GameUi.attributes.add("OptionsShadowCheckbox",{type:"entity",default:null}),GameUi.attributes.add("OptionsBloomCheckbox",{type:"entity",default:null}),GameUi.attributes.add("OptionsMaxResCheckbox",{type:"entity",default:null}),GameUi.attributes.add("OptionsPlayernameField",{type:"entity",default:null}),GameUi.attributes.add("OptionsVolumeArrowPlus",{type:"entity",default:null}),GameUi.attributes.add("OptionsVolumeArrowMinus",{type:"entity",default:null}),GameUi.attributes.add("OptionsVolumeValue",{type:"entity",default:null}),GameUi.attributes.add("OptionsSensitivityArrowPlus",{type:"entity",default:null}),GameUi.attributes.add("OptionsSensitivityArrowMinus",{type:"entity",default:null}),GameUi.attributes.add("OptionsSensitivityValue",{type:"entity",default:null}),GameUi.prototype.SetBeaten=function(t,e){this.BeatenUI.enabled=!0,this.BeatenUI.children[0].children[0].element.text='YOU WERE BEATEN BY [color="#ffbb00"]'+t.toUpperCase()+"[/color] WITH "+e.toUpperCase(),setTimeout(function(){this.BeatenUI.enabled=!1}.bind(this),4500)},GameUi.prototype.SaveOption=function(){this.SetPlayername(this.OptionsPlayernameField.script.input.getValue()),this.SetVolume(this.OptionsVolumeValue.element.text),this.SetSensitivity(this.OptionsSensitivityValue.element.text),this.SetMaxRes(this.OptionsMaxResCheckbox.script.checkbox.getValue().toString()),this.SetBloom(this.OptionsBloomCheckbox.script.checkbox.getValue().toString()),this.SetShadow(this.OptionsShadowCheckbox.script.checkbox.getValue().toString())},GameUi.prototype.SetPlayername=function(t){let e=!1;if(t.length>=2&&t.length<=18||0===t.length){e=!0;try{localStorage.setItem("Playername",t)}catch(t){console.log("storage is disabled")}this.Playername=t,this.OptionsPlayernameField.script.input.setValue(t)}!1===e&&this.OptionsPlayernameField.script.input.setValue("")},GameUi.prototype.ArrowVolume=function(t){!0===t?(this.OptionsVolumeValue.element.text=parseFloat(this.OptionsVolumeValue.element.text)+10,parseFloat(this.OptionsVolumeValue.element.text)>=100&&(this.OptionsVolumeValue.element.text=100)):(this.OptionsVolumeValue.element.text=parseFloat(this.OptionsVolumeValue.element.text)-10,parseFloat(this.OptionsVolumeValue.element.text)<=0&&(this.OptionsVolumeValue.element.text=0)),this.SetVolume(parseFloat(this.OptionsVolumeValue.element.text))},GameUi.prototype.SetVolume=function(t){this.app.systems.sound.volume=.01*t;try{localStorage.setItem("Volume",t)}catch(t){console.log("storage is disabled")}this.OptionsVolumeValue.element.text=t},GameUi.prototype.ArrowSensitivity=function(t){!0===t?(this.OptionsSensitivityValue.element.text=parseFloat(this.OptionsSensitivityValue.element.text)+4,parseFloat(this.OptionsSensitivityValue.element.text)>=80&&(this.OptionsSensitivityValue.element.text=80)):(this.OptionsSensitivityValue.element.text=parseFloat(this.OptionsSensitivityValue.element.text)-4,parseFloat(this.OptionsSensitivityValue.element.text)<=12&&(this.OptionsSensitivityValue.element.text=12)),this.SetSensitivity(parseFloat(this.OptionsSensitivityValue.element.text))},GameUi.prototype.SetSensitivity=function(t){try{localStorage.setItem("Sensitivity",t)}catch(t){console.log("storage is disabled")}this.OptionsSensitivityValue.element.text=t,this.GameManager.player.script.playerMovement.Camera.script.cameraMovement.UpdateSens()},GameUi.prototype.SetShadow=function(t){try{localStorage.setItem("Shadows",t)}catch(t){console.log("storage is disabled")}var e=!1;"true"===t&&(e=!0),this.OptionsShadowCheckbox.script.checkbox.setValue(e.toString()),this.GameManager.MapLight.light.castShadows=e},GameUi.prototype.SetBloom=function(t){try{localStorage.setItem("Bloom",t)}catch(t){console.log("storage is disabled")}var e=!1;"true"===t&&(e=!0),this.OptionsBloomCheckbox.script.checkbox.setValue(e.toString()),this.GameManager.player.children[1].children[0].script.bloom.enabled=e},GameUi.prototype.SetMaxRes=function(t){try{localStorage.setItem("MaxRes",t)}catch(t){console.log("storage is disabled")}var e=!1;"true"===t&&(e=!0),this.OptionsMaxResCheckbox.script.checkbox.setValue(e.toString()),!0===e?this.app.graphicsDevice.maxPixelRatio=Math.min(window.devicePixelRatio,2):1!==this.app.graphicsDevice.maxPixelRatio&&(this.app.graphicsDevice.maxPixelRatio=1)},GameUi.prototype.onKeyDown=function(t){t.key!==pc.KEY_TAB&&t.key!==pc.KEY_ESCAPE||(this.Pause_(),t.event.preventDefault()),t.key===pc.KEY_P&&!0===this.allowfullscreen&&!1===this.MainMenu.script.mainMenu.MainMenu.enabled&&!1===chatInputGameEnabled&&this.Fullscreen_()},GameUi.prototype.Fullscreen_=function(){document.documentElement.requestFullscreen()},GameUi.prototype.Pause_=function(){!1===this.PauseUI.enabled?this.P(!0):this.P(!1)},GameUi.prototype.P=function(t){!0!==this.BattleRoyaleEndGame.enabled&&!0!==this.OptionsUI.enabled&&!0!==this.SmartFoxServer.RoundEnd.enabled&&!0!==watchingAds&&(this.PauseUI.enabled=t,this.PlayerUI.enabled=!t,this.GameManager.SetGamePlay(!t),this.GameManager.SetLookCursor(!t))},GameUi.attributes.add("currentweaponcolordefault",{type:"rgba"}),GameUi.attributes.add("currentweaponcolorselected",{type:"rgba"}),GameUi.attributes.add("RewardJetpackButton",{type:"entity",default:null}),GameUi.attributes.add("Screen_1",{type:"entity"}),GameUi.attributes.add("TakePickupIcon",{type:"entity"}),GameUi.attributes.add("PickupAndText_element",{type:"entity"}),GameUi.attributes.add("HPandGrenade",{type:"entity"}),GameUi.attributes.add("Screen_2",{type:"entity"}),GameUi.attributes.add("WeaponButton1",{type:"entity"}),GameUi.attributes.add("WeaponButton2",{type:"entity"}),GameUi.attributes.add("WeaponButton3",{type:"entity"}),GameUi.attributes.add("WeaponButton4",{type:"entity"}),GameUi.prototype.initialize=function(){this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,this.app.touch&&(this.LoadingUI_controls.enabled=!1),this.GameManager=this.entity.script.gameManager,this.Weapon1_icon_temp="",this.Weapon2_icon_temp="",this.Weapon3_icon_temp="",this.Weapon4_icon_temp="",this.fadingBloodscreen=!1,this.fadingHitmarkUI=!1,this.fadingInBlackBgUI=!1,this.timewithblackscreen=0,this.BattleRoyaleEndGame_PlayAgain.button.on("click",function(){this.GameManager.PlayAgain(),this.GameManager.entity.sound.play("Button")}.bind(this)),this.BattleRoyaleEndGame_LeaveGame.button.on("click",function(){this.GameManager.LeaveGame(),this.GameManager.entity.sound.play("Button")}.bind(this)),this.PauseUI_Resume.button.on("click",function(){this.Pause_(),this.GameManager.entity.sound.play("Button")}.bind(this)),this.PauseUI_Options.button.on("click",function(){this.OptionsUI.enabled=!0,this.PauseUI.enabled=!1,this.GameManager.entity.sound.play("Button")}.bind(this)),this.PauseUI_LeaveGame.button.on("click",function(){this.GameManager.LeaveGame(),this.GameManager.entity.sound.play("Button")}.bind(this)),this.OptionsUI_save.button.on("click",function(){this.OptionsUI.enabled=!1,!1===this.MainMenu.script.mainMenu.MainMenu.enabled?this.PauseUI.enabled=!0:!0===returnToRoomsList&&(returnToRoomsList=!1,this.SmartFoxServer.RoomListUI.enabled=!0,this.SmartFoxServer.RoomInfoScrollView.enabled=!0),this.SaveOption(),this.GameManager.entity.sound.play("Button")}.bind(this)),this.RewardJetpackButton.button.on("click",function(){this.RequestJetpackReward()}.bind(this)),this.Playername="",this.WeaponButton1.button.on("pressedstart",function(){this.GameManager.player.script.weaponManager.Weapon1&&this.GameManager.player.script.weaponManager.Switch(this.GameManager.player.script.weaponManager.Weapon1)}.bind(this)),this.WeaponButton2.button.on("pressedstart",function(){this.GameManager.player.script.weaponManager.Weapon2&&this.GameManager.player.script.weaponManager.Switch(this.GameManager.player.script.weaponManager.Weapon2)}.bind(this)),this.WeaponButton3.button.on("pressedstart",function(){this.GameManager.player.script.weaponManager.Weapon3&&this.GameManager.player.script.weaponManager.Switch(this.GameManager.player.script.weaponManager.Weapon3)}.bind(this)),this.WeaponButton4.button.on("pressedstart",function(){this.GameManager.player.script.weaponManager.Weapon4&&this.GameManager.player.script.weaponManager.Switch(this.GameManager.player.script.weaponManager.Weapon4)}.bind(this)),this.OptionsSensitivityArrowPlus.button.on("click",function(){this.ArrowSensitivity(!0)}.bind(this)),this.OptionsSensitivityArrowMinus.button.on("click",function(){this.ArrowSensitivity(!1)}.bind(this)),this.OptionsVolumeArrowPlus.button.on("click",function(){this.ArrowVolume(!0)}.bind(this)),this.OptionsVolumeArrowMinus.button.on("click",function(){this.ArrowVolume(!1)}.bind(this)),this.app.touch&&(this.HPandGrenade.element.anchor=new pc.Vec4(0,0,0,0),this.HPandGrenade.setLocalPosition(205,0,0),this.TakePickupIcon.enabled=!0,this.TakePickupIcon.button.on("pressedstart",function(){this.GameManager.player.script.weaponManager.PickUp_()}.bind(this)),this.PickupAndText_element.enabled=!1);try{if("Volume"in localStorage&&this.SetVolume(localStorage.getItem("Volume")),"Sensitivity"in localStorage&&this.SetSensitivity(localStorage.getItem("Sensitivity")),"Playername"in localStorage&&this.SetPlayername(localStorage.getItem("Playername")),"Shadows"in localStorage&&this.SetShadow(localStorage.getItem("Shadows")),"Bloom"in localStorage&&this.SetBloom(localStorage.getItem("Bloom")),"MaxRes"in localStorage)this.SetMaxRes(localStorage.getItem("MaxRes"));else!0===iOS()&&(localStorage.setItem("MaxRes","true"),this.SetMaxRes("true"));null===this.app.touch&&this.OptionsMaxResCheckbox.script.checkbox.setDisable("true")}catch(t){console.log("storage is disabled")}this.allowfullscreen=!0,null===this.app.touch&&navigator.userAgent.indexOf("Mac")>-1&&navigator.userAgent.toLowerCase().indexOf("firefox")>-1&&(this.allowfullscreen=!1,console.log("Disable fullscreen"))},GameUi.attributes.add("JumpTouchIcon",{type:"entity"}),GameUi.attributes.add("JetpackIcon",{type:"entity"}),GameUi.prototype.RequestJetpackReward=function(){PokiSDK&&PokiSDK.rewardedBreak().then((t=>{t&&(this.GameManager.hadJetpack=!0,this.RewardJetpackButton.enabled=!1,this.MainMenu.script.mainMenu.DemoCharacterJetpack.enabled=!0,this.entity.sound.play("Unlock"),this.JumpTouchIcon.enabled=!1,this.JetpackIcon.enabled=!0)}))},GameUi.prototype.ShowRankScreenBattleRoyale=function(t){this.PlayerUI.enabled=!1,this.PauseUI.enabled=!1,this.OptionsUI.enabled=!1,this.GameManager.SetLookCursor(!1),this.BattleRoyaleEndGame.enabled=!0,this.BattleRoyaleEndGame_Victory.enabled=!1,this.BattleRoyaleEndGame_Eliminated.enabled=!1,!0===t?this.BattleRoyaleEndGame_Victory.enabled=!0:this.BattleRoyaleEndGame_Eliminated.enabled=!0;let e=this.AIManager.script.aimanager.ranks;e<=1&&(e=1),this.BattleRoyaleEndGame_Placed.element.text='YOU PLACED [color="#FFC71E"]#'+e+"[/color]"},GameUi.prototype.update=function(t){!0===this.GameManager.singleplayer?(this.AliveText.element.text=this.AIManager.script.aimanager.ranks,this.KillsText.element.text=this.GameManager.singleplayerKills):(this.AliveText.element.text=this.SmartFoxServer.GetOnlinePlayers(),this.KillsText.element.text=this.SmartFoxServer.GetMyKills()),!0===this.fadingBloodscreen?this.BloodScreenUI.element.opacity-=1*t:this.BloodScreenUI.element.opacity=0,!0===this.fadingHitmarkUI?this.HitmarkUI.element.opacity-=1.5*t:this.HitmarkUI.element.opacity=0,1===this.BackBgUI.element.opacity?(this.timewithblackscreen+=t,this.timewithblackscreen>=2&&this.fadingout()):this.timewithblackscreen=0,!0===this.fadingInBlackBgUI?(this.BackBgUI.element.opacity+=.8*t,this.BackBgUI.element.opacity>=1&&(this.BackBgUI.element.opacity=1)):(this.BackBgUI.element.opacity-=.8*t,this.BackBgUI.element.opacity<=0&&(this.BackBgUI.element.opacity=0))},GameUi.attributes.add("HitmarkUI",{type:"entity"}),GameUi.attributes.add("BloodScreenUI",{type:"entity"}),GameUi.prototype.bloodscreen=function(){this.fadingBloodscreen=!0,this.BloodScreenUI.element.opacity=.25},GameUi.prototype.hitmark=function(){this.entity.sound.play("Hitmarker"),this.fadingHitmarkUI=!0,this.HitmarkUI.element.opacity=1,setTimeout(function(){this.fadingHitmarkUI=!1,this.HitmarkUI.element.opacity=0}.bind(this),500)},GameUi.attributes.add("BackBgUI",{type:"entity"}),GameUi.prototype.fadingin=function(){this.fadingInBlackBgUI=!0,this.BackBgUI.element.opacity=0},GameUi.prototype.fadingout=function(){this.fadingInBlackBgUI=!1,this.BackBgUI.element.opacity=1};var LimitFps=pc.createScript("limitFps");LimitFps.attributes.add("targetFps",{type:"number",default:30}),LimitFps.prototype.initialize=function(){this.app;this.limit(this.targetFps),this.on("attr:targetFps",(function(t,i){this.limit(t)}))},LimitFps.prototype.limit=function(t){var i=this.app;this.intervalId&&(clearInterval(this.intervalId),this.intervalId=null),t>=60?i.autoRender=!0:(i.autoRender=!1,this.intervalId=setInterval((function(){i.renderNextFrame=!0}),1e3/t))};"undefined"!=typeof document&&(
/*! FPSMeter 0.3.1 - 9th May 2013 | https://github.com/Darsain/fpsmeter */
function(t,e){function s(t,e){for(var n in e)try{t.style[n]=e[n]}catch(t){}return t}function H(t){return null==t?String(t):"object"==typeof t||"function"==typeof t?Object.prototype.toString.call(t).match(/\s([a-z]+)/i)[1].toLowerCase()||"object":typeof t}function R(t,e){if("array"!==H(e))return-1;if(e.indexOf)return e.indexOf(t);for(var n=0,o=e.length;n<o;n++)if(e[n]===t)return n;return-1}function I(){var t,e=arguments;for(t in e[1])if(e[1].hasOwnProperty(t))switch(H(e[1][t])){case"object":e[0][t]=I({},e[0][t],e[1][t]);break;case"array":e[0][t]=e[1][t].slice(0);break;default:e[0][t]=e[1][t]}return 2<e.length?I.apply(null,[e[0]].concat(Array.prototype.slice.call(e,2))):e[0]}function N(t){return 1===(t=Math.round(255*t).toString(16)).length?"0"+t:t}function S(t,e,n,o){t.addEventListener?t[o?"removeEventListener":"addEventListener"](e,n,!1):t.attachEvent&&t[o?"detachEvent":"attachEvent"]("on"+e,n)}function D(t,e){function g(t,e,n,o){return h[0|t][Math.round(Math.min((e-n)/(o-n)*M,M))]}function r(){F.legend.fps!==q&&(F.legend.fps=q,F.legend[c]=q?"FPS":"ms"),b=q?v.fps:v.duration,F.count[c]=999<b?"999+":b.toFixed(99<b?0:O.decimals)}function m(){for(l=n(),P<l-O.threshold&&(v.fps-=v.fps/Math.max(1,60*O.smoothing/O.interval),v.duration=1e3/v.fps),w=O.history;w--;)T[w]=0===w?v.fps:T[w-1],j[w]=0===w?v.duration:j[w-1];if(r(),O.heat){if(z.length)for(w=z.length;w--;)z[w].el.style[o[z[w].name].heatOn]=q?g(o[z[w].name].heatmap,v.fps,0,O.maxFps):g(o[z[w].name].heatmap,v.duration,O.threshold,0);if(F.graph&&o.column.heatOn)for(w=C.length;w--;)C[w].style[o.column.heatOn]=q?g(o.column.heatmap,T[w],0,O.maxFps):g(o.column.heatmap,j[w],O.threshold,0)}if(F.graph)for(y=0;y<O.history;y++)C[y].style.height=(q?T[y]?Math.round(x/O.maxFps*Math.min(T[y],O.maxFps)):0:j[y]?Math.round(x/O.threshold*Math.min(j[y],O.threshold)):0)+"px"}function k(){20>O.interval?(p=i(k),m()):(p=setTimeout(k,O.interval),f=i(m))}function G(t){(t=t||window.event).preventDefault?(t.preventDefault(),t.stopPropagation()):(t.returnValue=!1,t.cancelBubble=!0),v.toggle()}function U(){O.toggleOn&&S(F.container,O.toggleOn,G,1),t.removeChild(F.container)}function V(){if(F.container&&U(),o=D.theme[O.theme],!(h=o.compiledHeatmaps||[]).length&&o.heatmaps.length){for(y=0;y<o.heatmaps.length;y++)for(h[y]=[],w=0;w<=M;w++){var e,n=h[y],a=w;e=.33/M*w;var i=o.heatmaps[y].saturation,l=o.heatmaps[y].lightness,p=void 0,c=void 0,u=void 0,d=u=void 0,f=p=c=void 0;f=void 0;0===(u=.5>=l?l*(1+i):l+i-l*i)?e="#000":(c=(u-(d=2*l-u))/u,f=(e*=6)-(p=Math.floor(e)),f*=u*c,0===p||6===p?(p=u,c=d+f,u=d):1===p?(p=u-f,c=u,u=d):2===p?(p=d,c=u,u=d+f):3===p?(p=d,c=u-f):4===p?(p=d+f,c=d):(p=u,c=d,u-=f),e="#"+N(p)+N(c)+N(u)),n[a]=e}o.compiledHeatmaps=h}for(var b in F.container=s(document.createElement("div"),o.container),F.count=F.container.appendChild(s(document.createElement("div"),o.count)),F.legend=F.container.appendChild(s(document.createElement("div"),o.legend)),F.graph=O.graph?F.container.appendChild(s(document.createElement("div"),o.graph)):0,z.length=0,F)F[b]&&o[b].heatOn&&z.push({name:b,el:F[b]});if(C.length=0,F.graph)for(F.graph.style.width=O.history*o.column.width+(O.history-1)*o.column.spacing+"px",w=0;w<O.history;w++)C[w]=F.graph.appendChild(s(document.createElement("div"),o.column)),C[w].style.position="absolute",C[w].style.bottom=0,C[w].style.right=w*o.column.width+w*o.column.spacing+"px",C[w].style.width=o.column.width+"px",C[w].style.height="0px";s(F.container,O),r(),t.appendChild(F.container),F.graph&&(x=F.graph.clientHeight),O.toggleOn&&("click"===O.toggleOn&&(F.container.style.cursor="pointer"),S(F.container,O.toggleOn,G))}"object"===H(t)&&undefined===t.nodeType&&(e=t,t=document.body),t||(t=document.body);var o,h,l,p,f,x,b,w,y,v=this,O=I({},D.defaults,e||{}),F={},C=[],M=100,z=[],E=O.threshold,A=0,P=n()-E,T=[],j=[],q="fps"===O.show;v.options=O,v.fps=0,v.duration=0,v.isPaused=0,v.tickStart=function(){A=n()},v.tick=function(){l=n(),E+=(l-P-E)/O.smoothing,v.fps=1e3/E,v.duration=A<P?E:l-A,P=l},v.pause=function(){return p&&(v.isPaused=1,clearTimeout(p),a(p),a(f),p=f=0),v},v.resume=function(){return p||(v.isPaused=0,k()),v},v.set=function(t,e){return O[t]=e,q="fps"===O.show,-1!==R(t,u)&&V(),-1!==R(t,d)&&s(F.container,O),v},v.showDuration=function(){return v.set("show","ms"),v},v.showFps=function(){return v.set("show","fps"),v},v.toggle=function(){return v.set("show",q?"ms":"fps"),v},v.hide=function(){return v.pause(),F.container.style.display="none",v},v.show=function(){return v.resume(),F.container.style.display="block",v},v.destroy=function(){v.pause(),U(),v.tick=v.tickStart=function(){}},V(),k()}var n,o=t.performance;n=o&&(o.now||o.webkitNow)?o[o.now?"now":"webkitNow"].bind(o):function(){return+new Date};for(var a=t.cancelAnimationFrame||t.cancelRequestAnimationFrame,i=t.requestAnimationFrame,h=0,l=0,p=(o=["moz","webkit","o"]).length;l<p&&!a;++l)i=(a=t[o[l]+"CancelAnimationFrame"]||t[o[l]+"CancelRequestAnimationFrame"])&&t[o[l]+"RequestAnimationFrame"];a||(i=function(e){var o=n(),a=Math.max(0,16-(o-h));return h=o+a,t.setTimeout((function(){e(o+a)}),a)},a=function(t){clearTimeout(t)});var c="string"===H(document.createElement("div").textContent)?"textContent":"innerText";D.extend=I,window.FPSMeter=D,D.defaults={interval:100,smoothing:10,show:"fps",toggleOn:"click",decimals:1,maxFps:60,threshold:100,position:"absolute",zIndex:10,left:"5px",top:"5px",right:"auto",bottom:"auto",margin:"0 0 0 0",theme:"dark",heat:0,graph:0,history:20};var u=["toggleOn","theme","heat","graph","history"],d="position zIndex left top right bottom margin".split(" ")}(window),function(t,e){e.theme={};var n=e.theme.base={heatmaps:[],container:{heatOn:null,heatmap:null,padding:"5px",minWidth:"95px",height:"30px",lineHeight:"30px",textAlign:"right",textShadow:"none"},count:{heatOn:null,heatmap:null,position:"absolute",top:0,right:0,padding:"5px 10px",height:"30px",fontSize:"24px",fontFamily:"Consolas, Andale Mono, monospace",zIndex:2},legend:{heatOn:null,heatmap:null,position:"absolute",top:0,left:0,padding:"5px 10px",height:"30px",fontSize:"12px",lineHeight:"32px",fontFamily:"sans-serif",textAlign:"left",zIndex:2},graph:{heatOn:null,heatmap:null,position:"relative",boxSizing:"padding-box",MozBoxSizing:"padding-box",height:"100%",zIndex:1},column:{width:4,spacing:1,heatOn:null,heatmap:null}};e.theme.dark=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.8}],container:{background:"#222",color:"#fff",border:"1px solid #1a1a1a",textShadow:"1px 1px 0 #222"},count:{heatOn:"color"},column:{background:"#3f3f3f"}}),e.theme.light=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.5}],container:{color:"#666",background:"#fff",textShadow:"1px 1px 0 rgba(255,255,255,.5), -1px -1px 0 rgba(255,255,255,.5)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},count:{heatOn:"color"},column:{background:"#eaeaea"}}),e.theme.colorful=e.extend({},n,{heatmaps:[{saturation:.5,lightness:.6}],container:{heatOn:"backgroundColor",background:"#888",color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.2)",boxShadow:"0 0 0 1px rgba(0,0,0,.1)"},column:{background:"#777",backgroundColor:"rgba(0,0,0,.2)"}}),e.theme.transparent=e.extend({},n,{heatmaps:[{saturation:.8,lightness:.5}],container:{padding:0,color:"#fff",textShadow:"1px 1px 0 rgba(0,0,0,.5)"},count:{padding:"0 5px",height:"40px",lineHeight:"40px"},legend:{padding:"0 5px",height:"40px",lineHeight:"42px"},graph:{height:"40px"},column:{width:5,background:"#999",heatOn:"backgroundColor",opacity:.5}})}(window,FPSMeter));var Fps=pc.createScript("fps");Fps.prototype.initialize=function(){this.fps=new FPSMeter({heat:!0,graph:!0})},Fps.prototype.update=function(t){this.fps.tick()};var CameraWallFix=pc.createScript("cameraWallFix");CameraWallFix.prototype.initialize=function(){this.pos=new pc.Vec3,this.lerpedPos=new pc.Vec3},CameraWallFix.attributes.add("LookCamera",{type:"entity"}),CameraWallFix.attributes.add("LookCamera2",{type:"entity"}),CameraWallFix.attributes.add("RaycastPoint",{type:"entity"}),CameraWallFix.attributes.add("Angle",{type:"entity"}),CameraWallFix.prototype.update=function(a){var t=this.app.renderer.device.maxPixelRatio,e=this.app.graphicsDevice.height/t,i=this.app.graphicsDevice.width/t;this.distance=this.LookCamera.camera.screenToWorld(i/2,e/2,6),this.pos=new pc.Vec3(0,0,0);var s=this.app.systems.rigidbody.raycastFirst(this.RaycastPoint.getPosition(),this.distance);s&&s.entity.tags.has("Map")&&(this.pos=new pc.Vec3(0,0,-2))};var ObjectPoolParticle=pc.createScript("objectPoolParticle");ObjectPoolParticle.attributes.add("maxCount",{type:"number",default:1}),ObjectPoolParticle.attributes.add("sleepTime",{type:"number",default:0}),ObjectPoolParticle.prototype.initialize=function(){this.entity.enabled=!1,this.index=0,this.objects=[],this.createClones(),this.app.on("ObjectPoolParticle:"+this.entity.name,this.onClone,this),this.app.on("ObjectPoolParticle:"+this.entity.name+"@Clear",this.onClear,this)},ObjectPoolParticle.prototype.onClear=function(){for(var t in this.objects){var e=this.objects[t];e.children[0]&&e.children[0].particlesystem.reset(),e.setPosition(0,-1e3,0),e.enabled=!1}},ObjectPoolParticle.prototype.createClones=function(){for(var t=0;t<this.maxCount;t++){var e=this.entity.clone();this.app.root.addChild(e),e.script.destroy("objectPoolParticle"),e.enabled=!1,this.objects.push(e)}this.entity.destroy()},ObjectPoolParticle.prototype.onClone=function(t){var e=this.objects[this.index];e&&(e.enabled=!0,t&&t(e),this.sleepTime>0&&(clearTimeout(e.timer),e.timer=setTimeout((function(t){t.children[0]&&t.children[0].particlesystem.reset(),t.setPosition(0,-1e3,0),t.enabled=!1}),1e3*this.sleepTime,e))),this.index++,this.index>this.objects.length-1&&(this.index=0)};var ObjectPoolPickup=pc.createScript("objectPoolPickup");ObjectPoolPickup.attributes.add("maxCount",{type:"number",default:1}),ObjectPoolPickup.attributes.add("sleepTime",{type:"number",default:0}),ObjectPoolPickup.prototype.initialize=function(){this.entity.enabled=!1,this.index=0,this.objects=[],this.createClones(),this.app.on("ObjectPoolPickup:"+this.entity.name,this.onClone,this),this.app.on("ObjectPoolPickup:"+this.entity.name+"@Clear",this.onClear,this),this.sleepTime_temp=this.sleepTime},ObjectPoolPickup.prototype.onClear=function(){for(var t in this.objects){var e=this.objects[t];e.setPosition(0,-1e3,0),e.rigidbody.type=pc.BODYTYPE_KINEMATIC,e.enabled=!1}},ObjectPoolPickup.prototype.createClones=function(){for(var t=0;t<this.maxCount;t++){var e=this.entity.clone();this.app.root.addChild(e),e.script.destroy("objectPoolPickup"),e.enabled=!1,this.objects.push(e)}this.entity.destroy()},ObjectPoolPickup.prototype.onClone=function(t){var e=this.objects[this.index];e&&(e.enabled=!0,t&&t(e),this.sleepTime>0&&(clearTimeout(e.timer),e.timer=setTimeout((function(t){t.setPosition(0,-1e3,0),t.rigidbody.type=pc.BODYTYPE_KINEMATIC,t.enabled=!1}),1e3*this.sleepTime,e))),this.index++,this.index>this.objects.length-1&&(this.index=0)};var ObjectPoolExplosion=pc.createScript("objectPoolExplosion");ObjectPoolExplosion.attributes.add("maxCount",{type:"number",default:1}),ObjectPoolExplosion.attributes.add("sleepTime",{type:"number",default:0}),ObjectPoolExplosion.prototype.initialize=function(){this.entity.enabled=!1,this.index=0,this.objects=[],this.createClones(),this.app.on("ObjectPoolExplosion:"+this.entity.name,this.onClone,this),this.app.on("ObjectPoolExplosion:"+this.entity.name+"@Clear",this.onClear,this)},ObjectPoolExplosion.prototype.onClear=function(){for(var e in this.objects){var t=this.objects[e],o=t.name;setTimeout(function(){"GrenadeLauncherExplosion"===o||"GrenadeExplosion"===o?(t.children[0].particlesystem.reset(),t.children[1].particlesystem.reset()):"BallProjectileExplosion_1"!==o&&"BallProjectileExplosion_2"!==o&&"BallProjectileExplosion_3"!==o||t.children[0].particlesystem.reset()}.bind(this),1),t.setPosition(0,-1e3,0),t.enabled=!1}},ObjectPoolExplosion.prototype.createClones=function(){for(var e=0;e<this.maxCount;e++){var t=this.entity.clone();this.app.root.addChild(t),t.script.destroy("objectPoolExplosion"),t.enabled=!1,this.objects.push(t)}this.entity.destroy()},ObjectPoolExplosion.prototype.onClone=function(e){var t=this.objects[this.index];if(t){var o=t.name;t.enabled=!0,e&&e(t),this.sleepTime>0&&(clearTimeout(t.timer),t.timer=setTimeout((function(e){setTimeout(function(){"GrenadeLauncherExplosion"===o||"GrenadeExplosion"===o?(e.children[0].particlesystem.reset(),e.children[1].particlesystem.reset()):"BallProjectileExplosion_1"!==o&&"BallProjectileExplosion_2"!==o&&"BallProjectileExplosion_3"!==o||e.children[0].particlesystem.reset()}.bind(this),1),e.setPosition(0,-1e3,0),e.enabled=!1}),1e3*this.sleepTime,t))}this.index++,this.index>this.objects.length-1&&(this.index=0)};var ObjectPoolGrenade=pc.createScript("objectPoolGrenade");ObjectPoolGrenade.attributes.add("maxCount",{type:"number",default:1}),ObjectPoolGrenade.attributes.add("sleepTime",{type:"number",default:0}),ObjectPoolGrenade.prototype.initialize=function(){this.entity.enabled=!1,this.index=0,this.objects=[],this.createClones(),this.app.on("ObjectPoolGrenade:"+this.entity.name,this.onClone,this),this.app.on("ObjectPoolGrenade:"+this.entity.name+"@Clear",this.onClear,this)},ObjectPoolGrenade.prototype.onClear=function(e){e.script.grenade.RestartPool(),e.enabled=!1},ObjectPoolGrenade.prototype.createClones=function(){for(var e=0;e<this.maxCount;e++){var t=this.entity.clone();this.app.root.addChild(t),t.script.destroy("objectPoolGrenade"),t.enabled=!1,this.objects.push(t)}this.entity.destroy()},ObjectPoolGrenade.prototype.onClone=function(e,t){var o=this.objects[this.index];t&&(o.setRotation(t),o.rotateLocal(0,90,0)),o&&(o.enabled=!0,e&&e(o),this.sleepTime>0&&(clearTimeout(o.timer),o.timer=setTimeout((function(e){e.script.grenade.RestartPool(),e.enabled=!1}),1e3*this.sleepTime,o))),this.index++,this.index>this.objects.length-1&&(this.index=0)};var ApplyPoolingClear=pc.createScript("applyPoolingClear");ApplyPoolingClear.attributes.add("poolname",{type:"string"}),ApplyPoolingClear.prototype.StartPool=function(t){t>0&&setTimeout(function(){this.entity.setPosition(0,-1e3,0),this.entity.enabled=!1}.bind(this),t)},ApplyPoolingClear.prototype.RestartPool=function(){};var Trail=pc.createScript("trail");Trail.attributes.add("color",{type:"rgb",title:"color"}),Trail.attributes.add("radius",{type:"number",title:"radius",default:.5}),Trail.attributes.add("lifetime",{type:"number",title:"lifetime",default:1.2}),Trail.attributes.add("timeout",{type:"number",title:"timeout",default:1.75}),Trail.attributes.add("trailfadeness",{type:"number",title:"trailfadeness",default:2,min:1,max:4}),Trail.attributes.add("opacityFactor",{type:"number",title:"opacityFactor",default:.8,min:.1,max:1}),Trail.v1=new pc.Vec3,Trail.q1=new pc.Quat,Trail.m1=new pc.Mat4,Trail.prototype.initialize=function(){this.MAX_VERTICES=1800,this.VERTEX_SIZE=4,this.timer=0,this.node=null,this.vertices=[],this.vertexData=new Float32Array(this.MAX_VERTICES*this.VERTEX_SIZE),this.model=null;var e=this.color.r+", "+this.color.g+", "+this.color.b,t={attributes:{poslist:pc.SEMANTIC_POSITION},vshader:["attribute vec4 poslist;","","uniform mat4 matrix_viewProjection;","uniform float trail_time;","","varying float vAge;","","void main(void)","{","   vAge = trail_time - poslist.w;","   gl_Position = matrix_viewProjection * vec4(poslist.xyz, 1.0);","}"].join("\n"),fshader:["precision mediump float;","","varying float vAge;","","uniform float trail_lifetime;","uniform bool visible;","void main(void)","{","   vec4 color = vec4(0);","   if(visible) color = vec4("+e+", (1.0 - (vAge / trail_lifetime)) *"+this.opacityFactor+");","   gl_FragColor = color;","}"].join("\n")},i=new pc.Shader(this.app.graphicsDevice,t),a=this.material=new pc.scene.Material;a.shader=i,a.setParameter("trail_time",0),a.setParameter("trail_lifetime",this.lifetime),a.setParameter("visible",!0),a.cull=pc.CULLFACE_NONE,a.blendType=pc.BLEND_ADDITIVE,a.blendSrc=pc.BLENDMODE_SRC_ALPHA,a.blendDst=pc.BLENDMODE_ONE_MINUS_SRC_ALPHA,a.blendEquation=pc.BLENDEQUATION_ADD,a.depthWrite=!1;var r=new pc.VertexFormat(this.app.graphicsDevice,[{semantic:pc.SEMANTIC_POSITION,components:4,type:pc.TYPE_FLOAT32}]),s=new pc.VertexBuffer(this.app.graphicsDevice,r,this.MAX_VERTICES,pc.BUFFER_DYNAMIC),o=new pc.scene.Mesh;o.vertexBuffer=s,o.indexBuffer[0]=null,o.primitive[0].type=pc.PRIMITIVE_TRISTRIP,o.primitive[0].base=0,o.primitive[0].count=0,o.primitive[0].indexed=!1;var c=new pc.GraphNode,l=new pc.MeshInstance(c,o,a);l.layer=pc.LAYER_WORLD,l.cull=!1,l.updateKey(),this.model=new pc.Model,this.model.graph=c,this.model.meshInstances.push(l),this.setNode(this.entity),this.vb=s,this.isNoneState=!1,this.cachedVec=new pc.Vec3(0,0,0),this.camera=this.app.root.findByName("Camera"),this.on("state",this.onStateChanged,this)},Trail.prototype.onStateChanged=function(e){!1===e?this.SetOff():this.SetOn()},Trail.prototype.postUpdate=function(e){if(this.timer+=e,this.model.meshInstances[0].material.setParameter("trail_time",this.timer),this.clearOld(),this.spawn(this.radius),this.vertices.length>1){this.copyToArrayBuffer(),this.updateNumActive();var t=this.model.meshInstances[0].mesh.vertexBuffer;new Float32Array(t.lock()).set(this.vertexData),t.unlock(),this.app.scene.containsModel(this.model)||this.app.scene.addModel(this.model)}else this.app.scene.containsModel(this.model)&&this.app.scene.removeModel(this.model)},Trail.prototype.SetOn=function(){this.reset(),this.material.setParameter("visible",!0)},Trail.prototype.SetOff=function(){this.app.scene.removeModel(this.model),this.material.setParameter("visible",!1)},Trail.prototype.visible=function(){this.material.setParameter("visible",!0)},Trail.prototype.invisible=function(){this.material.setParameter("visible",!1)},Trail.prototype.reset=function(){this.oldPos=null,this.timer=0,this.vertices=[]},Trail.prototype.spawn=function(e){var t=this.node.getPosition(),i=this.camera.getPosition(),a=this.node.getPosition(),r=Trail.v1,s=Trail.m1,o=Trail.q1;r.copy(i).sub(a).normalize(),setMat4Forward(s,r,pc.Vec3.UP),o.setFromMat4(s);var c=[];if(this.oldPos){for(var l=this.oldPos.clone().sub(t),n=0;n<9;n++){var h=Math.PI/4*n;this.cachedVec.set(e*Math.cos(h),e*Math.sin(h),0),o.transformVector(this.cachedVec,this.cachedVec),this.cachedVec.add(t),c=c.concat([this.cachedVec.x,this.cachedVec.y,this.cachedVec.z,this.cachedVec.x+l.x,this.cachedVec.y+l.y,this.cachedVec.z+l.z])}this.oldPos=t.clone(),this.vertices.unshift({spawnTime:this.timer,vertexPair:c})}else this.oldPos=t.clone()},Trail.prototype.clearOld=function(){for(var e=this.vertices.length-1;e>=0;e--){var t=this.vertices[e];if(!(this.timer-t.spawnTime>=this.lifetime))return;this.vertices.pop()}},Trail.prototype.copyToArrayBuffer=function(){for(var e=0;e<this.vertices.length;e++)for(var t=this.vertices[e],i=0;i<18;i++)this.vertexData[72*e+0+4*i]=t.vertexPair[0+3*i],this.vertexData[72*e+1+4*i]=t.vertexPair[1+3*i],this.vertexData[72*e+2+4*i]=t.vertexPair[2+3*i],this.vertexData[72*e+3+4*i]=t.spawnTime},Trail.prototype.updateNumActive=function(){this.model.meshInstances[0].mesh.primitive[0].count=this.trailfadeness*this.vertices.length*9},Trail.prototype.setNode=function(e){this.node=e},Trail.prototype.Finit=function(){this.vb.destroy()},Trail.prototype.clear=function(){this.reset(),this.app.scene.containsModel(this.model)&&(console.log("Removed model"),this.app.scene.removeModel(this.model))};var setMat4Forward=function(){var e,t,i;return e=new pc.Vec3,t=new pc.Vec3,i=new pc.Vec3,function(a,r,s){i.copy(r).scale(-1),t.copy(s).normalize(),e.cross(t,i).normalize(),t.cross(i,e);var o=a.data;return o[0]=e.x,o[1]=e.y,o[2]=e.z,o[3]=0,o[4]=t.x,o[5]=t.y,o[6]=t.z,o[7]=0,o[8]=i.x,o[9]=i.y,o[10]=i.z,o[11]=0,o[15]=1,a}}();var Rotategrenade=pc.createScript("rotategrenade");Rotategrenade.prototype.initialize=function(){this.on("state",this.onStateChanged,this),this.time=1.3},Rotategrenade.prototype.onStateChanged=function(t){this.time=1.3},Rotategrenade.prototype.update=function(t){this.time-=t;var e=220*t;(e=e*this.time*1.85)>0&&this.entity.rotate(0,e,e)};var Attachweapondemo=pc.createScript("attachweapondemo");Attachweapondemo.attributes.add("Weapon",{type:"entity"}),Attachweapondemo.attributes.add("Jetpack",{type:"entity"}),Attachweapondemo.prototype.initialize=function(){this.Attach()},Attachweapondemo.prototype.Attach=function(t){this.RightHand=this.entity.findByName("mixamorig:RightHand"),this.Weapon.reparent(this.RightHand),this.Spine=this.entity.findByName("mixamorig:Spine"),this.Jetpack.reparent(this.Spine)};var Trigger=pc.createScript("trigger");Trigger.attributes.add("SpawnPoints",{type:"entity",array:!0}),Trigger.prototype.initialize=function(){this.SpawnPoints=this.entity.findByTag("StaticWeaponSpawnpoint");var t=this;this.entity.collision.on("triggerenter",(function(i){i.tags.has("Player")&&t.Action(!0)})),this.entity.collision.on("triggerleave",(function(i){i.tags.has("Player")&&t.Action(!1)}))},Trigger.prototype.Action=function(t){this.SpawnPoints.forEach((i=>{i.enabled=t}))};var StormTrigger=pc.createScript("stormTrigger");StormTrigger.attributes.add("StormMinimap",{type:"entity"}),StormTrigger.prototype.initialize=function(){this.GameManager=this.app.root.findByName("GameManager").script.gameManager,this.GameUI=this.app.root.findByName("GameManager").script.gameUi,this.MainMenu=this.app.root.findByName("MainMenu").script.mainMenu;var i=this;this.entity.children[0].collision.on("triggerenter",(function(t){t.tags.has("Player")&&i.OnTrigger(!0)})),this.entity.children[0].collision.on("triggerleave",(function(t){t.tags.has("Player")&&i.OnTrigger(!1)})),this.StormDoDamageTimer=0,this.StormSize=this.entity.getLocalScale().x,this.MiniStormSize=this.StormMinimap.getLocalScale().x,this.StormColliderSize=this.entity.children[0].collision.radius,this.StormInside=!0,this.StartStorm(),this.timer_clear=0,this.timer=0},StormTrigger.prototype.update=function(i){return!0===this.MainMenu.enabled?(this.timer_clear=0,void(this.timer=0)):!1===this.GameManager.singleplayer?(this.entity.setLocalScale(new pc.Vec3(this.StormSize,this.StormSize,this.StormSize)),this.StormMinimap.setLocalScale(new pc.Vec3(this.MiniStormSize,this.MiniStormSize,this.MiniStormSize)),this.entity.children[0].collision.radius=this.StormColliderSize,this.StormInside=!0,this.GameUI.StormScreen.enabled=!1,this.entity.model.enabled=!1,void(this.StormMinimap.element.enabled=!1)):(this.StormDoDamageTimer+=i,this.StormDoDamageTimer>=2&&(this.StormDoDamageTimer=0,!1===this.StormInside&&this.GameManager.player.script.playerMovement.ReceiveDamage(7,!0)),this.entity.model.enabled=!0,this.StormMinimap.element.enabled=!0,this.StormSizeLerp=pc.math.lerp(this.entity.getLocalScale().x,this.CurrentStormSize,.03*i),this.entity.setLocalScale(new pc.Vec3(this.StormSizeLerp,this.StormSizeLerp,this.StormSizeLerp)),this.MinimapStormSizeLerp=pc.math.lerp(this.StormMinimap.getLocalScale().x,this.CurrentMiniStormSize,.03*i),this.StormMinimap.setLocalScale(new pc.Vec3(this.MinimapStormSizeLerp,this.MinimapStormSizeLerp,this.MinimapStormSizeLerp)),this.StormColliderSizeLerp=pc.math.lerp(this.entity.children[0].collision.radius,this.CurrentStormColliderSize,.03*i),this.entity.children[0].collision.radius=this.StormColliderSizeLerp,this.GameUI.StormScreen.enabled=!this.StormInside,this.timer+=i,void(this.timer_clear!==Math.floor(this.timer)&&(this.timer_clear=Math.floor(this.timer),this.RemoveAISpawnPoint_Op(this.timer_clear),this.RemoveAIWayPoint_Op(this.timer_clear))))},StormTrigger.prototype.StartStorm=function(){this.timer_clear=0,this.timer=0,this.AISpawnPoint=this.app.root.findByTag("AISpawnPoint"),this.AIWayPoint=this.app.root.findByTag("AIWayPoint"),this.StormInside=!0,this.entity.setLocalScale(new pc.Vec3(this.StormSize,this.StormSize,this.StormSize)),this.entity.children[0].collision.radius=this.StormColliderSize,this.StormMinimap.setLocalScale(new pc.Vec3(this.MiniStormSize,this.MiniStormSize,this.MiniStormSize)),this.CurrentStormSize=.1*this.StormSize,this.CurrentStormColliderSize=.1*this.StormColliderSize,this.CurrentMiniStormSize=.1*this.MiniStormSize},StormTrigger.prototype.OnTrigger=function(i){this.StormInside=i},StormTrigger.prototype.RemoveAISpawnPoint_Op=function(i){46===i?(this.AISpawnPoint_Splice(39),this.AISpawnPoint_Splice(40)):47===i?this.AISpawnPoint_Splice(21):49===i?this.AISpawnPoint_Splice(41):50===i?(this.AISpawnPoint_Splice(16),this.AISpawnPoint_Splice(3)):52===i?(this.AISpawnPoint_Splice(4),this.AISpawnPoint_Splice(37),this.AISpawnPoint_Splice(5),this.AISpawnPoint_Splice(15),this.AISpawnPoint_Splice(38)):53===i?(this.AISpawnPoint_Splice(44),this.AISpawnPoint_Splice(43),this.AISpawnPoint_Splice(20)):54===i?(this.AISpawnPoint_Splice(19),this.AISpawnPoint_Splice(18)):55===i?(this.AISpawnPoint_Splice(7),this.AISpawnPoint_Splice(42),this.AISpawnPoint_Splice(23)):56===i?this.AISpawnPoint_Splice(17):57===i?this.AISpawnPoint_Splice(35):58===i?this.AISpawnPoint_Splice(2):59===i?(this.AISpawnPoint_Splice(36),this.AISpawnPoint_Splice(6),this.AISpawnPoint_Splice(11)):60===i?(this.AISpawnPoint_Splice(25),this.AISpawnPoint_Splice(10),this.AISpawnPoint_Splice(14),this.AISpawnPoint_Splice(1)):61===i?(this.AISpawnPoint_Splice(27),this.AISpawnPoint_Splice(91)):63===i?(this.AISpawnPoint_Splice(33),this.AISpawnPoint_Splice(34)):64===i?(this.AISpawnPoint_Splice(66),this.AISpawnPoint_Splice(12),this.AISpawnPoint_Splice(92)):65===i?this.AISpawnPoint_Splice(28):66===i?this.AISpawnPoint_Splice(24):67===i?this.AISpawnPoint_Splice(22):68===i?this.AISpawnPoint_Splice(45):69===i?(this.AISpawnPoint_Splice(94),this.AISpawnPoint_Splice(0)):70===i?(this.AISpawnPoint_Splice(8),this.AISpawnPoint_Splice(67)):71===i?this.AISpawnPoint_Splice(32):72===i?this.AISpawnPoint_Splice(93):73===i?this.AISpawnPoint_Splice(13):76===i?(this.AISpawnPoint_Splice(63),this.AISpawnPoint_Splice(30)):77===i?this.AISpawnPoint_Splice(65):79===i?this.AISpawnPoint_Splice(72):80===i?this.AISpawnPoint_Splice(64):82===i?(this.AISpawnPoint_Splice(26),this.AISpawnPoint_Splice(29),this.AISpawnPoint_Splice(69)):84===i?(this.AISpawnPoint_Splice(46),this.AISpawnPoint_Splice(73)):86===i?(this.AISpawnPoint_Splice(9),this.AISpawnPoint_Splice(68)):89===i?this.AISpawnPoint_Splice(87):92===i?(this.AISpawnPoint_Splice(74),this.AISpawnPoint_Splice(70)):93===i?this.AISpawnPoint_Splice(96):95===i?this.AISpawnPoint_Splice(95):97===i?this.AISpawnPoint_Splice(88):102===i?this.AISpawnPoint_Splice(53):103===i?this.AISpawnPoint_Splice(77):105===i?this.AISpawnPoint_Splice(86):106===i?this.AISpawnPoint_Splice(59):107===i?this.AISpawnPoint_Splice(47):109===i?(this.AISpawnPoint_Splice(31),this.AISpawnPoint_Splice(89)):110===i?this.AISpawnPoint_Splice(78):111===i?this.AISpawnPoint_Splice(80):113===i?this.AISpawnPoint_Splice(84):115===i?(this.AISpawnPoint_Splice(85),this.AISpawnPoint_Splice(71)):122===i?this.AISpawnPoint_Splice(75):125===i?this.AISpawnPoint_Splice(61):126===i?this.AISpawnPoint_Splice(60):131===i?this.AISpawnPoint_Splice(90):152===i?this.AISpawnPoint_Splice(62):199===i&&this.AISpawnPoint_Splice(58)},StormTrigger.prototype.AISpawnPoint_Splice=function(i){let t=null;if(this.AISpawnPoint.forEach((e=>{e.name==="AISpawnPoint_"+i&&(t=e)})),null===t)return;const e=this.AISpawnPoint.indexOf(t);e>-1&&this.AISpawnPoint.splice(e,1),console.log("AISpawnPoint Remove, "+e+" takes "+this.timer_clear)},StormTrigger.prototype.GetRandomAvailableSpawn=function(){if(0!==this.AISpawnPoint.length){this.AISpawnPoint[0];var i=random(0,this.AISpawnPoint.length-1);return this.AISpawnPoint[i]}},StormTrigger.prototype.RemoveAIWayPoint_Op=function(i){44===i?this.AIWayPoint_Splice(36):46===i?(this.AIWayPoint_Splice(21),this.AIWayPoint_Splice(51)):47===i?(this.AIWayPoint_Splice(28),this.AIWayPoint_Splice(55)):48===i?this.AIWayPoint_Splice(25):49===i?(this.AIWayPoint_Splice(35),this.AIWayPoint_Splice(31),this.AIWayPoint_Splice(26),this.AIWayPoint_Splice(34)):51===i?(this.AIWayPoint_Splice(4),this.AIWayPoint_Splice(41),this.AIWayPoint_Splice(22),this.AIWayPoint_Splice(50)):52===i?this.AIWayPoint_Splice(27):53===i?(this.AIWayPoint_Splice(54),this.AIWayPoint_Splice(32)):54===i?(this.AIWayPoint_Splice(24),this.AIWayPoint_Splice(49),this.AIWayPoint_Splice(20)):55===i?(this.AIWayPoint_Splice(37),this.AIWayPoint_Splice(38),this.AIWayPoint_Splice(57),this.AIWayPoint_Splice(5)):56===i?(this.AIWayPoint_Splice(33),this.AIWayPoint_Splice(17),this.AIWayPoint_Splice(3),this.AIWayPoint_Splice(12),this.AIWayPoint_Splice(19),this.AIWayPoint_Splice(56),this.AIWayPoint_Splice(42)):57===i?(this.AIWayPoint_Splice(44),this.AIWayPoint_Splice(29),this.AIWayPoint_Splice(47)):58===i?(this.AIWayPoint_Splice(30),this.AIWayPoint_Splice(2)):60===i?this.AIWayPoint_Splice(23):61===i?(this.AIWayPoint_Splice(52),this.AIWayPoint_Splice(52),this.AIWayPoint_Splice(15),this.AIWayPoint_Splice(40)):62===i?this.AIWayPoint_Splice(93):63===i?(this.AIWayPoint_Splice(39),this.AIWayPoint_Splice(43)):64===i?this.AIWayPoint_Splice(82):65===i?(this.AIWayPoint_Splice(116),this.AIWayPoint_Splice(106),this.AIWayPoint_Splice(46),this.AIWayPoint_Splice(0),this.AIWayPoint_Splice(1),this.AIWayPoint_Splice(14)):66===i?(this.AIWayPoint_Splice(120),this.AIWayPoint_Splice(105),this.AIWayPoint_Splice(6),this.AIWayPoint_Splice(7),this.AIWayPoint_Splice(18)):68===i?(this.AIWayPoint_Splice(48),this.AIWayPoint_Splice(16)):69===i?(this.AIWayPoint_Splice(85),this.AIWayPoint_Splice(96)):70===i?(this.AIWayPoint_Splice(9),this.AIWayPoint_Splice(53)):71===i?(this.AIWayPoint_Splice(59),this.AIWayPoint_Splice(112)):73===i?this.AIWayPoint_Splice(92):74===i?(this.AIWayPoint_Splice(84),this.AIWayPoint_Splice(103)):75===i?this.AIWayPoint_Splice(108):76===i?this.AIWayPoint_Splice(58):77===i?this.AIWayPoint_Splice(81):78===i?(this.AIWayPoint_Splice(104),this.AIWayPoint_Splice(8),this.AIWayPoint_Splice(60)):81===i?this.AIWayPoint_Splice(119):82===i?this.AIWayPoint_Splice(45):83===i?this.AIWayPoint_Splice(83):84===i?(this.AIWayPoint_Splice(95),this.AIWayPoint_Splice(90),this.AIWayPoint_Splice(68)):86===i?(this.AIWayPoint_Splice(70),this.AIWayPoint_Splice(10),this.AIWayPoint_Splice(91)):87===i?this.AIWayPoint_Splice(86):88===i?this.AIWayPoint_Splice(13):90===i?this.AIWayPoint_Splice(80):91===i?this.AIWayPoint_Splice(94):93===i?this.AIWayPoint_Splice(62):96===i?this.AIWayPoint_Splice(67):97===i?this.AIWayPoint_Splice(64):98===i?(this.AIWayPoint_Splice(115),this.AIWayPoint_Splice(69)):100===i?this.AIWayPoint_Splice(61):104===i?this.AIWayPoint_Splice(123):106===i?this.AIWayPoint_Splice(114):107===i?this.AIWayPoint_Splice(101):108===i?this.AIWayPoint_Splice(75):110===i?this.AIWayPoint_Splice(66):114===i?this.AIWayPoint_Splice(11):115===i?this.AIWayPoint_Splice(102):121===i?(this.AIWayPoint_Splice(63),this.AIWayPoint_Splice(118)):126===i?this.AIWayPoint_Splice(71):130===i?this.AIWayPoint_Splice(117):137===i?this.AIWayPoint_Splice(76):141===i?this.AIWayPoint_Splice(113):142===i?this.AIWayPoint_Splice(121):146===i?this.AIWayPoint_Splice(89):151===i?this.AIWayPoint_Splice(79):162===i&&this.AIWayPoint_Splice(110)},StormTrigger.prototype.AIWayPoint_Splice=function(i){let t=null;if(this.AIWayPoint.forEach((e=>{e.name==="AIWayPoint_"+i&&(t=e)})),null===t)return;const e=this.AIWayPoint.indexOf(t);e>-1&&this.AIWayPoint.splice(e,1),console.log("AIWayPoint Remove, "+e+" takes "+this.timer_clear)},StormTrigger.prototype.GetRandomAvailableWayPoint=function(){if(0!==this.AIWayPoint.length){this.AIWayPoint[0];var i=random(0,this.AIWayPoint.length-1);return this.AIWayPoint[i]}};var OrbitCamera=pc.createScript("orbitCamera");OrbitCamera.attributes.add("distanceMax",{type:"number",default:0,title:"Distance Max",description:"Setting this at 0 will give an infinite distance limit"}),OrbitCamera.attributes.add("distanceMin",{type:"number",default:0,title:"Distance Min"}),OrbitCamera.attributes.add("pitchAngleMax",{type:"number",default:90,title:"Pitch Angle Max (degrees)"}),OrbitCamera.attributes.add("pitchAngleMin",{type:"number",default:-90,title:"Pitch Angle Min (degrees)"}),OrbitCamera.attributes.add("inertiaFactor",{type:"number",default:0,title:"Inertia Factor",description:"Higher value means that the camera will continue moving after the user has stopped dragging. 0 is fully responsive."}),OrbitCamera.attributes.add("focusEntity",{type:"entity",title:"Focus Entity",description:"Entity for the camera to focus on. If blank, then the camera will use the whole scene"}),OrbitCamera.attributes.add("frameOnStart",{type:"boolean",default:!0,title:"Frame on Start",description:'Frames the entity or scene at the start of the application."'}),Object.defineProperty(OrbitCamera.prototype,"distance",{get:function(){return this._targetDistance},set:function(t){this._targetDistance=this._clampDistance(t)}}),Object.defineProperty(OrbitCamera.prototype,"pitch",{get:function(){return this._targetPitch},set:function(t){this._targetPitch=this._clampPitchAngle(t)}}),Object.defineProperty(OrbitCamera.prototype,"yaw",{get:function(){return this._targetYaw},set:function(t){this._targetYaw=t;var i=(this._targetYaw-this._yaw)%360;this._targetYaw=i>180?this._yaw-(360-i):i<-180?this._yaw+(360+i):this._yaw+i}}),Object.defineProperty(OrbitCamera.prototype,"pivotPoint",{get:function(){return this._pivotPoint},set:function(t){this._pivotPoint.copy(t)}}),OrbitCamera.prototype.focus=function(t){this._buildAabb(t,0);var i=this._modelsAabb.halfExtents,e=Math.max(i.x,Math.max(i.y,i.z));e/=Math.tan(.5*this.entity.camera.fov*pc.math.DEG_TO_RAD),e*=2,this.distance=e,this._removeInertia(),this._pivotPoint.copy(this._modelsAabb.center)},OrbitCamera.distanceBetween=new pc.Vec3,OrbitCamera.prototype.resetAndLookAtPoint=function(t,i){this.pivotPoint.copy(i),this.entity.setPosition(t),this.entity.lookAt(i);var e=OrbitCamera.distanceBetween;e.sub2(i,t),this.distance=e.length(),this.pivotPoint.copy(i);var a=this.entity.getRotation();this.yaw=this._calcYaw(a),this.pitch=this._calcPitch(a,this.yaw),this._removeInertia(),this._updatePosition()},OrbitCamera.prototype.resetAndLookAtEntity=function(t,i){this._buildAabb(i,0),this.resetAndLookAtPoint(t,this._modelsAabb.center)},OrbitCamera.prototype.reset=function(t,i,e){this.pitch=i,this.yaw=t,this.distance=e,this._removeInertia()},OrbitCamera.prototype.initialize=function(){var t=this,onWindowResize=function(){t._checkAspectRatio()};window.addEventListener("resize",onWindowResize,!1),this._checkAspectRatio(),this._modelsAabb=new pc.BoundingBox,this._buildAabb(this.focusEntity||this.app.root,0),this.entity.lookAt(this._modelsAabb.center),this._pivotPoint=new pc.Vec3,this._pivotPoint.copy(this._modelsAabb.center);var i=this.entity.getRotation();if(this._yaw=this._calcYaw(i),this._pitch=this._clampPitchAngle(this._calcPitch(i,this._yaw)),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0),this._distance=0,this._targetYaw=this._yaw,this._targetPitch=this._pitch,this.frameOnStart)this.focus(this.focusEntity||this.app.root);else{var e=new pc.Vec3;e.sub2(this.entity.getPosition(),this._pivotPoint),this._distance=this._clampDistance(e.length())}this._targetDistance=this._distance,this.on("attr:distanceMin",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:distanceMax",(function(t,i){this._targetDistance=this._clampDistance(this._distance)})),this.on("attr:pitchAngleMin",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:pitchAngleMax",(function(t,i){this._targetPitch=this._clampPitchAngle(this._pitch)})),this.on("attr:focusEntity",(function(t,i){this.frameOnStart?this.focus(t||this.app.root):this.resetAndLookAtEntity(this.entity.getPosition(),t||this.app.root)})),this.on("attr:frameOnStart",(function(t,i){t&&this.focus(this.focusEntity||this.app.root)})),this.on("destroy",(function(){window.removeEventListener("resize",onWindowResize,!1)}))},OrbitCamera.prototype.update=function(t){var i=0===this.inertiaFactor?1:Math.min(t/this.inertiaFactor,1);this._distance=pc.math.lerp(this._distance,this._targetDistance,i),this._yaw=pc.math.lerp(this._yaw,this._targetYaw,i),this._pitch=pc.math.lerp(this._pitch,this._targetPitch,i),this._updatePosition()},OrbitCamera.prototype._updatePosition=function(){this.entity.setLocalPosition(0,0,0),this.entity.setLocalEulerAngles(this._pitch,this._yaw,0);var t=this.entity.getPosition();t.copy(this.entity.forward),t.scale(-this._distance),t.add(this.pivotPoint),this.entity.setPosition(t)},OrbitCamera.prototype._removeInertia=function(){this._yaw=this._targetYaw,this._pitch=this._targetPitch,this._distance=this._targetDistance},OrbitCamera.prototype._checkAspectRatio=function(){var t=this.app.graphicsDevice.height,i=this.app.graphicsDevice.width;this.entity.camera.horizontalFov=t>i},OrbitCamera.prototype._buildAabb=function(t,i){},OrbitCamera.prototype._calcYaw=function(t){var i=new pc.Vec3;return t.transformVector(pc.Vec3.FORWARD,i),Math.atan2(-i.x,-i.z)*pc.math.RAD_TO_DEG},OrbitCamera.prototype._clampDistance=function(t){return this.distanceMax>0?pc.math.clamp(t,this.distanceMin,this.distanceMax):Math.max(t,this.distanceMin)},OrbitCamera.prototype._clampPitchAngle=function(t){return pc.math.clamp(t,-this.pitchAngleMax,-this.pitchAngleMin)},OrbitCamera.quatWithoutYaw=new pc.Quat,OrbitCamera.yawOffset=new pc.Quat,OrbitCamera.prototype._calcPitch=function(t,i){var e=OrbitCamera.quatWithoutYaw,a=OrbitCamera.yawOffset;a.setFromEulerAngles(0,-i,0),e.mul2(a,t);var s=new pc.Vec3;return e.transformVector(pc.Vec3.FORWARD,s),Math.atan2(s.y,-s.z)*pc.math.RAD_TO_DEG};var ClickGoToPoint=pc.createScript("clickGoToPoint");ClickGoToPoint.attributes.add("cameraEntity",{type:"entity",title:"Camera",description:"The active camera."}),ClickGoToPoint.attributes.add("pointEntity",{type:"entity",title:"Point"}),ClickGoToPoint.attributes.add("renderPath",{type:"boolean",default:!0,title:"Render Path"}),ClickGoToPoint.prototype.initialize=function(){this.controlCrowd=!0,this.spawnObstacles=[],this.pointEntity&&(this.pointEntity.enabled=!1),this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.mouseDown,this),this.app.touch&&this.app.touch.on(pc.EVENT_TOUCHSTART,this.touchStart,this),this.app.on("UI:buttonClicked",this.onButtonClicked,this)},ClickGoToPoint.prototype.mouseDown=function(t){BtnStates.clicked||t.button===pc.MOUSEBUTTON_LEFT&&this.doRaycast(t)},ClickGoToPoint.prototype.touchStart=function(t){BtnStates.clicked||(1==t.touches.length&&this.doRaycast(t.touches[0]),t.event.preventDefault())},ClickGoToPoint.prototype.doRaycast=function(t){var i=this.cameraEntity.getPosition(),o=this.cameraEntity.camera.screenToWorld(t.x,t.y,this.cameraEntity.camera.farClip),e=this.app.systems.rigidbody.raycastFirst(i,o);if(e){this.pointEntity&&(this.pointEntity.enabled=!0,this.pointEntity.setPosition(e.point.x,e.point.y+this.pointEntity.getLocalScale().y/2,e.point.z));var n=this.app.root.findByName("Crowd");if(this.controlCrowd)n.fire("OrestisPathfinding:moveCrowdTo",e.point,this.renderPath);else{var s=this.app.root.findByName("Player Solo");n.fire("OrestisPathfinding:moveAgentsTo",[s],e.point,this.renderPath)}}},ClickGoToPoint.prototype.onButtonClicked=function(t,i){var o;if("Toggle Control"===t)return this.controlCrowd=!this.controlCrowd,o=this.controlCrowd?"Control Agent":"Control Crowd",void(i.findByName("Text").element.text=o.toUpperCase());if("Spawn Obstacle"===t){var e=new pc.Entity("Obstacle Cube");this.spawnObstacles.push(e),e.addComponent("model",{type:"box",materialAsset:this.app.assets.find("Mat Box Blue Dark")}),this.app.root.addChild(e),e.setPosition(pc.math.random(-20,20),13,pc.math.random(-20,20)),e.addComponent("collision",{type:"box"}),e.addComponent("rigidbody",{type:pc.BODYTYPE_DYNAMIC,mass:100,friction:1,restitution:0});var n=this;return onCollision=function(){var t=this.entity;!1!==e.rigidbody.linearVelocity.length()>.01||t.script||(t.collision.off("contact"),t.addComponent("script"),t.script.create("orestisObstacle",{attributes:{pathfinderEntity:n.app.root.findByName("Scene"),obstacleType:"box",boxExtents:[1,1,1],boxYAngle:t.getEulerAngles().y,initialState:!0}}),t.fire("OrestisPathfinding:initializeObstacle"))},void e.collision.on("contact",onCollision)}if("Remove Obstacles"!==t){var s,a;if("Stop Agents"===t)return s=this.app.root.findByName("Crowd"),void(this.controlCrowd?s.fire("OrestisPathfinding:stopCrowd"):(a=this.app.root.findByName("Player Solo"),s.fire("OrestisPathfinding:stopAgents",[a])));if("Teleport Agent"===t)return s=this.app.root.findByName("Crowd"),a=this.app.root.findByName("Player Solo"),void s.fire("OrestisPathfinding:teleportAgentsTo",[a],new pc.Vec3(-7.18,2.14,-19.69));if("Toggle Navmesh"===t)return pathfinderEntity=this.app.root.findByName("Scene"),void(pathfinderEntity.script.orestisPathfinding.debugNavMesh=!pathfinderEntity.script.orestisPathfinding.debugNavMesh);if("Get Paths"!==t)"Get Path"!==t||this.app.root.findByName("Scene").fire("OrestisPathfinding:findPath",this.app.root.findByName("Sphere1").getPosition(),this.app.root.findByName("Sphere2").getPosition(),(t=>{console.log(t)}));else{const t=[];this.app.root.findByName("Crowd").fire("OrestisPathfinding:getPath",t,(t=>{console.log(t)}))}}else this.spawnObstacles.forEach((function(t){t.destroy()}))};var MouseInput=pc.createScript("mouseInput");MouseInput.attributes.add("orbitSensitivity",{type:"number",default:.3,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),MouseInput.attributes.add("distanceSensitivity",{type:"number",default:.15,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),MouseInput.prototype.initialize=function(){if(this.orbitCamera=this.entity.script.orbitCamera,this.orbitCamera){var t=this,onMouseOut=function(o){t.onMouseOut(o)};this.app.mouse.on(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.on(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.on(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.addEventListener("mouseout",onMouseOut,!1),this.on("destroy",(function(){this.app.mouse.off(pc.EVENT_MOUSEDOWN,this.onMouseDown,this),this.app.mouse.off(pc.EVENT_MOUSEUP,this.onMouseUp,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,this.onMouseMove,this),this.app.mouse.off(pc.EVENT_MOUSEWHEEL,this.onMouseWheel,this),window.removeEventListener("mouseout",onMouseOut,!1)}))}this.app.mouse.disableContextMenu(),this.lookButtonDown=!1,this.panButtonDown=!1,this.lastPoint=new pc.Vec2},MouseInput.fromWorldPoint=new pc.Vec3,MouseInput.toWorldPoint=new pc.Vec3,MouseInput.worldDiff=new pc.Vec3,MouseInput.prototype.pan=function(t){var o=MouseInput.fromWorldPoint,e=MouseInput.toWorldPoint,i=MouseInput.worldDiff,s=this.entity.camera,n=this.orbitCamera.distance;s.screenToWorld(t.x,t.y,n,o),s.screenToWorld(this.lastPoint.x,this.lastPoint.y,n,e),i.sub2(e,o),this.orbitCamera.pivotPoint.add(i)},MouseInput.prototype.onMouseDown=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!0;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!0}},MouseInput.prototype.onMouseUp=function(t){switch(t.button){case pc.MOUSEBUTTON_LEFT:this.lookButtonDown=!1;break;case pc.MOUSEBUTTON_MIDDLE:case pc.MOUSEBUTTON_RIGHT:this.panButtonDown=!1}},MouseInput.prototype.onMouseMove=function(t){pc.app.mouse;this.lookButtonDown?(this.orbitCamera.pitch-=t.dy*this.orbitSensitivity,this.orbitCamera.yaw-=t.dx*this.orbitSensitivity):this.panButtonDown&&this.pan(t),this.lastPoint.set(t.x,t.y)},MouseInput.prototype.onMouseWheel=function(t){this.orbitCamera.distance-=t.wheel*this.distanceSensitivity*(.1*this.orbitCamera.distance),t.event.preventDefault()},MouseInput.prototype.onMouseOut=function(t){this.lookButtonDown=!1,this.panButtonDown=!1};pc.extend(pc,function(){var TweenManager=function(t){this._app=t,this._tweens=[],this._add=[]};TweenManager.prototype={add:function(t){return this._add.push(t),t},update:function(t){for(var i=0,e=this._tweens.length;i<e;)this._tweens[i].update(t)?i++:(this._tweens.splice(i,1),e--);this._add.length&&(this._tweens=this._tweens.concat(this._add),this._add.length=0)}};var Tween=function(t,i,e){pc.events.attach(this),this.manager=i,e&&(this.entity=null),this.time=0,this.complete=!1,this.playing=!1,this.stopped=!0,this.pending=!1,this.target=t,this.duration=0,this._currentDelay=0,this.timeScale=1,this._reverse=!1,this._delay=0,this._yoyo=!1,this._count=0,this._numRepeats=0,this._repeatDelay=0,this._from=!1,this._slerp=!1,this._fromQuat=new pc.Quat,this._toQuat=new pc.Quat,this._quat=new pc.Quat,this.easing=pc.Linear,this._sv={},this._ev={}},_parseProperties=function(t){var i;return t instanceof pc.Vec2?i={x:t.x,y:t.y}:t instanceof pc.Vec3?i={x:t.x,y:t.y,z:t.z}:t instanceof pc.Vec4||t instanceof pc.Quat?i={x:t.x,y:t.y,z:t.z,w:t.w}:t instanceof pc.Color?(i={r:t.r,g:t.g,b:t.b},void 0!==t.a&&(i.a=t.a)):i=t,i};Tween.prototype={to:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this},from:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._from=!0,this},rotate:function(t,i,e,n,s,r){return this._properties=_parseProperties(t),this.duration=i,e&&(this.easing=e),n&&this.delay(n),s&&this.repeat(s),r&&this.yoyo(r),this._slerp=!0,this},start:function(){var t,i,e,n;if(this.playing=!0,this.complete=!1,this.stopped=!1,this._count=0,this.pending=this._delay>0,this._reverse&&!this.pending?this.time=this.duration:this.time=0,this._from){for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this._properties[t],this._ev[t]=this.target[t]);this._slerp&&(this._toQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._fromQuat.setFromEulerAngles(i,e,n))}else{for(t in this._properties)this._properties.hasOwnProperty(t)&&(this._sv[t]=this.target[t],this._ev[t]=this._properties[t]);this._slerp&&(this._fromQuat.setFromEulerAngles(this.target.x,this.target.y,this.target.z),i=void 0!==this._properties.x?this._properties.x:this.target.x,e=void 0!==this._properties.y?this._properties.y:this.target.y,n=void 0!==this._properties.z?this._properties.z:this.target.z,this._toQuat.setFromEulerAngles(i,e,n))}return this._currentDelay=this._delay,this.manager.add(this),this},pause:function(){this.playing=!1},resume:function(){this.playing=!0},stop:function(){this.playing=!1,this.stopped=!0},delay:function(t){return this._delay=t,this.pending=!0,this},repeat:function(t,i){return this._count=0,this._numRepeats=t,this._repeatDelay=i||0,this},loop:function(t){return t?(this._count=0,this._numRepeats=1/0):this._numRepeats=0,this},yoyo:function(t){return this._yoyo=t,this},reverse:function(){return this._reverse=!this._reverse,this},chain:function(){for(var t=arguments.length;t--;)t>0?arguments[t-1]._chained=arguments[t]:this._chained=arguments[t];return this},update:function(t){if(this.stopped)return!1;if(!this.playing)return!0;if(!this._reverse||this.pending?this.time+=t*this.timeScale:this.time-=t*this.timeScale,this.pending){if(!(this.time>this._currentDelay))return!0;this._reverse?this.time=this.duration-(this.time-this._currentDelay):this.time=this.time-this._currentDelay,this.pending=!1}var i=0;(!this._reverse&&this.time>this.duration||this._reverse&&this.time<0)&&(this._count++,this.complete=!0,this.playing=!1,this._reverse?(i=this.duration-this.time,this.time=0):(i=this.time-this.duration,this.time=this.duration));var e,n,s=0===this.duration?1:this.time/this.duration,r=this.easing(s);for(var h in this._properties)this._properties.hasOwnProperty(h)&&(e=this._sv[h],n=this._ev[h],this.target[h]=e+(n-e)*r);if(this._slerp&&this._quat.slerp(this._fromQuat,this._toQuat,r),this.entity&&(this.entity._dirtifyLocal(),this.element&&this.entity.element&&(this.entity.element[this.element]=this.target),this._slerp&&this.entity.setLocalRotation(this._quat)),this.fire("update",t),this.complete){var a=this._repeat(i);return a?this.fire("loop"):(this.fire("complete",i),this.entity&&this.entity.off("destroy",this.stop,this),this._chained&&this._chained.start()),a}return!0},_repeat:function(t){if(this._count<this._numRepeats){if(this._reverse?this.time=this.duration-t:this.time=t,this.complete=!1,this.playing=!0,this._currentDelay=this._repeatDelay,this.pending=!0,this._yoyo){for(var i in this._properties){var e=this._sv[i];this._sv[i]=this._ev[i],this._ev[i]=e}this._slerp&&(this._quat.copy(this._fromQuat),this._fromQuat.copy(this._toQuat),this._toQuat.copy(this._quat))}return!0}return!1}};var BounceIn=function(t){return 1-BounceOut(1-t)},BounceOut=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375};return{TweenManager:TweenManager,Tween:Tween,Linear:function(t){return t},QuadraticIn:function(t){return t*t},QuadraticOut:function(t){return t*(2-t)},QuadraticInOut:function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},CubicIn:function(t){return t*t*t},CubicOut:function(t){return--t*t*t+1},CubicInOut:function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},QuarticIn:function(t){return t*t*t*t},QuarticOut:function(t){return 1- --t*t*t*t},QuarticInOut:function(t){return(t*=2)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2)},QuinticIn:function(t){return t*t*t*t*t},QuinticOut:function(t){return--t*t*t*t*t+1},QuinticInOut:function(t){return(t*=2)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2)},SineIn:function(t){return 0===t?0:1===t?1:1-Math.cos(t*Math.PI/2)},SineOut:function(t){return 0===t?0:1===t?1:Math.sin(t*Math.PI/2)},SineInOut:function(t){return 0===t?0:1===t?1:.5*(1-Math.cos(Math.PI*t))},ExponentialIn:function(t){return 0===t?0:Math.pow(1024,t-1)},ExponentialOut:function(t){return 1===t?1:1-Math.pow(2,-10*t)},ExponentialInOut:function(t){return 0===t?0:1===t?1:(t*=2)<1?.5*Math.pow(1024,t-1):.5*(2-Math.pow(2,-10*(t-1)))},CircularIn:function(t){return 1-Math.sqrt(1-t*t)},CircularOut:function(t){return Math.sqrt(1- --t*t)},CircularInOut:function(t){return(t*=2)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},BackIn:function(t){var i=1.70158;return t*t*((i+1)*t-i)},BackOut:function(t){var i=1.70158;return--t*t*((i+1)*t+i)+1},BackInOut:function(t){var i=2.5949095;return(t*=2)<1?t*t*((i+1)*t-i)*.5:.5*((t-=2)*t*((i+1)*t+i)+2)},BounceIn:BounceIn,BounceOut:BounceOut,BounceInOut:function(t){return t<.5?.5*BounceIn(2*t):.5*BounceOut(2*t-1)+.5},ElasticIn:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),-e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/.4))},ElasticOut:function(t){var i,e=.1;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=.4*Math.asin(1/e)/(2*Math.PI),e*Math.pow(2,-10*t)*Math.sin((t-i)*(2*Math.PI)/.4)+1)},ElasticInOut:function(t){var i,e=.1,n=.4;return 0===t?0:1===t?1:(!e||e<1?(e=1,i=.1):i=n*Math.asin(1/e)/(2*Math.PI),(t*=2)<1?e*Math.pow(2,10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*-.5:e*Math.pow(2,-10*(t-=1))*Math.sin((t-i)*(2*Math.PI)/n)*.5+1)}}}()),function(){pc.Application.prototype.addTweenManager=function(){this._tweenManager=new pc.TweenManager(this),this.on("update",(function(t){this._tweenManager.update(t)}))},pc.Application.prototype.tween=function(t){return new pc.Tween(t,this._tweenManager)},pc.Entity.prototype.tween=function(t,i){var e=this._app.tween(t);return e.entity=this,this.once("destroy",e.stop,e),i&&i.element&&(e.element=i.element),e};var t=pc.Application.getApplication();t&&t.addTweenManager()}();var BatchPerMaterial=pc.createScript("batchPerMaterial");BatchPerMaterial.prototype.initialize=function(){var e=[];this.entity.find((function(t){!0===t.enabled&&t.model&&t.model.meshInstances&&e.push(t.model)})),e.forEach(function(e){var t=this.app.assets.get(e.materialAsset);if(t){var a=t.resource.name,i=this.app.batcher.getGroupByName(a);i&&(e.batchGroupId=i.id)}}.bind(this)),this.app.batcher.generate()};var BtnStates=pc.createScript("btnStates");BtnStates.attributes.add("hoverAsset",{type:"asset",assetType:"texture"}),BtnStates.attributes.add("activeAsset",{type:"asset",assetType:"texture"}),BtnStates.clicked=!1,BtnStates.prototype.initialize=function(){this.activeNavMesh=0,this.originalTexture=this.entity.element.textureAsset,this.hovered=!1,this.entity.element.on("mouseenter",this.onEnter,this),this.entity.element.on("mousedown",this.onPress,this),this.entity.element.on("mouseup",this.onRelease,this),this.entity.element.on("mouseleave",this.onLeave,this),this.entity.element.on("touchstart",this.onPress,this),this.entity.element.on("touchend",this.onRelease,this)},BtnStates.prototype.onEnter=function(t){this.hovered=!0,t.element.textureAsset=this.hoverAsset,document.body.style.cursor="pointer"},BtnStates.prototype.onLeave=function(t){this.hovered=!1,t.element.textureAsset=this.originalTexture,document.body.style.cursor="default"},BtnStates.prototype.onPress=function(t){BtnStates.clicked=!0,t.element.textureAsset=this.activeAsset},BtnStates.prototype.onRelease=function(t){t.element.textureAsset=this.hovered?this.hoverAsset:this.originalTexture,this.app.fire("UI:buttonClicked",this.entity.name,this.entity),window.setTimeout((function(){BtnStates.clicked=!1}),100)};var GetAgentSpeed=pc.createScript("getAgentSpeed");GetAgentSpeed.prototype.initialize=function(){this.vec=new pc.Vec3,this.agentEntity=this.app.root.findByName("Player Solo"),this.orestisAgent=this.agentEntity.script.orestisAgent,this.agentIndex=void 0},GetAgentSpeed.prototype.update=function(t){var e=this.orestisAgent.crowd;if(e){this.agentIndex||(this.agentIndex=e.getAgentIndex(this.agentEntity));var i=e.getAgentVelocity(this.agentIndex,this.vec).length();this.entity.element.text="Agent Speed: "+i.toFixed(2)+"m/s"}this.app.keyboard.wasPressed(pc.KEY_R)&&(this.agentEntity.script.orestisAgent.maxSpeed=5===this.agentEntity.script.orestisAgent.maxSpeed?0:5)};var TouchInput=pc.createScript("touchInput");TouchInput.attributes.add("orbitSensitivity",{type:"number",default:.4,title:"Orbit Sensitivity",description:"How fast the camera moves around the orbit. Higher is faster"}),TouchInput.attributes.add("distanceSensitivity",{type:"number",default:.2,title:"Distance Sensitivity",description:"How fast the camera moves in and out. Higher is faster"}),TouchInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera,this.lastTouchPoint=new pc.Vec2,this.lastPinchMidPoint=new pc.Vec2,this.lastPinchDistance=0,this.orbitCamera&&this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this),this.on("destroy",(function(){this.app.touch.off(pc.EVENT_TOUCHSTART,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHEND,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHCANCEL,this.onTouchStartEndCancel,this),this.app.touch.off(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)})))},TouchInput.prototype.getPinchDistance=function(t,i){var o=t.x-i.x,n=t.y-i.y;return Math.sqrt(o*o+n*n)},TouchInput.prototype.calcMidPoint=function(t,i,o){o.set(i.x-t.x,i.y-t.y),o.scale(.5),o.x+=t.x,o.y+=t.y},TouchInput.prototype.onTouchStartEndCancel=function(t){var i=t.touches;1==i.length?this.lastTouchPoint.set(i[0].x,i[0].y):2==i.length&&(this.lastPinchDistance=this.getPinchDistance(i[0],i[1]),this.calcMidPoint(i[0],i[1],this.lastPinchMidPoint))},TouchInput.fromWorldPoint=new pc.Vec3,TouchInput.toWorldPoint=new pc.Vec3,TouchInput.worldDiff=new pc.Vec3,TouchInput.prototype.pan=function(t){var i=TouchInput.fromWorldPoint,o=TouchInput.toWorldPoint,n=TouchInput.worldDiff,h=this.entity.camera,c=this.orbitCamera.distance;h.screenToWorld(t.x,t.y,c,i),h.screenToWorld(this.lastPinchMidPoint.x,this.lastPinchMidPoint.y,c,o),n.sub2(o,i),this.orbitCamera.pivotPoint.add(n)},TouchInput.pinchMidPoint=new pc.Vec2,TouchInput.prototype.onTouchMove=function(t){var i=TouchInput.pinchMidPoint,o=t.touches;if(1==o.length){var n=o[0];this.orbitCamera.pitch-=(n.y-this.lastTouchPoint.y)*this.orbitSensitivity,this.orbitCamera.yaw-=(n.x-this.lastTouchPoint.x)*this.orbitSensitivity,this.lastTouchPoint.set(n.x,n.y)}else if(2==o.length){var h=this.getPinchDistance(o[0],o[1]),c=h-this.lastPinchDistance;this.lastPinchDistance=h,this.orbitCamera.distance-=c*this.distanceSensitivity*.1*(.1*this.orbitCamera.distance),this.calcMidPoint(o[0],o[1],i),this.pan(i),this.lastPinchMidPoint.copy(i)}};var HandleObstacles=pc.createScript("handleObstacles");HandleObstacles.prototype.initialize=function(){this.app.on("UI:buttonClicked",this.onButtonClicked,this)},HandleObstacles.prototype.onButtonClicked=function(t){if(-1!==t.indexOf("Obstacle")){var e=this.app.root.findByName("Obstacles").findByName(t);if(e){var s=e.script.orestisObstacle;s.updateObstacle(!s.state),e.orestisTween&&e.orestisTween.stop();var i=e.getPosition().clone();i.y+=s.state?-3:3,e.orestisTween=e.tween(e.getLocalPosition()).to(i,.5,pc.SineOut).start()}}};var KeyboardInput=pc.createScript("keyboardInput");KeyboardInput.prototype.initialize=function(){this.orbitCamera=this.entity.script.orbitCamera},KeyboardInput.prototype.postInitialize=function(){this.orbitCamera&&(this.startDistance=this.orbitCamera.distance,this.startYaw=this.orbitCamera.yaw,this.startPitch=this.orbitCamera.pitch,this.startPivotPosition=this.orbitCamera.pivotPoint.clone())},KeyboardInput.prototype.update=function(t){this.orbitCamera&&this.app.keyboard.wasPressed(pc.KEY_SPACE)&&(this.orbitCamera.reset(this.startYaw,this.startPitch,this.startDistance),this.orbitCamera.pivotPoint=this.startPivotPosition)};!function(t){var e={};function i(s){if(e[s])return e[s].exports;var n=e[s]={i:s,l:!1,exports:{}};return t[s].call(n.exports,n,n.exports,i),n.l=!0,n.exports}i.m=t,i.c=e,i.d=function(t,e,s){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:s})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(t,e){if(1&e&&(t=i(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var s=Object.create(null);if(i.r(s),Object.defineProperty(s,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)i.d(s,n,function(e){return t[e]}.bind(null,n));return s},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=0)}([function(t,e,s){"use strict";var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(e,"__esModule",{value:!0});const a=n(s(1)),d=n(s(2)),c=n(s(3)),l=n(s(5));new a.default,new d.default,new c.default,new l.default,console.log("Orestis 3D Pathfinding v2.1.0")},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.createPcScript()}createPcScript(){const t=pc.createScript("orestisAgent");this.attachAttributes(t),t.prototype.initialize=function(){let t;this.agentId=void 0,this.crowd=void 0,pc.events.attach(this.entity),this.on("attr",(()=>{window.clearTimeout(t),t=window.setTimeout(this.updateAgentAttributes.bind(this),300)})),this.entity.on("OrestisPathfinding:updateAgentAttributes",this.updateAgentAttributes,this)},t.prototype.onAddAgent=function(t,e){this.agentId=t,this.crowd=e},t.prototype.updateAgentAttributes=function(){this.crowd.updateAgentParameters(this.agentId,{radius:this.radius,height:this.height,maxAcceleration:this.maxAcceleration,maxSpeed:this.maxSpeed,collisionQueryRange:this.collisionQueryRange,pathOptimizationRange:this.pathOptimizationRange,separationWeight:this.separationWeight,stopDistance:this.stopDistance,orientAgent:this.orientAgent,orientInertia:this.orientInertia})}}attachAttributes(t){t.attributes.add("radius",{type:"number",default:.5,min:0,title:"Radius",description:"Agent radius. [Limit: >= 0]"}),t.attributes.add("height",{type:"number",default:1,min:0,title:"Height",description:"Agent height. [Limit: >= 0]"}),t.attributes.add("maxAcceleration",{type:"number",default:1,min:0,title:"Max Acceleration",description:"Maximum allowed acceleration. [Limit: >= 0]"}),t.attributes.add("maxSpeed",{type:"number",default:1,min:0,title:"Max Speed",description:"Maximum allowed speed. [Limit: >= 0]"}),t.attributes.add("collisionQueryRange",{type:"number",default:.5,min:0,title:"Collision Query Range",description:"Defines how close a collision element must be before it is considered for steering behaviors. [Limits: > 0]"}),t.attributes.add("pathOptimizationRange",{type:"number",default:0,min:0,title:"Path Optimization Range",description:"The path visibility optimization range. [Limit: > 0]"}),t.attributes.add("separationWeight",{type:"number",default:1,min:0,title:"Separation Weight",description:"How aggressive the agent manager should be at avoiding collisions with this agent. [Limit: >= 0]"}),t.attributes.add("stopDistance",{type:"number",default:0,title:"Stop Distance",description:"The distance from the path end point this agent should stop at. If 0.0 is provided the agent will reach as close as possible to the end point."}),t.attributes.add("orientInertia",{type:"number",default:.1,title:"Orient Inertia",description:"How smoothly the agent entity will rotate to orient itself."}),t.attributes.add("orientAgent",{type:"boolean",default:!0,title:"Orient Agent",description:"If selected the agent entity will automatically orient itself on the Y axis to look at the next point on the path."})}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=class{constructor(){this.createPcScript()}createPcScript(){const t=pc.createScript("orestisObstacle");this.attachAttributes(t),t.prototype.initialize=function(){this.pathfinder=void 0,this.obstacleRef=void 0,this.state=this.initialState,this.obstaclePos=this.entity.getPosition().clone(),this.entity.on("OrestisPathfinding:initializeObstacle",this.initializeObstacle,this),this.on("state",(function(t){this.updateObstacle(t)}),this)},t.prototype.initializeObstacle=function(t){var e,s,n;if(t)this.pathfinder=t;else{if(!this.pathfinderEntity)return;this.pathfinder=null===(n=null===(s=null===(e=this.pathfinderEntity)||void 0===e?void 0:e.script)||void 0===s?void 0:s.orestisPathfinding)||void 0===n?void 0:n.pathfinder}this.updateObstacle(this.state)},t.prototype.updateObstacle=function(t){this.state=!0===t;const e=this.pathfinder;if(!0===t){let t;switch(this.obstacleType){case"box":t=e.addBoxObstacle(this.obstaclePos,this.boxExtents,this.boxYAngle*pc.math.DEG_TO_RAD);break;case"cylinder":t=e.addCylinderObstacle(this.obstaclePos,this.cylinderRadius,this.cylinderHeight)}this.obstacleRef=t}else e.removeObstacle(this.obstacleRef),this.obstacleRef=void 0,e.navMesh.update()}}attachAttributes(t){t.attributes.add("pathfinderEntity",{type:"entity",title:"Pathfinder",description:"Drag and drop the pathfinder entity this obstacle should interact with. Updating this requires regenerating the navmesh or reloading your app"}),t.attributes.add("obstacleType",{type:"string",default:"box",title:"Obstacle Type",description:"Set the type of the obstacle shape.",enum:[{Box:"box"},{Cylinder:"cylinder"}]}),t.attributes.add("boxExtents",{type:"vec3",default:[1,1,1],title:"Box Extents",description:"The box extents on each axis."}),t.attributes.add("boxYAngle",{type:"number",default:0,min:0,max:360,title:"Box Y Angle",description:"The angle of the box orientation on the Y axis."}),t.attributes.add("cylinderRadius",{type:"number",default:1,min:0,title:"Cylinder Radius",description:"The cylinder radius."}),t.attributes.add("cylinderHeight",{type:"number",default:2,min:0,title:"Cylinder Height",description:"The cylinder height."}),t.attributes.add("initialState",{type:"boolean",default:!0,title:"Initial State",description:"If the obstacle will be enabled or disabled when the navmesh is generated."})}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=s(4);e.default=class{constructor(){this.createPcScript()}createPcScript(){const t=pc.createScript("orestisCrowd");this.attachAttributes(t),t.prototype.initialize=function(){this.pathfinder=void 0,this.crowd=void 0,this.agentsList=void 0,this.activeAgents=void 0,this.debugLines=!1,this.debugPath=void 0,this.debugColors=void 0,this.activeDestination=void 0,this.debugLineColor=new pc.Color(1,1,1,.5),pc.events.attach(this.entity),this.entity.on("OrestisPathfinding:moveCrowdTo",(function(t,e){this.moveCrowdTo(null,t,e)}),this),this.entity.on("OrestisPathfinding:moveAgentsTo",(function(t,e,s){this.moveCrowdTo(t,e,s)}),this),this.entity.on("OrestisPathfinding:stopCrowd",(function(){this.stopCrowd(null)}),this),this.entity.on("OrestisPathfinding:stopAgents",(function(t){this.stopCrowd(t)}),this),this.entity.on("OrestisPathfinding:teleportAgentsTo",(function(t,e,s){this.teleportAgentsTo(t,e)}),this),this.entity.on("OrestisPathfinding:getPath",(function(t,e){"function"==typeof e&&e(this.getPath(t))}),this),this.on("attr",(function(t,e){this.initializeCrowd()}))},t.prototype.initializeCrowd=function(t){t&&(this.pathfinder=t),this.crowd&&this.crowd.destroy(),this.crowd=new n.OrestisCrowd(this,this.pathfinder,this.maxAgents,this.maxAgentRadius),this.assignAgents()},t.prototype.destroyCrowd=function(){this.crowd&&this.crowd.destroy(),this.crowd=void 0},t.prototype.assignAgents=function(){this.agentsList={},this.agents.forEach((t=>{var e;const s=null===(e=null==t?void 0:t.script)||void 0===e?void 0:e.orestisAgent;if(!s||!s.enabled)return!0;const n=this.crowd.addAgent(t,{radius:s.radius,height:s.height,maxAcceleration:s.maxAcceleration,maxSpeed:s.maxSpeed,collisionQueryRange:s.collisionQueryRange,pathOptimizationRange:s.pathOptimizationRange,separationWeight:s.separationWeight,stopDistance:s.stopDistance,orientAgent:s.orientAgent,orientInertia:s.orientInertia});s.onAddAgent(n,this.crowd),this.agentsList[t._guid]=n}))},t.prototype.moveCrowdTo=function(t,e,s){if(this.debugLines=s,!this.crowd)return;let n,a;t?(a=[],t.forEach((t=>{a.push(this.agentsList[t._guid])}))):a=this.crowd.getAgents(),a.forEach((t=>{n=this.pathfinder.getClosestPoint(e),!0===this.isPointCloseToSelected(n,e)&&this.crowd.agentGoto(t,n)})),this.activeAgents=a,this.activeDestination=n.clone()},t.prototype.stopCrowd=function(t){if(!this.crowd)return;let e;t?(e=[],t.forEach((t=>{e.push(this.agentsList[t._guid])}))):e=this.crowd.getAgents(),e.forEach((t=>{this.crowd.agentStop(t)})),this.activeAgents=void 0,this.activeDestination=void 0},t.prototype.isPointCloseToSelected=function(t,e){let s=!0;const n=this.pathfinder.parameters.queryExtent;return Math.abs(t.x-e.x)>n.x&&(s=!1),s&&Math.abs(t.y-e.y)>n.y&&(s=!1),s&&Math.abs(t.z-e.z)>n.z&&(s=!1),s},t.prototype.teleportAgentsTo=function(t,e){if(!this.crowd)return;let s,n;t?(n=[],t.forEach((t=>{n.push(this.agentsList[t._guid])}))):n=this.crowd.getAgents(),n.forEach((t=>{s=this.pathfinder.getClosestPoint(e),!0===this.isPointCloseToSelected(s,e)&&(this.crowd.agentTeleport(t,s),!1===this.crowd.isAgentActive(t)&&this.crowd.getAgentEntity(t).setPosition(s))})),this.activeAgents=void 0,this.activeDestination=void 0},t.prototype.getPath=function(t){if(!this.crowd||!this.activeDestination)return;let e;e=t&&t.length>0?t:this.agents;const s=this.pathfinder,n={};return e.forEach((t=>{const e=s.computePath(s.getClosestPoint(t.getPosition()),this.activeDestination);n[t._guid]=[];const a=n[t._guid];e.forEach((t=>{a.push(t.clone())}))})),n},t.prototype.calculateDebugLines=function(){const t=this.pathfinder,e=this.activeAgents;this.debugPath=[],this.debugColors=[],e.forEach((e=>{const s=this.crowd.getAgentEntity(e);if(!s)return!0;const n=t.computePath(t.getClosestPoint(s.getPosition()),this.activeDestination);n.forEach(((t,e)=>{if(0===e)return!0;const s=n[e-1];this.debugPath.push(s),this.debugPath.push(t),this.debugColors.push(this.debugLineColor),this.debugColors.push(this.debugLineColor)}))}))},t.prototype.update=function(){this.activeDestination&&this.debugLines&&(this.calculateDebugLines(),this.app.renderLines(this.debugPath,this.debugColors))}}attachAttributes(t){t.attributes.add("pathfinderEntity",{type:"entity",title:"Pathfinder",description:"Drag and drop the pathfinder entity this crowd should interact with. Updating this requires regenerating the navmesh or reloading your app"}),t.attributes.add("agents",{type:"entity",array:!0,title:"Agents",description:"Assigns agents to this crowd."}),t.attributes.add("maxAgents",{type:"number",default:1,min:1,title:"Max Agents",description:"The maximum number of agents allowed on this crowd."}),t.attributes.add("maxAgentRadius",{type:"number",default:.1,min:0,title:"Max Agent Radius",description:"The maximum radius an agent can have."})}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OrestisCrowd=void 0,e.OrestisCrowd=class{constructor(t,e,s,n){this.vec=new pc.Vec3,this.vec2=new pc.Vec3,this.vec3=new pc.Vec3,this.recastCrowd={},this.entities=new Array,this.agents=new Array,this.agentsActive=new Array,this.agentsTargetPoint=new Array,this.script=t,this.app=t.app,this.pathfinder=e,this.recastCrowd=new this.pathfinder.RECAST.Crowd(s,n,this.pathfinder.navMesh.getNavMesh()),this.agentScriptParameters=[],this.agentCurrentAngleY=[],this.updateRef=this.update.bind(this),this.app.on("update",this.updateRef)}destroy(){this.recastCrowd&&this.recastCrowd.destroy()}addAgent(t,e){var s=new this.pathfinder.RECAST.dtCrowdAgentParams;s.radius=e.radius,s.height=e.height,s.maxAcceleration=e.maxAcceleration,s.maxSpeed=e.maxSpeed,s.collisionQueryRange=e.collisionQueryRange,s.pathOptimizationRange=e.pathOptimizationRange,s.separationWeight=e.separationWeight,s.updateFlags=7,s.obstacleAvoidanceType=0,s.queryFilterType=0,s.userData=0;const n=this.vec3;this.pathfinder.getRandomPointAround(t.getPosition(),.25,n);var a=this.recastCrowd.addAgent(new this.pathfinder.RECAST.Vec3(n.x,n.y,n.z),s);return this.entities.push(t),this.agents.push(a),this.agentScriptParameters[a]=e,this.agentCurrentAngleY[a]=t.getEulerAngles().y,a}getAgentPosition(t,e){const s=this.recastCrowd.getAgentPosition(t),n=-.75*this.pathfinder.parameters.cellHeight;return e?e.set(s.x,s.y+n,s.z):new pc.Vec3(s.x,s.y+n,s.z)}getAgentVelocity(t,e){var s=this.recastCrowd.getAgentVelocity(t);return e?e.set(s.x,s.y,s.z):new pc.Vec3(s.x,s.y,s.z)}getAgentNextTargetPath(t,e){var s=this.recastCrowd.getAgentNextTargetPath(t);return e?e.set(s.x,s.y,s.z):new pc.Vec3(s.x,s.y,s.z)}getAgentState(t){return this.recastCrowd.getAgentState(t)}getAgentEntity(t){return this.entities[t]}getAgentIndex(t){return this.entities.findIndex((e=>e._guid===t._guid))}overOffmeshConnection(t){return this.recastCrowd.overOffmeshConnection(t)}agentGoto(t,e){this.recastCrowd.agentGoto(t,new this.pathfinder.RECAST.Vec3(e.x,e.y,e.z)),this.agentsTargetPoint[t]||(this.agentsTargetPoint[t]=new pc.Vec3),this.agentsTargetPoint[t].copy(e),-1===this.agentsActive.indexOf(t)&&this.agentsActive.push(t)}agentStop(t){const e=this.getAgentEntity(t).getPosition();this.agentTeleport(t,e);const s=this.agentsActive.indexOf(t);s>-1&&this.agentsActive.splice(s,1)}isAgentActive(t){return this.agentsActive.indexOf(t)>-1}agentTeleport(t,e){this.recastCrowd.agentTeleport(t,new this.pathfinder.RECAST.Vec3(e.x,e.y,e.z))}updateAgentParameters(t,e){var s=this.recastCrowd.getAgentParameters(t);void 0!==e.radius&&(s.radius=e.radius),void 0!==e.height&&(s.height=e.height),void 0!==e.maxAcceleration&&(s.maxAcceleration=e.maxAcceleration),void 0!==e.maxSpeed&&(s.maxSpeed=e.maxSpeed),void 0!==e.collisionQueryRange&&(s.collisionQueryRange=e.collisionQueryRange),void 0!==e.pathOptimizationRange&&(s.pathOptimizationRange=e.pathOptimizationRange),void 0!==e.separationWeight&&(s.separationWeight=e.separationWeight),this.agentScriptParameters[t]=e,this.recastCrowd.setAgentParameters(t,s)}removeAgent(t){this.recastCrowd.removeAgent(t);var e=this.agents.indexOf(t);e>-1&&(this.agents.splice(e,1),this.entities.splice(e,1))}getAgents(){return this.agents}update(t){this.pathfinder.navMesh.update();var e=this.pathfinder.getTimeStep(),s=this.pathfinder.getMaximumSubStepCount();if(e<=.001)this.recastCrowd.update(t);else{var n=Math.floor(t/e);s&&n>s&&(n=s),n<1&&(n=1);var a=t/n;for(let t=0;t<n;t++)this.recastCrowd.update(a)}for(let e=0;e<this.agents.length;e++){if(-1===this.agentsActive.indexOf(e))continue;const s=this.agentScriptParameters[e],n=this.entities[e],a=this.getAgentPosition(this.agents[e],this.vec3);if(s.stopDistance>0&&this.agentsTargetPoint[e].distance(a)<=s.stopDistance)this.agentStop(e);else if(n.setPosition(a),s.orientAgent){const d=this.getAgentVelocity(e,this.vec2);if(d.length()>.2){const c=this.vec.copy(a).add(d.scale(3)),l=this.vec3.set(c.x,a.y,c.z);n.lookAt(l.x,l.y,l.z);const u=n.getEulerAngles(),p=u.y;this.agentCurrentAngleY[e]=pc.math.lerp(this.agentCurrentAngleY[e],p,s.orientInertia*t),n.setEulerAngles(u.x,this.agentCurrentAngleY[e],u.z)}}}}setDefaultQueryExtent(t){let e=new this.pathfinder.RECAST.Vec3(t.x,t.y,t.z);this.recastCrowd.setDefaultQueryExtent(e)}getDefaultQueryExtent(t){let e=this.recastCrowd.getDefaultQueryExtent();return t?t.set(e.x,e.y,e.z):new pc.Vec3(e.x,e.y,e.z)}getCorners(t){let e;const s=this.recastCrowd.getPath(t),n=s.getPointCount();var a=[];for(e=0;e<n;e++){let t=s.getPoint(e);a.push(new pc.Vec3(t.x,t.y,t.z))}return a}dispose(){this.recastCrowd.destroy(),this.app.off("update",this.updateRef),this.updateRef=void 0}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});const n=s(6);e.default=class{constructor(){this.createPcScript()}createPcScript(){const t=pc.createScript("orestisPathfinding");this.attachAttributes(t),t.prototype.postInitialize=function(){let t;this.pathfinder=new n.OrestisPathfinder(this),this.vecStart=new pc.Vec3,this.vecEnd=new pc.Vec3,pc.events.attach(this.entity),this.on("attr",(()=>{window.clearTimeout(t),t=window.setTimeout((()=>{this.pathfinder.onAttrUpdate()}),300)})),this.entity.on("OrestisPathfinding:findPath",this.findPath,this),this.onEventStart?this.app.once(this.onEventStart,(function(){this.pathfinder.createNavMesh()}),this):this.pathfinder.createNavMesh()},t.prototype.findPath=function(t,e,s){const n=this.pathfinder.getClosestPoint(t,this.vecStart),a=this.pathfinder.getClosestPoint(e,this.vecEnd);s(this.pathfinder.computePath(n,a))}}attachAttributes(t){t.attributes.add("cellSize",{type:"number",default:.25,min:0,title:"Cell Size",description:"XZ plane cell size, used to calculate the grid size based on the bounding box of the selected scene. [Limit: >= 0]"}),t.attributes.add("cellHeight",{type:"number",default:.25,min:0,title:"Cell Height",description:"Y-axis cell size, used to calculate the grid size based on the bounding box of the selected scene. [Limit: >= 0]"}),t.attributes.add("walkableHeight",{type:"number",default:1,min:0,title:"Walkable Height",description:"Minimum floor to ceiling height that will still allow the floor area to be considered walkable. [Limit: >=0]"}),t.attributes.add("walkableRadius",{type:"number",default:1,min:0,title:"Walkable Radius",description:"The distance to erode/shrink the walkable area of the heightfield away from obstructions. [Limit: >=0]"}),t.attributes.add("walkableClimb",{type:"number",default:1,min:0,title:"Walkable Climb",description:"Maximum ledge height that is considered to still be traversable. [Limit: >=0]"}),t.attributes.add("regionMinSize",{type:"number",default:8,min:0,title:"Region Min Size",description:"The minimum number of cells allowed to form isolated island areas. [Limit: >=0]"}),t.attributes.add("regionMergeSize",{type:"number",default:20,min:0,title:"Region Merge Size",description:"Any regions with a span count smaller than this value will, if possible, be merged with larger regions. [Limit: >=0]"}),t.attributes.add("edgeMaxLen",{type:"number",default:12,min:0,title:"Edge Max Length",description:"The maximum allowed length for contour edges along the border of the mesh. [Limit: >=0]"}),t.attributes.add("edgeMaxError",{type:"number",default:1.3,min:0,title:"Edge Max Error",description:"The maximum distance a simplfied contour's border edges should deviate the original raw contour. [Limit: >=0]"}),t.attributes.add("vertsPerPoly",{type:"number",default:6,min:3,title:"Max Verts Per Poly",description:"The maximum number of vertices allowed for polygons generated during the contour to polygon conversion process. [Limit: >= 3]"}),t.attributes.add("detailSampleDist",{type:"number",default:6,min:.9,title:"Detail Sample Dist",description:"Sets the sampling distance to use when generating the detail mesh, for height detail only. [Limits: >= 0.9]"}),t.attributes.add("detailSampleMaxError",{type:"number",default:1,min:0,title:"Detail Sample Max Error",description:"The maximum distance the detail mesh surface should deviate from heightfield data, for height detail only. [Limit: >=0]"}),t.attributes.add("tileSize",{type:"number",default:0,min:0,title:"Tile Size",description:"The width/height size of tile's on the xz-plane. If you plan to use obstacles the tileSize should be > 0. [Limit: >= 0]"}),t.attributes.add("borderSize",{type:"number",default:0,min:0,title:"Border Size",description:"The size of the non-navigable border around the heightfield. [Limit: >= 0]"}),t.attributes.add("debugNavMesh",{type:"boolean",default:!1,title:"Debug Nav Mesh",description:"If enabled the generated nav mesh will be rendered."}),t.attributes.add("queryExtent",{type:"vec3",default:[1,1,1],title:"Query Extent",description:"Set the Bounding box extent for doing spatial queries (getClosestPoint, getRandomPointAround etc.)."}),t.attributes.add("excludeTags",{type:"string",default:"navmesh-exclude",title:"Exclude Tags",description:"A comma separated list of entity tags to exclude from the navmesh."}),t.attributes.add("onEventStart",{type:"string",title:"On Event Start",description:"Run the navmesh generator when this app wide event fires, if empty the navmesh will be generated on initialize."}),t.attributes.add("onEventReady",{type:"string",title:"On Event Ready",description:"Fire a custom event when the navmesh generation finished."})}}},function(t,e,s){"use strict";var n=this&&this.__awaiter||function(t,e,s,n){return new(s||(s=Promise))((function(a,d){function r(t){try{h(n.next(t))}catch(t){d(t)}}function o(t){try{h(n.throw(t))}catch(t){d(t)}}function h(t){var e;t.done?a(t.value):(e=t.value,e instanceof s?e:new s((function(t){t(e)}))).then(r,o)}h((n=n.apply(t,e||[])).next())}))};Object.defineProperty(e,"__esModule",{value:!0}),e.OrestisPathfinder=void 0;const a=s(7);e.OrestisPathfinder=class{constructor(t,e=Recast){this.RECAST={},this._maximumSubStepCount=10,this._timeStep=1/60,this.parameters=t,this.app=t.app,this.parentEntity=t.entity,"function"==typeof e?e(this.RECAST):this.RECAST=e,this.isSupported()?this.setTimeStep():console.log("Orestis 3D Pathfinding, RecastJS is not available. Please make sure you included the js file.")}onAttrUpdate(){return n(this,void 0,void 0,(function*(){this.debugEntity&&(this.debugEntity.model.meshInstances[0].material.destroy(),this.debugEntity.model.meshInstances[0].mesh.destroy(),this.debugEntity.destroy(),this.debugEntity=void 0),this.createNavMesh()}))}setTimeStep(t=1/60){this._timeStep=t}getTimeStep(){return this._timeStep}setMaximumSubStepCount(t=10){this._maximumSubStepCount=t}getMaximumSubStepCount(){return this._maximumSubStepCount}createNavMesh(){this.navMesh&&(this.getCrowdEntities().forEach((t=>{t.script.orestisCrowd.destroyCrowd()})),this.navMesh.destroy());const t=new this.RECAST.rcConfig,e=this.parameters;t.borderSize=e.borderSize?e.borderSize:0,t.tileSize=e.tileSize?e.tileSize:0,t.cs=e.cellSize,t.ch=e.cellHeight,t.walkableSlopeAngle=e.walkableSlopeAngle?e.walkableSlopeAngle:35,t.walkableHeight=e.walkableHeight,t.walkableClimb=e.walkableClimb,t.walkableRadius=e.walkableRadius,t.maxEdgeLen=e.edgeMaxLen,t.maxSimplificationError=e.edgeMaxError,t.minRegionArea=e.regionMinSize,t.mergeRegionArea=e.regionMergeSize,t.maxVertsPerPoly=e.vertsPerPoly,t.detailSampleDist=e.detailSampleDist,t.detailSampleMaxError=e.detailSampleMaxError;const s=new a.OrestisGeometry(this.parentEntity,e.excludeTags).getGeometry();this.navMesh=new this.RECAST.NavMesh;const n=performance.now();this.navMesh.build(s.positions,s.offset,s.indices,s.indices.length,t);const d=performance.now();console.log(`Orestis 3D Pathfinding, nav mesh generation for ${this.parentEntity.name} entity ${d-n} milliseconds.`),e.debugNavMesh&&this.createDebugNavMesh(),this.bootCrowds(),this.setDefaultQueryExtent(this.parameters.queryExtent)}getCrowdEntities(){const t=this.parentEntity._guid;return this.app.root.find((e=>e.script&&e.script.orestisCrowd&&e.script.orestisCrowd.pathfinderEntity&&e.script.orestisCrowd.pathfinderEntity._guid===t))}bootCrowds(){const t=this.parentEntity._guid;this.getCrowdEntities().forEach((t=>{t.script.orestisCrowd.initializeCrowd(this)})),this.app.root.find((e=>e.script&&e.script.orestisObstacle&&e.script.orestisObstacle.pathfinderEntity&&e.script.orestisObstacle.pathfinderEntity._guid===t)).forEach((t=>{t.script.orestisObstacle.initializeObstacle(this)}))}createDebugNavMesh(t){var e=t?t.indices:null,s=t?t.positions:null;if(!t){e=[],s=[];var n=this.navMesh.getDebugNavMesh();let t=n.getTriangleCount();var a,d;for(a=0;a<3*t;a++)e.push(a);for(a=0;a<t;a++)for(d=0;d<3;d++){let t=n.getTriangle(a).getPoint(d);s.push(t.x,t.y,t.z)}}const c=new pc.Entity,l=new pc.StandardMaterial;l.emissive.set(.8,.8,.8,1),l.cull=pc.CULLFACE_FRONT,l.update();const u=new pc.GraphNode,p=new pc.Mesh(this.app.graphicsDevice);p.setPositions(s),p.setNormals(pc.calculateNormals(s,e)),p.setIndices(e),p.update();const g=new pc.MeshInstance(u,p,l),f=new pc.Model;f.graph=u,f.meshInstances.push(g),c.addComponent("model",{layers:[this.app.scene.layers.getLayerByName("World").id],castShadows:!1,receiveShadows:!1}),c.model.model=f,this.app.root.addChild(c),this.debugEntity=c}isSupported(){return void 0!==this.RECAST}getClosestPoint(t,e){var s=new this.RECAST.Vec3(t.x,t.y,t.z),n=this.navMesh.getClosestPoint(s);return e?e.set(n.x,n.y,n.z):new pc.Vec3(n.x,n.y,n.z)}getRandomPointAround(t,e,s){var n=new this.RECAST.Vec3(t.x,t.y,t.z),a=this.navMesh.getRandomPointAround(n,e);return s?s.set(a.x,a.y,a.z):new pc.Vec3(a.x,a.y,a.z)}moveAlong(t,e,s){var n=new this.RECAST.Vec3(t.x,t.y,t.z),a=new this.RECAST.Vec3(e.x,e.y,e.z),d=this.navMesh.moveAlong(n,a);return s?s.set(d.x,d.y,d.z):new pc.Vec3(d.x,d.y,d.z)}computePath(t,e){var s;let n=new this.RECAST.Vec3(t.x,t.y,t.z),a=new this.RECAST.Vec3(e.x,e.y,e.z),d=this.navMesh.computePath(n,a),c=d.getPointCount();var l=[];for(s=0;s<c;s++){let t=d.getPoint(s);l.push(new pc.Vec3(t.x,t.y,t.z))}return l}setDefaultQueryExtent(t){let e=new this.RECAST.Vec3(t.x,t.y,t.z);this.navMesh.setDefaultQueryExtent(e)}getDefaultQueryExtent(t){let e=this.navMesh.getDefaultQueryExtent();return t?t.set(e.x,e.y,e.z):new pc.Vec3(e.x,e.y,e.z)}buildFromNavmeshData(t){var e=t.length*t.BYTES_PER_ELEMENT,s=this.RECAST._malloc(e),n=new Uint8Array(this.RECAST.HEAPU8.buffer,s,e);n.set(t);let a=new this.RECAST.NavmeshData;a.dataPointer=n.byteOffset,a.size=t.length,this.navMesh=new this.RECAST.NavMesh,this.navMesh.buildFromNavmeshData(a),this.RECAST._free(n.byteOffset)}getNavmeshData(){let t=this.navMesh.getNavmeshData();var e=new Uint8Array(this.RECAST.HEAPU8.buffer,t.dataPointer,t.size),s=new Uint8Array(t.size);return s.set(e),this.navMesh.freeNavmeshData(t),s}addCylinderObstacle(t,e,s){return this.navMesh.addCylinderObstacle(new this.RECAST.Vec3(t.x,t.y,t.z),e,s)}addBoxObstacle(t,e,s){return this.navMesh.addBoxObstacle(new this.RECAST.Vec3(t.x,t.y,t.z),new this.RECAST.Vec3(e.x,e.y,e.z),s)}removeObstacle(t){this.navMesh.removeObstacle(t)}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.OrestisGeometry=void 0,e.OrestisGeometry=class{constructor(t,e){this.excludeTags=e,this.setParentEntity(t)}setParentEntity(t){t&&(this.parentEntity=t)}getMeshInstances(t){let e=[];return this.excludeTags.split(","),t.findComponents("model").concat(t.findComponents("render")).forEach((t=>{e=e.concat(t.meshInstances)})),e}getMeshGeometry(t){const e=t.node.getWorldTransform(),s=t.mesh.vertexBuffer,n=new pc.VertexIterator(s),a=[],d=new pc.Vec3;for(let t=0;t<s.getNumVertices();t++){const t=n.element[pc.SEMANTIC_POSITION],s=t.array[t.index],c=t.array[t.index+1],l=t.array[t.index+2];d.set(s,c,l),e.transformPoint(d,d),a.push(d.x,d.y,d.z),n.next()}n.end();const c=t.mesh.indexBuffer[pc.RENDERSTYLE_SOLID],l=new Uint16Array(c.lock()),u=[],p=t.mesh.primitive[0].base,g=t.mesh.primitive[0].count;for(let t=0;t<g;t++)u.push(l[t+p]);return{vertices:a,indices:u,numIndices:g,numVertices:a.length/3}}getGeometry(){if(!this.parentEntity)return;const t=this.getMeshInstances(this.parentEntity);if(0===t.length)return;const e=[],s=[];let n=0,a=0;for(let d=0;d<t.length;d++){const c=t[d],l=this.getMeshGeometry(c);let u=0;for(let t=0;t<l.vertices.length;t+=3)s.push(l.vertices[t],l.vertices[t+1],l.vertices[t+2]),u++;for(let t=0;t<l.indices.length;t+=3)e.push(l.indices[t+2]+a,l.indices[t+1]+a,l.indices[t]+a);n+=l.vertices.length/3,a+=u}return{positions:s,indices:e,offset:n}}}}]);var BotAi=pc.createScript("botAi");BotAi.attributes.add("Crowd",{type:"entity"}),BotAi.attributes.add("Pathfinder",{type:"entity"}),BotAi.attributes.add("AIManager",{type:"entity"}),BotAi.attributes.add("Model",{type:"entity"}),BotAi.attributes.add("Raycast",{type:"entity"}),BotAi.attributes.add("RunAnimation",{type:"string"}),BotAi.attributes.add("Health",{type:"number"}),BotAi.attributes.add("footsteps_walkspeed",{type:"number",default:.5}),BotAi.attributes.add("AttackDistance",{type:"number",default:5}),BotAi.prototype.initialize=function(){this.GameManager=this.app.root.findByName("GameManager").script.gameManager,setTimeout(function(){this.entity.enabled=!1}.bind(this),10),this.realspeed=this.entity.script.orestisAgent.maxSpeed,this.SetupWeapons(),this.reinit()},BotAi.prototype.reinit=function(){this.forceTarget=!1,this.target=null,this.currentWayPoint=null,this.idlesound=!1,this.timer=0,this.timer2=0,this.attacktimer=0,this.attacking=!1,this.footstepTimer=0,this.deathsound=!1,this.currentspeed=this.realspeed,this.currentspeed_="",this.distance=1e7,this.MovementAnimation="",this.currentAnimation=this.RunAnimation,this.health_=this.Health,this.app.touch&&(this.health_=65),this.dying=!1,this.jump=!1,this.attacking=!1,!1===this.idlesound&&(this.idlesound=!0,this.entity.sound.play("Idle")),this.findtargettimer=0,this.checkifmovingtimer=0,this.state="",this.stopDistance=1,this.disableGetTarget=!1,this.isMoving=!1,this.oldPosition=new pc.Vec3,this.weaponRange=0,this.weaponType="",this.damage=0,this.fireRate=0,this.currentWeapon=null,this.wasAiming=!1,this.disableFire=!1,this.reloading=!1,this.shooting=!1,this.nextShootAllowedAt=0,this.MagazineSize=0,this.LoadedBullets=0,this.BulletInventory=0,this._MagazineSize=0,this._LoadedBullets=0,this._BulletInventory=0,this.GetRandomWeapon(),this.startRunAway=!1,this.visibleTimer=0,this.EnableCollider(!1),this.Collider.collision.enabled=!0,this.entity.collision.enabled=!0},BotAi.attributes.add("Collider",{type:"entity"}),BotAi.prototype.EnableCollider=function(t){this.Collider.enabled=t},BotAi.prototype.FindTarget=function(){if(!0===this.disableGetTarget||!0===this.forceTarget)return;let t=this.AIManager.script.aimanager.GetAliveBots();this.GameManager.player.script.playerMovement.Health>0&&t.push(this.GameManager.player);const i=t.indexOf(this.entity);if(i>-1&&t.splice(i,1),0!==t){var e=null,s=1e6;if(t.forEach(function(t){if(t.enabled){var i=this.entity.getPosition().distance(t.getPosition());i<s&&(s=i,e=t)}}.bind(this)),e){var n=e.getPosition().sub(this.entity.getPosition());this.distance=n.lengthSq();var a=1e3,h=3200;"Sniper"===this.weaponType&&(a*=1.4,h*=1.4),this.distance<=a&&(this.target=e),this.distance>=h&&(this.target=null,this.disableGetTarget=!0,setTimeout(function(){this.disableGetTarget=!1}.bind(this),5e3))}}},BotAi.prototype.Fire=function(t){if(!0===this.forceTarget&&this.target){let t=this.target.getPosition().sub(this.entity.getPosition()).lengthSq(),i=3200;if("Sniper"===this.weaponType&&(i*=1.4),t>i)return}this.currentWeapon&&!0===this.shooting&&this.target&&null===this.currentWayPoint&&"Fast Run"!==this.currentAnimation&&(this.nextShootAllowedAt-=t,this.nextShootAllowedAt<0&&this.currentWeapon&&!0===this.shooting&&this.target&&null===this.currentWayPoint&&"Fast Run"!==this.currentAnimation&&(this.currentWeapon.sound.play("Fire"),this.LoadedBullets-=1,this.muzzleFlash(),this.nextShootAllowedAt=1.3*this.fireRate,this.ErrorAngle()))},BotAi.prototype.ErrorAngle=function(){if("Rifle"===this.weaponType){if(this.distance<=10)random(1,100)<=65&&this.DoDamage(this.damage,this.target);else if(this.distance<=70){random(1,100)<=55&&this.DoDamage(this.damage,this.target)}else if(this.distance<=210){random(1,100)<=45&&this.DoDamage(this.damage,this.target)}else if(this.distance>=211){random(1,100)<=35&&this.DoDamage(this.damage,this.target)}}else if("Shotgun"===this.weaponType){if(this.distance<=10)random(1,100)<=70&&this.DoDamage(45,this.target);else if(this.distance<=70){random(1,100)<=70&&this.DoDamage(40,this.target)}else if(this.distance<=140){random(1,100)<=70&&this.DoDamage(35,this.target)}else if(this.distance<=210){random(1,100)<=70&&this.DoDamage(30,this.target)}else if(this.distance>=211){random(1,100)<=70&&this.DoDamage(25,this.target)}}else if("Sniper"===this.weaponType){if(this.distance<=10)random(1,100)<=70&&this.DoDamage(this.damage,this.target);else if(this.distance<=70){random(1,100)<=60&&this.DoDamage(this.damage,this.target)}else if(this.distance<=210){random(1,100)<=50&&this.DoDamage(this.damage,this.target)}else if(this.distance>=211){random(1,100)<=40&&this.DoDamage(this.damage,this.target)}}},BotAi.prototype.muzzleFlash=function(){if(this.currentWeapon){var t=this.currentWeapon.children[0].children[0];t&&(t.particlesystem.reset(),t.enabled=!0,setTimeout(function(){t.particlesystem.reset(),t.enabled=!1}.bind(this),30))}},BotAi.prototype.reload=function(){this.currentWeapon&&(this.reloading=!0,this.currentWeapon.sound.play("Reload"),setTimeout(function(){this.LoadMagazine(),this.reloading=!1}.bind(this),1800))},BotAi.prototype.LoadMagazine=function(){this.BulletInventory>0&&this.LoadedBullets<this.MagazineSize&&(this.BulletInventory>=this.MagazineSize-this.LoadedBullets&&(this.BulletInventory-=this.MagazineSize-this.LoadedBullets,this.LoadedBullets=this.MagazineSize),this.BulletInventory<this.MagazineSize-this.LoadedBullets&&(this.LoadedBullets+=this.BulletInventory,this.BulletInventory=0))},BotAi.prototype.update=function(t){if(!0===this.dying)return this.Model.animation.loop=!1,this.currentAnimation="Dying",this.MovementAnimation!==this.currentAnimation&&(this.MovementAnimation=this.currentAnimation,this.PlayAnimation(this.currentAnimation)),void this.Crowd.fire("OrestisPathfinding:stopAgents",[this.entity]);if(this.Model.animation.loop=!0,this.currentAnimation="Run Forward",this.stopDistance=.1,this.findtargettimer+=t,this.findtargettimer>=1&&(this.findtargettimer=0,this.FindTarget()),this.checkifmovingtimer+=t,this.checkifmovingtimer>=.05)if(this.checkifmovingtimer=0,this.oldPosition.equals(pc.Vec3.ZERO))this.oldPosition=new pc.Vec3(this.entity.getPosition().x,this.entity.getPosition().y,this.entity.getPosition().z);else{var i=this.oldPosition.sub(this.entity.getPosition());this.isMoving=i.lengthSq(),this.oldPosition=new pc.Vec3}if(!0!==this.startRunAway&&!0!==this.disableGetTarget||(this.currentAnimation="Fast Run"),!0===this.startRunAway)this.visibleTimer=0,this.currentWayPoint?(this.timer2+=t,this.timer2>=1&&(this.timer2=0,this.Crowd.fire("OrestisPathfinding:moveAgentsTo",[this.entity],this.currentWayPoint.getPosition(),!1)),(i=this.currentWayPoint.getPosition().sub(this.entity.getPosition())).lengthSq()<=10&&(this.currentWayPoint=null)):this.currentWayPoint=this.AIManager.script.aimanager.stormTrigger.script.stormTrigger.GetRandomAvailableWayPoint();else if(this.target){this.currentWayPoint=null,this.vec=new pc.Vec3,this.vec.copy(this.target.getPosition()),this.vec.y=this.entity.getPosition().y;var e=new pc.Vec3;e.lerp(this.entity.getPosition(),this.vec,3*t),this.entity.lookAt(e),this.Raycast.lookAt(this.target);var s=!1,n=this.app.systems.rigidbody.raycastFirst(this.Raycast.getPosition(),this.target.getPosition());n&&(n.entity.tags.has("Player")||n.entity.tags.has("BotAI"))&&(s=!0),!1===s?(this.visibleTimer+=t,this.visibleTimer>=4.5&&(this.visibleTimer=0,this.target=null,this.disableGetTarget=!0,setTimeout(function(){this.disableGetTarget=!1}.bind(this),8e3))):this.visibleTimer=0,this.shooting=!1,0===this.isMoving?(this.currentAnimation="Idle Aiming",this.wasAiming=!0):!0===this.wasAiming&&(this.wasAiming=!1,this.disableFire=!0,setTimeout(function(){this.disableFire=!1}.bind(this),2e3)),!0===s&&(this.shooting=!0),!0===this.disableFire&&(this.shooting=!1),!1===this.reloading&&this.LoadedBullets<=0&&this.BulletInventory>0&&this.LoadedBullets<this.MagazineSize&&this.reload(),!0===this.reloading&&(this.shooting=!1),!0===this.reloading&&(0===this.isMoving?this.currentAnimation="Reloading":this.currentAnimation="ReloadForward"),this.Fire(t);var a=this.weaponRange;!1===s&&(a=10),this.timer2+=t,this.timer2>=1&&(this.timer2=0,this.distance<=a?this.Crowd.fire("OrestisPathfinding:stopAgents",[this.entity]):this.target&&this.Crowd.fire("OrestisPathfinding:moveAgentsTo",[this.entity],this.target.getPosition(),!1))}else{if(this.visibleTimer=0,this.currentWayPoint)this.timer2+=t,this.timer2>=1&&(this.timer2=0,this.Crowd.fire("OrestisPathfinding:moveAgentsTo",[this.entity],this.currentWayPoint.getPosition(),!1)),(i=this.currentWayPoint.getPosition().sub(this.entity.getPosition())).lengthSq()<=10&&(this.currentWayPoint=null);else this.currentWayPoint=this.AIManager.script.aimanager.stormTrigger.script.stormTrigger.GetRandomAvailableWayPoint()}this.MovementAnimation!==this.currentAnimation&&(this.MovementAnimation=this.currentAnimation,this.PlayAnimation(this.currentAnimation)),"Fast Run"===this.currentAnimation?this.currentspeed=1.35*this.realspeed:this.currentspeed=this.realspeed,this.currentspeed_!==this.currentspeed&&(this.currentspeed_=this.currentspeed,this.Crowd.script.orestisCrowd.crowd&&(this.entity.script.orestisAgent.maxSpeed=this.currentspeed));let h=0;!0===this.currentAnimation.includes("Run Forward")?h=.3:!0===this.currentAnimation.includes("Fast Run")&&(h=.28),0!==h&&(this.footstepspeed=h,this.footstepTimer+=t,this.footstepTimer>this.footstepspeed&&(this.soundname="Footstep01",this.ran=random(1,3),1===this.ran?this.soundname="Footstep01":2===this.ran?this.soundname="Footstep02":3===this.ran&&(this.soundname="Footstep03"),this.entity.sound.play(this.soundname),this.footstepTimer=0))},BotAi.prototype.SetForceTarget=function(){this.forceTarget=!0,setTimeout(function(){this.forceTarget=!1}.bind(this),1e4)},BotAi.prototype.ReceiveDamage=function(t){if(!0!==this.dying)if(this.health_-=t,this.health_<=0)this.dying=!0,this.AIManager.script.aimanager.ranks-=1,this.Collider.collision.enabled=!1,this.entity.collision.enabled=!1,this.currentWeapon&&this.currentWeapon.sound.stop(),setTimeout(function(){this.reinit(),this.target=null,this.entity.enabled=!1}.bind(this),5e3);else if(this.health_<=60&&!1===this.startRunAway){setTimeout(function(){this.currentWayPoint=null,this.startRunAway=!1}.bind(this),6e3),1===random(1,10)&&(this.currentWayPoint=null,this.startRunAway=!0)}},BotAi.prototype.DoDamage=function(t,i){i&&(i.tags.has("Player")?(i.script.playerMovement.ReceiveDamage(t,!1),i.script.playerMovement.Health<=0&&(this.target=null)):i.tags.has("BotAI")&&(i.script.botAi.ReceiveDamage(t),i.script.botAi.SetForceTarget(),i.script.botAi.target=this.entity,i.script.botAi.health_<=0&&(this.target=null)))},BotAi.prototype.Jump=function(){!1===this.dying&&(this.jump=!0),setTimeout(function(){this.jump=!1,setTimeout(function(){!1===this.dying&&(this.jump=!0),setTimeout(function(){this.jump=!1}.bind(this),600)}.bind(this),random(3e3,6e3))}.bind(this),600)},BotAi.attributes.add("G36C",{type:"entity"}),BotAi.attributes.add("AUG",{type:"entity"}),BotAi.attributes.add("P90",{type:"entity"}),BotAi.attributes.add("AWP",{type:"entity"}),BotAi.attributes.add("Barrett",{type:"entity"}),BotAi.attributes.add("SCAR",{type:"entity"}),BotAi.attributes.add("M110",{type:"entity"}),BotAi.attributes.add("M3",{type:"entity"}),BotAi.attributes.add("M4",{type:"entity"}),BotAi.attributes.add("M249",{type:"entity"}),BotAi.attributes.add("MP5",{type:"entity"}),BotAi.attributes.add("XM1014",{type:"entity"}),BotAi.prototype.SetupWeapons=function(){this.RightHand=this.entity.findByName("mixamorig:RightHand"),this.G36C.reparent(this.RightHand),this.AUG.reparent(this.RightHand),this.P90.reparent(this.RightHand),this.AWP.reparent(this.RightHand),this.Barrett.reparent(this.RightHand),this.SCAR.reparent(this.RightHand),this.M110.reparent(this.RightHand),this.M3.reparent(this.RightHand),this.M4.reparent(this.RightHand),this.M249.reparent(this.RightHand),this.MP5.reparent(this.RightHand),this.XM1014.reparent(this.RightHand)},BotAi.prototype.GetRandomWeapon=function(){this.G36C.enabled=!1,this.AUG.enabled=!1,this.P90.enabled=!1,this.AWP.enabled=!1,this.Barrett.enabled=!1,this.SCAR.enabled=!1,this.M110.enabled=!1,this.M3.enabled=!1,this.M4.enabled=!1,this.M249.enabled=!1,this.MP5.enabled=!1,this.XM1014.enabled=!1;var t=null,i=random(1,12);1===i?t=this.G36C:2===i?t=this.AUG:3===i?t=this.P90:4===i?t=this.AWP:5===i?t=this.Barrett:6===i?t=this.SCAR:7===i?t=this.M110:8===i?t=this.M3:9===i?t=this.M4:10===i?t=this.M249:11===i?t=this.MP5:12===i&&(t=this.XM1014),this.damage=this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.baseHitDamage,this.fireRate=this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.fireRate,this.weaponType="Rifle",this.weaponRange=500,!0===this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.shotgun?(this.weaponType="Shotgun",this.weaponRange=400):!0===this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.sniper&&(this.weaponType="Sniper",this.weaponRange=2200),this.MagazineSize=this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.MagazineSize,this.LoadedBullets=this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.LoadedBullets,this.BulletInventory=100*this.GameManager.player.children[0].findByName(t.name).script.gunBehaviour.BulletInventory,this._MagazineSize=this.MagazineSize,this._LoadedBullets=this.LoadedBullets,this._BulletInventory=100*this.BulletInventory,t.enabled=!0,this.currentWeapon=t},BotAi.prototype.PlayAnimation=function(t){this.Model.animation.play(t,.4)};var Aimanager=pc.createScript("aimanager"),initAiManager=!1,self_Aimanager=this;Aimanager.attributes.add("stormTrigger",{type:"entity"}),Aimanager.prototype.BattleRoyaleStop=function(){this.ranks=24,this.currentSpawnId=0,this.battleRoyaleStart=!1,this.DisableAllBots()},Aimanager.prototype.initialize=function(){this.GameManager=this.app.root.findByName("GameManager").script.gameManager,this.GameUI=this.app.root.findByName("GameManager").script.gameUi,initAiManager=!0,self_Aimanager=this,this.ranks=24,this.currentSpawnId=0,this.battleRoyaleStart=!1,setInterval(this.BotSpawner,7e3)},Aimanager.prototype.update=function(){!1!==this.battleRoyaleStart&&!1===this.GameManager.player.script.playerMovement.dying&&this.ranks<=1&&(this.GameUI.ShowRankScreenBattleRoyale(!0),this.battleRoyaleStart=!1)},Aimanager.prototype.BotSpawner=function(){!1!==initAiManager&&!1!==self_Aimanager.entity.enabled&&!1!==self_Aimanager.battleRoyaleStart&&(self_Aimanager.currentSpawnId+=1,self_Aimanager.SpawnBot(self_Aimanager.currentSpawnId))},Aimanager.prototype.BattleRoyaleStart=function(){this.stormTrigger.script.stormTrigger.StartStorm(),this.DisableAllBots(),this.ranks=24,this.currentSpawnId=0,this.battleRoyaleStart=!0},Aimanager.prototype.SpawnBot=function(t){if(!(t>this.entity.script.orestisCrowd.agents.length)){var e=t-1,i=this.stormTrigger.script.stormTrigger.GetRandomAvailableSpawn();i&&(this.entity.script.orestisCrowd.agents[e].setPosition(i.getPosition().x,i.getPosition().y,i.getPosition().z),this.entity.fire("OrestisPathfinding:teleportAgentsTo",[this.entity.script.orestisCrowd.agents[e]],i.getPosition()),this.entity.script.orestisCrowd.agents[e].enabled=!0,this.entity.script.orestisCrowd.agents[e].script.botAi.reinit()),console.log("Spawn bot id "+this.currentSpawnId)}},Aimanager.prototype.GetAliveBots=function(){let t=[];return this.entity.script.orestisCrowd.agents.forEach((e=>{!0===e.enabled&&e.script.botAi.health_>0&&t.push(e)})),t},Aimanager.prototype.UpdateBotTarget=function(t,e){if(!(t>this.entity.script.orestisCrowd.agents.length)){var i=t-1;this.entity.script.orestisCrowd.agents[i].script.botAi.target=e}},Aimanager.prototype.DisableAllBots=function(){!1!==initAiManager&&this.entity.script.orestisCrowd.agents.forEach((t=>{t.script.botAi.reinit(),t.enabled=!1}))};var HitboxManager=pc.createScript("hitboxManager");HitboxManager.attributes.add("RightUpLeg",{type:"entity"}),HitboxManager.attributes.add("LeftUpLeg",{type:"entity"}),HitboxManager.attributes.add("LeftLeg",{type:"entity"}),HitboxManager.attributes.add("RightLeg",{type:"entity"}),HitboxManager.attributes.add("Spine",{type:"entity"}),HitboxManager.attributes.add("Head",{type:"entity"}),HitboxManager.attributes.add("LeftArm",{type:"entity"}),HitboxManager.attributes.add("RightArm",{type:"entity"}),HitboxManager.prototype.initialize=function(){this.tag="mixamorig:",this.mixamorigRightUpLeg=this.entity.findByName(this.tag+"RightUpLeg"),this.RightUpLeg.reparent(this.mixamorigRightUpLeg),this.mixamorigLeftUpLeg=this.entity.findByName(this.tag+"LeftUpLeg"),this.LeftUpLeg.reparent(this.mixamorigLeftUpLeg),this.mixamorigLeftLeg=this.entity.findByName(this.tag+"LeftLeg"),this.LeftLeg.reparent(this.mixamorigLeftLeg),this.mixamorigRightLeg=this.entity.findByName(this.tag+"RightLeg"),this.RightLeg.reparent(this.mixamorigRightLeg),this.mixamorigSpine=this.entity.findByName(this.tag+"Spine"),this.Spine.reparent(this.mixamorigSpine),this.mixamorigHead=this.entity.findByName(this.tag+"Head"),this.Head.reparent(this.mixamorigHead),this.mixamorigLeftArm=this.entity.findByName(this.tag+"LeftArm"),this.LeftArm.reparent(this.mixamorigLeftArm),this.mixamorigRightArm=this.entity.findByName(this.tag+"RightArm"),this.RightArm.reparent(this.mixamorigRightArm)};var HitboxInfo=pc.createScript("hitboxInfo");HitboxInfo.attributes.add("Player",{type:"entity"}),HitboxInfo.attributes.add("factor",{type:"number",default:1}),HitboxInfo.prototype.initialize=function(){},HitboxInfo.prototype.update=function(t){};var MainMenu=pc.createScript("mainMenu");MainMenu.attributes.add("BattleRoyaleBtn",{type:"entity"}),MainMenu.attributes.add("OptionsBtn",{type:"entity"}),MainMenu.attributes.add("MainMenu",{type:"entity"}),MainMenu.attributes.add("MainMenu_Fade",{type:"entity"}),MainMenu.attributes.add("DemoCharacter",{type:"entity"}),MainMenu.attributes.add("DemoCharacterJetpack",{type:"entity"});var self_mainmenu=this,returnToRoomsList=!1;function percentage(e,t){return 100*e/t}MainMenu.prototype.initialize=function(){self_mainmenu=this,this.showLoading=!1,this.GameManager=this.app.root.findByName("GameManager").script.gameManager,this.GameUI=this.app.root.findByName("GameManager").script.gameUi,this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,this.BattleRoyaleBtn.button.on("click",function(){this.GameManager.DestroyAds();let e=function(){this.BattleRoyale()}.bind(this);this.GameManager.RequestCommercial(e)}.bind(this)),this.OptionsBtn.button.on("click",function(){this.GameUI.OptionsUI.enabled=!0,returnToRoomsList=this.SmartFoxServer.RoomListUI.enabled,!1===this.MainMenu.enabled&&(returnToRoomsList=!1),this.SmartFoxServer.OpenRoomListUI(!1),this.GameManager.entity.sound.play("Button")}.bind(this)),this.currentSkin=1,this.SetRandomSkin(),setTimeout(function(){this.DemoCharacter.enabled=!0}.bind(this),2e3),this.GameAssetsReturn=null,this.GameAssetsLoaded=!1,this.LoadAssets(),this.DownloadingAssets_close.button.on("click",function(){this.CloseGameAssets(),this.GameManager.entity.sound.play("Button")}.bind(this))},MainMenu.prototype.BattleRoyale=function(){if(!1===this.GameAssetsLoaded)return this.GameAssetsReturn=function(){let e=function(){this.BattleRoyale()}.bind(this);this.GameManager.RequestCommercial(e)}.bind(this),hadRoomListUIOpened=this.SmartFoxServer.RoomListUI.enabled,this.SmartFoxServer.OpenRoomListUI(!1),void(this.DownloadingAssets.enabled=!0);!1===this.showLoading&&(this.GameUI.LoadingUI.enabled=!0,this.MainMenu.enabled=!1,this.showLoading=!0),!0===this.GameUI.OptionsUI.enabled&&(this.GameUI.SaveOption(),this.GameUI.OptionsUI.enabled=!1),setTimeout(function(){!1===this.GameUI.InGameUI.enabled&&(this.MainMenu.enabled=!1,this.SmartFoxServer.OpenRoomListUI(!1),this.GameUI.InGameUI.enabled=!0,this.GameUI.PlayerUI.enabled=!0,this.GameManager.singleplayer=!0,this.GameManager.LoadWeaponsData(this.GameManager.GenerateWeaponsData()),this.GameManager.SpawnPlayer(),this.GameManager.entity.sound.play("Button"))}.bind(this),100)},MainMenu.prototype.PlayOnline=function(){setTimeout(function(){!1===this.GameUI.InGameUI.enabled&&(!0===this.GameUI.OptionsUI.enabled&&(this.GameUI.SaveOption(),this.GameUI.OptionsUI.enabled=!1),this.MainMenu.enabled=!1,this.SmartFoxServer.OpenRoomListUI(!1),this.GameUI.InGameUI.enabled=!0,this.GameUI.PlayerUI.enabled=!0,this.GameManager.singleplayer=!1,this.GameManager.SpawnPlayer(),this.GameManager.entity.sound.play("Button"))}.bind(this),100)},MainMenu.prototype.CloseGameAssets=function(){this.GameAssetsReturn=null,this.SmartFoxServer.GameAssetsReturn=null,this.DownloadingAssets.enabled=!1,!0===hadRoomListUIOpened&&(this.SmartFoxServer.OpenRoomListUI(!0),hadRoomListUIOpened=!1)},MainMenu.attributes.add("DownloadingAssets",{type:"entity"}),MainMenu.attributes.add("DownloadingAssets_close",{type:"entity"}),MainMenu.attributes.add("DownloadingAssets_percent",{type:"entity"}),MainMenu.prototype.LoadAssets=function(){for(var e=self_mainmenu.app.assets.findByTag("InGameAssets"),t=0,a=0;a<e.length;a++)e[a].once("load",(function(){++t===e.length&&(console.log("Game Assets Loaded"),self_mainmenu.GameAssetsLoaded=!0,self_mainmenu.GameAssetsReturn&&(self_mainmenu.GameAssetsReturn(),self_mainmenu.GameAssetsReturn=null),self_mainmenu.SmartFoxServer.GameAssetsReturn&&(self_mainmenu.SmartFoxServer.GameAssetsReturn(),self_mainmenu.SmartFoxServer.GameAssetsReturn=null),self_mainmenu.CloseGameAssets(),!0===poki_init&&PokiSDK&&PokiSDK.gameLoadingFinished());let a=percentage(t,e.length);self_mainmenu.DownloadingAssets_percent.element.text=Math.floor(a)+"%"})),self_mainmenu.app.assets.load(e[a])},MainMenu.prototype.SetRandomSkin=function(){let e=random(1,6);1===e?(this.GameManager.player.children[0].model.asset=this.app.assets.get(37149206),this.DemoCharacter.model.asset=this.app.assets.get(37149206)):2===e?(this.GameManager.player.children[0].model.asset=this.app.assets.get(89091783),this.DemoCharacter.model.asset=this.app.assets.get(89091783)):3===e?(this.GameManager.player.children[0].model.asset=this.app.assets.get(91990263),this.DemoCharacter.model.asset=this.app.assets.get(91990263)):4===e?(this.GameManager.player.children[0].model.asset=this.app.assets.get(91990854),this.DemoCharacter.model.asset=this.app.assets.get(91990854)):5===e?(this.GameManager.player.children[0].model.asset=this.app.assets.get(91992390),this.DemoCharacter.model.asset=this.app.assets.get(91992390)):6===e&&(this.GameManager.player.children[0].model.asset=this.app.assets.get(91993957),this.DemoCharacter.model.asset=this.app.assets.get(91993957)),this.currentSkin=e},MainMenu.prototype.update=function(e){this.MainMenu_Fade.element.opacity-=.5*e,this.MainMenu_Fade.element.opacity<=0&&(this.MainMenu_Fade.element.opacity=0)};var Slider=pc.createScript("slider");Slider.attributes.add("min",{type:"number",default:0}),Slider.attributes.add("max",{type:"number",default:100}),Slider.attributes.add("step",{type:"number",default:1}),Slider.attributes.add("defaultValue",{type:"number",default:1}),Slider.attributes.add("padding",{type:"number",default:1}),Slider.attributes.add("scaleUnit",{type:"string",enum:[{"Viewport Width":"vw"},{"Viewport Height":"vh"},{Pixel:"px"}],default:"vw"}),Slider.prototype.initialize=function(){this.element=document.createElement("input"),this.element.type="range",this.element.style.position="absolute",this.element.style.fontFamily=this.fontFamily,this.element.style.border="0px",this.element.style.margin="0px",this.element.style.padding=this.padding+this.scaleUnit,this.element.style.background="transparent",this.element.style.boxSizing="border-box",this.element.min=this.min,this.element.max=this.max,this.element.step=this.step,this.element.defaultValue=this.defaultValue,this.element.style.outline="none",document.body.appendChild(this.element),this.updateStyle(),this.on("state",(function(e){this.entity.enabled?this.element.style.display="block":this.element.style.display="none"}),this),this.valueWaiting&&999!==this.valueWaiting&&this.setValue(this.valueWaiting)},Slider.prototype.onFocus=function(){this.focusEntity.enabled=!0},Slider.prototype.onBlur=function(){this.focusEntity.enabled=!1},Slider.prototype.updateStyle=function(){if(this.entity.element.screenCorners){var e=this.entity.element.screenCorners,t=this.app.renderer.device.maxPixelRatio;this.element.style.left=e[0].x/t+"px",this.element.style.bottom=e[0].y/t+"px",this.element.style.width=(e[2].x-e[0].x)/t+"px",this.element.style.height=(e[2].y-e[0].y)/t+"px"}},Slider.prototype.update=function(e){this.updateStyle()},Slider.prototype.getValue=function(){if(this.element)return this.element.value},Slider.prototype.setValue=function(e){this.element?this.element.value=e:this.valueWaiting=e};var Input=pc.createScript("input");Input.attributes.add("placeholder",{type:"string"}),Input.attributes.add("type",{type:"string",enum:[{Text:"text"},{Email:"email"},{Password:"password"}],default:"text"}),Input.attributes.add("fontSize",{type:"number",default:1}),Input.attributes.add("padding",{type:"number",default:1}),Input.attributes.add("scaleUnit",{type:"string",enum:[{"Viewport Width":"vw"},{"Viewport Height":"vh"},{Pixel:"px"}],default:"vw"}),Input.attributes.add("color",{type:"rgb"}),Input.attributes.add("fontFamily",{type:"string",default:"Arial, sans-serif"}),Input.attributes.add("storeValue",{type:"boolean"}),Input.attributes.add("focusEntity",{type:"entity"}),Input.attributes.add("fontMaxlength",{type:"number",default:100}),Input.attributes.add("allowSpecialCharacters",{type:"boolean"}),Input.attributes.add("disableOnIngame",{type:"boolean"}),Input.prototype.initialize=function(){this.element=document.createElement("input"),this.element.placeholder=this.placeholder,this.element.type=this.type,this.element.style.position="absolute",this.element.style.fontFamily=this.fontFamily,this.element.maxLength=this.fontMaxlength,this.element.style.border="0px",this.element.style.background="transparent",this.element.style.fontSize=this.fontSize+this.scaleUnit,this.element.style.padding=this.padding+this.scaleUnit,this.element.style.boxSizing="border-box";var t="rgb("+255*this.color.r+", "+255*this.color.g+", "+255*this.color.b+")";(this.element.style.color=t,this.element.style.placeholderTextColor="#000",this.element.style.outline="none",document.body.appendChild(this.element),this.focusEntity&&(this.focusEntity.enabled=!1,this.element.onfocus=this.onFocus.bind(this),this.element.onblur=this.onBlur.bind(this)),this.element.onchange=this.onChange.bind(this),this.storeValue)&&(window.localStorage.getItem(this.entity._guid)&&this.setValue(window.localStorage.getItem(this.entity._guid)));this.updateStyle(),this.on("state",(function(t){this.entity.enabled?this.element.style.display="block":this.element.style.display="none"}),this),this.valueWaiting&&999!==this.valueWaiting&&this.setValue(this.valueWaiting),!0===this.disableOnIngame&&(this.onStateChanged(!0),this.on("state",this.onStateChanged,this))},Input.prototype.onStateChanged=function(t){!0===t&&(this.MainMenu=this.app.root.findByName("MainMenu").script.mainMenu,!1===this.MainMenu.enabled?this.element.disabled=!0:this.element.disabled=!1)},Input.prototype.onFocus=function(){this.focusEntity.enabled=!0},Input.prototype.onBlur=function(){this.focusEntity.enabled=!1},Input.prototype.onChange=function(){this.storeValue&&window.localStorage.setItem(this.entity._guid,this.getValue())},Input.prototype.updateStyle=function(){if(this.entity.element.screenCorners){var t=this.entity.element.screenCorners,e=this.app.renderer.device.maxPixelRatio;this.element.style.left=t[0].x/e+"px",this.element.style.bottom=t[0].y/e+"px",this.element.style.width=(t[2].x-t[0].x)/e+"px",this.element.style.height=(t[2].y-t[0].y)/e+"px"}},Input.prototype.update=function(t){if(this.updateStyle(),!1===this.allowSpecialCharacters){var e=this.element.value;e=e.replace(/[^a-zA-Z0-9 ]/g,""),this.element.value=e}},Input.prototype.setValue=function(t){this.element?this.element.value=t:this.valueWaiting=t},Input.prototype.getValue=function(){if(this.element)return this.element.value};var Checkbox=pc.createScript("checkbox");Checkbox.attributes.add("default",{type:"boolean"}),Checkbox.prototype.initialize=function(){this.element=document.createElement("input"),this.element.type="checkbox",this.element.style.position="absolute",this.element.style.border="0px",this.element.style.background="transparent",this.element.style.outline="none",this.element.style.margin="0 auto",this.element.style.padding="auto",document.body.appendChild(this.element),this.updateStyle(),this.on("state",(function(e){this.entity.enabled?this.element.style.display="block":this.element.style.display="none"}),this),this.valueWaiting&&("true"!==this.valueWaiting&&"false"!==this.valueWaiting||this.setValue(this.valueWaiting)),this.disabledWaiting&&this.setDisable(this.disabledWaiting)},Checkbox.prototype.updateStyle=function(){if(this.entity.element.screenCorners){var e=this.entity.element.screenCorners,t=this.app.renderer.device.maxPixelRatio;this.element.style.left=e[0].x/t+"px",this.element.style.bottom=e[0].y/t+"px",this.element.style.width=(e[2].x-e[0].x)/t+"px",this.element.style.height=(e[2].y-e[0].y)/t+"px"}},Checkbox.prototype.update=function(e){this.updateStyle()},Checkbox.prototype.getValue=function(){if(this.element)return this.element.checked},Checkbox.prototype.setValue=function(e){this.element?this.element.checked="true"===e:this.valueWaiting=e},Checkbox.prototype.setDisable=function(e){this.element?this.element.disabled="true"===e?"disabled":"":this.disabledWaiting=e};pc.extend(pc,function(){function computeGaussian(e,t){return 1/Math.sqrt(2*Math.PI*t)*Math.exp(-e*e/(2*t*t))}function calculateBlurValues(e,t,s,o,r){e[0]=computeGaussian(0,r),t[0]=0,t[1]=0;var i,a,l=e[0];for(i=0,a=Math.floor(7.5);i<a;i++){var u=computeGaussian(i+1,r);e[2*i]=u,e[2*i+1]=u,l+=2*u;var h=2*i+1.5;t[4*i]=s*h,t[4*i+1]=o*h,t[4*i+2]=-s*h,t[4*i+3]=-o*h}for(i=0,a=e.length;i<a;i++)e[i]/=l}var BloomEffect=function(e){var t={aPosition:pc.SEMANTIC_POSITION},s=["attribute vec2 aPosition;","","varying vec2 vUv0;","","void main(void)","{","    gl_Position = vec4(aPosition, 0.0, 1.0);","    vUv0 = (aPosition + 1.0) * 0.5;","}"].join("\n"),o=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform sampler2D uBaseTexture;","uniform float uBloomThreshold;","","void main(void)","{","    vec4 color = texture2D(uBaseTexture, vUv0);","","    gl_FragColor = clamp((color - uBloomThreshold) / (1.0 - uBloomThreshold), 0.0, 1.0);","}"].join("\n"),r=["precision "+e.precision+" float;","","#define SAMPLE_COUNT 15","","varying vec2 vUv0;","","uniform sampler2D uBloomTexture;","uniform vec2 uBlurOffsets[SAMPLE_COUNT];","uniform float uBlurWeights[SAMPLE_COUNT];","","void main(void)","{","    vec4 color = vec4(0.0);","    for (int i = 0; i < SAMPLE_COUNT; i++)","    {","        color += texture2D(uBloomTexture, vUv0 + uBlurOffsets[i]) * uBlurWeights[i];","    }","","    gl_FragColor = color;","}"].join("\n"),i=["precision "+e.precision+" float;","","varying vec2 vUv0;","","uniform float uBloomEffectIntensity;","uniform sampler2D uBaseTexture;","uniform sampler2D uBloomTexture;","","void main(void)","{","    vec4 bloom = texture2D(uBloomTexture, vUv0) * uBloomEffectIntensity;","    vec4 base = texture2D(uBaseTexture, vUv0);","","    base *= (1.0 - clamp(bloom, 0.0, 1.0));","","    gl_FragColor = base + bloom;","}"].join("\n");this.extractShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:o}),this.blurShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:r}),this.combineShader=new pc.Shader(e,{attributes:t,vshader:s,fshader:i});var a=e.width,l=e.height;this.targets=[];for(var u=0;u<2;u++){var h=new pc.Texture(e,{format:pc.PIXELFORMAT_R8_G8_B8_A8,width:a>>1,height:l>>1});h.minFilter=pc.FILTER_LINEAR,h.magFilter=pc.FILTER_LINEAR,h.addressU=pc.ADDRESS_CLAMP_TO_EDGE,h.addressV=pc.ADDRESS_CLAMP_TO_EDGE;var n=new pc.RenderTarget(e,h,{depth:!1});this.targets.push(n)}this.bloomThreshold=.25,this.blurAmount=4,this.bloomIntensity=1.25,this.sampleWeights=new Float32Array(15),this.sampleOffsets=new Float32Array(30)};return(BloomEffect=pc.inherits(BloomEffect,pc.PostEffect)).prototype=pc.extend(BloomEffect.prototype,{render:function(e,t,s){var o=this.device,r=o.scope;r.resolve("uBloomThreshold").setValue(this.bloomThreshold),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.extractShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,1/this.targets[1].width,0,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),pc.drawFullscreenQuad(o,this.targets[1],this.vertexBuffer,this.blurShader),calculateBlurValues(this.sampleWeights,this.sampleOffsets,0,1/this.targets[0].height,this.blurAmount),r.resolve("uBlurWeights[0]").setValue(this.sampleWeights),r.resolve("uBlurOffsets[0]").setValue(this.sampleOffsets),r.resolve("uBloomTexture").setValue(this.targets[1].colorBuffer),pc.drawFullscreenQuad(o,this.targets[0],this.vertexBuffer,this.blurShader),r.resolve("uBloomEffectIntensity").setValue(this.bloomIntensity),r.resolve("uBloomTexture").setValue(this.targets[0].colorBuffer),r.resolve("uBaseTexture").setValue(e.colorBuffer),pc.drawFullscreenQuad(o,t,this.vertexBuffer,this.combineShader,s)}}),{BloomEffect:BloomEffect}}());var Bloom=pc.createScript("bloom");Bloom.attributes.add("bloomIntensity",{type:"number",default:1,min:0,title:"Intensity"}),Bloom.attributes.add("bloomThreshold",{type:"number",default:.25,min:0,max:1,precision:2,title:"Threshold"}),Bloom.attributes.add("blurAmount",{type:"number",default:4,min:1,title:"Blur amount"}),Bloom.prototype.initialize=function(){this.effect=new pc.BloomEffect(this.app.graphicsDevice),this.effect.bloomThreshold=this.bloomThreshold,this.effect.blurAmount=this.blurAmount,this.effect.bloomIntensity=this.bloomIntensity;var e=this.entity.camera.postEffects;e.addEffect(this.effect),this.on("attr",(function(e,t){this.effect[e]=t}),this),this.on("state",(function(t){t?e.addEffect(this.effect):e.removeEffect(this.effect)})),this.on("destroy",(function(){e.removeEffect(this.effect)}))};var Rotatez=pc.createScript("rotatez");Rotatez.attributes.add("Speed",{type:"number",default:400}),Rotatez.prototype.initialize=function(){},Rotatez.prototype.update=function(t){this.entity.rotateLocal(0,0,this.Speed*t)};pc.script.createLoadingScreen((function(e){var t,a;t=["body {","    background-color: #7c4600;","}","","#application-splash-wrapper {","    position: absolute;","    top: 0;","    left: 0;","    height: 100%;","    width: 100%;","    background-color: #7c4600;","}","","#application-splash {","    position: absolute;","    top: calc(50% - 222px);","    width: 464px;","    left: calc(50% - 232px);","}","","#application-splash img {","    width: 100%;","}","","#progress-bar-container {","    margin: -50px auto 0 auto;","    height: 6px;","    width: 100%;","    background-color: #141C1E;","}","","#progress-bar {","    width: 0%;","    height: 100%;","    background-color: #ffbb00;","}","","input::placeholder {","    color: #595959;","}","@media (max-width: 480px) {","    #application-splash {","        width: 170px;","        left: calc(50% - 85px);","    }","}"].join("\n"),(a=document.createElement("style")).type="text/css",a.styleSheet?a.styleSheet.cssText=t:a.appendChild(document.createTextNode(t)),document.head.appendChild(a),function(){var e=document.createElement("div");e.id="application-splash-wrapper",document.body.appendChild(e);var t=document.createElement("div");t.id="application-splash",e.appendChild(t),t.style.display="none";var a=document.createElement("img");a.src="https://nadgames.com/Playcanvas/RC_logo3.png",t.appendChild(a),a.onload=function(){t.style.display="block"};var o=document.createElement("div");o.id="progress-bar-container",t.appendChild(o);var n=document.createElement("div");n.id="progress-bar",o.appendChild(n)}(),e.on("preload:end",(function(){e.off("preload:progress")})),e.on("preload:progress",(function(e){var t=document.getElementById("progress-bar");t&&(e=Math.min(1,Math.max(0,e)),t.style.width=100*e+"%")})),e.on("start",(function(){var e=document.getElementById("application-splash-wrapper");e.parentElement.removeChild(e)}))}));var SmartFoxServer=pc.createScript("smartFoxServer"),self_SmartFoxServer=this;SmartFoxServer.attributes.add("PlayOnline",{type:"entity",default:null}),SmartFoxServer.attributes.add("PlayOnlineDisable",{type:"entity",default:null}),SmartFoxServer.attributes.add("CreateRoomBtn",{type:"entity",default:null}),SmartFoxServer.attributes.add("CreateRoomBtnDisable",{type:"entity",default:null}),SmartFoxServer.attributes.add("PlayNowBtn",{type:"entity",default:null}),SmartFoxServer.attributes.add("LoadingRooms",{type:"entity",default:null}),SmartFoxServer.attributes.add("NoRoomsFound",{type:"entity",default:null}),SmartFoxServer.attributes.add("ConnectingToRoom",{type:"entity",default:null}),SmartFoxServer.attributes.add("ErrorPopup",{type:"entity",default:null}),SmartFoxServer.attributes.add("ErrorPopup_msg",{type:"entity",default:null}),SmartFoxServer.attributes.add("ErrorPopup_btn",{type:"entity",default:null}),SmartFoxServer.attributes.add("RoomInfo",{type:"entity",default:null}),SmartFoxServer.attributes.add("RoomInfoParent",{type:"entity",default:null}),SmartFoxServer.attributes.add("RoomListUI",{type:"entity",default:null}),SmartFoxServer.attributes.add("RoomInfoScrollView",{type:"entity",default:null}),SmartFoxServer.attributes.add("OnlinePlayers",{type:"entity",default:null});var badWords=["2g1c","2 girls 1 cup","acrotomophilia","alabama hot pocket","alaskan pipeline","anal","anilingus","anus","apeshit","arsehole","ass","asshole","assmunch","auto erotic","autoerotic","babeland","baby batter","baby juice","ball gag","ball gravy","ball kicking","ball licking","ball sack","ball sucking","bangbros","bangbus","bareback","barely legal","barenaked","bastard","bastardo","bastinado","bbw","bdsm","beaner","beaners","beaver cleaver","beaver lips","beastiality","bestiality","big black","big breasts","big knockers","big tits","bimbos","birdlock","bitch","bitches","black cock","blonde action","blonde on blonde action","blowjob","blow job","blow your load","blue waffle","blumpkin","bollocks","bondage","boner","boob","boobs","booty call","brown showers","brunette action","bukkake","bulldyke","bullet vibe","bullshit","bung hole","bunghole","busty","butt","buttcheeks","butthole","camel toe","camgirl","camslut","camwhore","carpet muncher","carpetmuncher","chocolate rosebuds","cialis","circlejerk","cleveland steamer","clit","clitoris","clover clamps","clusterfuck","cock","cocks","coprolagnia","coprophilia","cornhole","coon","coons","creampie","cum","cumming","cumshot","cumshots","cunnilingus","cunt","darkie","date rape","daterape","deep throat","deepthroat","dendrophilia","dick","dildo","dingleberry","dingleberries","dirty pillows","dirty sanchez","doggie style","doggiestyle","doggy style","doggystyle","dog style","dolcett","domination","dominatrix","dommes","donkey punch","double dong","double penetration","dp action","dry hump","dvda","eat my ass","ecchi","ejaculation","erotic","erotism","escort","eunuch","fag","faggot","fecal","felch","fellatio","feltch","female squirting","femdom","figging","fingerbang","fingering","fisting","foot fetish","footjob","frotting","fuck","fuck buttons","fuckin","fucking","fucktards","fudge packer","fudgepacker","futanari","gangbang","gang bang","gay sex","genitals","giant cock","girl on","girl on top","girls gone wild","goatcx","goatse","god damn","gokkun","golden shower","goodpoop","goo girl","goregasm","grope","group sex","g-spot","guro","hand job","handjob","hard core","hardcore","hentai","homoerotic","honkey","hooker","horny","hot carl","hot chick","how to kill","how to murder","huge fat","humping","incest","intercourse","jack off","jail bait","jailbait","jelly donut","jerk off","jigaboo","jiggaboo","jiggerboo","jizz","juggs","kike","kinbaku","kinkster","kinky","knobbing","leather restraint","leather straight jacket","lemon party","livesex","lolita","lovemaking","make me come","male squirting","masturbate","masturbating","masturbation","menage a trois","milf","missionary position","mong","motherfucker","mound of venus","mr hands","muff diver","muffdiving","nambla","nawashi","negro","neonazi","nigga","nigger","nig nog","nimphomania","nipple","nipples","nsfw","nsfw images","nude","nudity","nutten","nympho","nymphomania","octopussy","omorashi","one cup two girls","one guy one jar","orgasm","orgy","paedophile","paki","panties","panty","pedobear","pedophile","pegging","penis","phone sex","piece of shit","pikey","pissing","piss pig","pisspig","playboy","pleasure chest","pole smoker","ponyplay","poof","poon","poontang","punany","poop chute","poopchute","porn","porno","pornography","prince albert piercing","pthc","pubes","pussy","queaf","queef","quim","raghead","raging boner","rape","raping","rapist","rectum","reverse cowgirl","rimjob","rimming","rosy palm","rosy palm and her 5 sisters","rusty trombone","sadism","santorum","scat","schlong","scissoring","semen","sex","sexcam","sexo","sexy","sexual","sexually","sexuality","shaved beaver","shaved pussy","shemale","shibari","shit","shitblimp","shitty","shota","shrimping","skeet","slanteye","slut","s&m","smut","snatch","snowballing","sodomize","sodomy","spastic","spic","splooge","splooge moose","spooge","spread legs","spunk","strap on","strapon","strappado","strip club","style doggy","suck","sucks","suicide girls","sultry women","swastika","swinger","tainted love","taste my","tea bagging","threesome","throating","thumbzilla","tied up","tight white","tit","tits","titties","titty","tongue in a","topless","tosser","towelhead","tranny","tribadism","tub girl","tubgirl","tushy","twat","twink","twinkie","two girls one cup","undressing","upskirt","urethra play","urophilia","vagina","venus mound","viagra","vibrator","violet wand","vorarephilia","voyeur","voyeurweb","voyuer","vulva","wank","wetback","wet dream","white power","whore","worldsex","wrapping men","wrinkled starfish","xx","xxx","yaoi","yellow showers","yiffy","zoophilia","culo","puta","puto","pendejo","verga","maricon","pelotudo","mierda","culiao","maraca","cagar","malparido","admin","administrator","moderator","guest","size=","/size>","color=","/color"];SmartFoxServer.prototype.initialize=function(){self_SmartFoxServer=this,this.app.keyboard.on("keyup",onKeyUp,this),this.GameManager=this.app.root.findByName("GameManager").script.gameManager,this.GameUI=this.app.root.findByName("GameManager").script.gameUi,this.MainMenu=this.app.root.findByName("MainMenu").script.mainMenu,this.player=this.GameManager.player,this.GetServers(),setTimeout(function(){this.PlayOnlineDisable.enabled=!1}.bind(this),2e3),this.PlayOnline.button.on("click",function(){!0===this.GameUI.OptionsUI.enabled&&(this.GameUI.OptionsUI.enabled=!1),this.OnlinePlayers.enabled=!0,this.OpenRoomListUI(!0),this.GameManager.entity.sound.play("Button")}.bind(this)),this.CreateRoomBtn.button.on("click",function(){this.PreCreateRoom(),this.GameManager.entity.sound.play("Button")}.bind(this)),this.waitingPlayNowBtn=!1,this.PlayNowBtn.button.on("click",function(){this.waitingPlayNowBtn=!0,this.GameManager.entity.sound.play("Button")}.bind(this)),this.usingslots=0,this.allslots=0,this.ErrorPopup_btn.button.on("click",function(){this.ErrorPopup.enabled=!1}.bind(this)),this.currenttime=480,this.timerLeader=0,this.GameAssetsReturn=null,setInterval(this.SendPlayerData,120),setInterval(this.ReSendPlayerData,2e3),setInterval(this.GetHealth,200),this.cancheckhealth=!0};var x_Temp=9999,y_Temp=9999,z_Temp=9999,rot_y_Temp=9999,rot_w_Temp=9999,anim_Temp="null",skinid_Temp=9999,currentweapon_Temp="null",shooting_Temp=!1,jetpack_Temp=!1,jetpackFire_Temp=!1;SmartFoxServer.prototype.SendPlayerData=function(){if(!0!==isSFSDisconnected()&&!1!==self_SmartFoxServer.player.enabled){var e=[],t=self_SmartFoxServer.player.getPosition().x,o=self_SmartFoxServer.player.getPosition().y,r=self_SmartFoxServer.player.getPosition().z,a=!1;if((isNaN(t)||isNaN(o)||isNaN(r))&&(a=!0),!1===a&&(x_Temp!=t||y_Temp!=o||z_Temp!=r)){x_Temp=t,y_Temp=o,z_Temp=r;var n=[t,o,r];let a=new SFS2X.SFSObject;a.putFloatArray("Position",n),e.push(new SFS2X.SFSUserVariable("Position",a))}var s=self_SmartFoxServer.player.children[0].getRotation().y,i=self_SmartFoxServer.player.children[0].getRotation().w;if(rot_y_Temp!=s||rot_w_Temp!=i){rot_y_Temp=s,rot_w_Temp=i;var l=[s,i];let t=new SFS2X.SFSObject;t.putFloatArray("Rotation",l),e.push(new SFS2X.SFSUserVariable("Rotation",t))}var m=self_SmartFoxServer.player.children[0].script.playerAnimationHandler.direction;anim_Temp!=m&&(anim_Temp=m,e.push(new SFS2X.SFSUserVariable("Animation",m)));var c=self_SmartFoxServer.player.script.weaponManager.currentweapon;if(c){currentweapon_Temp!=c.name&&(currentweapon_Temp=c.name,e.push(new SFS2X.SFSUserVariable("CurrentWeapon",c.name)));var p=c.script.gunBehaviour.shooting;shooting_Temp!=p&&(shooting_Temp=p,e.push(new SFS2X.SFSUserVariable("Shooting",p)))}var S=self_SmartFoxServer.player.script.weaponManager.Jetpack.enabled;jetpack_Temp!=S&&(jetpack_Temp=S,e.push(new SFS2X.SFSUserVariable("Jetpack",S)));var u=self_SmartFoxServer.player.script.playerMovement.pressingJetpackFire;jetpackFire_Temp!=u&&(jetpackFire_Temp=u,e.push(new SFS2X.SFSUserVariable("JetpackFire",u))),e.length>=1&&sfs.send(new SFS2X.SetUserVariablesRequest(e))}},SmartFoxServer.prototype.ReSendPlayerData=function(){if(!0!==isSFSDisconnected()&&!1!==self_SmartFoxServer.player.enabled){var e=[];e.push(new SFS2X.SFSUserVariable("Animation",self_SmartFoxServer.player.children[0].script.playerAnimationHandler.direction)),e.push(new SFS2X.SFSUserVariable("SkinID",self_SmartFoxServer.MainMenu.currentSkin));var t=self_SmartFoxServer.player.script.weaponManager.currentweapon;if(t){e.push(new SFS2X.SFSUserVariable("CurrentWeapon",t.name));var o=t.script.gunBehaviour.shooting;e.push(new SFS2X.SFSUserVariable("Shooting",o))}var r=self_SmartFoxServer.player.script.weaponManager.Jetpack.enabled;e.push(new SFS2X.SFSUserVariable("Jetpack",r)),e.length>=1&&sfs.send(new SFS2X.SetUserVariablesRequest(e))}},SmartFoxServer.prototype.GetServers=function(){try{"Servers"in localStorage?this.AddServers(localStorage.getItem("Servers")):this.AddServers("ws_server8.nadgames.com/ws_server7.nadgames.com/ws_server13.nadgames.com/")}catch(e){console.log("storage is disabled")}this.RequestServers()},SmartFoxServer.prototype.RequestServers=function(){pc.http.get("https://nadgames.com/PHP/RebelsClash_2022/GetServerList.php",{retry:!0,maxRetries:5,maxRetryDelay:1e3},(function(e,t){t?t.includes("/")&&self_SmartFoxServer.AddServers(t):e&&console.log(e)}))};var roomsList=[];SmartFoxServer.prototype.OpenRoomListUI=function(e){this.RoomListUI.enabled=e,this.RoomInfoScrollView.enabled=e,!0===e&&0===roomsList.length&&this.RequestRooms()},SmartFoxServer.prototype.RequestRooms=function(){this.usingslots=0,this.allslots=0,this.LoadingRooms.enabled=!0,this.NoRoomsFound.enabled=!1,this.RoomInfoParent.element.height=0,setTimeout(function(){0===roomsList.length&&(this.LoadingRooms.enabled=!1,this.NoRoomsFound.enabled=!0)}.bind(this),6e3),roomsList.forEach((e=>{e.destroy()})),roomsList=[],serversList.forEach((e=>{if(e){var t=new pc.Entity;t.addComponent("script"),t.script.create("getServerRooms",{attributes:{ip:e}}),this.app.root.addChild(t)}}))},SmartFoxServer.prototype.PrintRooms=function(e,t){e.forEach((e=>{var o=e;if(o.isGame&&!o.isPasswordProtected&&!o.isHidden){this.usingslots+=o.userCount,this.allslots+=o.maxUsers;var r=o.name.split("|"[0])[0];if(o.userCount>=o.maxUsers);else{var a=this.RoomInfo.clone();a.enabled=!0,a.children[1].element.text=r.toUpperCase(),a.children[2].element.text=o.userCount+" / "+o.maxUsers,a.children[6].button.on("click",function(){if(!1===this.MainMenu.GameAssetsLoaded)return this.GameAssetsReturn=function(){let e=function(){this.ConnectoToServerRoom(o.id,t)}.bind(this);this.RequestCommercial(e)}.bind(this),hadRoomListUIOpened=this.RoomListUI.enabled,this.OpenRoomListUI(!1),void(this.MainMenu.DownloadingAssets.enabled=!0);{let e=function(){this.ConnectoToServerRoom(o.id,t)}.bind(this);this.RequestCommercial(e)}}.bind(this)),a.reparent(this.RoomInfoParent),a.script.roomInfo.roomid=o.id,a.script.roomInfo.ip=t,roomsList.push(a),this.RoomInfoParent.element.height+=32}}})),roomsList.length>=1&&(this.LoadingRooms.enabled=!1,this.NoRoomsFound.enabled=!1)};var serversList=[];SmartFoxServer.prototype.AddServers=function(e){serversList=e.split("/"[0]),console.log(serversList);let t=-1;serversList.forEach((e=>{t+=1,""===e&&serversList.splice(t,1)}));try{localStorage.setItem("Servers",e)}catch(e){}},SmartFoxServer.prototype.OpenErrorPopup=function(e){this.ConnectingToRoom.enabled=!1,this.ErrorPopup.enabled=!0,this.ErrorPopup_msg.element.text=e};var sfs=null,roomToJoin=-999;SmartFoxServer.prototype.PreCreateRoom=function(){if(0===serversList.length)return;let e=random(0,serversList.length-1);var t=serversList[e];if(console.log(t),!1===this.MainMenu.GameAssetsLoaded)return this.GameAssetsReturn=function(){let e=function(){this.ConnectoToServerRoom("CreateRoom",t)}.bind(this);this.RequestCommercial(e)}.bind(this),hadRoomListUIOpened=this.RoomListUI.enabled,this.OpenRoomListUI(!1),void(this.MainMenu.DownloadingAssets.enabled=!0);{let e=function(){this.ConnectoToServerRoom("CreateRoom",t)}.bind(this);this.RequestCommercial(e)}},SmartFoxServer.prototype.RequestCommercial=function(e){if(!0===watchingAds)return;let t=cursorIsLooked,o=gamePlay;this.GameManager.MuteAudio(!0),this.GameManager.SetLookCursor(!1),this.GameManager.SetGamePlay(!1),watchingAds=!0,PokiSDK.commercialBreak().then((()=>{console.log("Commercial break finished, proceeding to game"),this.GameManager.MuteAudio(!1),this.GameManager.SetLookCursor(t),this.GameManager.SetGamePlay(o),watchingAds=!1,e&&e()}))},SmartFoxServer.prototype.CreateRoom=function(){console.log("Request CreateRoom");var e="ROOM "+random(100,99999),t=new SFS2X.RoomSettings(e);t.groupId="games",t.isGame=!0,t.maxSpectators=0,t.maxUsers=14,t.maxVariables=12;let o=this.GameManager.GenerateWeaponsData();t.variables.push(new SFS2X.SFSRoomVariable("WeaponsData",o)),t.extension=new SFS2X.RoomExtension("btpcextension","myExtBTPCExtension.DMZoneExtension");sfs.send(new SFS2X.CreateRoomRequest(t,!0))},SmartFoxServer.prototype.ConnectoToServerRoom=function(e,t){if(!1===isSFSDisconnectedLobby())return this.Disconnect(),void setTimeout(function(){this.ConnectoToServerRoom(e,t)}.bind(this),1e3);if(!0!==this.ConnectingToRoom.enabled){this.ConnectingToRoom.enabled=!0,setTimeout(function(){this.ConnectingToRoom.enabled=!1}.bind(this),1500),roomToJoin=e;var o={};o.host=t,o.port=8443,o.zone="BT_PC_v3",o.debug=!1,o.useSSL=!0,(sfs=new SFS2X.SmartFox(o)).addEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnection,this),sfs.addEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLost,this),sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoin,this),sfs.addEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinError,this),sfs.addEventListener(SFS2X.SFSEvent.LOGIN,this.onLogin,this),sfs.addEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginError,this),sfs.addEventListener(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVariableUpdate,this),sfs.addEventListener(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessage,this),sfs.addEventListener(SFS2X.SFSEvent.OBJECT_MESSAGE,this.onObjectMessage,this),sfs.addEventListener(SFS2X.SFSEvent.USER_ENTER_ROOM,this.onUserEnterRoom,this),sfs.addEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.onUserExitRoom,this),sfs.addEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponse,this),sfs.connect()}},SmartFoxServer.prototype.onConnection=function(e){if(e.success){console.log("Connected to SmartFoxServer 2X!<br>SFS2X API version: "+sfs.version);let e=new SFS2X.SFSObject;e.putUtfString("pass","");let t=this.GameUI.Playername;sfs.send(new SFS2X.LoginRequest(t,"",e))}else console.log("Connection failed: "+(e.errorMessage?e.errorMessage+" ("+e.errorCode+")":"Is the server running at all?")),this.OpenErrorPopup("UNABLE TO CONNECT TO SERVER. TRY ANOTHER ROOM."),this.reset()},SmartFoxServer.prototype.onConnectionLost=function(e){console.log("Disconnection occurred; reason is: "+e.reason),this.reset(),!1===this.MainMenu.enabled&&(this.GameManager.LeaveGame(),this.OpenErrorPopup("CONNECTION TO THE SERVER WAS LOST."))},SmartFoxServer.prototype.onRoomJoin=function(e){var t=[];t.push(new SFS2X.SFSUserVariable("SkinID",this.MainMenu.currentSkin)),sfs.send(new SFS2X.SetUserVariablesRequest(t)),e.room.isGame?(this.JoinRoom(),null===this.app.touch&&(this.chatTextGame.enabled=!0,this.AddChatMessage('Press [color="#ff6600"]Enter[/color] for open chat.'))):(this.OpenErrorPopup("UNKNOWN ERROR."),this.Disconnect())},SmartFoxServer.prototype.JoinRoom=function(){if(console.log("Joined to room "+sfs.lastJoinedRoom.name),sfs.lastJoinedRoom.containsVariable("WeaponsData")){let e=sfs.lastJoinedRoom.getVariable("WeaponsData").value;this.GameManager.LoadWeaponsData(e),this.MainMenu.PlayOnline()}else this.OpenErrorPopup("UNKNOWN ERROR."),this.Disconnect()},SmartFoxServer.prototype.JoinRoomRequest=function(e){sfs.send(new SFS2X.JoinRoomRequest(e.id))},SmartFoxServer.prototype.onRoomJoinError=function(e){e.errorMessage.includes("is full")?this.OpenErrorPopup("UNABLE TO JOIN BECAUSE THE ROOM IS ALREADY FULL."):this.OpenErrorPopup("UNABLE TO JOIN ROOM."),this.Disconnect()},SmartFoxServer.prototype.onLogin=function(e){if("CreateRoom"===roomToJoin)this.CreateRoom();else if(-999!==roomToJoin){var t=sfs.getRoomById(roomToJoin);t?this.JoinRoomRequest(t):(this.OpenErrorPopup("THE ROOM NO LONGER EXISTS."),this.Disconnect())}else this.OpenErrorPopup("UNKNOWN ERROR."),this.Disconnect()},SmartFoxServer.prototype.onLoginError=function(e){e.errorMessage.includes("is already logged in")?this.OpenErrorPopup("THIS USERNAME IS ALREADY IN USE. TRY ANOTHER ONE."):this.OpenErrorPopup("UNABLE TO LOGIN TO SERVER. TRY ANOTHER ROOM."),this.Disconnect()},SmartFoxServer.prototype.DisableRequestHealth=function(){!1!==this.cancheckhealth&&(this.cancheckhealth=!1,setTimeout(function(){this.cancheckhealth=!0}.bind(this),4200))},SmartFoxServer.prototype.RequestHealth=function(){if(!0===isSFSDisconnected())return;let e=new SFS2X.SFSObject;sfs.send(new SFS2X.ExtensionRequest("RequestRespawn",e,sfs.lastJoinedRoom))},SmartFoxServer.prototype.GetHealth=function(){if(!0!==isSFSDisconnected()&&!0===self_SmartFoxServer.player.enabled&&sfs.mySelf.containsVariable("Health")){var e=sfs.mySelf.getVariable("Health").value;self_SmartFoxServer.player.script.playerMovement.Health=e}},SmartFoxServer.prototype.GetUserKey=function(e){for(var t in Object.keys(remotePlayers))if(remotePlayers[t].user.name===e)return remotePlayers[t];return null},SmartFoxServer.prototype.GetUserScript=function(e){for(var t in Object.keys(remotePlayers))if(remotePlayers[t].user.id===e.id)return remotePlayers[t].script;return null};var remotePlayers=[];SmartFoxServer.prototype.onUserVariableUpdate=function(e){var t=e.user,o=e.changedVars;if(t==sfs.mySelf&&o.indexOf("Health")>-1){var r=t.getVariable("Health").value;!0===this.player.enabled&&100!==r&&this.GameUI.bloodscreen()}this.SyncRemotePlayer(t,o)},SmartFoxServer.attributes.add("remoteplayer1",{type:"entity",default:null}),SmartFoxServer.attributes.add("remoteplayer2",{type:"entity",default:null}),SmartFoxServer.attributes.add("remoteplayer3",{type:"entity",default:null}),SmartFoxServer.attributes.add("remoteplayer4",{type:"entity",default:null}),SmartFoxServer.attributes.add("remoteplayer5",{type:"entity",default:null}),SmartFoxServer.attributes.add("remoteplayer6",{type:"entity",default:null}),SmartFoxServer.prototype.SyncRemotePlayer=function(e,t){if(!0!==isSFSDisconnected()&&e!=sfs.mySelf){var o=1;if(e.containsVariable("SkinID")){var r=e.getVariable("SkinID");"int"===r.type&&(o=r.value);var a=remotePlayers.find((t=>t.user.id==e.id));if(a){var n=a.script,s=new pc.Vec3(0,0,0);if(t.indexOf("DG")>-1||(n.packets+=1),e.containsVariable("Position")){let t=e.getVariable("Position");if("SFSObject"===t.type)try{3==t.value.getFloatArray("Position").length&&(s.x=t.value.getFloatArray("Position")[0],s.y=t.value.getFloatArray("Position")[1],s.z=t.value.getFloatArray("Position")[2]),n.pos=new pc.Vec3(s.x,s.y,s.z)}catch(e){}}var i=new pc.Quat(0,0,0,0);if(t.indexOf("Rotation")>-1&&e.containsVariable("Rotation")){let t=e.getVariable("Rotation");if("SFSObject"===t.type)try{2==t.value.getFloatArray("Rotation").length&&(i.y=t.value.getFloatArray("Rotation")[0],i.w=t.value.getFloatArray("Rotation")[1]),n.rot_Y=new pc.Quat(0,i.y,0,i.w)}catch(e){}}if(t.indexOf("Animation")>-1&&e.containsVariable("Animation")){var l=e.getVariable("Animation");"string"===l.type&&(n.currentAnimation=l.value)}if(t.indexOf("Health")>-1&&e.containsVariable("Health")){var m=e.getVariable("Health");"int"===m.type&&(n.Health=m.value)}if(t.indexOf("CurrentWeapon")>-1&&e.containsVariable("CurrentWeapon")){var c=e.getVariable("CurrentWeapon");"string"===c.type&&(n.currentweapon=c.value)}if(t.indexOf("Shooting")>-1&&e.containsVariable("Shooting")){var p=e.getVariable("Shooting");"boolean"===p.type&&(n.shooting=p.value)}if(t.indexOf("Jetpack")>-1&&e.containsVariable("Jetpack")){var S=e.getVariable("Jetpack");"boolean"===S.type&&(n.Jetpack.enabled=S.value)}if(t.indexOf("JetpackFire")>-1&&e.containsVariable("JetpackFire")){var u=e.getVariable("JetpackFire");"boolean"===u.type&&(n.isJetpackFire=u.value)}}else{var d=null;1===o?d=this.remoteplayer1.clone():2===o?d=this.remoteplayer2.clone():3===o?d=this.remoteplayer3.clone():4===o?d=this.remoteplayer4.clone():5===o?d=this.remoteplayer5.clone():6===o&&(d=this.remoteplayer6.clone()),d&&(this.app.root.addChild(d),d.enabled=!0,d.name=e.name,remotePlayers.push({user:e,entity:d,script:d.script.remotePlayer}))}}}},SmartFoxServer.prototype.onPublicMessage=function(e){!0!==isSFSDisconnected()&&!0===sfs.lastJoinedRoom.isGame&&this.ChatMessage(e.sender,e.message)},SmartFoxServer.prototype.GetSingleShot=function(e,t){if(t!=sfs.mySelf&&!0===remotePlayers.some((e=>e.user.id==t.id))){var o=this.GetUserScript(t);o&&o.SingleShot()}},SmartFoxServer.prototype.GetGrenadeLauncher=function(e,t){if(t!=sfs.mySelf){var o=e.getFloat("barrelx"),r=e.getFloat("barrely"),a=e.getFloat("barrelz"),n=e.getFloat("camforcex"),s=e.getFloat("camforcey"),i=e.getFloat("camforcez"),l=e.getFloat("rotationx"),m=e.getFloat("rotationy"),c=e.getFloat("rotationz"),p=e.getFloat("rotationw"),S=e.getFloat("linear");if(!0===remotePlayers.some((e=>e.user.id==t.id))){var u=this.GetUserScript(t);u&&u.GrenadeLauncher_(o,r,a,n,s,i,l,m,c,p,S)}}},SmartFoxServer.prototype.GetGrenade=function(e,t){if(t!=sfs.mySelf){var o=e.getFloat("barrelx"),r=e.getFloat("barrely"),a=e.getFloat("barrelz"),n=e.getFloat("camforcex"),s=e.getFloat("camforcey"),i=e.getFloat("camforcez"),l=e.getFloat("rotationx"),m=e.getFloat("rotationy"),c=e.getFloat("rotationz"),p=e.getFloat("rotationw"),S=e.getFloat("linear"),u=e.getInt("throwforce");if(!0===remotePlayers.some((e=>e.user.id==t.id))){var d=this.GetUserScript(t);d&&d.Grenade_(o,r,a,n,s,i,l,m,c,p,S,u)}}},SmartFoxServer.prototype.onObjectMessage=function(e){let t=e.message,o=e.sender;if(!0===sfs.lastJoinedRoom.isGame&&t.containsKey("cmd"))switch(t.get("cmd")){case"SingleShot":this.GetSingleShot(t,o);break;case"GrenadeLauncher":this.GetGrenadeLauncher(t,o);break;case"Grenade":this.GetGrenade(t,o)}},SmartFoxServer.prototype.RemoveRemotePlayer=function(e){if(e!=sfs.mySelf){var t=-1;remotePlayers.forEach((o=>{t+=1,o.user.id===e.id&&(remotePlayers.splice(t,1),this.DestroyPlayer(o.entity))}))}},SmartFoxServer.prototype.RemoveAllRemotePlayers=function(){remotePlayers.forEach((e=>{this.DestroyPlayer(e.entity)})),remotePlayers=[]},SmartFoxServer.prototype.DestroyPlayer=function(e){e&&(e.script.remotePlayer.G36C.destroy(),e.script.remotePlayer.AUG.destroy(),e.script.remotePlayer.P90.destroy(),e.script.remotePlayer.AWP.destroy(),e.script.remotePlayer.Barrett.destroy(),e.script.remotePlayer.SCAR.destroy(),e.script.remotePlayer.M110.destroy(),e.script.remotePlayer.M3.destroy(),e.script.remotePlayer.M4.destroy(),e.script.remotePlayer.M249.destroy(),e.script.remotePlayer.MP5.destroy(),e.script.remotePlayer.XM1014.destroy(),e.script.remotePlayer.RPG.destroy(),e.script.hitboxManager.RightUpLeg.destroy(),e.script.hitboxManager.LeftUpLeg.destroy(),e.script.hitboxManager.LeftLeg.destroy(),e.script.hitboxManager.RightLeg.destroy(),e.script.hitboxManager.Spine.destroy(),e.script.hitboxManager.Head.destroy(),e.script.hitboxManager.LeftArm.destroy(),e.script.hitboxManager.RightArm.destroy(),e.destroy())},SmartFoxServer.prototype.SendGrenadeLauncher=function(e,t,o,r,a,n,s,i,l,m,c){if(!0===isSFSDisconnected())return;let p=sfs.lastJoinedRoom.getUserList(),S=new SFS2X.SFSObject;S.putUtfString("cmd","GrenadeLauncher"),S.putFloat("barrelx",e),S.putFloat("barrely",t),S.putFloat("barrelz",o),S.putFloat("camforcex",r),S.putFloat("camforcey",a),S.putFloat("camforcez",n),S.putFloat("rotationx",s),S.putFloat("rotationy",i),S.putFloat("rotationz",l),S.putFloat("rotationw",m),S.putFloat("linear",c),sfs.send(new SFS2X.ObjectMessageRequest(S,sfs.lastJoinedRoom,p))},SmartFoxServer.prototype.SendGrenade=function(e,t,o,r,a,n,s,i,l,m,c,p){if(!0===isSFSDisconnected())return;let S=sfs.lastJoinedRoom.getUserList(),u=new SFS2X.SFSObject;u.putUtfString("cmd","Grenade"),u.putFloat("barrelx",e),u.putFloat("barrely",t),u.putFloat("barrelz",o),u.putFloat("camforcex",r),u.putFloat("camforcey",a),u.putFloat("camforcez",n),u.putFloat("rotationx",s),u.putFloat("rotationy",i),u.putFloat("rotationz",l),u.putFloat("rotationw",m),u.putFloat("linear",c),u.putInt("throwforce",p),sfs.send(new SFS2X.ObjectMessageRequest(u,sfs.lastJoinedRoom,S))},SmartFoxServer.prototype.SendDamage=function(e,t,o){if(!0===isSFSDisconnected())return;let r=new SFS2X.SFSObject;r.putInt("targetid",o),r.putUtfString("weaponname",e),r.putFloat("factor",t),sfs.send(new SFS2X.ExtensionRequest("DoDamage",r,sfs.lastJoinedRoom))},SmartFoxServer.prototype.onUserEnterRoom=function(e){!0!==isSFSDisconnected()&&!0===sfs.lastJoinedRoom.isGame&&this.AddChatMessage(e.user.name+" joined")},SmartFoxServer.prototype.onUserExitRoom=function(e){if(!0!==isSFSDisconnected()&&!0===sfs.lastJoinedRoom.isGame){var t=e.user;this.RemoveRemotePlayer(t),sfs.mySelf!==e.user&&console.log(e.user.name+" left the room")}},SmartFoxServer.attributes.add("RoundEnd",{type:"entity",default:null}),SmartFoxServer.attributes.add("RoundEnd_Won",{type:"entity",default:null}),SmartFoxServer.attributes.add("RoundEnd_Time",{type:"entity",default:null}),SmartFoxServer.prototype.SendSingleShot=function(){if(!0===isSFSDisconnected())return;let e=sfs.lastJoinedRoom.getUserList(),t=new SFS2X.SFSObject;t.putUtfString("cmd","SingleShot"),sfs.send(new SFS2X.ObjectMessageRequest(t,sfs.lastJoinedRoom,e))},SmartFoxServer.prototype.RestartFakeHealth=function(){remotePlayers.forEach((e=>{e&&(e.entity.script.remotePlayer.fake_health=100)}))};var hadPause=!1;SmartFoxServer.prototype.onExtensionResponse=function(e){if(!0!==isSFSDisconnected())if("RoundTime"==e.cmd)this.currenttime=e.params.getInt("Time"),this.Timer.children[0].children[0].element.text=this.secondsToDate(this.currenttime),!0===hadPause&&(!1===this.GameUI.PauseUI.enabled&&(this.GameUI.PauseUI.enabled=!0),hadPause=!1),!1===this.GameUI.PauseUI.enabled&&!1===this.RoundEnd.enabled&&!1===this.GameUI.OptionsUI.enabled&&(this.GameUI.PlayerUI.enabled=!0),this.currenttime<=0?(!0===this.GameUI.PauseUI.enabled&&(this.GameUI.PauseUI.enabled=!1,hadPause=!0),this.GameUI.PlayerUI.enabled=!1,!1===this.RoundEnd.enabled&&(this.RoundEnd.enabled=!0,this.RoundEnd_Won.element.text=leaderplayer.toUpperCase(),this.RestartFakeHealth()),this.RoundEnd_Time.element.text=this.currenttime+5):(this.RoundEnd.enabled=!1,this.RoundEnd_Won.element.text="",this.RoundEnd_Time.element.text="");else if("WhoKillWho"==e.cmd){var t=e.params.getUtfString("Killer"),o=e.params.getUtfString("Killed"),r=e.params.getUtfString("Weapon");let a=sfs.lastJoinedRoom.getUserByName(o);a&&a===sfs.mySelf&&(t=t.substring(0,13),this.GameUI.SetBeaten(t,r))}else if("Respawn"==e.cmd)this.GameManager.PlayAgain();else if("SpawnPickup"==e.cmd){var a=e.params.getUtfString("WeaponName"),n=e.params.getFloat("x"),s=e.params.getFloat("y"),i=e.params.getFloat("z"),l=e.params.getInt("Time");"MP5"!==a&&this.GameManager.SpawnPickup(a,new pc.Vec3(n,s-.82,i),l)}},SmartFoxServer.prototype.Disconnect=function(){!1===isSFSDisconnectedLobby()&&sfs.disconnect(),this.reset()},SmartFoxServer.prototype.reset=function(){sfs&&(sfs.removeEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnection),sfs.removeEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnection),sfs.removeEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLost),sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN,this.onRoomJoin),sfs.removeEventListener(SFS2X.SFSEvent.ROOM_JOIN_ERROR,this.onRoomJoinError),sfs.removeEventListener(SFS2X.SFSEvent.LOGIN,this.onLogin),sfs.removeEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginError),sfs.removeEventListener(SFS2X.SFSEvent.USER_VARIABLES_UPDATE,this.onUserVariableUpdate),sfs.removeEventListener(SFS2X.SFSEvent.PUBLIC_MESSAGE,this.onPublicMessage),sfs.removeEventListener(SFS2X.SFSEvent.OBJECT_MESSAGE,this.onObjectMessage),sfs.removeEventListener(SFS2X.SFSEvent.USER_ENTER_ROOM,this.onUserEnterRoom),sfs.removeEventListener(SFS2X.SFSEvent.USER_EXIT_ROOM,this.onUserExitRoom),sfs.removeEventListener(SFS2X.SFSEvent.EXTENSION_RESPONSE,this.onExtensionResponse)),sfs=null,roomToJoin=-999};var isSFSDisconnected=function(){return null===sfs||null===sfs.lastJoinedRoom},isSFSDisconnectedLobby=function(){return null===sfs};SmartFoxServer.prototype.SendChat=function(e){!0!==isSFSDisconnected()&&(e.length>100||(e=e.replace(/[^a-zA-Z0-9)(:;<>?= ]/g,""),sfs.send(new SFS2X.PublicMessageRequest(e))))};var chatUsersGame=[],penalty=200;SmartFoxServer.prototype.ChatMessage=function(e,t){if(null!==e){this.GameManager.entity.sound.play("Chat");var o=!1;if(!1===chatUsersGame.some((t=>t.user==e))&&chatUsersGame.push({user:e,chat_score:0,lastact:new Date}),!0===chatUsersGame.some((t=>t.user==e))){var r=null;for(var a in Object.keys(chatUsersGame))chatUsersGame[a].user===e&&(r=chatUsersGame[a]);r&&(r.chat_score-=.12*(new Date-r.lastact),r.chat_score=r.chat_score<0?0:r.chat_score,r.chat_score+=penalty,!0===(o=!(parseInt(r.chat_score+=penalty)<=1e3))?e==sfs.mySelf&&this.AddChatMessage('[color="#ff6600"]Please wait a bit..[/color]'):r.lastact=new Date)}if(!1===o){var n=70;this.app.touch&&(n=35),t.length>n&&(t=t.substring(0,n)),badWords.forEach((e=>{if(t.includes(e.toLowerCase())){var o=t.toLowerCase();t=o.replace(e,"****")}})),this.AddChatMessage('[color="#ff6600"]'+e.name+":[/color] "+t.toLowerCase())}}},SmartFoxServer.attributes.add("chatTextGame",{type:"entity",default:null}),SmartFoxServer.attributes.add("chatInputGame",{type:"entity",default:null});var ingamechats=[];SmartFoxServer.prototype.AddChatMessage=function(e){this.chatTextGame.element.text="";ingamechats.length>=5&&ingamechats.shift(),ingamechats.push(e),ingamechats.forEach((e=>{this.chatTextGame.element.text+=e+"\n"}))};var chatInputGameEnabled=!1,onKeyUp=function(e){!0!==isSFSDisconnected()&&!0===sfs.lastJoinedRoom.isGame&&(!1===this.GameUI.PauseUI.enabled?e.key===pc.KEY_ENTER&&(!1===this.chatInputGame.enabled?(this.chatInputGame.enabled=!0,chatInputGameEnabled=!0,this.chatInputGame.script.input.element.focus()):(this.chatInputGame.script.input.getValue().length>=1&&(this.SendChat(this.chatInputGame.script.input.getValue()),this.chatInputGame.script.input.setValue("")),this.chatInputGame.enabled=!1,chatInputGameEnabled=!1)):(this.chatInputGame.script.input.setValue(""),this.chatInputGame.enabled=!1,chatInputGameEnabled=!1))},hadRoomListUIOpened=!1,bestroomscurrentindex=0;SmartFoxServer.prototype.PlayNow=function(){setTimeout(function(){if(0===this.RoomInfoParent.children.length)this.PreCreateRoom();else{var e=this.RoomInfoParent.children[bestroomscurrentindex];(bestroomscurrentindex+=1)>=this.RoomInfoParent.children.length&&(bestroomscurrentindex=this.RoomInfoParent.children.length-1);let t=e.script.roomInfo.roomid,o=e.script.roomInfo.ip;if(t&&o){if(!1===this.MainMenu.GameAssetsLoaded)return this.GameAssetsReturn=function(){let e=function(){this.ConnectoToServerRoom(t,o)}.bind(this);this.RequestCommercial(e)}.bind(this),hadRoomListUIOpened=this.RoomListUI.enabled,this.OpenRoomListUI(!1),void(this.MainMenu.DownloadingAssets.enabled=!0);{let e=function(){this.ConnectoToServerRoom(t,o)}.bind(this);this.RequestCommercial(e)}}}}.bind(this),100)},SmartFoxServer.prototype.update=function(e){!1===this.LoadingRooms.enabled&&!0===this.waitingPlayNowBtn&&(this.waitingPlayNowBtn=!1,this.PlayNow()),this.CreateRoomBtnDisable.enabled=!0;let t=!1;if(!1===this.LoadingRooms.enabled){let e=Math.round(100*this.usingslots/this.allslots);t=roomsList.length<=3||e>=37}!0===t&&(this.CreateRoomBtnDisable.enabled=!1),this.OnlinePlayers.children[0].element.text=this.usingslots+" PLAYERS ONLINE",this.timerLeader+=e,this.timerLeader>=1&&(this.timerLeader=0,this.SetLeader())},SmartFoxServer.attributes.add("Leader",{type:"entity"}),SmartFoxServer.attributes.add("Timer",{type:"entity"}),SmartFoxServer.attributes.add("Chat",{type:"entity"});var leaderplayer="";SmartFoxServer.prototype.SetLeader=function(){if(!0===isSFSDisconnected()||!1===sfs.lastJoinedRoom.isGame||!1===self_SmartFoxServer.GameManager.enabled||!0===self_SmartFoxServer.GameUI.PauseUI.enabled)return;self_SmartFoxServer.Leader.enabled=!1;let e=sfs.lastJoinedRoom.getUserList();if(e.length>=1){if(e.sort(self_SmartFoxServer.SortPlayers),leaderplayer=(leaderplayer=e[0].name).substring(0,12),self_SmartFoxServer.Leader.children[3].element.text=leaderplayer,e[0].containsVariable("Kills")){let t=e[0].getVariable("Kills").value;self_SmartFoxServer.Leader.children[4].element.text=t}self_SmartFoxServer.Leader.enabled=!0}},SmartFoxServer.prototype.GetMyKills=function(){if(!0===isSFSDisconnected())return 0;let e=0;return sfs.mySelf.containsVariable("Kills")&&(e=sfs.mySelf.getVariable("Kills").value),e},SmartFoxServer.prototype.GetOnlinePlayers=function(){if(!0===isSFSDisconnected())return 0;return sfs.lastJoinedRoom.getUserList().length},SmartFoxServer.prototype.SortPlayers=function(e,t){return t.containsVariable("Kills")&&e.containsVariable("Kills")?t.getVariable("Kills").value-e.getVariable("Kills").value:0},SmartFoxServer.prototype.secondsToDate=function(e){var t=Math.floor(e/3600),o=Math.floor((e-3600*t)/60),r=e-3600*t-60*o;return t<10&&(t="0"+t),o<10&&(o="0"+o),r<10&&(r="0"+r),o+":"+r};/*!
 * SmartFoxServer 2X HTML5/JavaScript API v1.7.17
 * (c) gotoAndPlay | All rights reserved
 * http://www.smartfoxserver.com
 */
!function(m,M){"object"==typeof exports&&"object"==typeof module?module.exports=M():"function"==typeof define&&define.amd?define([],M):"object"==typeof exports?exports.SFS2X=M():m.SFS2X=M()}(this,(function(){return function(m){var M={};function n(z){if(M[z])return M[z].exports;var $=M[z]={i:z,l:!1,exports:{}};return m[z].call($.exports,$,$.exports,n),$.l=!0,$.exports}return n.m=m,n.c=M,n.d=function(m,M,z){n.o(m,M)||Object.defineProperty(m,M,{configurable:!1,enumerable:!0,get:z})},n.r=function(m){Object.defineProperty(m,"__esModule",{value:!0})},n.n=function(m){var M=m&&m.__esModule?function(){return m.default}:function(){return m};return n.d(M,"a",M),M},n.o=function(m,M){return Object.prototype.hasOwnProperty.call(m,M)},n.p="",n(n.s=323)}([function(m,M,z){var $=z(6),te=z(37),re=z(18),ie=z(15),oe=z(27),u=function(m,M,z){var se,ae,ue,ce,le=m&u.F,fe=m&u.G,he=m&u.S,_e=m&u.P,ye=m&u.B,pe=fe?$:he?$[M]||($[M]={}):($[M]||{}).prototype,de=fe?te:te[M]||(te[M]={}),ge=de.prototype||(de.prototype={});for(se in fe&&(z=M),z)ue=((ae=!le&&pe&&void 0!==pe[se])?pe:z)[se],ce=ye&&ae?oe(ue,$):_e&&"function"==typeof ue?oe(Function.call,ue):ue,pe&&ie(pe,se,ue,m&u.U),de[se]!=ue&&re(de,se,ce),_e&&ge[se]!=ue&&(ge[se]=ue)};$.core=te,u.F=1,u.G=2,u.S=4,u.P=8,u.B=16,u.W=32,u.U=64,u.R=128,m.exports=u},function(m,M,z){"use strict";function r(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}function i(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}function o(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}Object.defineProperty(M,"__esModule",{value:!0});var $=function(m){function t(m){r(this,t);var M=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m));return M.name="SFSError",M}return o(t,Error),t}(),te=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];r(this,t);var z=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m));return z.name="SFSValidationError",z.errors=M,z}return o(t,$),t}(),re=function(m){function t(m){r(this,t);var M=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m));return M.name="SFSTypeError",M}return o(t,$),t}();M.SFSError=$,M.SFSValidationError=te,M.SFSTypeError=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.Message=M.Requests=M.BaseRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(8),re=z(50);function s(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var ie=function(){function e(m){s(this,e),this._reqObj=new te.SFSObject,this._id=m,this._targetController=0,this._logger=re.Logger.instance}return $(e,null,[{key:"KEY_ERROR_CODE",get:function(){return"ec"}},{key:"KEY_ERROR_PARAMS",get:function(){return"ep"}}]),$(e,[{key:"getMessage",value:function(){return new oe(this._id,this._targetController,this._reqObj)}},{key:"validate",value:function(){this._logger.error("BaseRequest.validate = no child-class implementation found!")}},{key:"execute",value:function(){this._logger.error("BaseRequest.execute = no child-class implementation found!")}},{key:"id",get:function(){return this._id}}]),e}(),oe=function(){function e(m,M,z){s(this,e),this._id=m,this._targetController=M,this._content=z,Object.freeze(this)}return $(e,[{key:"dump",value:function(){return(se.getNameFromId(this.id)+" ("+this.id+")").trim()+"\n"+this.content.getDump()}},{key:"id",get:function(){return this._id}},{key:"targetController",get:function(){return this._targetController}},{key:"content",get:function(){return this._content}}]),e}(),se=Object.freeze({Handshake:0,Login:1,Logout:2,JoinRoom:4,CreateRoom:6,GenericMessage:7,ChangeRoomName:8,ChangeRoomPassword:9,SetRoomVariables:11,SetUserVariables:12,CallExtension:13,LeaveRoom:14,SubscribeRoomGroup:15,UnsubscribeRoomGroup:16,SpectatorToPlayer:17,PlayerToSpectator:18,ChangeRoomCapacity:19,KickUser:24,BanUser:25,FindRooms:27,FindUsers:28,PingPong:29,SetUserPosition:30,InitBuddyList:200,AddBuddy:201,BlockBuddy:202,RemoveBuddy:203,SetBuddyVariables:204,GoOnline:205,InviteUsers:300,InvitationReply:301,CreateSFSGame:302,QuickJoinGame:303,JoinRoomInvite:304,getNameFromId:function(m){for(var M in this)if(this.hasOwnProperty(M)&&this[M]===m)return M;return""}});M.BaseRequest=ie,M.Requests=se,M.Message=oe},function(m,M){m.exports=function(m){try{return!!m()}catch(m){return!0}}},function(m,M){m.exports=function(m){return"object"==typeof m?null!==m:"function"==typeof m}},function(m,M,z){var $=z(4);m.exports=function(m){if(!$(m))throw TypeError(m+" is not an object!");return m}},function(m,M){var z=m.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=z)},function(m,M,z){var $=z(94)("wks"),te=z(35),re=z(6).Symbol,ie="function"==typeof re;(m.exports=function(m){return $[m]||($[m]=ie&&re[m]||(ie?re:te)("Symbol."+m))}).store=$},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.Vec3D=M.SFSArray=M.SFSObject=M.SFSDataWrapper=M.SFSDataType=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(172),re=z(51),ie=z(50),oe=z(1);function u(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var se=Object.freeze({NULL:0,BOOL:1,BYTE:2,SHORT:3,INT:4,LONG:5,FLOAT:6,DOUBLE:7,UTF_STRING:8,BOOL_ARRAY:9,BYTE_ARRAY:10,SHORT_ARRAY:11,INT_ARRAY:12,LONG_ARRAY:13,FLOAT_ARRAY:14,DOUBLE_ARRAY:15,UTF_STRING_ARRAY:16,SFS_ARRAY:17,SFS_OBJECT:18,TEXT:20,fromId:function(m){if("number"!=typeof m)return null;for(var M in this)if(this.hasOwnProperty(M)&&this[M]===m)return M},validate:function(m,M){if(null==this.fromId(m))throw new oe.SFSTypeError("Invalid type passed; use one of the SFSDataType constants");var z=null;if(m===this.NULL&&null!=M&&(z="a null value"),m!==this.NULL&&null==M&&(z="a non-null value"),m!==this.BOOL||this.isBoolType(M)||(z="a boolean value"),m!==this.BYTE||this.isByteType(M)||(z="an integer number in this range: 0 <= value < 256"),m!==this.SHORT||this.isShortType(M)||(z="an integer number in this range: -32.768 <= value < +32.768"),m!==this.INT||this.isIntType(M)||(z="an integer number in this range: -2^31 <= value < +2^31"),m!==this.LONG||this.isLongType(M)||(z="an integer number in this range: -(2^53 - 1) <= value <= +(2^53 - 1)"),m!==this.FLOAT||this.isFloatType(M)||(z="a number in this range: -3.4028234663852886e+38 <= value <= 3.4028234663852886e+38"),m!==this.DOUBLE||this.isDoubleType(M)||(z="a finite number"),m!==this.UTF_STRING&&m!==this.TEXT||this.isStringType(M)||(z="a string value"),m!==this.BOOL_ARRAY||this.isArrayType(M,this.isBoolType)||(z="an array of boolean values"),m!==this.BYTE_ARRAY||M instanceof Uint8Array||(z="a Uint8Array"),m!==this.SHORT_ARRAY||this.isArrayType(M,this.isShortType)||(z="an array of integer numbers in this range: -32.768 <= value < +32.768"),m!==this.INT_ARRAY||this.isArrayType(M,this.isIntType)||(z="an array of integer numbers in this range: -2^31 <= value < +2^31"),m!==this.LONG_ARRAY||this.isArrayType(M,this.isLongType)||(z="an array of integer numbers in this range: -(2^53 - 1) <= value <= +(2^53 - 1)"),m!==this.FLOAT_ARRAY||this.isArrayType(M,this.isFloatType)||(z="an array of numbers in this range: -3.4028234663852886e+38 <= value <= 3.4028234663852886e+38"),m!==this.DOUBLE_ARRAY||this.isArrayType(M,this.isDoubleType)||(z="an array of finite numbers"),m!==this.UTF_STRING_ARRAY||this.isArrayType(M,this.isStringType)||(z="an array of string values"),m!==this.SFS_OBJECT||M instanceof ue||(z="a SFSObject instance"),m!==this.SFS_ARRAY||M instanceof ce||(z="a SFSArray instance"),null!=z)throw new oe.SFSTypeError("Invalid value passed; type SFSDataType."+this.fromId(m)+" requires "+z)},isBoolType:function(m){return"boolean"==typeof m},isByteType:function(m){return"number"==typeof m&&Math.floor(m)===m&&m>=0&&m<256},isShortType:function(m){return"number"==typeof m&&Math.floor(m)===m&&m>=-32768&&m<32768},isIntType:function(m){return"number"==typeof m&&Math.floor(m)===m&&m>=-2147483648&&m<2147483648},isLongType:function(m){return"number"==typeof m&&Math.floor(m)===m&&Number.isSafeInteger(m)},isFloatType:function(m){return"number"==typeof m&&m>=-34028234663852886e22&&m<=34028234663852886e22},isDoubleType:function(m){return"number"==typeof m&&isFinite(m)},isStringType:function(m){return"string"==typeof m},isArrayType:function(m,M){return m instanceof Array&&(!(m.length>0)||M(m[0]))}}),ae=function e(m,M){u(this,e),this.type=m,this.value=M,Object.freeze(this)},ue=function(){function e(){u(this,e),this._dataHolder=new Map,this._serializer=te.SFSDataSerializer.instance,Object.freeze(this)}return $(e,[{key:"toBinary",value:function(){return this._serializer.object2binary(this)}},{key:"keys",value:function(){return this._dataHolder.keys()}},{key:"getWrappedItem",value:function(m){return this._dataHolder.get(m)}},{key:"getKeysArray",value:function(){return Array.from(this.keys())}},{key:"size",value:function(){return this._dataHolder.size}},{key:"containsKey",value:function(m){return null!=this.getWrappedItem(m)}},{key:"get",value:function(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=this.getWrappedItem(m);if(null!=z&&null!=M&&z.type!=M)throw new oe.SFSTypeError("Requested value is not of type SFSDataType."+se.fromId(M));return null!=z?z.value:null}},{key:"isNull",value:function(m){var M=this.getWrappedItem(m);return null==M||M.type==se.NULL}},{key:"getBool",value:function(m){return this.get(m,se.BOOL)}},{key:"getByte",value:function(m){return this.get(m,se.BYTE)}},{key:"getShort",value:function(m){return this.get(m,se.SHORT)}},{key:"getInt",value:function(m){return this.get(m,se.INT)}},{key:"getLong",value:function(m){var M=this.get(m,se.LONG);return Number.isSafeInteger(M)||ie.Logger.instance.warn("Long value contained in SFSObject is not safe"),M}},{key:"getFloat",value:function(m){return this.get(m,se.FLOAT)}},{key:"getDouble",value:function(m){return this.get(m,se.DOUBLE)}},{key:"getUtfString",value:function(m){return this.get(m,se.UTF_STRING)}},{key:"getText",value:function(m){return this.get(m,se.TEXT)}},{key:"getBoolArray",value:function(m){return this.get(m,se.BOOL_ARRAY)}},{key:"getByteArray",value:function(m){return this.get(m,se.BYTE_ARRAY)}},{key:"getShortArray",value:function(m){return this.get(m,se.SHORT_ARRAY)}},{key:"getIntArray",value:function(m){return this.get(m,se.INT_ARRAY)}},{key:"getLongArray",value:function(m){return this.get(m,se.LONG_ARRAY)}},{key:"getFloatArray",value:function(m){return this.get(m,se.FLOAT_ARRAY)}},{key:"getDoubleArray",value:function(m){return this.get(m,se.DOUBLE_ARRAY)}},{key:"getUtfStringArray",value:function(m){return this.get(m,se.UTF_STRING_ARRAY)}},{key:"getSFSObject",value:function(m){return this.get(m,se.SFS_OBJECT)}},{key:"getSFSArray",value:function(m){return this.get(m,se.SFS_ARRAY)}},{key:"put",value:function(m,M,z){if(!(arguments.length>3&&void 0!==arguments[3]&&arguments[3])){if("string"!=typeof m)throw"Invalid key passed; must be of type string";se.validate(z,M)}this._dataHolder.set(m,new ae(z,M))}},{key:"putNull",value:function(m){this.put(m,null,se.NULL)}},{key:"putBool",value:function(m,M){this.put(m,M,se.BOOL)}},{key:"putByte",value:function(m,M){this.put(m,M,se.BYTE)}},{key:"putShort",value:function(m,M){this.put(m,M,se.SHORT)}},{key:"putInt",value:function(m,M){this.put(m,M,se.INT)}},{key:"putLong",value:function(m,M){this.put(m,M,se.LONG)}},{key:"putFloat",value:function(m,M){this.put(m,M,se.FLOAT)}},{key:"putDouble",value:function(m,M){this.put(m,M,se.DOUBLE)}},{key:"putUtfString",value:function(m,M){this.put(m,M,se.UTF_STRING)}},{key:"putText",value:function(m,M){this.put(m,M,se.TEXT)}},{key:"putBoolArray",value:function(m,M){this.put(m,M,se.BOOL_ARRAY)}},{key:"putByteArray",value:function(m,M){this.put(m,M,se.BYTE_ARRAY)}},{key:"putShortArray",value:function(m,M){this.put(m,M,se.SHORT_ARRAY)}},{key:"putIntArray",value:function(m,M){this.put(m,M,se.INT_ARRAY)}},{key:"putLongArray",value:function(m,M){this.put(m,M,se.LONG_ARRAY)}},{key:"putFloatArray",value:function(m,M){this.put(m,M,se.FLOAT_ARRAY)}},{key:"putDoubleArray",value:function(m,M){this.put(m,M,se.DOUBLE_ARRAY)}},{key:"putUtfStringArray",value:function(m,M){this.put(m,M,se.UTF_STRING_ARRAY)}},{key:"putSFSArray",value:function(m,M){this.put(m,M,se.SFS_ARRAY)}},{key:"putSFSObject",value:function(m,M){this.put(m,M,se.SFS_OBJECT)}},{key:"getDump",value:function(){var m=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return 0===this.size()?"[ Empty SFSObject ]":m?re.DumpFormatter.prettyPrintDump(this._dump()):this._dump()}},{key:"getHexDump",value:function(){return re.DumpFormatter.hexDump(this.toBinary())}},{key:"_dump",value:function(){var m=re.DumpFormatter.TOKEN_INDENT_OPEN,M=!0,z=!1,$=void 0;try{for(var te,ie=this.keys()[Symbol.iterator]();!(M=(te=ie.next()).done);M=!0){var oe=te.value,ae=this.getWrappedItem(oe);m+="("+se.fromId(ae.type).toLowerCase()+") "+oe+": ",ae.type===se.SFS_OBJECT||ae.type===se.SFS_ARRAY?m+=ae.value.getDump(!1):ae.type===se.BYTE_ARRAY?m+=re.DumpFormatter.prettyPrintByteArray(ae.value):m+=ae.value,m+=re.DumpFormatter.TOKEN_DIVIDER}}catch(m){z=!0,$=m}finally{try{!M&&ie.return&&ie.return()}finally{if(z)throw $}}return m+re.DumpFormatter.TOKEN_INDENT_CLOSE}}],[{key:"newFromBinaryData",value:function(m){return te.SFSDataSerializer.instance.binary2object(m)}}]),e}(),ce=function(){function e(){u(this,e),this._dataHolder=[],this._serializer=te.SFSDataSerializer.instance,Object.freeze(this)}return $(e,[{key:"toBinary",value:function(){return this._serializer.array2binary(this)}},{key:"getWrappedItem",value:function(m){return"number"!=typeof m||m>=this._dataHolder.length?null:this._dataHolder[m]}},{key:"size",value:function(){return this._dataHolder.length}},{key:"contains",value:function(m){if(m instanceof e||m instanceof ue)throw new oe.SFSError("SFSArray and SFSObject types are not supported by the SFSArray.contains method");for(var M=0;M<this.size();M++){var z=this.getWrappedItem(M);if(null!=z&&z.value==m)return!0}return!1}},{key:"get",value:function(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;if("number"!=typeof m||m>=this._dataHolder.length)return null;var z=this.getWrappedItem(m);if(null!=z&&null!=M&&z.type!=M)throw new oe.SFSTypeError("Requested value is not of type SFSDataType."+se.fromId(M));return null!=z?z.value:null}},{key:"isNull",value:function(m){var M=this.getWrappedItem(m);return null==M||M.type==se.NULL}},{key:"getBool",value:function(m){return this.get(m,se.BOOL)}},{key:"getByte",value:function(m){return this.get(m,se.BYTE)}},{key:"getShort",value:function(m){return this.get(m,se.SHORT)}},{key:"getInt",value:function(m){return this.get(m,se.INT)}},{key:"getLong",value:function(m){var M=this.get(m,se.LONG);return Number.isSafeInteger(M)||ie.Logger.instance.warn("Long value contained in SFSObject is not safe"),M}},{key:"getFloat",value:function(m){return this.get(m,se.FLOAT)}},{key:"getDouble",value:function(m){return this.get(m,se.DOUBLE)}},{key:"getUtfString",value:function(m){return this.get(m,se.UTF_STRING)}},{key:"getText",value:function(m){return this.get(m,se.TEXT)}},{key:"getBoolArray",value:function(m){return this.get(m,se.BOOL_ARRAY)}},{key:"getByteArray",value:function(m){return this.get(m,se.BYTE_ARRAY)}},{key:"getShortArray",value:function(m){return this.get(m,se.SHORT_ARRAY)}},{key:"getIntArray",value:function(m){return this.get(m,se.INT_ARRAY)}},{key:"getLongArray",value:function(m){return this.get(m,se.LONG_ARRAY)}},{key:"getFloatArray",value:function(m){return this.get(m,se.FLOAT_ARRAY)}},{key:"getDoubleArray",value:function(m){return this.get(m,se.DOUBLE_ARRAY)}},{key:"getUtfStringArray",value:function(m){return this.get(m,se.UTF_STRING_ARRAY)}},{key:"getSFSObject",value:function(m){return this.get(m,se.SFS_OBJECT)}},{key:"getSFSArray",value:function(m){return this.get(m,se.SFS_ARRAY)}},{key:"add",value:function(m,M){arguments.length>2&&void 0!==arguments[2]&&arguments[2]||se.validate(M,m),this._dataHolder.push(new ae(M,m))}},{key:"addNull",value:function(){this.add(null,se.NULL)}},{key:"addBool",value:function(m){this.add(m,se.BOOL)}},{key:"addByte",value:function(m){this.add(m,se.BYTE)}},{key:"addShort",value:function(m){this.add(m,se.SHORT)}},{key:"addInt",value:function(m){this.add(m,se.INT)}},{key:"addLong",value:function(m){this.add(m,se.LONG)}},{key:"addFloat",value:function(m){this.add(m,se.FLOAT)}},{key:"addDouble",value:function(m){this.add(m,se.DOUBLE)}},{key:"addUtfString",value:function(m){this.add(m,se.UTF_STRING)}},{key:"addText",value:function(m){this.add(m,se.TEXT)}},{key:"addBoolArray",value:function(m){this.add(m,se.BOOL_ARRAY)}},{key:"addByteArray",value:function(m){this.add(m,se.BYTE_ARRAY)}},{key:"addShortArray",value:function(m){this.add(m,se.SHORT_ARRAY)}},{key:"addIntArray",value:function(m){this.add(m,se.INT_ARRAY)}},{key:"addLongArray",value:function(m){this.add(m,se.LONG_ARRAY)}},{key:"addFloatArray",value:function(m){this.add(m,se.FLOAT_ARRAY)}},{key:"addDoubleArray",value:function(m){this.add(m,se.DOUBLE_ARRAY)}},{key:"addUtfStringArray",value:function(m){this.add(m,se.UTF_STRING_ARRAY)}},{key:"addSFSArray",value:function(m){this.add(m,se.SFS_ARRAY)}},{key:"addSFSObject",value:function(m){this.add(m,se.SFS_OBJECT)}},{key:"getDump",value:function(){var m=!(arguments.length>0&&void 0!==arguments[0])||arguments[0];return 0===this.size()?"[ Empty SFSArray ]":m?re.DumpFormatter.prettyPrintDump(this._dump()):this._dump()}},{key:"getHexDump",value:function(){return re.DumpFormatter.hexDump(this.toBinary())}},{key:"_dump",value:function(){for(var m=re.DumpFormatter.TOKEN_INDENT_OPEN,M=0;M<this.size();M++){var z=this.getWrappedItem(M);m+="("+se.fromId(z.type).toLowerCase()+") "+M+": ",z.type===se.SFS_OBJECT||z.type===se.SFS_ARRAY?m+=z.value.getDump(!1):z.type===se.BYTE_ARRAY?m+=re.DumpFormatter.prettyPrintByteArray(z.value):m+=z.value,m+=re.DumpFormatter.TOKEN_DIVIDER}return m+re.DumpFormatter.TOKEN_INDENT_CLOSE}}],[{key:"newFromBinaryData",value:function(m){return te.SFSDataSerializer.instance.binary2array(m)}}]),e}(),le=function(){function e(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,$=arguments.length>3&&void 0!==arguments[3]&&arguments[3];u(this,e),this.px=m,this.py=M,this.pz=z,this._useFloatCoordinates=$}return $(e,[{key:"toString",value:function(){return"("+this.px+","+this.py+","+this.pz+")"}},{key:"toArray",value:function(){return[this.px,this.py,this.pz]}},{key:"isFloat",get:function(){return this._useFloatCoordinates}}],[{key:"fromArray",value:function(m){return new e(m[0],m[1],m[2])}}]),e}();M.SFSDataType=se,M.SFSDataWrapper=ae,M.SFSObject=ue,M.SFSArray=ce,M.Vec3D=le},function(m,M,z){var $=z(5),te=z(148),re=z(30),ie=Object.defineProperty;M.f=z(11)?Object.defineProperty:function(m,M,z){if($(m),M=re(M,!0),$(z),te)try{return ie(m,M,z)}catch(m){}if("get"in z||"set"in z)throw TypeError("Accessors not supported!");return"value"in z&&(m[M]=z.value),m}},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.MMORoom=M.SFSRoom=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(8),re=z(49),ie=z(119),oe=z(1);function u(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var se=function(){function e(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default",$=!(arguments.length>3&&void 0!==arguments[3])||arguments[3];u(this,e),this._id=m,this._name=M,this._groupId=z,this._isGame=!1,this._isHidden=!1,this._isJoined=!1,this._isPasswordProtected=!1,this._maxUsers=0,this._maxSpectators=0,this._userCount=0,this._specCount=0,this._isManaged=!0,this._variables=new Map,this._userManager=new ie.SFSUserManager,this._roomManager=null,this.properties={},$&&Object.seal(this)}return $(e,[{key:"toString",value:function(){return"[Room: "+this.name+", Id: "+this.id+", Group Id: "+this.groupId+"]"}},{key:"getUserByName",value:function(m){return this._userManager.getUserByName(m)}},{key:"getUserById",value:function(m){return this._userManager.getUserById(m)}},{key:"containsUser",value:function(m){return this._userManager.containsUser(m)}},{key:"getUserList",value:function(){return this._userManager.getUserList()}},{key:"getPlayerList",value:function(){var m=this;return this._userManager.getUserList().filter((function(M){return M.isPlayerInRoom(m)}))}},{key:"getSpectatorList",value:function(){var m=this;return this._userManager.getUserList().filter((function(M){return M.isSpectatorInRoom(m)}))}},{key:"getVariable",value:function(m){return this._variables.get(m)}},{key:"containsVariable",value:function(m){return this._variables.has(m)}},{key:"getVariables",value:function(){return Array.from(this._variables.values())}},{key:"getRoomManager",value:function(){return this._roomManager}},{key:"_addUser",value:function(m){this._userManager._addUser(m)}},{key:"_removeUser",value:function(m){this._userManager._removeUser(m)}},{key:"_setVariables",value:function(m){var M=!0,z=!1,$=void 0;try{for(var te,re=m[Symbol.iterator]();!(M=(te=re.next()).done);M=!0){var ie=te.value;this._setVariable(ie)}}catch(m){z=!0,$=m}finally{try{!M&&re.return&&re.return()}finally{if(z)throw $}}}},{key:"_setVariable",value:function(m){m.isNull?this._variables.delete(m.name):this._variables.set(m.name,m)}},{key:"_setRoomManager",value:function(m){if(null!=this._roomManager)throw new oe.SFSError("Room Manager already assigned to "+this.toString());this._roomManager=m}},{key:"_merge",value:function(m){if(!this.isJoined){this._variables.clear();var M=!0,z=!1,$=void 0;try{for(var te,re=m._variables.values()[Symbol.iterator]();!(M=(te=re.next()).done);M=!0){var ie=te.value;this._setVariable(ie)}}catch(m){z=!0,$=m}finally{try{!M&&re.return&&re.return()}finally{if(z)throw $}}this._userManager._clearAll();var oe=!0,se=!1,ae=void 0;try{for(var ue,ce=m.getUserList()[Symbol.iterator]();!(oe=(ue=ce.next()).done);oe=!0){var le=ue.value;this._addUser(le)}}catch(m){se=!0,ae=m}finally{try{!oe&&ce.return&&ce.return()}finally{if(se)throw ae}}}}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"groupId",get:function(){return this._groupId}},{key:"isGame",get:function(){return this._isGame}},{key:"isHidden",get:function(){return this._isHidden}},{key:"isJoined",get:function(){return this._isJoined}},{key:"isPasswordProtected",get:function(){return this._isPasswordProtected}},{key:"maxUsers",get:function(){return this._maxUsers}},{key:"maxSpectators",get:function(){return this._maxSpectators}},{key:"userCount",get:function(){return this.isJoined?this.isGame?this.getPlayerList().length:this._userManager.getUserCount():this._userCount}},{key:"spectatorCount",get:function(){return this.isGame?this.isJoined?this.getSpectatorList().length:this._specCount:0}},{key:"capacity",get:function(){return this.maxUsers+this.maxSpectators}}],[{key:"fromSFSArray",value:function(m){var M=14===m.size(),z=void 0;(z=M?new ae(m.get(0),m.get(1),m.get(2)):new e(m.get(0),m.get(1),m.get(2)))._isGame=m.get(3),z._isHidden=m.get(4),z._isPasswordProtected=m.get(5),z._userCount=m.get(6),z._maxUsers=m.get(7);var $=m.get(8);if(null!=$)for(var ie=0;ie<$.size();ie++){var oe=re.SFSRoomVariable.fromSFSArray($.get(ie));z._setVariable(oe)}return z._isGame&&(z._specCount=m.get(9),z._maxSpectators=m.get(10)),M&&(z._defaultAOI=te.Vec3D.fromArray(m.get(11)),null!=m.get(13)&&(z._lowerMapLimit=te.Vec3D.fromArray(m.get(12)),z._higherMapLimit=te.Vec3D.fromArray(m.get(13)))),z}}]),e}(),ae=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"default";u(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m,M,z,!1));return $._defaultAOI=null,$._lowerMapLimit=null,$._higherMapLimit=null,$._itemsById=new Map,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,se),$(t,[{key:"getMMOItem",value:function(m){return this._itemsById.get(m)}},{key:"getMMOItems",value:function(){return Array.from(this._itemsById.values())}},{key:"_addMMOItem",value:function(m){this._itemsById.set(m.id,m)}},{key:"_removeItem",value:function(m){this._itemsById.delete(m)}},{key:"defaultAOI",get:function(){return this._defaultAOI}},{key:"lowerMapLimit",get:function(){return this._lowerMapLimit}},{key:"higherMapLimit",get:function(){return this._higherMapLimit}}]),t}();M.SFSRoom=se,M.MMORoom=ae},function(m,M,z){m.exports=!z(3)((function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}))},function(m,M,z){var $=z(24),te=Math.min;m.exports=function(m){return m>0?te($(m),9007199254740991):0}},function(m,M,z){var $=z(0),te=z(3),re=z(28),ie=/"/g,a=function(m,M,z,$){var te=String(re(m)),oe="<"+M;return""!==z&&(oe+=" "+z+'="'+String($).replace(ie,"&quot;")+'"'),oe+">"+te+"</"+M+">"};m.exports=function(m,M){var z={};z[m]=M(a),$($.P+$.F*te((function(){var M=""[m]('"');return M!==M.toLowerCase()||M.split('"').length>3})),"String",z)}},function(m,M,z){var $=z(28);m.exports=function(m){return Object($(m))}},function(m,M,z){var $=z(6),te=z(18),re=z(16),ie=z(35)("src"),oe=Function.toString,se=(""+oe).split("toString");z(37).inspectSource=function(m){return oe.call(m)},(m.exports=function(m,M,z,oe){var ae="function"==typeof z;ae&&(re(z,"name")||te(z,"name",M)),m[M]!==z&&(ae&&(re(z,ie)||te(z,ie,m[M]?""+m[M]:se.join(String(M)))),m===$?m[M]=z:oe?m[M]?m[M]=z:te(m,M,z):(delete m[M],te(m,M,z)))})(Function.prototype,"toString",(function(){return"function"==typeof this&&this[ie]||oe.call(this)}))},function(m,M){var z={}.hasOwnProperty;m.exports=function(m,M){return z.call(m,M)}},function(m,M,z){"use strict";var $=z(3);m.exports=function(m,M){return!!m&&$((function(){M?m.call(null,(function(){}),1):m.call(null)}))}},function(m,M,z){var $=z(9),te=z(36);m.exports=z(11)?function(m,M,z){return $.f(m,M,te(1,z))}:function(m,M,z){return m[M]=z,m}},function(m,M,z){var $=z(27),te=z(54),re=z(14),ie=z(12),oe=z(229);m.exports=function(m,M){var z=1==m,se=2==m,ae=3==m,ue=4==m,ce=6==m,le=5==m||ce,fe=M||oe;return function(M,oe,he){for(var _e,ye,pe=re(M),de=te(pe),ge=$(oe,he,3),ve=ie(de.length),be=0,me=z?fe(M,ve):se?fe(M,0):void 0;ve>be;be++)if((le||be in de)&&(ye=ge(_e=de[be],be,pe),m))if(z)me[be]=ye;else if(ye)switch(m){case 3:return!0;case 5:return _e;case 6:return be;case 2:me.push(_e)}else if(ue)return!1;return ce?-1:ae||ue?ue:me}}},function(m,M,z){var $=z(0),te=z(37),re=z(3);m.exports=function(m,M){var z=(te.Object||{})[m]||Object[m],ie={};ie[m]=M(z),$($.S+$.F*re((function(){z(1)})),"Object",ie)}},function(m,M,z){var $=z(54),te=z(28);m.exports=function(m){return $(te(m))}},function(m,M,z){"use strict";if(z(11)){var $=z(43),te=z(6),re=z(3),ie=z(0),oe=z(59),se=z(74),ae=z(27),ue=z(41),ce=z(36),le=z(18),fe=z(40),he=z(24),_e=z(12),ye=z(121),pe=z(34),de=z(30),ge=z(16),ve=z(65),be=z(4),me=z(14),Se=z(79),Ee=z(33),Re=z(31),Fe=z(32).f,je=z(78),Le=z(35),xe=z(7),qe=z(19),Ve=z(93),Ke=z(75),Ge=z(128),ze=z(53),He=z(63),Je=z(42),We=z(77),Xe=z(129),Ze=z(9),Qe=z(23),$e=Ze.f,et=Qe.f,tt=te.RangeError,nt=te.TypeError,rt=te.Uint8Array,it=Array.prototype,ot=se.ArrayBuffer,st=se.DataView,at=qe(0),ut=qe(2),ct=qe(3),lt=qe(4),ft=qe(5),ht=qe(6),_t=Ve(!0),yt=Ve(!1),pt=Ge.values,dt=Ge.keys,gt=Ge.entries,vt=it.lastIndexOf,bt=it.reduce,mt=it.reduceRight,St=it.join,Et=it.sort,Rt=it.slice,Ot=it.toString,At=it.toLocaleString,wt=xe("iterator"),It=xe("toStringTag"),Mt=Le("typed_constructor"),Tt=Le("def_constructor"),kt=oe.CONSTR,Pt=oe.TYPED,Ft=oe.VIEW,jt=qe(1,(function(m,M){return we(Ke(m,m[Tt]),M)})),Ut=re((function(){return 1===new rt(new Uint16Array([1]).buffer)[0]})),Nt=!!rt&&!!rt.prototype.set&&re((function(){new rt(1).set({})})),Oe=function(m,M){var z=he(m);if(z<0||z%M)throw tt("Wrong offset!");return z},Ae=function(m){if(be(m)&&Pt in m)return m;throw nt(m+" is not a typed array!")},we=function(m,M){if(!be(m)||!(Mt in m))throw nt("It is not a typed array constructor!");return new m(M)},Ie=function(m,M){return Me(Ke(m,m[Tt]),M)},Me=function(m,M){for(var z=0,$=M.length,te=we(m,$);$>z;)te[z]=M[z++];return te},Te=function(m,M,z){$e(m,M,{get:function(){return this._d[z]}})},ke=function(m){var M,z,$,te,re,ie,oe=me(m),se=arguments.length,ue=se>1?arguments[1]:void 0,ce=void 0!==ue,le=je(oe);if(null!=le&&!Se(le)){for(ie=le.call(oe),$=[],M=0;!(re=ie.next()).done;M++)$.push(re.value);oe=$}for(ce&&se>2&&(ue=ae(ue,arguments[2],2)),M=0,z=_e(oe.length),te=we(this,z);z>M;M++)te[M]=ce?ue(oe[M],M):oe[M];return te},Pe=function(){for(var m=0,M=arguments.length,z=we(this,M);M>m;)z[m]=arguments[m++];return z},Bt=!!rt&&re((function(){At.call(new rt(1))})),Ne=function(){return At.apply(Bt?Rt.call(Ae(this)):Ae(this),arguments)},Lt={copyWithin:function(m,M){return Xe.call(Ae(this),m,M,arguments.length>2?arguments[2]:void 0)},every:function(m){return lt(Ae(this),m,arguments.length>1?arguments[1]:void 0)},fill:function(m){return We.apply(Ae(this),arguments)},filter:function(m){return Ie(this,ut(Ae(this),m,arguments.length>1?arguments[1]:void 0))},find:function(m){return ft(Ae(this),m,arguments.length>1?arguments[1]:void 0)},findIndex:function(m){return ht(Ae(this),m,arguments.length>1?arguments[1]:void 0)},forEach:function(m){at(Ae(this),m,arguments.length>1?arguments[1]:void 0)},indexOf:function(m){return yt(Ae(this),m,arguments.length>1?arguments[1]:void 0)},includes:function(m){return _t(Ae(this),m,arguments.length>1?arguments[1]:void 0)},join:function(m){return St.apply(Ae(this),arguments)},lastIndexOf:function(m){return vt.apply(Ae(this),arguments)},map:function(m){return jt(Ae(this),m,arguments.length>1?arguments[1]:void 0)},reduce:function(m){return bt.apply(Ae(this),arguments)},reduceRight:function(m){return mt.apply(Ae(this),arguments)},reverse:function(){for(var m,M=Ae(this).length,z=Math.floor(M/2),$=0;$<z;)m=this[$],this[$++]=this[--M],this[M]=m;return this},some:function(m){return ct(Ae(this),m,arguments.length>1?arguments[1]:void 0)},sort:function(m){return Et.call(Ae(this),m)},subarray:function(m,M){var z=Ae(this),$=z.length,te=pe(m,$);return new(Ke(z,z[Tt]))(z.buffer,z.byteOffset+te*z.BYTES_PER_ELEMENT,_e((void 0===M?$:pe(M,$))-te))}},Ue=function(m,M){return Ie(this,Rt.call(Ae(this),m,M))},Be=function(m){Ae(this);var M=Oe(arguments[1],1),z=this.length,$=me(m),te=_e($.length),re=0;if(te+M>z)throw tt("Wrong length!");for(;re<te;)this[M+re]=$[re++]},Dt={entries:function(){return gt.call(Ae(this))},keys:function(){return dt.call(Ae(this))},values:function(){return pt.call(Ae(this))}},De=function(m,M){return be(m)&&m[Pt]&&"symbol"!=typeof M&&M in m&&String(+M)==String(M)},Ye=function(m,M){return De(m,M=de(M,!0))?ce(2,m[M]):et(m,M)},Ce=function(m,M,z){return!(De(m,M=de(M,!0))&&be(z)&&ge(z,"value"))||ge(z,"get")||ge(z,"set")||z.configurable||ge(z,"writable")&&!z.writable||ge(z,"enumerable")&&!z.enumerable?$e(m,M,z):(m[M]=z.value,m)};kt||(Qe.f=Ye,Ze.f=Ce),ie(ie.S+ie.F*!kt,"Object",{getOwnPropertyDescriptor:Ye,defineProperty:Ce}),re((function(){Ot.call({})}))&&(Ot=At=function(){return St.call(this)});var Yt=fe({},Lt);fe(Yt,Dt),le(Yt,wt,Dt.values),fe(Yt,{slice:Ue,set:Be,constructor:function(){},toString:Ot,toLocaleString:Ne}),Te(Yt,"buffer","b"),Te(Yt,"byteOffset","o"),Te(Yt,"byteLength","l"),Te(Yt,"length","e"),$e(Yt,It,{get:function(){return this[Pt]}}),m.exports=function(m,M,z,se){var ae=m+((se=!!se)?"Clamped":"")+"Array",ce="get"+m,fe="set"+m,he=te[ae],pe=he||{},de=he&&Re(he),ge=!he||!oe.ABV,me={},Se=he&&he.prototype,I=function(m,z){$e(m,z,{get:function(){return function(m,z){var $=m._d;return $.v[ce](z*M+$.o,Ut)}(this,z)},set:function(m){return function(m,z,$){var te=m._d;se&&($=($=Math.round($))<0?0:$>255?255:255&$),te.v[fe](z*M+te.o,$,Ut)}(this,z,m)},enumerable:!0})};ge?(he=z((function(m,z,$,te){ue(m,he,ae,"_d");var re,ie,oe,se,ce=0,fe=0;if(be(z)){if(!(z instanceof ot||"ArrayBuffer"==(se=ve(z))||"SharedArrayBuffer"==se))return Pt in z?Me(he,z):ke.call(he,z);re=z,fe=Oe($,M);var pe=z.byteLength;if(void 0===te){if(pe%M)throw tt("Wrong length!");if((ie=pe-fe)<0)throw tt("Wrong length!")}else if((ie=_e(te)*M)+fe>pe)throw tt("Wrong length!");oe=ie/M}else oe=ye(z),re=new ot(ie=oe*M);for(le(m,"_d",{b:re,o:fe,l:ie,e:oe,v:new st(re)});ce<oe;)I(m,ce++)})),Se=he.prototype=Ee(Yt),le(Se,"constructor",he)):re((function(){he(1)}))&&re((function(){new he(-1)}))&&He((function(m){new he,new he(null),new he(1.5),new he(m)}),!0)||(he=z((function(m,z,$,te){var re;return ue(m,he,ae),be(z)?z instanceof ot||"ArrayBuffer"==(re=ve(z))||"SharedArrayBuffer"==re?void 0!==te?new pe(z,Oe($,M),te):void 0!==$?new pe(z,Oe($,M)):new pe(z):Pt in z?Me(he,z):ke.call(he,z):new pe(ye(z))})),at(de!==Function.prototype?Fe(pe).concat(Fe(de)):Fe(pe),(function(m){m in he||le(he,m,pe[m])})),he.prototype=Se,$||(Se.constructor=he));var je=Se[wt],Le=!!je&&("values"==je.name||null==je.name),xe=Dt.values;le(he,Mt,!0),le(Se,Pt,ae),le(Se,Ft,!0),le(Se,Tt,he),(se?new he(1)[It]==ae:It in Se)||$e(Se,It,{get:function(){return ae}}),me[ae]=he,ie(ie.G+ie.W+ie.F*(he!=pe),me),ie(ie.S,ae,{BYTES_PER_ELEMENT:M}),ie(ie.S+ie.F*re((function(){pe.of.call(he,1)})),ae,{from:ke,of:Pe}),"BYTES_PER_ELEMENT"in Se||le(Se,"BYTES_PER_ELEMENT",M),ie(ie.P,ae,Lt),Je(ae),ie(ie.P+ie.F*Nt,ae,{set:Be}),ie(ie.P+ie.F*!Le,ae,Dt),$||Se.toString==Ot||(Se.toString=Ot),ie(ie.P+ie.F*re((function(){new he(1).slice()})),ae,{slice:Ue}),ie(ie.P+ie.F*(re((function(){return[1,2].toLocaleString()!=new he([1,2]).toLocaleString()}))||!re((function(){Se.toLocaleString.call([1,2])}))),ae,{toLocaleString:Ne}),ze[ae]=Le?je:xe,$||Le||le(Se,wt,xe)}}else m.exports=function(){}},function(m,M,z){var $=z(66),te=z(36),re=z(21),ie=z(30),oe=z(16),se=z(148),ae=Object.getOwnPropertyDescriptor;M.f=z(11)?ae:function(m,M){if(m=re(m),M=ie(M,!0),se)try{return ae(m,M)}catch(m){}if(oe(m,M))return te(!$.f.call(m,M),m[M])}},function(m,M){var z=Math.ceil,$=Math.floor;m.exports=function(m){return isNaN(m=+m)?0:(m>0?$:z)(m)}},function(m,M){var z={}.toString;m.exports=function(m){return z.call(m).slice(8,-1)}},function(m,M){m.exports=function(m){if("function"!=typeof m)throw TypeError(m+" is not a function!");return m}},function(m,M,z){var $=z(26);m.exports=function(m,M,z){if($(m),void 0===M)return m;switch(z){case 1:return function(z){return m.call(M,z)};case 2:return function(z,$){return m.call(M,z,$)};case 3:return function(z,$,te){return m.call(M,z,$,te)}}return function(){return m.apply(M,arguments)}}},function(m,M){m.exports=function(m){if(null==m)throw TypeError("Can't call method on  "+m);return m}},function(m,M,z){var $=z(35)("meta"),te=z(4),re=z(16),ie=z(9).f,oe=0,se=Object.isExtensible||function(){return!0},ae=!z(3)((function(){return se(Object.preventExtensions({}))})),l=function(m){ie(m,$,{value:{i:"O"+ ++oe,w:{}}})},ue=m.exports={KEY:$,NEED:!1,fastKey:function(m,M){if(!te(m))return"symbol"==typeof m?m:("string"==typeof m?"S":"P")+m;if(!re(m,$)){if(!se(m))return"F";if(!M)return"E";l(m)}return m[$].i},getWeak:function(m,M){if(!re(m,$)){if(!se(m))return!0;if(!M)return!1;l(m)}return m[$].w},onFreeze:function(m){return ae&&ue.NEED&&se(m)&&!re(m,$)&&l(m),m}}},function(m,M,z){var $=z(4);m.exports=function(m,M){if(!$(m))return m;var z,te;if(M&&"function"==typeof(z=m.toString)&&!$(te=z.call(m)))return te;if("function"==typeof(z=m.valueOf)&&!$(te=z.call(m)))return te;if(!M&&"function"==typeof(z=m.toString)&&!$(te=z.call(m)))return te;throw TypeError("Can't convert object to primitive value")}},function(m,M,z){var $=z(16),te=z(14),re=z(92)("IE_PROTO"),ie=Object.prototype;m.exports=Object.getPrototypeOf||function(m){return m=te(m),$(m,re)?m[re]:"function"==typeof m.constructor&&m instanceof m.constructor?m.constructor.prototype:m instanceof Object?ie:null}},function(m,M,z){var $=z(146),te=z(91).concat("length","prototype");M.f=Object.getOwnPropertyNames||function(m){return $(m,te)}},function(m,M,z){var $=z(5),te=z(145),re=z(91),ie=z(92)("IE_PROTO"),a=function(){},u=function(){var m,M=z(95)("iframe"),$=re.length;for(M.style.display="none",z(89).appendChild(M),M.src="javascript:",(m=M.contentWindow.document).open(),m.write("<script>document.F=Object<\/script>"),m.close(),u=m.F;$--;)delete u.prototype[re[$]];return u()};m.exports=Object.create||function(m,M){var z;return null!==m?(a.prototype=$(m),z=new a,a.prototype=null,z[ie]=m):z=u(),void 0===M?z:te(z,M)}},function(m,M,z){var $=z(24),te=Math.max,re=Math.min;m.exports=function(m,M){return(m=$(m))<0?te(m+M,0):re(m,M)}},function(m,M){var z=0,$=Math.random();m.exports=function(m){return"Symbol(".concat(void 0===m?"":m,")_",(++z+$).toString(36))}},function(m,M){m.exports=function(m,M){return{enumerable:!(1&m),configurable:!(2&m),writable:!(4&m),value:M}}},function(m,M){var z=m.exports={version:"2.5.4"};"number"==typeof __e&&(__e=z)},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=function(){function e(){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._listenersByEvent={}}return $(e,[{key:"addEventListener",value:function(m,M,z){this._listenersByEvent[m]||(this._listenersByEvent[m]=[]),this._listenersByEvent[m].push({callback:M,scope:z})}},{key:"removeEventListener",value:function(m,M){var z=this._listenersByEvent[m];if(z)for(var $=0;$<z.length;$++)if(z[$].callback===M){z.splice($,1);break}}},{key:"dispatchEvent",value:function(m,M){var z=this._listenersByEvent[m];if(z){var $=!0,te=!1,re=void 0;try{for(var ie,oe=z[Symbol.iterator]();!($=(ie=oe.next()).done);$=!0){var se=ie.value;se.callback.call(se.scope,M)}}catch(m){te=!0,re=m}finally{try{!$&&oe.return&&oe.return()}finally{if(te)throw re}}}}}]),e}(),re=Object.freeze({HANDSHAKE:"handshake",CONNECTION:"connection",CONNECTION_LOST:"connectionLost",LOGIN:"login",LOGIN_ERROR:"loginError",LOGOUT:"logout",ROOM_ADD:"roomAdd",ROOM_CREATION_ERROR:"roomCreationError",ROOM_REMOVE:"roomRemove",ROOM_JOIN:"roomJoin",ROOM_JOIN_ERROR:"roomJoinError",USER_ENTER_ROOM:"userEnterRoom",USER_EXIT_ROOM:"userExitRoom",USER_COUNT_CHANGE:"userCountChange",PROXIMITY_LIST_UPDATE:"proximityListUpdate",PLAYER_TO_SPECTATOR:"playerToSpectator",PLAYER_TO_SPECTATOR_ERROR:"playerToSpectatorError",SPECTATOR_TO_PLAYER:"spectatorToPlayer",SPECTATOR_TO_PLAYER_ERROR:"spectatorToPlayerError",ROOM_NAME_CHANGE:"roomNameChange",ROOM_NAME_CHANGE_ERROR:"roomNameChangeError",ROOM_PASSWORD_STATE_CHANGE:"roomPasswordStateChange",ROOM_PASSWORD_STATE_CHANGE_ERROR:"roomPasswordStateChangeError",ROOM_CAPACITY_CHANGE:"roomCapacityChange",ROOM_CAPACITY_CHANGE_ERROR:"roomCapacityChangeError",PUBLIC_MESSAGE:"publicMessage",PRIVATE_MESSAGE:"privateMessage",OBJECT_MESSAGE:"objectMessage",MODERATOR_MESSAGE:"moderatorMessage",ADMIN_MESSAGE:"adminMessage",EXTENSION_RESPONSE:"extensionResponse",ROOM_VARIABLES_UPDATE:"roomVariablesUpdate",USER_VARIABLES_UPDATE:"userVariablesUpdate",MMOITEM_VARIABLES_UPDATE:"mmoItemVariablesUpdate",ROOM_GROUP_SUBSCRIBE:"roomGroupSubscribe",ROOM_GROUP_SUBSCRIBE_ERROR:"roomGroupSubscribeError",ROOM_GROUP_UNSUBSCRIBE:"roomGroupUnsubscribe",ROOM_GROUP_UNSUBSCRIBE_ERROR:"roomGroupUnsubscribeError",ROOM_FIND_RESULT:"roomFindResult",USER_FIND_RESULT:"userFindResult",INVITATION:"invitation",INVITATION_REPLY:"invitationReply",INVITATION_REPLY_ERROR:"invitationReplyError",PING_PONG:"pingPong",SOCKET_ERROR:"socketError"}),ie=Object.freeze({BUDDY_LIST_INIT:"buddyListInit",BUDDY_ADD:"buddyAdd",BUDDY_REMOVE:"buddyRemove",BUDDY_BLOCK:"buddyBlock",BUDDY_ERROR:"buddyError",BUDDY_ONLINE_STATE_CHANGE:"buddyOnlineStateChange",BUDDY_VARIABLES_UPDATE:"buddyVariablesUpdate",BUDDY_MESSAGE:"buddyMessage"});M.EventDispatcher=te,M.SFSEvent=re,M.SFSBuddyEvent=ie},function(m,M,z){var $=z(4);m.exports=function(m,M){if(!$(m)||m._t!==M)throw TypeError("Incompatible receiver, "+M+" required!");return m}},function(m,M,z){var $=z(15);m.exports=function(m,M,z){for(var te in M)$(m,te,M[te],z);return m}},function(m,M){m.exports=function(m,M,z,$){if(!(m instanceof M)||void 0!==$&&$ in m)throw TypeError(z+": incorrect invocation!");return m}},function(m,M,z){"use strict";var $=z(6),te=z(9),re=z(11),ie=z(7)("species");m.exports=function(m){var M=$[m];re&&M&&!M[ie]&&te.f(M,ie,{configurable:!0,get:function(){return this}})}},function(m,M){m.exports=!1},function(m,M,z){var $=z(9).f,te=z(16),re=z(7)("toStringTag");m.exports=function(m,M,z){m&&!te(m=z?m:m.prototype,re)&&$(m,re,{configurable:!0,value:M})}},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.LogicOperator=M.MatchExpression=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(8);function o(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var re=function(){function e(m,M,z){o(this,e),this._varName=m,this._condition=M,this._value=z,this._logicOp=null,this._next=null,this._parent=null,Object.seal(this)}return $(e,[{key:"and",value:function(m,M,z){return this._next=e.chainedMatchExpression(m,M,z,ie.AND,this),this._next}},{key:"or",value:function(m,M,z){return this._next=e.chainedMatchExpression(m,M,z,ie.OR,this),this._next}},{key:"hasNext",value:function(){return null!=this._next}},{key:"rewind",value:function(){for(var m=this;null!=m._parent;)m=m._parent;return m}},{key:"toString",value:function(){for(var m=this.rewind(),M=m.asString();m.hasNext();)M+=(m=m.next).asString();return M}},{key:"asString",value:function(){var m="";null!=this._logicOp&&(m+=" "+this._logicOp.id+" ");var M="string"==typeof this._value?"' "+this._value+" '":this._value;return m+"("+this._varName+" "+this._condition.symbol+" "+M+")"}},{key:"toSFSArray",value:function(){var m=this.rewind(),M=new te.SFSArray;for(M.addSFSArray(m.expressionAsSFSArray());m.hasNext();)m=m.next,M.addSFSArray(m.expressionAsSFSArray());return M}},{key:"expressionAsSFSArray",value:function(){var m=new te.SFSArray;return null!=this._logicOp?m.addUtfString(this._logicOp.id):m.addNull(),m.addUtfString(this._varName),m.addByte(this._condition.type),m.addUtfString(this._condition.symbol),0===this._condition.type?m.addBool(this._value):1===this._condition.type?m.addDouble(this._value):m.addUtfString(this._value),m}},{key:"varName",get:function(){return this._varName}},{key:"condition",get:function(){return this._condition}},{key:"value",get:function(){return this._value}},{key:"logicOp",get:function(){return this._logicOp}},{key:"next",get:function(){return this._next}}],[{key:"chainedMatchExpression",value:function(m,M,z,$,te){var re=new e(m,M,z);return re._logicOp=$,re._parent=te,re}}]),e}(),ie=function(){function e(m){o(this,e),this._id=m,Object.freeze(this)}return $(e,[{key:"id",get:function(){return this._id}}],[{key:"AND",get:function(){return new e("AND")}},{key:"OR",get:function(){return new e("OR")}}]),e}();M.MatchExpression=re,M.LogicOperator=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SFSBuddyVariable=M.ReservedBuddyVariables=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(48),re=Object.freeze({BV_ONLINE:"$__BV_ONLINE__",BV_STATE:"$__BV_STATE__",BV_NICKNAME:"$__BV_NICKNAME__"}),ie=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m,M,z));return Object.freeze($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseVariable),$(t,null,[{key:"OFFLINE_PREFIX",get:function(){return"$"}}]),$(t,[{key:"toString",value:function(){return"[BuddyVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"}},{key:"isOffline",get:function(){return this._name.charAt(0)===t.OFFLINE_PREFIX}}],[{key:"fromSFSArray",value:function(m){return new t(m.get(0),m.get(2),m.get(1))}}]),t}();M.ReservedBuddyVariables=re,M.SFSBuddyVariable=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.UserPrivileges=M.SFSUser=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(58),re=z(1),ie=function(){function e(m,M){var z=arguments.length>2&&void 0!==arguments[2]&&arguments[2];!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=m,this._name=M,this._isItMe=z,this._privilegeId=0,this._aoiEntryPoint=null,this._variables=new Map,this._playerIdByRoomId=new Map,this._userManager=null,this.properties={},Object.seal(this)}return $(e,[{key:"toString",value:function(){return"[User: "+this.name+", Id: "+this.id+", Is me: "+this.isItMe+"]"}},{key:"isJoinedInRoom",value:function(m){return m.containsUser(this)}},{key:"getPlayerId",value:function(m){var M=this._playerIdByRoomId.get(m.id);return null!=M?M:0}},{key:"isPlayerInRoom",value:function(m){return!!m.isGame&&this.getPlayerId(m)>0}},{key:"isSpectatorInRoom",value:function(m){return!!m.isGame&&this.getPlayerId(m)<0}},{key:"getVariable",value:function(m){return this._variables.get(m)}},{key:"containsVariable",value:function(m){return this._variables.has(m)}},{key:"getVariables",value:function(){return Array.from(this._variables.values())}},{key:"getUserManager",value:function(){return this._userManager}},{key:"_setPlayerId",value:function(m,M){this._playerIdByRoomId.set(M.id,m)}},{key:"_removePlayerId",value:function(m){this._playerIdByRoomId.delete(m.id)}},{key:"_setVariables",value:function(m){var M=!0,z=!1,$=void 0;try{for(var te,re=m[Symbol.iterator]();!(M=(te=re.next()).done);M=!0){var ie=te.value;this._setVariable(ie)}}catch(m){z=!0,$=m}finally{try{!M&&re.return&&re.return()}finally{if(z)throw $}}}},{key:"_setVariable",value:function(m){m.isNull?this._variables.delete(m.name):this._variables.set(m.name,m)}},{key:"_setUserManager",value:function(m){if(null!=this._userManager)throw new re.SFSError("User Manager already assigned to user "+this.toString());this._userManager=m}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"isItMe",get:function(){return this._isItMe}},{key:"privilegeId",get:function(){return this._privilegeId}},{key:"aoiEntryPoint",get:function(){return this._aoiEntryPoint}},{key:"isGuest",get:function(){return this._privilegeId===oe.GUEST}},{key:"isStandardUser",get:function(){return this._privilegeId===oe.STANDARD}},{key:"isModerator",get:function(){return this._privilegeId===oe.MODERATOR}},{key:"isAdmin",get:function(){return this.privilegeId===oe.ADMINISTRATOR}},{key:"isPlayer",get:function(){return this.isPlayerInRoom(this._userManager._sfs.lastJoinedRoom)}},{key:"isSpectator",get:function(){return this.isSpectatorInRoom(this._userManager._sfs.lastJoinedRoom)}}],[{key:"fromSFSArray",value:function(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=new e(m.get(0),m.get(1));z._privilegeId=m.get(2),null!=M&&z._setPlayerId(m.get(3),M);var $=m.get(4);if(null!=$)for(var re=0;re<$.size();re++)z._setVariable(te.SFSUserVariable.fromSFSArray($.get(re)));return z}}]),e}(),oe=Object.freeze({GUEST:0,STANDARD:1,MODERATOR:2,ADMINISTRATOR:3});M.SFSUser=ie,M.UserPrivileges=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.BaseVariable=M.VariableType=void 0;var $="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(m){return typeof m}:function(m){return m&&"function"==typeof Symbol&&m.constructor===Symbol&&m!==Symbol.prototype?"symbol":typeof m},te=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),re=z(8),ie=Object.freeze({NULL:0,BOOLEAN:1,INT:2,DOUBLE:3,STRING:4,SFSOBJECT:5,SFSARRAY:6,getTypeName:function(m){return["null","boolean","int","double","string","SFSObject","SFSArray"][m]}}),oe=function(){function e(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._name=m,this._value=M,this._type=z>-1?z:this._evalType()}return te(e,[{key:"toSFSArray",value:function(){var m=new re.SFSArray;return m.addUtfString(this.name),m.addByte(this._type),this._populateArrayWithValue(m),m}},{key:"_populateArrayWithValue",value:function(m){switch(this._type){case ie.NULL:m.addNull();break;case ie.BOOLEAN:m.addBool(this.value);break;case ie.INT:m.addInt(this.value);break;case ie.DOUBLE:m.addDouble(this.value);break;case ie.STRING:m.addUtfString(this.value);break;case ie.SFSOBJECT:m.addSFSObject(this.value);break;case ie.SFSARRAY:m.addSFSArray(this.value)}}},{key:"_evalType",value:function(){if(null==this._value)return ie.NULL;var m=$(this._value);if("boolean"===m)return ie.BOOLEAN;if("number"===m){var M=this._value;return M===+M&&M===(0|M)?ie.INT:ie.DOUBLE}return"string"===m?ie.STRING:"object"===m?this._value instanceof re.SFSArray?ie.SFSARRAY:ie.SFSOBJECT:void 0}},{key:"name",get:function(){return this._name}},{key:"value",get:function(){return this._value}},{key:"type",get:function(){return ie.getTypeName(this._type)}},{key:"isNull",get:function(){return this._type===ie.NULL}}]),e}();M.VariableType=ie,M.BaseVariable=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SFSRoomVariable=M.ReservedRoomVariables=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(48),re=Object.freeze({RV_GAME_STARTED:"$GS"}),ie=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m,M,z));return $.isPrivate=!1,$.isPersistent=!1,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseVariable),$(t,[{key:"toString",value:function(){return"[RoomVar: "+this.name+", Type: "+this.type+", Value: "+this.value+", Private: "+this.isPrivate+"]"}},{key:"toSFSArray",value:function(){var m=function e(m,M,z){null===m&&(m=Function.prototype);var $=Object.getOwnPropertyDescriptor(m,M);if(void 0===$){var te=Object.getPrototypeOf(m);return null===te?void 0:e(te,M,z)}if("value"in $)return $.value;var re=$.get;return void 0!==re?re.call(z):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toSFSArray",this).call(this);return m.addBool(this.isPrivate),m.addBool(this.isPersistent),m}}],[{key:"fromSFSArray",value:function(m){var M=new t(m.get(0),m.get(2),m.get(1));return M.isPrivate=m.get(3),M.isPersistent=m.get(4),M}}]),t}();M.ReservedRoomVariables=re,M.SFSRoomVariable=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.LoggerEvent=M.Logger=M.LogLevel=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(38),re=Object.freeze({DEBUG:0,INFO:1,WARN:2,ERROR:3,toString:function(m){return m===this.DEBUG?"DEBUG":m===this.INFO?"INFO":m===this.WARN?"WARN":m===this.ERROR?"ERROR":void 0}}),ie=Object.freeze({DEBUG:"debug",INFO:"info",WARNING:"warn",ERROR:"error"}),oe=Symbol(),se=Symbol(),ae=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(m!==se)throw"Logger is a singleton class; you can't instantiate it";return M._enableConsoleOutput=void 0!==console,M._enableEventDispatching=!1,M._level=re.INFO,M._useBasicLog=!0,void 0!==console&&(M._useBasicLog="function"!=typeof console.debug||"function"!=typeof console.info||"function"!=typeof console.warn||"function"!=typeof console.error),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.EventDispatcher),$(t,[{key:"log",value:function(m){for(var M=this,z=arguments.length,$=Array(z>1?z-1:0),te=1;te<z;te++)$[te-1]=arguments[te];if(this.isValidLevel(m)&&m>=this._level){if(this._enableConsoleOutput){var s=function(m,z){M._useBasicLog&&(z=function(m){console.log(m)}),z("[ SFS2X | "+m+" ] "+$.join(" "))};switch(m){case re.DEBUG:s("DEBUG",(function(m){console.debug(m)}));break;case re.INFO:s("INFO",(function(m){console.info(m)}));break;case re.WARN:s("WARN",(function(m){console.warn(m)}));break;case re.ERROR:s("ERROR",(function(m){console.error(m)}))}}this._enableEventDispatching&&this.dispatchEvent(re.toString(m).toLowerCase(),{message:$.join(" ")})}}},{key:"debug",value:function(){for(var m=arguments.length,M=Array(m),z=0;z<m;z++)M[z]=arguments[z];this.log(re.DEBUG,M)}},{key:"info",value:function(){for(var m=arguments.length,M=Array(m),z=0;z<m;z++)M[z]=arguments[z];this.log(re.INFO,M)}},{key:"warn",value:function(){for(var m=arguments.length,M=Array(m),z=0;z<m;z++)M[z]=arguments[z];this.log(re.WARN,M)}},{key:"error",value:function(){for(var m=arguments.length,M=Array(m),z=0;z<m;z++)M[z]=arguments[z];this.log(re.ERROR,M)}},{key:"isValidLevel",value:function(m){if(!Number.isInteger(m)||m<re.DEBUG||m>re.ERROR)throw"Logging level must be set to a valid value (see LogLevel class)";return!0}},{key:"level",set:function(m){this.isValidLevel(m)&&(this._level=m)},get:function(){return this._level}},{key:"enableConsoleOutput",set:function(m){void 0!==console&&(this._enableConsoleOutput=m)},get:function(){return this._enableConsoleOutput}},{key:"enableEventDispatching",set:function(m){this._enableEventDispatching=m},get:function(){return this._enableEventDispatching}}],[{key:"instance",get:function(){return this[oe]||(this[oe]=new t(se)),Object.seal(this[oe])}}]),t}();M.LogLevel=re,M.Logger=ae,M.LoggerEvent=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=Object.freeze({IDLE:"idle",KICK:"kick",BAN:"ban",MANUAL:"manual",UNKNOWN:"unknown",getReason:function(m){switch(m){case 0:return this.IDLE;case 1:return this.KICK;case 2:return this.BAN;case 3:return this.MANUAL;case 4:return this.UNKNOWN}}}),re=function(){function e(){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e)}return $(e,null,[{key:"prettyPrintByteArray",value:function(m){return null==m?"Null":m.length<32?m.toString():"Byte["+m.length+"]"}},{key:"prettyPrintDump",value:function(m){for(var M="",z=0,$=0;$<m.length;$++){var te=m.charAt($);if(te==this.TOKEN_INDENT_OPEN)z++,M+=this.NEW_LINE+this.getFormatTabs(z);else if(te==this.TOKEN_INDENT_CLOSE){if(--z<0)throw"DumpFormatter: the indentPos is negative. TOKENS ARE NOT BALANCED!";M+=this.NEW_LINE+this.getFormatTabs(z)}else te==this.TOKEN_DIVIDER?M+=this.NEW_LINE+this.getFormatTabs(z):M+=te}if(0!=z)throw"DumpFormatter: the indentPos is not === 0 ("+z+"). TOKENS ARE NOT BALANCED!";return M}},{key:"getFormatTabs",value:function(m){return this.strFill(this.TAB,m)}},{key:"strFill",value:function(m,M){for(var z="",$=0;$<M;$++)z+=m;return z}},{key:"hexDump",value:function(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;-1===M&&(M=this.HEX_BYTES_PER_LINE);var z="Binary size: "+m.byteLength+this.NEW_LINE,$="",te="",re=0,ie=0,oe=null;do{var se=(oe=m[re]).toString(16).toUpperCase();1===se.length&&(se="0"+se),$+=se+" ",te+=oe>=33&&oe<=126?String.fromCharCode(oe):this.DOT,++ie===M&&(ie=0,z+=$+this.TAB+te+this.NEW_LINE,$="",te="")}while(++re<m.length);if(0!==ie){for(var ae=M-ie;ae>0;--ae)$+="   ",te+=" ";z+=$+this.TAB+te+this.NEW_LINE}return z}},{key:"TOKEN_INDENT_OPEN",get:function(){return"{"}},{key:"TOKEN_INDENT_CLOSE",get:function(){return"}"}},{key:"TOKEN_DIVIDER",get:function(){return";"}},{key:"NEW_LINE",get:function(){return"\n"}},{key:"TAB",get:function(){return"\t"}},{key:"DOT",get:function(){return"."}},{key:"HEX_BYTES_PER_LINE",get:function(){return 16}}]),e}();M.ClientDisconnectionReason=te,M.DumpFormatter=re},function(m,M,z){var $=z(7)("unscopables"),te=Array.prototype;null==te[$]&&z(18)(te,$,{}),m.exports=function(m){te[$][m]=!0}},function(m,M){m.exports={}},function(m,M,z){var $=z(25);m.exports=Object("z").propertyIsEnumerable(0)?Object:function(m){return"String"==$(m)?m.split(""):Object(m)}},function(m,M,z){var $=z(146),te=z(91);m.exports=Object.keys||function(m){return $(m,te)}},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.MessageRecipientMode=M.BanMode=M.MapLimits=M.RoomExtension=M.RoomEvents=M.RoomPermissions=M.MMORoomSettings=M.SFSGameSettings=M.RoomSettings=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(1);function o(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}function s(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}function a(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var re=function e(m){a(this,e),this.name=m,this.password="",this.groupId="default",this.isGame=!1,this.maxUsers=10,this.maxSpectators=0,this.maxVariables=5,this.variables=[],this.permissions=null,this.events=null,this.extension=null,this.allowOwnerOnlyInvitation=!0},ie=function(m){function t(m){a(this,t);var M=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m));return M.isPublic=!0,M.minPlayersToStartGame=2,M.invitedPlayers=null,M.searchableRooms=null,M.invitationExpiryTime=15,M.leaveLastJoinedRoom=!0,M.notifyGameStarted=!1,M.playerMatchExpression=null,M.spectatorMatchExpression=null,M.invitationParams=null,Object.seal(M),M}return s(t,re),t}(),oe=function(m){function t(m,M){a(this,t);var z=o(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m));return z.defaultAOI=M,z.mapLimits=null,z.userMaxLimboSeconds=50,z.proximityListUpdateMillis=250,z.sendAOIEntryPoint=!0,Object.seal(z),z}return s(t,re),t}(),se=Object.freeze({BY_ADDRESS:0,BY_NAME:1}),ae=function(){function e(m,M){if(a(this,e),m<e.TO_USER||m>e.TO_ZONE)throw new te.SFSError("Illegal recipient mode: "+m);this._mode=m,this._target=M,Object.freeze(this)}return $(e,null,[{key:"TO_USER",get:function(){return 0}},{key:"TO_ROOM",get:function(){return 1}},{key:"TO_GROUP",get:function(){return 2}},{key:"TO_ZONE",get:function(){return 3}}]),$(e,[{key:"mode",get:function(){return this._mode}},{key:"target",get:function(){return this._target}}]),e}();M.RoomSettings=re,M.SFSGameSettings=ie,M.MMORoomSettings=oe,M.RoomPermissions=function e(){a(this,e),this.allowNameChange=!1,this.allowPasswordStateChange=!1,this.allowPublicMessages=!0,this.allowResizing=!1,Object.seal(this)},M.RoomEvents=function e(){a(this,e),this.allowUserCountChange=!1,this.allowUserEnter=!1,this.allowUserExit=!1,this.allowUserVariablesUpdate=!1,Object.seal(this)},M.RoomExtension=function e(m,M){a(this,e),this.id=m,this.className=M,this.propertiesFile="",Object.seal(this)},M.MapLimits=function e(m,M){if(a(this,e),null==m||null==M)throw new te.SFSError("Map limits arguments must be both non null!");this.lowerLimit=m,this.higherLimit=M,Object.seal(this)},M.BanMode=se,M.MessageRecipientMode=ae},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.BuddyOnlineState=M.SFSBuddy=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(46),re=function(){function e(m,M){var z=arguments.length>2&&void 0!==arguments[2]&&arguments[2],$=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=m,this._name=M,this._isBlocked=z,this._isTemp=$,this._variables=new Map,Object.seal(this)}return $(e,[{key:"toString",value:function(){return"[Buddy: "+this.name+", Id: "+this.id+"]"}},{key:"getVariable",value:function(m){return this._variables.get(m)}},{key:"containsVariable",value:function(m){return this._variables.has(m)}},{key:"getVariables",value:function(){return Array.from(this._variables.values())}},{key:"getOfflineVariables",value:function(){return this.getVariables().filter((function(m){return m.name.charAt(0)===te.SFSBuddyVariable.OFFLINE_PREFIX}))}},{key:"getOnlineVariables",value:function(){return this.getVariables().filter((function(m){return m.name.charAt(0)!==te.SFSBuddyVariable.OFFLINE_PREFIX}))}},{key:"_setVariables",value:function(m){var M=!0,z=!1,$=void 0;try{for(var te,re=m[Symbol.iterator]();!(M=(te=re.next()).done);M=!0){var ie=te.value;this._setVariable(ie)}}catch(m){z=!0,$=m}finally{try{!M&&re.return&&re.return()}finally{if(z)throw $}}}},{key:"_setVariable",value:function(m){m.isNull?this._variables.delete(m.name):this._variables.set(m.name,m)}},{key:"_removeVariable",value:function(m){this._variables.delete(m)}},{key:"_clearVolatileVariables",value:function(){var m=!0,M=!1,z=void 0;try{for(var $,te=this.getOnlineVariables()[Symbol.iterator]();!(m=($=te.next()).done);m=!0){var re=$.value;this._removeVariable(re.name)}}catch(m){M=!0,z=m}finally{try{!m&&te.return&&te.return()}finally{if(M)throw z}}}},{key:"id",get:function(){return this._id}},{key:"name",get:function(){return this._name}},{key:"isBlocked",get:function(){return this._isBlocked}},{key:"isTemp",get:function(){return this._isTemp}},{key:"isOnline",get:function(){var m=!0;return this.containsVariable(te.ReservedBuddyVariables.BV_ONLINE)&&(m=this.getVariable(te.ReservedBuddyVariables.BV_ONLINE).value),m&&this._id>-1}},{key:"state",get:function(){return this.containsVariable(te.ReservedBuddyVariables.BV_STATE)?this.getVariable(te.ReservedBuddyVariables.BV_STATE).value:null}},{key:"nickName",get:function(){return this.containsVariable(te.ReservedBuddyVariables.BV_NICKNAME)?this.getVariable(te.ReservedBuddyVariables.BV_NICKNAME).value:null}}],[{key:"fromSFSArray",value:function(m){var M=new e(m.get(0),m.get(1),m.get(2),m.size()>3&&m.get(4)),z=m.get(3);if(null!=z)for(var $=0;$<z.size();$++)M._setVariable(te.SFSBuddyVariable.fromSFSArray(z.get($)));return M}}]),e}(),ie=Object.freeze({ONLINE:0,OFFLINE:1,LEFT_THE_SERVER:2});M.SFSBuddy=re,M.BuddyOnlineState=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SFSUserVariable=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(48),re=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m,M,z));return $.isPrivate=!1,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseVariable),$(t,[{key:"toString",value:function(){return"[UserVar: "+this.name+", Type: "+this.type+", Value: "+this.value+", Private: "+this.isPrivate+"]"}},{key:"toSFSArray",value:function(){var m=function e(m,M,z){null===m&&(m=Function.prototype);var $=Object.getOwnPropertyDescriptor(m,M);if(void 0===$){var te=Object.getPrototypeOf(m);return null===te?void 0:e(te,M,z)}if("value"in $)return $.value;var re=$.get;return void 0!==re?re.call(z):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"toSFSArray",this).call(this);return m.addBool(this.isPrivate),m}}],[{key:"fromSFSArray",value:function(m){var M=new t(m.get(0),m.get(2),m.get(1));return m.size()>3&&(M.isPrivate=m.get(3)),M}}]),t}();M.SFSUserVariable=re},function(m,M,z){for(var $,te=z(6),re=z(18),ie=z(35),oe=ie("typed_array"),se=ie("view"),ae=!(!te.ArrayBuffer||!te.DataView),ue=ae,ce=0,le="Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array".split(",");ce<9;)($=te[le[ce++]])?(re($.prototype,oe,!0),re($.prototype,se,!0)):ue=!1;m.exports={ABV:ae,CONSTR:ue,TYPED:oe,VIEW:se}},function(m,M,z){"use strict";var $=z(6),te=z(0),re=z(15),ie=z(40),oe=z(29),se=z(61),ae=z(41),ue=z(4),ce=z(3),le=z(63),fe=z(44),he=z(86);m.exports=function(m,M,z,_e,ye,pe){var de=$[m],ge=de,ve=ye?"set":"add",be=ge&&ge.prototype,me={},R=function(m){var M=be[m];re(be,m,"delete"==m||"has"==m?function(m){return!(pe&&!ue(m))&&M.call(this,0===m?0:m)}:"get"==m?function(m){return pe&&!ue(m)?void 0:M.call(this,0===m?0:m)}:"add"==m?function(m){return M.call(this,0===m?0:m),this}:function(m,z){return M.call(this,0===m?0:m,z),this})};if("function"==typeof ge&&(pe||be.forEach&&!ce((function(){(new ge).entries().next()})))){var Se=new ge,Ee=Se[ve](pe?{}:-0,1)!=Se,Re=ce((function(){Se.has(1)})),Fe=le((function(m){new ge(m)})),je=!pe&&ce((function(){for(var m=new ge,M=5;M--;)m[ve](M,M);return!m.has(-0)}));Fe||((ge=M((function(M,z){ae(M,ge,m);var $=he(new de,M,ge);return null!=z&&se(z,ye,$[ve],$),$}))).prototype=be,be.constructor=ge),(Re||je)&&(R("delete"),R("has"),ye&&R("get")),(je||Ee)&&R(ve),pe&&be.clear&&delete be.clear}else ge=_e.getConstructor(M,m,ye,ve),ie(ge.prototype,z),oe.NEED=!0;return fe(ge,m),me[m]=ge,te(te.G+te.W+te.F*(ge!=de),me),pe||_e.setStrong(ge,m,ye),ge}},function(m,M,z){var $=z(27),te=z(132),re=z(79),ie=z(5),oe=z(12),se=z(78),ae={},ue={};(M=m.exports=function(m,M,z,ce,le){var fe,he,_e,ye,pe=le?function(){return m}:se(m),de=$(z,ce,M?2:1),ge=0;if("function"!=typeof pe)throw TypeError(m+" is not iterable!");if(re(pe)){for(fe=oe(m.length);fe>ge;ge++)if((ye=M?de(ie(he=m[ge])[0],he[1]):de(m[ge]))===ae||ye===ue)return ye}else for(_e=pe.call(m);!(he=_e.next()).done;)if((ye=te(_e,de,he.value,M))===ae||ye===ue)return ye}).BREAK=ae,M.RETURN=ue},function(m,M,z){"use strict";var $=z(18),te=z(15),re=z(3),ie=z(28),oe=z(7);m.exports=function(m,M,z){var se=oe(m),ae=z(ie,se,""[m]),ue=ae[0],ce=ae[1];re((function(){var M={};return M[se]=function(){return 7},7!=""[m](M)}))&&(te(String.prototype,m,ue),$(RegExp.prototype,se,2==M?function(m,M){return ce.call(m,this,M)}:function(m){return ce.call(m,this)}))}},function(m,M,z){var $=z(7)("iterator"),te=!1;try{var re=[7][$]();re.return=function(){te=!0},Array.from(re,(function(){throw 2}))}catch(m){}m.exports=function(m,M){if(!M&&!te)return!1;var z=!1;try{var re=[7],ie=re[$]();ie.next=function(){return{done:z=!0}},re[$]=function(){return ie},m(re)}catch(m){}return z}},function(m,M,z){var $=z(0),te=z(28),re=z(3),ie=z(87),oe="["+ie+"]",se=RegExp("^"+oe+oe+"*"),ae=RegExp(oe+oe+"*$"),l=function(m,M,z){var te={},oe=re((function(){return!!ie[m]()||"​"!="​"[m]()})),se=te[m]=oe?M(ue):ie[m];z&&(te[z]=se),$($.P+$.F*oe,"String",te)},ue=l.trim=function(m,M){return m=String(te(m)),1&M&&(m=m.replace(se,"")),2&M&&(m=m.replace(ae,"")),m};m.exports=l},function(m,M,z){var $=z(25),te=z(7)("toStringTag"),re="Arguments"==$(function(){return arguments}());m.exports=function(m){var M,z,ie;return void 0===m?"Undefined":null===m?"Null":"string"==typeof(z=function(m,M){try{return m[M]}catch(m){}}(M=Object(m),te))?z:re?$(M):"Object"==(ie=$(M))&&"function"==typeof M.callee?"Arguments":ie}},function(m,M){M.f={}.propertyIsEnumerable},function(m,M){M.f=Object.getOwnPropertySymbols},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.InviteUsersRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(47),oe=z(57),se=z(8),ae=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.InviteUsers));return $._invitedUsers=m,$._secondsForAnswer=M,$._params=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_USER",get:function(){return"u"}},{key:"KEY_USER_ID",get:function(){return"ui"}},{key:"KEY_INVITATION_ID",get:function(){return"ii"}},{key:"KEY_TIME",get:function(){return"t"}},{key:"KEY_PARAMS",get:function(){return"p"}},{key:"KEY_INVITEE_ID",get:function(){return"ee"}},{key:"KEY_INVITED_USERS",get:function(){return"iu"}},{key:"KEY_REPLY_ID",get:function(){return"ri"}},{key:"MAX_INVITATIONS_FROM_CLIENT_SIDE",get:function(){return 8}},{key:"MIN_EXPIRY_TIME",get:function(){return 5}},{key:"MAX_EXPIRY_TIME",get:function(){return 300}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._invitedUsers?M.push("No invited users"):this._invitedUsers instanceof Array?(this._invitedUsers.length<1&&M.push("No invited users"),this._invitedUsers.length>t.MAX_INVITATIONS_FROM_CLIENT_SIDE&&M.push("Too many invitations; "+t.MAX_INVITATIONS_FROM_CLIENT_SIDE+" max are allowed from client side"),this._invitedUsers.every((function(m){return m instanceof ie.SFSUser||m instanceof oe.SFSBuddy}))||M.push("Each invited user must be an instance of SFSUser or SFSBuddy class")):M.push("Invited users must be passed in an array"),(this._secondsForAnswer<t.MIN_EXPIRY_TIME||this._secondsForAnswer>t.MAX_EXPIRY_TIME)&&M.push("secondsForAnswer value is out of range (min: "+t.MIN_EXPIRY_TIME+"; max: "+t.MAX_EXPIRY_TIME+")"),null==this._params||this._params instanceof se.SFSObject||M.push("Custom invitation parameters must be set in a SFSObject class instance"),M.length>0)throw new re.SFSValidationError("InviteUsersRequest Error",M)}},{key:"execute",value:function(m){var M=[],z=!0,$=!1,te=void 0;try{for(var re,se=this._invitedUsers[Symbol.iterator]();!(z=(re=se.next()).done);z=!0){var ae=re.value;if(ae instanceof ie.SFSUser||ae instanceof oe.SFSBuddy){if(ae===m.mySelf)continue;M.push(ae.id)}}}catch(m){$=!0,te=m}finally{try{!z&&se.return&&se.return()}finally{if($)throw te}}this._reqObj.putIntArray(t.KEY_INVITED_USERS,M),this._reqObj.putShort(t.KEY_TIME,this._secondsForAnswer),null!=this._params&&this._reqObj.putSFSObject(t.KEY_PARAMS,this._params)}}]),t}();M.InviteUsersRequest=ae},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.AdminMessageRequest=M.ModeratorMessageRequest=M.ObjectMessageRequest=M.PrivateMessageRequest=M.PublicMessageRequest=M.GenericMessageRequest=M.GenericMessageType=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(56),oe=z(8),se=z(10),ae=z(47);function l(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}function f(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}function h(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}var ue=Object.freeze({PUBLIC_MSG:0,PRIVATE_MSG:1,MODERATOR_MSG:2,ADMING_MSG:3,OBJECT_MSG:4,BUDDY_MSG:5}),ce=function(m){function t(){l(this,t);var m=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.GenericMessage));return m._type=-1,m._room=null,m._user=null,m._message=null,m._params=null,m._recipient=null,m._sendMode=-1,Object.seal(m),m}return h(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM_ID",get:function(){return"r"}},{key:"KEY_USER_ID",get:function(){return"u"}},{key:"KEY_MESSAGE",get:function(){return"m"}},{key:"KEY_MESSAGE_TYPE",get:function(){return"t"}},{key:"KEY_RECIPIENT",get:function(){return"rc"}},{key:"KEY_RECIPIENT_MODE",get:function(){return"rm"}},{key:"KEY_XTRA_PARAMS",get:function(){return"p"}},{key:"KEY_SENDER_DATA",get:function(){return"sd"}}]),$(t,[{key:"validate",value:function(m){if(this._type<0)throw new re.SFSValidationError("GenericMessageRequest Error",["Unsupported message type: "+this._type]);var M=[];switch(this._type){case ue.PUBLIC_MSG:this._validatePublicMessage(m,M);break;case ue.PRIVATE_MSG:this._validatePrivateMessage(m,M);break;case ue.OBJECT_MSG:this._validateObjectMessage(m,M);break;case ue.BUDDY_MSG:this._validateBuddyMessage(m,M);break;default:this._validateSuperUserMessage(m,M)}if(M.length>0)throw new re.SFSValidationError("GenericMessageRequest Error",M)}},{key:"execute",value:function(m){switch(this._reqObj.putByte(t.KEY_MESSAGE_TYPE,this._type),this._type){case ue.PUBLIC_MSG:this._executePublicMessage(m);break;case ue.PRIVATE_MSG:this._executePrivateMessage(m);break;case ue.OBJECT_MSG:this._executeObjectMessage(m);break;case ue.BUDDY_MSG:this._executeBuddyMessage(m);break;default:this._executeSuperUserMessage(m)}}},{key:"_validatePublicMessage",value:function(m,M){null!=this._message&&0!==this._message.length||M.push("Public message is empty"),null==this._room&&(this._room=m.lastJoinedRoom),null==this._room?M.push("You must be joined in a Room to send a message"):this._room instanceof se.SFSRoom?m.getJoinedRooms().indexOf(this._room)<0&&M.push("You are not joined in the target Room: "+this._room):M.push("Target Room must be an instance of SFSRoom class"),null==this._params||this._params instanceof oe.SFSObject||M.push("Message parameters must be set in a SFSObject class instance")}},{key:"_validatePrivateMessage",value:function(m,M){null!=this._message&&0!==this._message.length||M.push("Private message is empty"),this._recipient<0&&M.push("Invalid recipient id: "+this._recipient),null==this._params||this._params instanceof oe.SFSObject||M.push("Message parameters must be set in a SFSObject class instance")}},{key:"_validateObjectMessage",value:function(m,M){null==this._params?M.push("Object message is null"):this._params instanceof oe.SFSObject||M.push("Message object must be an instance of SFSObject class"),null==this._room&&(this._room=m.lastJoinedRoom),null==this._room?M.push("You must be joined in a Room to send a message"):this._room instanceof se.SFSRoom?m.getJoinedRooms().indexOf(this._room)<0&&M.push("You are not joined in the target Room: "+this._room):M.push("Target Room must be an instance of SFSRoom class"),null!=this._recipient&&(this._recipient instanceof Array?this._recipient.every((function(m){return m instanceof ae.SFSUser}))||M.push("Each message recipient must be an instance of SFSUser class"):M.push("Message recipients must be passed in an array"),this._recipient.length>this._room.capacity&&M.push("The number of recipients is bigger than the target Room capacity: "+this._recipient.length))}},{key:"_validateBuddyMessage",value:function(m,M){m.buddyManager.isInited||M.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),!1===m.buddyManager.myOnlineState&&M.push("Can't send messages while you are offline in the Buddy List system"),null!=this._message&&0!==this._message.length||M.push("Buddy message is empty"),this._recipient<0&&M.push("Recipient is offline or not in your Buddy List"),null==this._params||this._params instanceof oe.SFSObject||M.push("Message parameters must be set in a SFSObject class instance")}},{key:"_validateSuperUserMessage",value:function(m,M){switch(null!=this._message&&0!==this._message.length||M.push("Moderator message is empty"),null==this._params||this._params instanceof oe.SFSObject||M.push("Message parameters must be set in a SFSObject class instance"),this._sendMode){case ie.MessageRecipientMode.TO_USER:this._recipient instanceof ae.SFSUser||M.push("Recipient must be an instance of SFSUser class");break;case ie.MessageRecipientMode.TO_ROOM:this._recipient instanceof se.SFSRoom||M.push("Recipient must be an instance of SFSRoom class");break;case ie.MessageRecipientMode.TO_GROUP:"string"!=typeof this._recipient&&M.push("Recipient must be a string (the groupId)")}}},{key:"_executePublicMessage",value:function(m){this._reqObj.putInt(t.KEY_ROOM_ID,this._room.id),this._reqObj.putInt(t.KEY_USER_ID,m.mySelf.id),this._reqObj.putUtfString(t.KEY_MESSAGE,this._message),null!=this._params&&this._reqObj.putSFSObject(t.KEY_XTRA_PARAMS,this._params)}},{key:"_executePrivateMessage",value:function(m){this._reqObj.putInt(t.KEY_RECIPIENT,this._recipient),this._reqObj.putUtfString(t.KEY_MESSAGE,this._message),null!=this._params&&this._reqObj.putSFSObject(t.KEY_XTRA_PARAMS,this._params)}},{key:"_executeBuddyMessage",value:function(m){this._reqObj.putInt(t.KEY_RECIPIENT,this._recipient),this._reqObj.putUtfString(t.KEY_MESSAGE,this._message),null!=this._params&&this._reqObj.putSFSObject(t.KEY_XTRA_PARAMS,this._params)}},{key:"_executeSuperUserMessage",value:function(m){switch(this._reqObj.putUtfString(t.KEY_MESSAGE,this._message),null!=this._params&&this._reqObj.putSFSObject(t.KEY_XTRA_PARAMS,this._params),this._reqObj.putInt(t.KEY_RECIPIENT_MODE,this._sendMode),this._sendMode){case ie.MessageRecipientMode.TO_USER:case ie.MessageRecipientMode.TO_ROOM:this._reqObj.putInt(t.KEY_RECIPIENT,this._recipient.id);break;case ie.MessageRecipientMode.TO_GROUP:this._reqObj.putUtfString(t.KEY_RECIPIENT,this._recipient)}}},{key:"_executeObjectMessage",value:function(m){this._reqObj.putInt(t.KEY_ROOM_ID,this._room.id),this._reqObj.putSFSObject(t.KEY_XTRA_PARAMS,this._params);var M=new Set;if(null!=this._recipient){var z=!0,$=!1,te=void 0;try{for(var re,ie=this._recipient[Symbol.iterator]();!(z=(re=ie.next()).done);z=!0){var oe=re.value;M.add(oe.id)}}catch(m){$=!0,te=m}finally{try{!z&&ie.return&&ie.return()}finally{if($)throw te}}}M.size>0&&this._reqObj.putIntArray(t.KEY_RECIPIENT,Array.from(M))}}]),t}(),le=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l(this,t);var $=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return $._type=ue.OBJECT_MSG,$._params=m,$._room=M,$._recipient=z,Object.seal($),$}return h(t,ce),t}(),fe=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l(this,t);var $=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return $._type=ue.PUBLIC_MSG,$._message=m,$._room=z,$._params=M,Object.seal($),$}return h(t,ce),t}(),he=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l(this,t);var $=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return $._type=ue.PRIVATE_MSG,$._message=m,$._recipient=M,$._params=z,Object.seal($),$}return h(t,ce),t}(),_e=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l(this,t);var $=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(null==M)throw new re.SFSError("Recipient mode cannot be null");if(!(M instanceof ie.MessageRecipientMode))throw new re.SFSError("Recipient mode must be an instance of MessageRecipientMode class");return $._type=ue.MODERATOR_MSG,$._message=m,$._params=z,$._recipient=M.target,$._sendMode=M.mode,Object.seal($),$}return h(t,ce),t}(),ye=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;l(this,t);var $=f(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(null==M)throw new re.SFSError("Recipient mode cannot be null");if(!(M instanceof ie.MessageRecipientMode))throw new re.SFSError("Recipient mode must an instance of MessageRecipientMode class");return $._type=ue.ADMING_MSG,$._message=m,$._params=z,$._recipient=M.target,$._sendMode=M.mode,Object.seal($),$}return h(t,ce),t}();M.GenericMessageType=ue,M.GenericMessageRequest=ce,M.PublicMessageRequest=fe,M.PrivateMessageRequest=he,M.ObjectMessageRequest=le,M.ModeratorMessageRequest=_e,M.AdminMessageRequest=ye},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.CreateRoomRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(56),oe=z(8),se=z(10),ae=z(49),ue=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]&&arguments[1],z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.CreateRoom));return $._settings=m,$._autoJoin=M,$._roomToLeave=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_NAME",get:function(){return"n"}},{key:"KEY_PASSWORD",get:function(){return"p"}},{key:"KEY_GROUP_ID",get:function(){return"g"}},{key:"KEY_ISGAME",get:function(){return"ig"}},{key:"KEY_MAXUSERS",get:function(){return"mu"}},{key:"KEY_MAXSPECTATORS",get:function(){return"ms"}},{key:"KEY_MAXVARS",get:function(){return"mv"}},{key:"KEY_ROOMVARS",get:function(){return"rv"}},{key:"KEY_PERMISSIONS",get:function(){return"pm"}},{key:"KEY_EVENTS",get:function(){return"ev"}},{key:"KEY_EXTID",get:function(){return"xn"}},{key:"KEY_EXTCLASS",get:function(){return"xc"}},{key:"KEY_EXTPROP",get:function(){return"xp"}},{key:"KEY_AUTOJOIN",get:function(){return"aj"}},{key:"KEY_ROOM_TO_LEAVE",get:function(){return"rl"}},{key:"KEY_ALLOW_JOIN_INVITATION_BY_OWNER",get:function(){return"aji"}},{key:"KEY_MMO_DEFAULT_AOI",get:function(){return"maoi"}},{key:"KEY_MMO_MAP_LOW_LIMIT",get:function(){return"mllm"}},{key:"KEY_MMO_MAP_HIGH_LIMIT",get:function(){return"mlhm"}},{key:"KEY_MMO_USER_MAX_LIMBO_SECONDS",get:function(){return"muls"}},{key:"KEY_MMO_PROXIMITY_UPDATE_MILLIS",get:function(){return"mpum"}},{key:"KEY_MMO_SEND_ENTRY_POINT",get:function(){return"msep"}}]),$(t,[{key:"validate",value:function(m){if(!(this._settings instanceof ie.RoomSettings))throw new re.SFSValidationError("CreateRoomRequest Error",["Room configuration must be an instance of RoomSettings class"]);var M=[];if(null!=this._settings.name&&0!==this._settings.name.length||M.push("Missing Room name"),this._settings.maxUsers<=0&&M.push("Max number of users must be > 0"),this._settings.maxSpectators<0&&M.push("Max number of spectators must be >= 0"),this._settings.maxVariables<0&&M.push("Max number of Room Variables must be >= 0"),null!=this._settings.variables&&(this._settings.variables instanceof Array?this._settings.variables.every((function(m){return m instanceof ae.SFSRoomVariable}))||M.push("Each Room Variable must be an instance of SFSRoomVariable class"):M.push("Room Variables must be passed in an array")),null==this._settings.permissions||this._settings.permissions instanceof ie.RoomPermissions||M.push("Allowed room permissions must be an instance of RoomPermissions class"),null==this._settings.events||this._settings.events instanceof ie.RoomEvents||M.push("Allowed room events must be an instance of RoomEvents class"),null!=this._settings.extension&&(this._settings.extension instanceof ie.RoomExtension?(null!=this._settings.extension.className&&0!==this._settings.extension.className.length||M.push("Missing Room Extension class name"),null!=this._settings.extension.id&&0!==this._settings.extension.id.length||M.push("Missing Room Extension id")):M.push("Room Extension settings must be an instance of RoomExtension class")),this._settings instanceof ie.MMORoomSettings&&(null==this._settings.defaultAOI&&M.push("Missing MMORoom's default AoI (Area of Interest)"),this._settings.defaultAOI instanceof oe.Vec3D||M.push("MMORoom's AoI (Area of Interest) must be an instance of Vec3D class"),null!=this._settings.mapLimits&&(this._settings.mapLimits instanceof ie.MapLimits?(null!=this._settings.mapLimits.lowerLimit&&null!=this._settings.mapLimits.higherLimit||M.push("MMORoom's lower and higher map limits must be both set"),this._settings.mapLimits.lowerLimit instanceof oe.Vec3D&&this._settings.mapLimits.higherLimit instanceof oe.Vec3D||M.push("MMORoom's lower and higher map limits must be both instances of Vec3D class")):M.push("MMORoom's map limits must be set in an instance of MapLimits class"))),null==this._roomToLeave||this._roomToLeave instanceof se.SFSRoom||M.push("Room to leave must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("CreateRoomRequest Error",M)}},{key:"execute",value:function(m){if(this._reqObj.putUtfString(t.KEY_NAME,this._settings.name),this._reqObj.putUtfString(t.KEY_GROUP_ID,this._settings.groupId),this._reqObj.putUtfString(t.KEY_PASSWORD,this._settings.password),this._reqObj.putBool(t.KEY_ISGAME,this._settings.isGame),this._reqObj.putShort(t.KEY_MAXUSERS,this._settings.maxUsers),this._reqObj.putShort(t.KEY_MAXSPECTATORS,this._settings.maxSpectators),this._reqObj.putShort(t.KEY_MAXVARS,this._settings.maxVariables),this._reqObj.putBool(t.KEY_ALLOW_JOIN_INVITATION_BY_OWNER,this._settings.allowOwnerOnlyInvitation),null!=this._settings.variables&&this._settings.variables.length>0){var M=new oe.SFSArray,z=!0,$=!1,te=void 0;try{for(var re,se=this._settings.variables[Symbol.iterator]();!(z=(re=se.next()).done);z=!0){var ae=re.value;M.addSFSArray(ae.toSFSArray())}}catch(m){$=!0,te=m}finally{try{!z&&se.return&&se.return()}finally{if($)throw te}}this._reqObj.putSFSArray(t.KEY_ROOMVARS,M)}if(null!=this._settings.permissions){var ue=[];ue.push(this._settings.permissions.allowNameChange),ue.push(this._settings.permissions.allowPasswordStateChange),ue.push(this._settings.permissions.allowPublicMessages),ue.push(this._settings.permissions.allowResizing),this._reqObj.putBoolArray(t.KEY_PERMISSIONS,ue)}if(null!=this._settings.events){var ce=[];ce.push(this._settings.events.allowUserEnter),ce.push(this._settings.events.allowUserExit),ce.push(this._settings.events.allowUserCountChange),ce.push(this._settings.events.allowUserVariablesUpdate),this._reqObj.putBoolArray(t.KEY_EVENTS,ce)}null!=this._settings.extension&&(this._reqObj.putUtfString(t.KEY_EXTID,this._settings.extension.id),this._reqObj.putUtfString(t.KEY_EXTCLASS,this._settings.extension.className),null!=this._settings.extension.propertiesFile&&this._settings.extension.propertiesFile.length>0&&this._reqObj.putUtfString(t.KEY_EXTPROP,this._settings.extension.propertiesFile)),this._settings instanceof ie.MMORoomSettings&&(this._settings.defaultAOI.isFloat?(this._reqObj.putFloatArray(t.KEY_MMO_DEFAULT_AOI,this._settings.defaultAOI.toArray()),null!=this._settings.mapLimits&&(this._reqObj.putFloatArray(t.KEY_MMO_MAP_LOW_LIMIT,this._settings.mapLimits.lowerLimit.toArray()),this._reqObj.putFloatArray(t.KEY_MMO_MAP_HIGH_LIMIT,this._settings.mapLimits.higherLimit.toArray()))):(this._reqObj.putIntArray(t.KEY_MMO_DEFAULT_AOI,this._settings.defaultAOI.toArray()),null!=this._settings.mapLimits&&(this._reqObj.putIntArray(t.KEY_MMO_MAP_LOW_LIMIT,this._settings.mapLimits.lowerLimit.toArray()),this._reqObj.putIntArray(t.KEY_MMO_MAP_HIGH_LIMIT,this._settings.mapLimits.higherLimit.toArray()))),this._reqObj.putShort(t.KEY_MMO_USER_MAX_LIMBO_SECONDS,this._settings.userMaxLimboSeconds),this._reqObj.putShort(t.KEY_MMO_PROXIMITY_UPDATE_MILLIS,this._settings.proximityListUpdateMillis),this._reqObj.putBool(t.KEY_MMO_SEND_ENTRY_POINT,this._settings.sendAOIEntryPoint)),this._reqObj.putBool(t.KEY_AUTOJOIN,this._autoJoin),null!=this._roomToLeave&&this._reqObj.putInt(t.KEY_ROOM_TO_LEAVE,this._roomToLeave.id)}}]),t}();M.CreateRoomRequest=ue},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=function(){function e(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:15,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=-1,this._inviter=m,this._invitee=M,this._secondsForAnswer=z,this._params=$,Object.seal(this)}return $(e,[{key:"id",get:function(){return this._id}},{key:"inviter",get:function(){return this._inviter}},{key:"invitee",get:function(){return this._invitee}},{key:"secondsForAnswer",get:function(){return this._secondsForAnswer}},{key:"params",get:function(){return this._params}}]),e}(),re=Object.freeze({ACCEPT:0,REFUSE:1,EXPIRED:255});M.SFSInvitation=te,M.InvitationReply=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.MMOItemVariable=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(48),re=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:-1;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m,M,z));return Object.freeze($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseVariable),$(t,[{key:"toString",value:function(){return"[ItemVar: "+this.name+", Type: "+this.type+", Value: "+this.value+"]"}}],[{key:"fromSFSArray",value:function(m){return new t(m.get(0),m.get(2),m.get(1))}}]),t}();M.MMOItemVariable=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=function(){function e(){throw function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),"Class SFSErrorCodes cannot be instantiated. Please check the documentation for more details on its usage"}return $(e,null,[{key:"setErrorMessage",value:function(m,M){this._errorsByCode[m]=M}},{key:"getErrorMessage",value:function(m,M){return this.stringFormat(this._errorsByCode[m],M)}},{key:"stringFormat",value:function(m,M){if(null==m)return"";if(null!=M)for(var z=0;z<M.length;z++){var $="{"+z+"}";m=m.replace($,M[z])}return m}},{key:"_errorsByCode",get:function(){return re}}]),e}();M.SFSErrorCodes=te;var re=["Client API version is obsolete: {0}; required version: {1}","Requested Zone {0} does not exist","User name {0} is not recognized","Wrong password for user {0}","User {0} is banned","Zone {0} is full","User {0} is already logged in Zone {1}","The server is full","Zone {0} is currently inactive","User name {0} contains bad words; filtered: {1}","Guest users not allowed in Zone {0}","IP address {0} is banned","A Room with the same name already exists: {0}","Requested Group is not available - Room: {0}; Group: {1}","Bad Room name length -  Min: {0}; max: {1}; passed name length: {2}","Room name contains bad words: {0}","Zone is full; can't add Rooms anymore","You have exceeded the number of Rooms that you can create per session: {0}","Room creation failed, wrong parameter: {0}","User {0} already joined in Room","Room {0} is full","Wrong password for Room {0}","Requested Room does not exist","Room {0} is locked","Group {0} is already subscribed","Group {0} does not exist","Group {0} is not subscribed","Group {0} does not exist","{0}","Room permission error; Room {0} cannot be renamed","Room permission error; Room {0} cannot change password state","Room permission error; Room {0} cannot change capacity","Switch user error; no player slots available in Room {0}","Switch user error; no spectator slots available in Room {0}","Switch user error; Room {0} is not a Game Room","Switch user error; you are not joined in Room {0}","Buddy Manager initialization error, could not load buddy list: {0}","Buddy Manager error, your buddy list is full; size is {0}","Buddy Manager error, was not able to block buddy {0} because offline","Buddy Manager error, you are attempting to set too many Buddy Variables; limit is {0}","Game {0} access denied, user does not match access criteria","QuickJoinGame action failed: no matching Rooms were found","Your previous invitation reply was invalid or arrived too late"]},function(m,M,z){"use strict";var $=z(6),te=z(11),re=z(43),ie=z(59),oe=z(18),se=z(40),ae=z(3),ue=z(41),ce=z(24),le=z(12),fe=z(121),he=z(32).f,_e=z(9).f,ye=z(77),pe=z(44),de="prototype",ge="Wrong index!",ve=$.ArrayBuffer,be=$.DataView,me=$.Math,Se=$.RangeError,Ee=$.Infinity,Re=ve,Fe=me.abs,je=me.pow,Le=me.floor,xe=me.log,qe=me.LN2,Ve=te?"_b":"buffer",Ke=te?"_l":"byteLength",Ge=te?"_o":"byteOffset";function j(m,M,z){var $,te,re,ie=new Array(z),oe=8*z-M-1,se=(1<<oe)-1,ae=se>>1,ue=23===M?je(2,-24)-je(2,-77):0,ce=0,le=m<0||0===m&&1/m<0?1:0;for((m=Fe(m))!=m||m===Ee?(te=m!=m?1:0,$=se):($=Le(xe(m)/qe),m*(re=je(2,-$))<1&&($--,re*=2),(m+=$+ae>=1?ue/re:ue*je(2,1-ae))*re>=2&&($++,re/=2),$+ae>=se?(te=0,$=se):$+ae>=1?(te=(m*re-1)*je(2,M),$+=ae):(te=m*je(2,ae-1)*je(2,M),$=0));M>=8;ie[ce++]=255&te,te/=256,M-=8);for($=$<<M|te,oe+=M;oe>0;ie[ce++]=255&$,$/=256,oe-=8);return ie[--ce]|=128*le,ie}function U(m,M,z){var $,te=8*z-M-1,re=(1<<te)-1,ie=re>>1,oe=te-7,se=z-1,ae=m[se--],ue=127&ae;for(ae>>=7;oe>0;ue=256*ue+m[se],se--,oe-=8);for($=ue&(1<<-oe)-1,ue>>=-oe,oe+=M;oe>0;$=256*$+m[se],se--,oe-=8);if(0===ue)ue=1-ie;else{if(ue===re)return $?NaN:ae?-Ee:Ee;$+=je(2,M),ue-=ie}return(ae?-1:1)*$*je(2,ue-M)}function B(m){return m[3]<<24|m[2]<<16|m[1]<<8|m[0]}function L(m){return[255&m]}function D(m){return[255&m,m>>8&255]}function Y(m){return[255&m,m>>8&255,m>>16&255,m>>24&255]}function C(m){return j(m,52,8)}function x(m){return j(m,23,4)}function q(m,M,z){_e(m[de],M,{get:function(){return this[z]}})}function V(m,M,z,$){var te=fe(+z);if(te+M>m[Ke])throw Se(ge);var re=m[Ve]._b,ie=te+m[Ge],oe=re.slice(ie,ie+M);return $?oe:oe.reverse()}function K(m,M,z,$,te,re){var ie=fe(+z);if(ie+M>m[Ke])throw Se(ge);for(var oe=m[Ve]._b,se=ie+m[Ge],ae=$(+te),ue=0;ue<M;ue++)oe[se+ue]=ae[re?ue:M-ue-1]}if(ie.ABV){if(!ae((function(){ve(1)}))||!ae((function(){new ve(-1)}))||ae((function(){return new ve,new ve(1.5),new ve(NaN),"ArrayBuffer"!=ve.name}))){for(var ze,He=(ve=function(m){return ue(this,ve),new Re(fe(m))})[de]=Re[de],Je=he(Re),We=0;Je.length>We;)(ze=Je[We++])in ve||oe(ve,ze,Re[ze]);re||(He.constructor=ve)}var Xe=new be(new ve(2)),Ze=be[de].setInt8;Xe.setInt8(0,2147483648),Xe.setInt8(1,2147483649),!Xe.getInt8(0)&&Xe.getInt8(1)||se(be[de],{setInt8:function(m,M){Ze.call(this,m,M<<24>>24)},setUint8:function(m,M){Ze.call(this,m,M<<24>>24)}},!0)}else ve=function(m){ue(this,ve,"ArrayBuffer");var M=fe(m);this._b=ye.call(new Array(M),0),this[Ke]=M},be=function(m,M,z){ue(this,be,"DataView"),ue(m,ve,"DataView");var $=m[Ke],te=ce(M);if(te<0||te>$)throw Se("Wrong offset!");if(te+(z=void 0===z?$-te:le(z))>$)throw Se("Wrong length!");this[Ve]=m,this[Ge]=te,this[Ke]=z},te&&(q(ve,"byteLength","_l"),q(be,"buffer","_b"),q(be,"byteLength","_l"),q(be,"byteOffset","_o")),se(be[de],{getInt8:function(m){return V(this,1,m)[0]<<24>>24},getUint8:function(m){return V(this,1,m)[0]},getInt16:function(m){var M=V(this,2,m,arguments[1]);return(M[1]<<8|M[0])<<16>>16},getUint16:function(m){var M=V(this,2,m,arguments[1]);return M[1]<<8|M[0]},getInt32:function(m){return B(V(this,4,m,arguments[1]))},getUint32:function(m){return B(V(this,4,m,arguments[1]))>>>0},getFloat32:function(m){return U(V(this,4,m,arguments[1]),23,4)},getFloat64:function(m){return U(V(this,8,m,arguments[1]),52,8)},setInt8:function(m,M){K(this,1,m,L,M)},setUint8:function(m,M){K(this,1,m,L,M)},setInt16:function(m,M){K(this,2,m,D,M,arguments[2])},setUint16:function(m,M){K(this,2,m,D,M,arguments[2])},setInt32:function(m,M){K(this,4,m,Y,M,arguments[2])},setUint32:function(m,M){K(this,4,m,Y,M,arguments[2])},setFloat32:function(m,M){K(this,4,m,x,M,arguments[2])},setFloat64:function(m,M){K(this,8,m,C,M,arguments[2])}});pe(ve,"ArrayBuffer"),pe(be,"DataView"),oe(be[de],ie.VIEW,!0),M.ArrayBuffer=ve,M.DataView=be},function(m,M,z){var $=z(5),te=z(26),re=z(7)("species");m.exports=function(m,M){var z,ie=$(m).constructor;return void 0===ie||null==(z=$(ie)[re])?M:te(z)}},function(m,M,z){"use strict";var $=z(5);m.exports=function(){var m=$(this),M="";return m.global&&(M+="g"),m.ignoreCase&&(M+="i"),m.multiline&&(M+="m"),m.unicode&&(M+="u"),m.sticky&&(M+="y"),M}},function(m,M,z){"use strict";var $=z(14),te=z(34),re=z(12);m.exports=function(m){for(var M=$(this),z=re(M.length),ie=arguments.length,oe=te(ie>1?arguments[1]:void 0,z),se=ie>2?arguments[2]:void 0,ae=void 0===se?z:te(se,z);ae>oe;)M[oe++]=m;return M}},function(m,M,z){var $=z(65),te=z(7)("iterator"),re=z(53);m.exports=z(37).getIteratorMethod=function(m){if(null!=m)return m[te]||m["@@iterator"]||re[$(m)]}},function(m,M,z){var $=z(53),te=z(7)("iterator"),re=Array.prototype;m.exports=function(m){return void 0!==m&&($.Array===m||re[te]===m)}},function(m,M,z){var $=z(7)("match");m.exports=function(m){var M=/./;try{"/./"[m](M)}catch(z){try{return M[$]=!1,!"/./"[m](M)}catch(m){}}return!0}},function(m,M,z){var $=z(4),te=z(25),re=z(7)("match");m.exports=function(m){var M;return $(m)&&(void 0!==(M=m[re])?!!M:"RegExp"==te(m))}},function(m,M,z){var $=z(81),te=z(28);m.exports=function(m,M,z){if($(M))throw TypeError("String#"+z+" doesn't accept regex!");return String(te(m))}},function(m,M,z){"use strict";var $=z(43),te=z(0),re=z(15),ie=z(18),oe=z(53),se=z(133),ae=z(44),ue=z(31),ce=z(7)("iterator"),le=!([].keys&&"next"in[].keys()),_=function(){return this};m.exports=function(m,M,z,fe,he,_e,ye){se(z,M,fe);var pe,de,ge,S=function(m){if(!le&&m in Se)return Se[m];switch(m){case"keys":case"values":return function(){return new z(this,m)}}return function(){return new z(this,m)}},ve=M+" Iterator",be="values"==he,me=!1,Se=m.prototype,Ee=Se[ce]||Se["@@iterator"]||he&&Se[he],Re=Ee||S(he),Fe=he?be?S("entries"):Re:void 0,je="Array"==M&&Se.entries||Ee;if(je&&(ge=ue(je.call(new m)))!==Object.prototype&&ge.next&&(ae(ge,ve,!0),$||"function"==typeof ge[ce]||ie(ge,ce,_)),be&&Ee&&"values"!==Ee.name&&(me=!0,Re=function(){return Ee.call(this)}),$&&!ye||!le&&!me&&Se[ce]||ie(Se,ce,Re),oe[M]=Re,oe[ve]=_,he)if(pe={values:be?Re:S("values"),keys:_e?Re:S("keys"),entries:Fe},ye)for(de in pe)de in Se||re(Se,de,pe[de]);else te(te.P+te.F*(le||me),M,pe);return pe}},function(m,M){var z=Math.expm1;m.exports=!z||z(10)>22025.465794806718||z(10)<22025.465794806718||-2e-17!=z(-2e-17)?function(m){return 0==(m=+m)?m:m>-1e-6&&m<1e-6?m+m*m/2:Math.exp(m)-1}:z},function(m,M){m.exports=Math.sign||function(m){return 0==(m=+m)||m!=m?m:m<0?-1:1}},function(m,M,z){var $=z(4),te=z(88).set;m.exports=function(m,M,z){var re,ie=M.constructor;return ie!==z&&"function"==typeof ie&&(re=ie.prototype)!==z.prototype&&$(re)&&te&&te(m,re),m}},function(m,M){m.exports="\t\n\v\f\r   ᠎             　\u2028\u2029\ufeff"},function(m,M,z){var $=z(4),te=z(5),o=function(m,M){if(te(m),!$(M)&&null!==M)throw TypeError(M+": can't set as prototype!")};m.exports={set:Object.setPrototypeOf||("__proto__"in{}?function(m,M,$){try{($=z(27)(Function.call,z(23).f(Object.prototype,"__proto__").set,2))(m,[]),M=!(m instanceof Array)}catch(m){M=!0}return function(m,z){return o(m,z),M?m.__proto__=z:$(m,z),m}}({},!1):void 0),check:o}},function(m,M,z){var $=z(6).document;m.exports=$&&$.documentElement},function(m,M,z){var $=z(25);m.exports=Array.isArray||function(m){return"Array"==$(m)}},function(m,M){m.exports="constructor,hasOwnProperty,isPrototypeOf,propertyIsEnumerable,toLocaleString,toString,valueOf".split(",")},function(m,M,z){var $=z(94)("keys"),te=z(35);m.exports=function(m){return $[m]||($[m]=te(m))}},function(m,M,z){var $=z(21),te=z(12),re=z(34);m.exports=function(m){return function(M,z,ie){var oe,se=$(M),ae=te(se.length),ue=re(ie,ae);if(m&&z!=z){for(;ae>ue;)if((oe=se[ue++])!=oe)return!0}else for(;ae>ue;ue++)if((m||ue in se)&&se[ue]===z)return m||ue||0;return!m&&-1}}},function(m,M,z){var $=z(6),te=$["__core-js_shared__"]||($["__core-js_shared__"]={});m.exports=function(m){return te[m]||(te[m]={})}},function(m,M,z){var $=z(4),te=z(6).document,re=$(te)&&$(te.createElement);m.exports=function(m){return re?te.createElement(m):{}}},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.ExtensionRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(8),oe=z(10),se=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.CallExtension));return $._targetController=1,$._extCmd=m,$._params=M,$._room=z,null==$._params&&($._params=new ie.SFSObject),Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_CMD",get:function(){return"c"}},{key:"KEY_PARAMS",get:function(){return"p"}},{key:"KEY_ROOM",get:function(){return"r"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null!=this._extCmd&&0!==this._extCmd.length||M.push("Missing extension command"),null==this._params||this._params instanceof ie.SFSObject||M.push("Custom parameters must be set in a SFSObject class instance"),null==this._room||this._room instanceof oe.SFSRoom||M.push("Room must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("ExtensionRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_CMD,this._extCmd),this._reqObj.putInt(t.KEY_ROOM,null==this._room?-1:this._room.id),this._reqObj.putSFSObject(t.KEY_PARAMS,this._params)}}]),t}();M.ExtensionRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SetBuddyVariablesRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(8),oe=z(46),se=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.SetBuddyVariables));return M._buddyVariables=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_BUDDY_NAME",get:function(){return"bn"}},{key:"KEY_BUDDY_VARS",get:function(){return"bv"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.buddyManager.isInited||M.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),!1===m.buddyManager.getMyOnlineState()&&M.push("Can't set Buddy Variables while you are offline in the Buddy List system"),null==this._buddyVariables?M.push("No Buddy Variables specified"):this._buddyVariables instanceof Array?0===this._buddyVariables.length?M.push("No Buddy Variables specified"):this._buddyVariables.every((function(m){return m instanceof oe.SFSBuddyVariable}))||M.push("Buddy Variables must be passed as instances of SFSBuddyVariable class"):M.push("Buddy Variables must be passed in an array"),M.length>0)throw new re.SFSValidationError("SetBuddyVariablesRequest Error",M)}},{key:"execute",value:function(m){var M=new ie.SFSArray,z=!0,$=!1,te=void 0;try{for(var re,oe=this._buddyVariables[Symbol.iterator]();!(z=(re=oe.next()).done);z=!0){var se=re.value;M.addSFSArray(se.toSFSArray())}}catch(m){$=!0,te=m}finally{try{!z&&oe.return&&oe.return()}finally{if($)throw te}}this._reqObj.putSFSArray(t.KEY_BUDDY_VARS,M)}}]),t}();M.SetBuddyVariablesRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.GoOnlineRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.GoOnline));return M._online=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ONLINE",get:function(){return"o"}},{key:"KEY_BUDDY_NAME",get:function(){return"bn"}},{key:"KEY_BUDDY_ID",get:function(){return"bi"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.buddyManager.isInited||M.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),M.length>0)throw new re.SFSValidationError("GoOnlineRequest Error",M)}},{key:"execute",value:function(m){m.buddyManager._setMyOnlineState(this._online),this._reqObj.putBool(t.KEY_ONLINE,this._online)}}]),t}();M.GoOnlineRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.BlockBuddyRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m,M){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var z=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.BlockBuddy));return z._name=m,z._blocked=M,Object.seal(z),z}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_BUDDY_NAME",get:function(){return"bn"}},{key:"KEY_BUDDY_BLOCK_STATE",get:function(){return"bs"}},{key:"KEY_BUDDY",get:function(){return"bd"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.buddyManager.isInited||M.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),!1===m.buddyManager.getMyOnlineState()&&M.push("Can't block a buddy while you are offline in the Buddy List system"),null==this._name||this._name.length<1)M.push("Invalid buddy name (null or empty string)");else{var z=m.buddyManager.getBuddyByName(this._name);null==z?M.push("Can't block buddy '"+this._name+"' because it isn't in your list"):z.isBlocked==this._blocked&&M.push("Block flag is already in the requested '"+this._blocked+"' state for buddy '"+this._name+"'")}if(M.length>0)throw new re.SFSValidationError("BlockBuddyRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_BUDDY_NAME,this._name),this._reqObj.putBool(t.KEY_BUDDY_BLOCK_STATE,this._blocked)}}]),t}();M.BlockBuddyRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.RemoveBuddyRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.RemoveBuddy));return M._name=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_BUDDY_NAME",get:function(){return"bn"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.buddyManager.isInited||M.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),!1===m.buddyManager.getMyOnlineState()&&M.push("Can't remove a buddy while you are offline in the Buddy List system"),null==this._name||this._name.length<1?M.push("Invalid buddy name (null or empty string)"):m.buddyManager.containsBuddy(this._name)||M.push("Can't remove buddy '"+this._name+"' because it isn't in your list"),M.length>0)throw new re.SFSValidationError("RemoveBuddyRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_BUDDY_NAME,this._name)}}]),t}();M.RemoveBuddyRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.AddBuddyRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.AddBuddy));return M._name=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_BUDDY_NAME",get:function(){return"bn"}}]),$(t,[{key:"validate",value:function(m){var M=[];m.buddyManager.isInited||M.push("Buddy List not yet initialized; please send an InitBuddyRequest first"),(null==this._name||this._name.length<1)&&M.push("Invalid buddy name (null or empty string)"),!1===m.buddyManager.getMyOnlineState()&&M.push("Can't add a buddy while you are offline in the Buddy List system");var z=m.buddyManager.getBuddyByName(this._name);if(null==z||z.isTemp||M.push("Can't add buddy '"+this._name+"' because it is already in your list"),M.length>0)throw new re.SFSValidationError("AddBuddyRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_BUDDY_NAME,this._name)}}]),t}();M.AddBuddyRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.InitBuddyListRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var m=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.InitBuddyList));return Object.seal(m),m}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_BLIST",get:function(){return"bl"}},{key:"KEY_BUDDY_STATES",get:function(){return"bs"}},{key:"KEY_MY_VARS",get:function(){return"mv"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.buddyManager.isInited&&M.push("Buddy List is already initialized"),M.length>0)throw new re.SFSValidationError("InitBuddyListRequest Error",M)}},{key:"execute",value:function(m){}}]),t}();M.InitBuddyListRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SetUserPositionRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(8),oe=z(10),se=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var z=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.SetUserPosition));return z._pos=m,z._room=M,Object.seal(z),z}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_VEC3D",get:function(){return"v"}},{key:"KEY_PLUS_USER_LIST",get:function(){return"p"}},{key:"KEY_MINUS_USER_LIST",get:function(){return"m"}},{key:"KEY_PLUS_ITEM_LIST",get:function(){return"q"}},{key:"KEY_MINUS_ITEM_LIST",get:function(){return"n"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null!=this._pos&&this._pos instanceof ie.Vec3D||M.push("Position must be an instance of Vec3D class"),null==this._room&&(this._room=m.lastJoinedRoom),null==this._room&&M.push("You are not joined in any room"),this._room instanceof oe.MMORoom||M.push("Target room must be an instance of MMORoom class"),M.length>0)throw new re.SFSValidationError("SetUserPosition Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_ROOM,this._room.id),this._pos.isFloat?this._reqObj.putFloatArray(t.KEY_VEC3D,this._pos.toArray()):this._reqObj.putIntArray(t.KEY_VEC3D,this._pos.toArray())}}]),t}();M.SetUserPositionRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.FindUsersRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=z(45),se=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.FindUsers));return $._matchExpr=m,$._target=M,$._limit=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_EXPRESSION",get:function(){return"e"}},{key:"KEY_GROUP",get:function(){return"g"}},{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_LIMIT",get:function(){return"l"}},{key:"KEY_FILTERED_USERS",get:function(){return"fu"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._matchExpr&&M.push("Missing match expression"),null==this._matchExpr||this._matchExpr instanceof oe.MatchExpression||M.push("Match expression must be passed as an instance of MatchExpression class"),M.length>0)throw new re.SFSValidationError("FindUsersRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putSFSArray(t.KEY_EXPRESSION,this._matchExpr.toSFSArray()),null!=this._target&&(this._target instanceof ie.SFSRoom?this._reqObj.putInt(t.KEY_ROOM,this._target.id):"string"==typeof this._target?this._reqObj.putUtfString(t.KEY_GROUP,this._target):this._logger.warn("Unsupported target type for FindUsersRequest: "+this._target)),this._limit>0&&this._reqObj.putShort(t.KEY_LIMIT,this._limit)}}]),t}();M.FindUsersRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.FindRoomsRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(45),oe=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.FindRooms));return $._matchExpr=m,$._groupId=M,$._limit=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_EXPRESSION",get:function(){return"e"}},{key:"KEY_GROUP",get:function(){return"g"}},{key:"KEY_LIMIT",get:function(){return"l"}},{key:"KEY_FILTERED_ROOMS",get:function(){return"fr"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._matchExpr&&M.push("Missing match expression"),null==this._matchExpr||this._matchExpr instanceof ie.MatchExpression||M.push("Match expression must be passed as an instance of MatchExpression class"),M.length>0)throw new re.SFSValidationError("FindRoomsRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putSFSArray(t.KEY_EXPRESSION,this._matchExpr.toSFSArray()),null!=this._groupId&&this._reqObj.putUtfString(t.KEY_GROUP,this._groupId),this._limit>0&&this._reqObj.putShort(t.KEY_LIMIT,this._limit)}}]),t}();M.FindRoomsRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.PlayerToSpectatorRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.PlayerToSpectator));return M._room=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM_ID",get:function(){return"r"}},{key:"KEY_USER_ID",get:function(){return"u"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.getJoinedRooms().length<1&&M.push("You are not joined in any Room"),null==this._room||this._room instanceof ie.SFSRoom||M.push("Target Room must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("PlayerToSpectatorRequest Error",M)}},{key:"execute",value:function(m){null==this._room&&(this._room=m.lastJoinedRoom),this._reqObj.putInt(t.KEY_ROOM_ID,this._room.id)}}]),t}();M.PlayerToSpectatorRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SpectatorToPlayerRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.SpectatorToPlayer));return M._room=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM_ID",get:function(){return"r"}},{key:"KEY_USER_ID",get:function(){return"u"}},{key:"KEY_PLAYER_ID",get:function(){return"p"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.getJoinedRooms().length<1&&M.push("You are not joined in any Room"),null==this._room||this._room instanceof ie.SFSRoom||M.push("Target Room must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("SpectatorToPlayerRequest Error",M)}},{key:"execute",value:function(m){null==this._room&&(this._room=m.lastJoinedRoom),this._reqObj.putInt(t.KEY_ROOM_ID,this._room.id)}}]),t}();M.SpectatorToPlayerRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.UnsubscribeRoomGroupRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.UnsubscribeRoomGroup));return M._groupId=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_GROUP_ID",get:function(){return"g"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null!=this._groupId&&0!==this._groupId.length||M.push("Invalid group id passed; must be a string with at least one character"),M.length>0)throw new re.SFSValidationError("UnsubscribeGroupRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_GROUP_ID,this._groupId)}}]),t}();M.UnsubscribeRoomGroupRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SubscribeRoomGroupRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.SubscribeRoomGroup));return M._groupId=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_GROUP_ID",get:function(){return"g"}},{key:"KEY_ROOM_LIST",get:function(){return"rl"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null!=this._groupId&&0!==this._groupId.length||M.push("Invalid group id passed; must be a string with at least one character"),M.length>0)throw new re.SFSValidationError("SubscribeGroupRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_GROUP_ID,this._groupId)}}]),t}();M.SubscribeRoomGroupRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SetUserVariablesRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(8),oe=z(58),se=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.SetUserVariables));return M._userVariables=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_USER",get:function(){return"u"}},{key:"KEY_VAR_LIST",get:function(){return"vl"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._userVariables?M.push("No User Variables specified"):this._userVariables instanceof Array?0===this._userVariables.length?M.push("No User Variables specified"):this._userVariables.every((function(m){return m instanceof oe.SFSUserVariable}))||M.push("User Variables must be passed as instances of SFSUserVariable class"):M.push("User Variables must be passed in an array"),M.length>0)throw new re.SFSValidationError("SetUserVariablesRequest Error",M)}},{key:"execute",value:function(m){var M=new ie.SFSArray,z=!0,$=!1,te=void 0;try{for(var re,oe=this._userVariables[Symbol.iterator]();!(z=(re=oe.next()).done);z=!0){var se=re.value;M.addSFSArray(se.toSFSArray())}}catch(m){$=!0,te=m}finally{try{!z&&oe.return&&oe.return()}finally{if($)throw te}}this._reqObj.putSFSArray(t.KEY_VAR_LIST,M)}}]),t}();M.SetUserVariablesRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SetRoomVariablesRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(8),oe=z(10),se=z(49),ae=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var z=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.SetRoomVariables));return z._roomVariables=m,z._room=M,Object.seal(z),z}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_VAR_ROOM",get:function(){return"r"}},{key:"KEY_VAR_LIST",get:function(){return"vl"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._room&&(this._room=m.lastJoinedRoom),null==this._room?M.push("You must be joined in a Room to send a message"):this._room instanceof oe.SFSRoom?m.getJoinedRooms().indexOf(this._room)<0&&M.push("You are not joined in the target Room: "+this._room):M.push("Target Room must be an instance of SFSRoom class"),null==this._roomVariables?M.push("No Room Variables specified"):this._roomVariables instanceof Array?0===this._roomVariables.length?M.push("No Room Variables specified"):this._roomVariables.every((function(m){return m instanceof se.SFSRoomVariable}))||M.push("Room Variables must be passed as instances of SFSRoomVariable class"):M.push("Room Variables must be passed in an array"),M.length>0)throw new re.SFSValidationError("SetRoomVariablesRequest Error",M)}},{key:"execute",value:function(m){var M=new ie.SFSArray,z=!0,$=!1,te=void 0;try{for(var re,oe=this._roomVariables[Symbol.iterator]();!(z=(re=oe.next()).done);z=!0){var se=re.value;M.addSFSArray(se.toSFSArray())}}catch(m){$=!0,te=m}finally{try{!z&&oe.return&&oe.return()}finally{if($)throw te}}this._reqObj.putSFSArray(t.KEY_VAR_LIST,M),this._reqObj.putInt(t.KEY_VAR_ROOM,this._room.id)}}]),t}();M.SetRoomVariablesRequest=ae},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.ChangeRoomCapacityRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(m,M,z){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.ChangeRoomCapacity));return $._room=m,$._newMaxUsers=M,$._newMaxSpect=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_USER_SIZE",get:function(){return"u"}},{key:"KEY_SPEC_SIZE",get:function(){return"s"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(this._room instanceof ie.SFSRoom||M.push("Room must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("ChangeRoomCapacityRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_ROOM,this._room.id),this._reqObj.putInt(t.KEY_USER_SIZE,this._newMaxUsers),this._reqObj.putInt(t.KEY_SPEC_SIZE,this._newMaxSpect)}}]),t}();M.ChangeRoomCapacityRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.ChangeRoomPasswordStateRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(m,M){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var z=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.ChangeRoomPassword));return z._room=m,z._newPass=M,Object.seal(z),z}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_PASS",get:function(){return"p"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(this._room instanceof ie.SFSRoom||M.push("Room must be an instance of SFSRoom class"),null==this._newPass&&M.push("New room password must be a non-null string (empty string to remove the password)"),M.length>0)throw new re.SFSValidationError("ChangeRoomPasswordStateRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_ROOM,this._room.id),this._reqObj.putUtfString(t.KEY_PASS,this._newPass)}}]),t}();M.ChangeRoomPasswordStateRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.ChangeRoomNameRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(m,M){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var z=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.ChangeRoomName));return z._room=m,z._newName=M,Object.seal(z),z}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_NAME",get:function(){return"n"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(this._room instanceof ie.SFSRoom||M.push("Room must be an instance of SFSRoom class"),null!=this._newName&&0!==this._newName.length||M.push("New room name must be a non-null and non-empty string"),M.length>0)throw new re.SFSValidationError("ChangeRoomNameRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_ROOM,this._room.id),this._reqObj.putUtfString(t.KEY_NAME,this._newName)}}]),t}();M.ChangeRoomNameRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.JoinRoomRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,$=arguments.length>3&&void 0!==arguments[3]&&arguments[3];!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var re=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.JoinRoom));return"string"==typeof m?re._rName=m:"number"==typeof m?re._rId=m:m instanceof ie.SFSRoom&&(re._rId=m.id,re._rName=m.name),re._password=M,re._roomIdToLeave=z,re._asSpectator=$,Object.seal(re),re}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM",get:function(){return"r"}},{key:"KEY_USER_LIST",get:function(){return"ul"}},{key:"KEY_ROOM_NAME",get:function(){return"n"}},{key:"KEY_ROOM_ID",get:function(){return"i"}},{key:"KEY_PASS",get:function(){return"p"}},{key:"KEY_ROOM_TO_LEAVE",get:function(){return"rl"}},{key:"KEY_AS_SPECTATOR",get:function(){return"sp"}}]),$(t,[{key:"validate",value:function(m){if(null==this._rId&&null==this._rName)throw new re.SFSValidationError("JoinRoomRequest Error",["Missing Room id or name, please provide one of the two or an existing SFSRoom object"])}},{key:"execute",value:function(m){m._isJoining=!0,this._rId>=0?this._reqObj.putInt(t.KEY_ROOM_ID,this._rId):null!=this._rName&&this._reqObj.putUtfString(t.KEY_ROOM_NAME,this._rName),null!=this._password&&this._reqObj.putUtfString(t.KEY_PASS,this._password),null!=this._roomIdToLeave&&this._reqObj.putInt(t.KEY_ROOM_TO_LEAVE,this._roomIdToLeave),this._asSpectator&&this._reqObj.putBool(t.KEY_AS_SPECTATOR,this._asSpectator)}}]),t}();M.JoinRoomRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.LogoutRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var m=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.Logout));return Object.seal(m),m}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ZONE_NAME",get:function(){return"zn"}}]),$(t,[{key:"validate",value:function(m){if(null==m.mySelf)throw new re.SFSValidationError("LogoutRequest error",["You are not logged in"])}},{key:"execute",value:function(m){}}]),t}();M.LogoutRequest=ie},function(m,M,z){"use strict";z.r(M),z.d(M,"MD5",(function(){return r}));var r=function(){this.hexcase=0,this.b64pad=""};r.prototype={},r.prototype.hex_md5=function(m){return this.rstr2hex(this.rstr_md5(this.str2rstr_utf8(m)))},r.prototype.b64_md5=function(m){return this.rstr2b64(this.rstr_md5(this.str2rstr_utf8(m)))},r.prototype.any_md5=function(m,M){return this.rstr2any(this.rstr_md5(this.str2rstr_utf8(m)),M)},r.prototype.hex_hmac_md5=function(m,M){return this.rstr2hex(this.rstr_hmac_md5(this.str2rstr_utf8(m),this.str2rstr_utf8(M)))},r.prototype.b64_hmac_md5=function(m,M){return this.rstr2b64(this.rstr_hmac_md5(this.str2rstr_utf8(m),this.str2rstr_utf8(M)))},r.prototype.any_hmac_md5=function(m,M,z){return this.rstr2any(this.rstr_hmac_md5(this.str2rstr_utf8(m),this.str2rstr_utf8(M)),z)},r.prototype.md5_vm_test=function(){return"900150983cd24fb0d6963f7d28e17f72"==this.hex_md5("abc").toLowerCase()},r.prototype.rstr_md5=function(m){return this.binl2rstr(this.binl_md5(this.rstr2binl(m),8*m.length))},r.prototype.rstr_hmac_md5=function(m,M){var z=this.rstr2binl(m);z.length>16&&(z=this.binl_md5(z,8*m.length));for(var $=Array(16),te=Array(16),re=0;re<16;re++)$[re]=909522486^z[re],te[re]=1549556828^z[re];var ie=this.binl_md5($.concat(this.rstr2binl(M)),512+8*M.length);return this.binl2rstr(this.binl_md5(te.concat(ie),640))},r.prototype.rstr2hex=function(m){try{this.hexcase}catch(m){this.hexcase=0}for(var M,z=this.hexcase?"0123456789ABCDEF":"0123456789abcdef",$="",te=0;te<m.length;te++)M=m.charCodeAt(te),$+=z.charAt(M>>>4&15)+z.charAt(15&M);return $},r.prototype.rstr2b64=function(m){try{this.b64pad}catch(m){this.b64pad=""}for(var M="",z=m.length,$=0;$<z;$+=3)for(var te=m.charCodeAt($)<<16|($+1<z?m.charCodeAt($+1)<<8:0)|($+2<z?m.charCodeAt($+2):0),re=0;re<4;re++)8*$+6*re>8*m.length?M+=this.b64pad:M+="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(te>>>6*(3-re)&63);return M},r.prototype.rstr2any=function(m,M){var z,$,te,re,ie,oe=M.length,se=Array(Math.ceil(m.length/2));for(z=0;z<se.length;z++)se[z]=m.charCodeAt(2*z)<<8|m.charCodeAt(2*z+1);var ae=Math.ceil(8*m.length/(Math.log(M.length)/Math.log(2))),ue=Array(ae);for($=0;$<ae;$++){for(ie=Array(),re=0,z=0;z<se.length;z++)re=(re<<16)+se[z],re-=(te=Math.floor(re/oe))*oe,(ie.length>0||te>0)&&(ie[ie.length]=te);ue[$]=re,se=ie}var ce="";for(z=ue.length-1;z>=0;z--)ce+=M.charAt(ue[z]);return ce},r.prototype.str2rstr_utf8=function(m){for(var M,z,$="",te=-1;++te<m.length;)M=m.charCodeAt(te),z=te+1<m.length?m.charCodeAt(te+1):0,55296<=M&&M<=56319&&56320<=z&&z<=57343&&(M=65536+((1023&M)<<10)+(1023&z),te++),M<=127?$+=String.fromCharCode(M):M<=2047?$+=String.fromCharCode(192|M>>>6&31,128|63&M):M<=65535?$+=String.fromCharCode(224|M>>>12&15,128|M>>>6&63,128|63&M):M<=2097151&&($+=String.fromCharCode(240|M>>>18&7,128|M>>>12&63,128|M>>>6&63,128|63&M));return $},r.prototype.str2rstr_utf16le=function(m){for(var M="",z=0;z<m.length;z++)M+=String.fromCharCode(255&m.charCodeAt(z),m.charCodeAt(z)>>>8&255);return M},r.prototype.str2rstr_utf16be=function(m){for(var M="",z=0;z<m.length;z++)M+=String.fromCharCode(m.charCodeAt(z)>>>8&255,255&m.charCodeAt(z));return M},r.prototype.rstr2binl=function(m){for(var M=Array(m.length>>2),z=0;z<M.length;z++)M[z]=0;for(z=0;z<8*m.length;z+=8)M[z>>5]|=(255&m.charCodeAt(z/8))<<z%32;return M},r.prototype.binl2rstr=function(m){for(var M="",z=0;z<32*m.length;z+=8)M+=String.fromCharCode(m[z>>5]>>>z%32&255);return M},r.prototype.binl_md5=function(m,M){m[M>>5]|=128<<M%32,m[14+(M+64>>>9<<4)]=M;for(var z=1732584193,$=-271733879,te=-1732584194,re=271733878,ie=0;ie<m.length;ie+=16){var oe=z,se=$,ae=te,ue=re;z=this.md5_ff(z,$,te,re,m[ie+0],7,-680876936),re=this.md5_ff(re,z,$,te,m[ie+1],12,-389564586),te=this.md5_ff(te,re,z,$,m[ie+2],17,606105819),$=this.md5_ff($,te,re,z,m[ie+3],22,-1044525330),z=this.md5_ff(z,$,te,re,m[ie+4],7,-176418897),re=this.md5_ff(re,z,$,te,m[ie+5],12,1200080426),te=this.md5_ff(te,re,z,$,m[ie+6],17,-1473231341),$=this.md5_ff($,te,re,z,m[ie+7],22,-45705983),z=this.md5_ff(z,$,te,re,m[ie+8],7,1770035416),re=this.md5_ff(re,z,$,te,m[ie+9],12,-1958414417),te=this.md5_ff(te,re,z,$,m[ie+10],17,-42063),$=this.md5_ff($,te,re,z,m[ie+11],22,-1990404162),z=this.md5_ff(z,$,te,re,m[ie+12],7,1804603682),re=this.md5_ff(re,z,$,te,m[ie+13],12,-40341101),te=this.md5_ff(te,re,z,$,m[ie+14],17,-1502002290),$=this.md5_ff($,te,re,z,m[ie+15],22,1236535329),z=this.md5_gg(z,$,te,re,m[ie+1],5,-165796510),re=this.md5_gg(re,z,$,te,m[ie+6],9,-1069501632),te=this.md5_gg(te,re,z,$,m[ie+11],14,643717713),$=this.md5_gg($,te,re,z,m[ie+0],20,-373897302),z=this.md5_gg(z,$,te,re,m[ie+5],5,-701558691),re=this.md5_gg(re,z,$,te,m[ie+10],9,38016083),te=this.md5_gg(te,re,z,$,m[ie+15],14,-660478335),$=this.md5_gg($,te,re,z,m[ie+4],20,-405537848),z=this.md5_gg(z,$,te,re,m[ie+9],5,568446438),re=this.md5_gg(re,z,$,te,m[ie+14],9,-1019803690),te=this.md5_gg(te,re,z,$,m[ie+3],14,-187363961),$=this.md5_gg($,te,re,z,m[ie+8],20,1163531501),z=this.md5_gg(z,$,te,re,m[ie+13],5,-1444681467),re=this.md5_gg(re,z,$,te,m[ie+2],9,-51403784),te=this.md5_gg(te,re,z,$,m[ie+7],14,1735328473),$=this.md5_gg($,te,re,z,m[ie+12],20,-1926607734),z=this.md5_hh(z,$,te,re,m[ie+5],4,-378558),re=this.md5_hh(re,z,$,te,m[ie+8],11,-2022574463),te=this.md5_hh(te,re,z,$,m[ie+11],16,1839030562),$=this.md5_hh($,te,re,z,m[ie+14],23,-35309556),z=this.md5_hh(z,$,te,re,m[ie+1],4,-1530992060),re=this.md5_hh(re,z,$,te,m[ie+4],11,1272893353),te=this.md5_hh(te,re,z,$,m[ie+7],16,-155497632),$=this.md5_hh($,te,re,z,m[ie+10],23,-1094730640),z=this.md5_hh(z,$,te,re,m[ie+13],4,681279174),re=this.md5_hh(re,z,$,te,m[ie+0],11,-358537222),te=this.md5_hh(te,re,z,$,m[ie+3],16,-722521979),$=this.md5_hh($,te,re,z,m[ie+6],23,76029189),z=this.md5_hh(z,$,te,re,m[ie+9],4,-640364487),re=this.md5_hh(re,z,$,te,m[ie+12],11,-421815835),te=this.md5_hh(te,re,z,$,m[ie+15],16,530742520),$=this.md5_hh($,te,re,z,m[ie+2],23,-995338651),z=this.md5_ii(z,$,te,re,m[ie+0],6,-198630844),re=this.md5_ii(re,z,$,te,m[ie+7],10,1126891415),te=this.md5_ii(te,re,z,$,m[ie+14],15,-1416354905),$=this.md5_ii($,te,re,z,m[ie+5],21,-57434055),z=this.md5_ii(z,$,te,re,m[ie+12],6,1700485571),re=this.md5_ii(re,z,$,te,m[ie+3],10,-1894986606),te=this.md5_ii(te,re,z,$,m[ie+10],15,-1051523),$=this.md5_ii($,te,re,z,m[ie+1],21,-2054922799),z=this.md5_ii(z,$,te,re,m[ie+8],6,1873313359),re=this.md5_ii(re,z,$,te,m[ie+15],10,-30611744),te=this.md5_ii(te,re,z,$,m[ie+6],15,-1560198380),$=this.md5_ii($,te,re,z,m[ie+13],21,1309151649),z=this.md5_ii(z,$,te,re,m[ie+4],6,-145523070),re=this.md5_ii(re,z,$,te,m[ie+11],10,-1120210379),te=this.md5_ii(te,re,z,$,m[ie+2],15,718787259),$=this.md5_ii($,te,re,z,m[ie+9],21,-343485551),z=this.safe_add(z,oe),$=this.safe_add($,se),te=this.safe_add(te,ae),re=this.safe_add(re,ue)}return Array(z,$,te,re)},r.prototype.md5_cmn=function(m,M,z,$,te,re){return this.safe_add(this.bit_rol(this.safe_add(this.safe_add(M,m),this.safe_add($,re)),te),z)},r.prototype.md5_ff=function(m,M,z,$,te,re,ie){return this.md5_cmn(M&z|~M&$,m,M,te,re,ie)},r.prototype.md5_gg=function(m,M,z,$,te,re,ie){return this.md5_cmn(M&$|z&~$,m,M,te,re,ie)},r.prototype.md5_hh=function(m,M,z,$,te,re,ie){return this.md5_cmn(M^z^$,m,M,te,re,ie)},r.prototype.md5_ii=function(m,M,z,$,te,re,ie){return this.md5_cmn(z^(M|~$),m,M,te,re,ie)},r.prototype.safe_add=function(m,M){var z=(65535&m)+(65535&M);return(m>>16)+(M>>16)+(z>>16)<<16|65535&z},r.prototype.bit_rol=function(m,M){return m<<M|m>>>32-M}},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.LoginRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(117),re=z(2),ie=z(1),oe=z(8),se=function(m){function t(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var te=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,re.Requests.Login));return te._userName=m,te._password=M,te._params=z,te._zoneName=$,Object.seal(te),te}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,re.BaseRequest),$(t,null,[{key:"KEY_ZONE_NAME",get:function(){return"zn"}},{key:"KEY_USER_NAME",get:function(){return"un"}},{key:"KEY_PASSWORD",get:function(){return"pw"}},{key:"KEY_PARAMS",get:function(){return"p"}},{key:"KEY_PRIVILEGE_ID",get:function(){return"pi"}},{key:"KEY_ID",get:function(){return"id"}},{key:"KEY_ROOMLIST",get:function(){return"rl"}},{key:"KEY_RECONNECTION_SECONDS",get:function(){return"rs"}}]),$(t,[{key:"validate",value:function(m){if(null!=m.mySelf)throw new ie.SFSValidationError("LoginRequest error",["You are already logged in; logout before attempting a new login"]);var M=[],z=null!=m.config&&null!=m.config.zone?m.config.zone:null;if(null!=this._zoneName&&(z=this._zoneName),null==z||0===z.length?M.push("Missing Zone name"):this._zoneName=z,null==this._params||this._params instanceof oe.SFSObject||M.push("Custom parameters must be passed in a SFSObject"),M.length>0)throw new ie.SFSValidationError("LoginRequest Error",M)}},{key:"execute",value:function(m){null==this._userName&&(this._userName=""),null==this._password&&(this._password=""),this._reqObj.putUtfString(t.KEY_ZONE_NAME,this._zoneName),this._reqObj.putUtfString(t.KEY_USER_NAME,this._userName),this._reqObj.putUtfString(t.KEY_PASSWORD,this._password.length>0?(new te.MD5).hex_md5(m.sessionToken+this._password):""),null!=this._params&&this._reqObj.putSFSObject(t.KEY_PARAMS,this._params)}}]),t}();M.LoginRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}();function i(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var te=function(){function e(m){i(this,e),this._sfs=m,this._usersById=new Map,this._usersByName=new Map}return $(e,[{key:"containsUserName",value:function(m){return this._usersByName.has(m)}},{key:"containsUserId",value:function(m){return this._usersById.has(m)}},{key:"containsUser",value:function(m){return this._usersById.has(m.id)}},{key:"getUserById",value:function(m){return this._usersById.get(m)}},{key:"getUserByName",value:function(m){return this._usersByName.get(m)}},{key:"getUserCount",value:function(){return this._usersById.size}},{key:"getUserList",value:function(){return Array.from(this._usersById.values())}},{key:"_addUser",value:function(m){this.__addUser(m)}},{key:"__addUser",value:function(m){this._usersByName.set(m.name,m),this._usersById.set(m.id,m)}},{key:"_removeUser",value:function(m){this._usersById.delete(m.id),this._usersByName.delete(m.name)}},{key:"_clearAll",value:function(){this._usersById.clear(),this._usersByName.clear()}}]),e}(),re=function(m){function t(m){i(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,m));return M._roomRefCount=new Map,Object.freeze(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te),$(t,[{key:"_addUser",value:function(m){this._roomRefCount.has(m)?this._roomRefCount.set(m,this._roomRefCount.get(m)+1):this._roomRefCount.set(m,1),this.__addUser(m)}},{key:"_removeUser",value:function(m){this._removeUserReference(m,!1)}},{key:"_removeUserReference",value:function(m,M){var z=this._roomRefCount.get(m);z<1&&null!=this._sfs?this._sfs.logger.warn("GlobalUserManager RefCount is already at zero. User: "+m):(this._roomRefCount.set(m,this._roomRefCount.get(m)-1),(0===z||M)&&(function e(m,M,z){null===m&&(m=Function.prototype);var $=Object.getOwnPropertyDescriptor(m,M);if(void 0===$){var te=Object.getPrototypeOf(m);return null===te?void 0:e(te,M,z)}if("value"in $)return $.value;var re=$.get;return void 0!==re?re.call(z):void 0}(t.prototype.__proto__||Object.getPrototypeOf(t.prototype),"_removeUser",this).call(this,m),this._roomRefCount.delete(m)))}}]),t}();M.SFSUserManager=te,M.GlobalUserManager=re},function(m,M,z){(function(m){var z,r=function(m,M,z){this._byteOffset=M||0,m instanceof ArrayBuffer?this.buffer=m:"object"==typeof m?(this.dataView=m,M&&(this._byteOffset+=M)):this.buffer=new ArrayBuffer(m||1),this.position=0,this.endianness=null==z?r.LITTLE_ENDIAN:z};r.prototype={},void 0===Uint8Array.prototype.BYTES_PER_ELEMENT&&(Uint8Array.prototype.BYTES_PER_ELEMENT=Uint8Array.BYTES_PER_ELEMENT,Int8Array.prototype.BYTES_PER_ELEMENT=Int8Array.BYTES_PER_ELEMENT,Uint8ClampedArray.prototype.BYTES_PER_ELEMENT=Uint8ClampedArray.BYTES_PER_ELEMENT,Uint16Array.prototype.BYTES_PER_ELEMENT=Uint16Array.BYTES_PER_ELEMENT,Int16Array.prototype.BYTES_PER_ELEMENT=Int16Array.BYTES_PER_ELEMENT,Uint32Array.prototype.BYTES_PER_ELEMENT=Uint32Array.BYTES_PER_ELEMENT,Int32Array.prototype.BYTES_PER_ELEMENT=Int32Array.BYTES_PER_ELEMENT,Float64Array.prototype.BYTES_PER_ELEMENT=Float64Array.BYTES_PER_ELEMENT),r.prototype.save=function(m){var M=new Blob(this.buffer),z=window.webkitURL||window.URL;if(!z||!z.createObjectURL)throw"DataStream.save: Can't create object URL.";var $=z.createObjectURL(M),te=document.createElement("a");te.setAttribute("href",$),te.setAttribute("download",m),te.click(),z.revokeObjectURL($)},r.BIG_ENDIAN=!1,r.LITTLE_ENDIAN=!0,r.prototype._dynamicSize=!0,Object.defineProperty(r.prototype,"dynamicSize",{get:function(){return this._dynamicSize},set:function(m){m||this._trimAlloc(),this._dynamicSize=m}}),r.prototype._byteLength=0,Object.defineProperty(r.prototype,"byteLength",{get:function(){return this._byteLength-this._byteOffset}}),Object.defineProperty(r.prototype,"buffer",{get:function(){return this._trimAlloc(),this._buffer},set:function(m){this._buffer=m,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(r.prototype,"byteOffset",{get:function(){return this._byteOffset},set:function(m){this._byteOffset=m,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._buffer.byteLength}}),Object.defineProperty(r.prototype,"dataView",{get:function(){return this._dataView},set:function(m){this._byteOffset=m.byteOffset,this._buffer=m.buffer,this._dataView=new DataView(this._buffer,this._byteOffset),this._byteLength=this._byteOffset+m.byteLength}}),r.prototype._realloc=function(m){if(this._dynamicSize){var M=this._byteOffset+this.position+m,z=this._buffer.byteLength;if(M<=z)M>this._byteLength&&(this._byteLength=M);else{for(z<1&&(z=1);M>z;)z*=2;var $=new ArrayBuffer(z),te=new Uint8Array(this._buffer);new Uint8Array($,0,te.length).set(te),this.buffer=$,this._byteLength=M}}},r.prototype._trimAlloc=function(){if(this._byteLength!=this._buffer.byteLength){var m=new ArrayBuffer(this._byteLength),M=new Uint8Array(m),z=new Uint8Array(this._buffer,0,M.length);M.set(z),this.buffer=m}},r.prototype.seek=function(m){var M=Math.max(0,Math.min(this.byteLength,m));this.position=isNaN(M)||!isFinite(M)?0:M},r.prototype.isEof=function(){return this.position>=this.byteLength},r.prototype.mapInt32Array=function(m,M){this._realloc(4*m);var z=new Int32Array(this._buffer,this.byteOffset+this.position,m);return r.arrayToNative(z,null==M?this.endianness:M),this.position+=4*m,z},r.prototype.mapInt16Array=function(m,M){this._realloc(2*m);var z=new Int16Array(this._buffer,this.byteOffset+this.position,m);return r.arrayToNative(z,null==M?this.endianness:M),this.position+=2*m,z},r.prototype.mapInt8Array=function(m){this._realloc(1*m);var M=new Int8Array(this._buffer,this.byteOffset+this.position,m);return this.position+=1*m,M},r.prototype.mapUint32Array=function(m,M){this._realloc(4*m);var z=new Uint32Array(this._buffer,this.byteOffset+this.position,m);return r.arrayToNative(z,null==M?this.endianness:M),this.position+=4*m,z},r.prototype.mapUint16Array=function(m,M){this._realloc(2*m);var z=new Uint16Array(this._buffer,this.byteOffset+this.position,m);return r.arrayToNative(z,null==M?this.endianness:M),this.position+=2*m,z},r.prototype.mapUint8Array=function(m){this._realloc(1*m);var M=new Uint8Array(this._buffer,this.byteOffset+this.position,m);return this.position+=1*m,M},r.prototype.mapFloat64Array=function(m,M){this._realloc(8*m);var z=new Float64Array(this._buffer,this.byteOffset+this.position,m);return r.arrayToNative(z,null==M?this.endianness:M),this.position+=8*m,z},r.prototype.mapFloat32Array=function(m,M){this._realloc(4*m);var z=new Float32Array(this._buffer,this.byteOffset+this.position,m);return r.arrayToNative(z,null==M?this.endianness:M),this.position+=4*m,z},r.prototype.readInt32Array=function(m,M){m=null==m?this.byteLength-this.position/4:m;var z=new Int32Array(m);return r.memcpy(z.buffer,0,this.buffer,this.byteOffset+this.position,m*z.BYTES_PER_ELEMENT),r.arrayToNative(z,null==M?this.endianness:M),this.position+=z.byteLength,z},r.prototype.readInt16Array=function(m,M){m=null==m?this.byteLength-this.position/2:m;var z=new Int16Array(m);return r.memcpy(z.buffer,0,this.buffer,this.byteOffset+this.position,m*z.BYTES_PER_ELEMENT),r.arrayToNative(z,null==M?this.endianness:M),this.position+=z.byteLength,z},r.prototype.readInt8Array=function(m){m=null==m?this.byteLength-this.position:m;var M=new Int8Array(m);return r.memcpy(M.buffer,0,this.buffer,this.byteOffset+this.position,m*M.BYTES_PER_ELEMENT),this.position+=M.byteLength,M},r.prototype.readUint32Array=function(m,M){m=null==m?this.byteLength-this.position/4:m;var z=new Uint32Array(m);return r.memcpy(z.buffer,0,this.buffer,this.byteOffset+this.position,m*z.BYTES_PER_ELEMENT),r.arrayToNative(z,null==M?this.endianness:M),this.position+=z.byteLength,z},r.prototype.readUint16Array=function(m,M){m=null==m?this.byteLength-this.position/2:m;var z=new Uint16Array(m);return r.memcpy(z.buffer,0,this.buffer,this.byteOffset+this.position,m*z.BYTES_PER_ELEMENT),r.arrayToNative(z,null==M?this.endianness:M),this.position+=z.byteLength,z},r.prototype.readUint8Array=function(m){m=null==m?this.byteLength-this.position:m;var M=new Uint8Array(m);return r.memcpy(M.buffer,0,this.buffer,this.byteOffset+this.position,m*M.BYTES_PER_ELEMENT),this.position+=M.byteLength,M},r.prototype.readFloat64Array=function(m,M){m=null==m?this.byteLength-this.position/8:m;var z=new Float64Array(m);return r.memcpy(z.buffer,0,this.buffer,this.byteOffset+this.position,m*z.BYTES_PER_ELEMENT),r.arrayToNative(z,null==M?this.endianness:M),this.position+=z.byteLength,z},r.prototype.readFloat32Array=function(m,M){m=null==m?this.byteLength-this.position/4:m;var z=new Float32Array(m);return r.memcpy(z.buffer,0,this.buffer,this.byteOffset+this.position,m*z.BYTES_PER_ELEMENT),r.arrayToNative(z,null==M?this.endianness:M),this.position+=z.byteLength,z},r.prototype.writeInt32Array=function(m,M){if(this._realloc(4*m.length),m instanceof Int32Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapInt32Array(m.length,M);else for(var z=0;z<m.length;z++)this.writeInt32(m[z],M)},r.prototype.writeInt16Array=function(m,M){if(this._realloc(2*m.length),m instanceof Int16Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapInt16Array(m.length,M);else for(var z=0;z<m.length;z++)this.writeInt16(m[z],M)},r.prototype.writeInt8Array=function(m){if(this._realloc(1*m.length),m instanceof Int8Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapInt8Array(m.length);else for(var M=0;M<m.length;M++)this.writeInt8(m[M])},r.prototype.writeUint32Array=function(m,M){if(this._realloc(4*m.length),m instanceof Uint32Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapUint32Array(m.length,M);else for(var z=0;z<m.length;z++)this.writeUint32(m[z],M)},r.prototype.writeUint16Array=function(m,M){if(this._realloc(2*m.length),m instanceof Uint16Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapUint16Array(m.length,M);else for(var z=0;z<m.length;z++)this.writeUint16(m[z],M)},r.prototype.writeUint8Array=function(m){if(this._realloc(1*m.length),m instanceof Uint8Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapUint8Array(m.length);else for(var M=0;M<m.length;M++)this.writeUint8(m[M])},r.prototype.writeFloat64Array=function(m,M){if(this._realloc(8*m.length),m instanceof Float64Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapFloat64Array(m.length,M);else for(var z=0;z<m.length;z++)this.writeFloat64(m[z],M)},r.prototype.writeFloat32Array=function(m,M){if(this._realloc(4*m.length),m instanceof Float32Array&&(this.byteOffset+this.position)%m.BYTES_PER_ELEMENT==0)r.memcpy(this._buffer,this.byteOffset+this.position,m.buffer,m.byteOffset,m.byteLength),this.mapFloat32Array(m.length,M);else for(var z=0;z<m.length;z++)this.writeFloat32(m[z],M)},r.prototype.readInt32=function(m){var M=this._dataView.getInt32(this.position,null==m?this.endianness:m);return this.position+=4,M},r.prototype.readInt16=function(m){var M=this._dataView.getInt16(this.position,null==m?this.endianness:m);return this.position+=2,M},r.prototype.readInt8=function(){var m=this._dataView.getInt8(this.position);return this.position+=1,m},r.prototype.readUint32=function(m){var M=this._dataView.getUint32(this.position,null==m?this.endianness:m);return this.position+=4,M},r.prototype.readUint16=function(m){var M=this._dataView.getUint16(this.position,null==m?this.endianness:m);return this.position+=2,M},r.prototype.readUint8=function(){var m=this._dataView.getUint8(this.position);return this.position+=1,m},r.prototype.readFloat32=function(m){var M=this._dataView.getFloat32(this.position,null==m?this.endianness:m);return this.position+=4,M},r.prototype.readFloat64=function(m){var M=this._dataView.getFloat64(this.position,null==m?this.endianness:m);return this.position+=8,M},r.prototype.writeInt32=function(m,M){this._realloc(4),this._dataView.setInt32(this.position,m,null==M?this.endianness:M),this.position+=4},r.prototype.writeInt16=function(m,M){this._realloc(2),this._dataView.setInt16(this.position,m,null==M?this.endianness:M),this.position+=2},r.prototype.writeInt8=function(m){this._realloc(1),this._dataView.setInt8(this.position,m),this.position+=1},r.prototype.writeUint32=function(m,M){this._realloc(4),this._dataView.setUint32(this.position,m,null==M?this.endianness:M),this.position+=4},r.prototype.writeUint16=function(m,M){this._realloc(2),this._dataView.setUint16(this.position,m,null==M?this.endianness:M),this.position+=2},r.prototype.writeUint8=function(m){this._realloc(1),this._dataView.setUint8(this.position,m),this.position+=1},r.prototype.writeFloat32=function(m,M){this._realloc(4),this._dataView.setFloat32(this.position,m,null==M?this.endianness:M),this.position+=4},r.prototype.writeFloat64=function(m,M){this._realloc(8),this._dataView.setFloat64(this.position,m,null==M?this.endianness:M),this.position+=8},r.endianness=new Int8Array(new Int16Array([1]).buffer)[0]>0,r.memcpy=function(m,M,z,$,te){var re=new Uint8Array(m,M,te),ie=new Uint8Array(z,$,te);re.set(ie)},r.arrayToNative=function(m,M){return M==this.endianness?m:this.flipArrayEndianness(m)},r.nativeToEndian=function(m,M){return this.endianness==M?m:this.flipArrayEndianness(m)},r.flipArrayEndianness=function(m){for(var M=new Uint8Array(m.buffer,m.byteOffset,m.byteLength),z=0;z<m.byteLength;z+=m.BYTES_PER_ELEMENT)for(var $=z+m.BYTES_PER_ELEMENT-1,te=z;$>te;$--,te++){var re=M[te];M[te]=M[$],M[$]=re}return m},r.createStringFromArray=function(m){for(var M=[],z=0;z<m.length;z+=32768)M.push(String.fromCharCode.apply(null,m.subarray(z,z+32768)));return M.join("")},r.prototype.failurePosition=0,r.prototype.readStruct=function(m){for(var M,z,$={},te=this.position,re=0;re<m.length;re+=2){if(M=m[re+1],null==(z=this.readType(M,$)))return 0==this.failurePosition&&(this.failurePosition=this.position),this.position=te,null;$[m[re]]=z}return $},r.prototype.readUCS2String=function(m,M){return r.createStringFromArray(this.readUint16Array(m,M))},r.prototype.writeUCS2String=function(m,M,z){null==z&&(z=m.length);for(var $=0;$<m.length&&$<z;$++)this.writeUint16(m.charCodeAt($),M);for(;$<z;$++)this.writeUint16(0)},r.prototype.readString=function(m,M){return null==M||"ASCII"==M?r.createStringFromArray(this.mapUint8Array(null==m?this.byteLength-this.position:m)):new TextDecoder(M).decode(this.mapUint8Array(m))},r.prototype.writeString=function(m,M,z){if(null==M||"ASCII"==M)if(null!=z){var $=0,te=Math.min(m.length,z);for($=0;$<te;$++)this.writeUint8(m.charCodeAt($));for(;$<z;$++)this.writeUint8(0)}else for($=0;$<m.length;$++)this.writeUint8(m.charCodeAt($));else this.writeUint8Array(new TextEncoder(M).encode(m.substring(0,z)))},r.prototype.readCString=function(m){var M=this.byteLength-this.position,z=new Uint8Array(this._buffer,this._byteOffset+this.position),$=M;null!=m&&($=Math.min(m,M));for(var te=0;te<$&&0!=z[te];te++);var re=r.createStringFromArray(this.mapUint8Array(te));return null!=m?this.position+=$-te:te!=M&&(this.position+=1),re},r.prototype.writeCString=function(m,M){if(null!=M){var z=0,$=Math.min(m.length,M);for(z=0;z<$;z++)this.writeUint8(m.charCodeAt(z));for(;z<M;z++)this.writeUint8(0)}else{for(z=0;z<m.length;z++)this.writeUint8(m.charCodeAt(z));this.writeUint8(0)}},r.prototype.readType=function(m,M){if("function"==typeof m)return m(this,M);if(!("object"!=typeof m||m instanceof Array))return m.get(this,M);if(m instanceof Array&&3!=m.length)return this.readStruct(m,M);var z,$=null,te=null,re="ASCII",ie=this.position;switch("string"==typeof m&&/:/.test(m)&&(m=(z=m.split(":"))[0],te=null!=M[oe=z[1]]?parseInt(M[oe]):parseInt(z[1])),"string"==typeof m&&/,/.test(m)&&(m=(z=m.split(","))[0],re=parseInt(z[1])),m){case"uint8":$=this.readUint8();break;case"int8":$=this.readInt8();break;case"uint16":$=this.readUint16(this.endianness);break;case"int16":$=this.readInt16(this.endianness);break;case"uint32":$=this.readUint32(this.endianness);break;case"int32":$=this.readInt32(this.endianness);break;case"float32":$=this.readFloat32(this.endianness);break;case"float64":$=this.readFloat64(this.endianness);break;case"uint16be":$=this.readUint16(r.BIG_ENDIAN);break;case"int16be":$=this.readInt16(r.BIG_ENDIAN);break;case"uint32be":$=this.readUint32(r.BIG_ENDIAN);break;case"int32be":$=this.readInt32(r.BIG_ENDIAN);break;case"float32be":$=this.readFloat32(r.BIG_ENDIAN);break;case"float64be":$=this.readFloat64(r.BIG_ENDIAN);break;case"uint16le":$=this.readUint16(r.LITTLE_ENDIAN);break;case"int16le":$=this.readInt16(r.LITTLE_ENDIAN);break;case"uint32le":$=this.readUint32(r.LITTLE_ENDIAN);break;case"int32le":$=this.readInt32(r.LITTLE_ENDIAN);break;case"float32le":$=this.readFloat32(r.LITTLE_ENDIAN);break;case"float64le":$=this.readFloat64(r.LITTLE_ENDIAN);break;case"cstring":$=this.readCString(te);break;case"string":$=this.readString(te,re);break;case"u16string":$=this.readUCS2String(te,this.endianness);break;case"u16stringle":$=this.readUCS2String(te,r.LITTLE_ENDIAN);break;case"u16stringbe":$=this.readUCS2String(te,r.BIG_ENDIAN);break;default:if(3==m.length){var oe,se=m[1],ae=0;if(ae="function"==typeof(oe=m[2])?oe(M,this,m):"string"==typeof oe&&null!=M[oe]?parseInt(M[oe]):parseInt(oe),"string"==typeof se){var ue=se.replace(/(le|be)$/,""),ce=null;switch(/le$/.test(se)?ce=r.LITTLE_ENDIAN:/be$/.test(se)&&(ce=r.BIG_ENDIAN),"*"==oe&&(ae=null),ue){case"uint8":$=this.readUint8Array(ae);break;case"uint16":$=this.readUint16Array(ae,ce);break;case"uint32":$=this.readUint32Array(ae,ce);break;case"int8":$=this.readInt8Array(ae);break;case"int16":$=this.readInt16Array(ae,ce);break;case"int32":$=this.readInt32Array(ae,ce);break;case"float32":$=this.readFloat32Array(ae,ce);break;case"float64":$=this.readFloat64Array(ae,ce);break;case"cstring":case"utf16string":case"string":if(null==ae)for($=[];!this.isEof()&&null!=(_e=this.readType(se,M));)$.push(_e);else{$=new Array(ae);for(var le=0;le<ae;le++)$[le]=this.readType(se,M)}}}else if("*"==oe)for($=[],this.buffer;;){var fe=this.position;try{var he=this.readType(se,M);if(null==he){this.position=fe;break}$.push(he)}catch(m){this.position=fe;break}}else for($=new Array(ae),le=0;le<ae;le++){var _e;if(null==(_e=this.readType(se,M)))return null;$[le]=_e}break}}return null!=te&&(this.position=ie+te),$},r.prototype.writeStruct=function(m,M){for(var z=0;z<m.length;z+=2){var $=m[z+1];this.writeType($,M[m[z]],M)}},r.prototype.writeType=function(m,M,z){if("function"==typeof m)return m(this,M);if("object"==typeof m&&!(m instanceof Array))return m.set(this,M,z);var $,te=null,re="ASCII",ie=this.position;switch("string"==typeof m&&/:/.test(m)&&(m=($=m.split(":"))[0],te=parseInt($[1])),"string"==typeof m&&/,/.test(m)&&(m=($=m.split(","))[0],re=parseInt($[1])),m){case"uint8":this.writeUint8(M);break;case"int8":this.writeInt8(M);break;case"uint16":this.writeUint16(M,this.endianness);break;case"int16":this.writeInt16(M,this.endianness);break;case"uint32":this.writeUint32(M,this.endianness);break;case"int32":this.writeInt32(M,this.endianness);break;case"float32":this.writeFloat32(M,this.endianness);break;case"float64":this.writeFloat64(M,this.endianness);break;case"uint16be":this.writeUint16(M,r.BIG_ENDIAN);break;case"int16be":this.writeInt16(M,r.BIG_ENDIAN);break;case"uint32be":this.writeUint32(M,r.BIG_ENDIAN);break;case"int32be":this.writeInt32(M,r.BIG_ENDIAN);break;case"float32be":this.writeFloat32(M,r.BIG_ENDIAN);break;case"float64be":this.writeFloat64(M,r.BIG_ENDIAN);break;case"uint16le":this.writeUint16(M,r.LITTLE_ENDIAN);break;case"int16le":this.writeInt16(M,r.LITTLE_ENDIAN);break;case"uint32le":this.writeUint32(M,r.LITTLE_ENDIAN);break;case"int32le":this.writeInt32(M,r.LITTLE_ENDIAN);break;case"float32le":this.writeFloat32(M,r.LITTLE_ENDIAN);break;case"float64le":this.writeFloat64(M,r.LITTLE_ENDIAN);break;case"cstring":this.writeCString(M,te);break;case"string":this.writeString(M,re,te);break;case"u16string":this.writeUCS2String(M,this.endianness,te);break;case"u16stringle":this.writeUCS2String(M,r.LITTLE_ENDIAN,te);break;case"u16stringbe":this.writeUCS2String(M,r.BIG_ENDIAN,te);break;default:if(3==m.length){for(var oe=m[1],se=0;se<M.length;se++)this.writeType(oe,M[se]);break}this.writeStruct(m,M)}null!=te&&(this.position=ie,this._realloc(te),this.position=ie+te)},void 0===(z=function(){return r}.apply(M,[]))||(m.exports=z),"object"==typeof m&&m&&m.exports&&(m.exports=r)}).call(this,z(171)(m))},function(m,M,z){var $=z(24),te=z(12);m.exports=function(m){if(void 0===m)return 0;var M=$(m),z=te(M);if(M!==z)throw RangeError("Wrong length!");return z}},function(m,M,z){"use strict";var $=z(40),te=z(29).getWeak,re=z(5),ie=z(4),oe=z(41),se=z(61),ae=z(19),ue=z(16),ce=z(39),le=ae(5),fe=ae(6),he=0,p=function(m){return m._l||(m._l=new d)},d=function(){this.a=[]},g=function(m,M){return le(m.a,(function(m){return m[0]===M}))};d.prototype={get:function(m){var M=g(this,m);if(M)return M[1]},has:function(m){return!!g(this,m)},set:function(m,M){var z=g(this,m);z?z[1]=M:this.a.push([m,M])},delete:function(m){var M=fe(this.a,(function(M){return M[0]===m}));return~M&&this.a.splice(M,1),!!~M}},m.exports={getConstructor:function(m,M,z,re){var ae=m((function(m,$){oe(m,ae,M,"_i"),m._t=M,m._i=he++,m._l=void 0,null!=$&&se($,z,m[re],m)}));return $(ae.prototype,{delete:function(m){if(!ie(m))return!1;var z=te(m);return!0===z?p(ce(this,M)).delete(m):z&&ue(z,this._i)&&delete z[this._i]},has:function(m){if(!ie(m))return!1;var z=te(m);return!0===z?p(ce(this,M)).has(m):z&&ue(z,this._i)}}),ae},def:function(m,M,z){var $=te(re(M),!0);return!0===$?p(m).set(M,z):$[m._i]=z,m},ufstore:p}},function(m,M,z){"use strict";var $=z(9).f,te=z(33),re=z(40),ie=z(27),oe=z(41),se=z(61),ae=z(83),ue=z(127),ce=z(42),le=z(11),fe=z(29).fastKey,he=z(39),_e=le?"_s":"size",d=function(m,M){var z,$=fe(M);if("F"!==$)return m._i[$];for(z=m._f;z;z=z.n)if(z.k==M)return z};m.exports={getConstructor:function(m,M,z,ae){var ue=m((function(m,$){oe(m,ue,M,"_i"),m._t=M,m._i=te(null),m._f=void 0,m._l=void 0,m[_e]=0,null!=$&&se($,z,m[ae],m)}));return re(ue.prototype,{clear:function(){for(var m=he(this,M),z=m._i,$=m._f;$;$=$.n)$.r=!0,$.p&&($.p=$.p.n=void 0),delete z[$.i];m._f=m._l=void 0,m[_e]=0},delete:function(m){var z=he(this,M),$=d(z,m);if($){var te=$.n,re=$.p;delete z._i[$.i],$.r=!0,re&&(re.n=te),te&&(te.p=re),z._f==$&&(z._f=te),z._l==$&&(z._l=re),z[_e]--}return!!$},forEach:function(m){he(this,M);for(var z,$=ie(m,arguments.length>1?arguments[1]:void 0,3);z=z?z.n:this._f;)for($(z.v,z.k,this);z&&z.r;)z=z.p},has:function(m){return!!d(he(this,M),m)}}),le&&$(ue.prototype,"size",{get:function(){return he(this,M)[_e]}}),ue},def:function(m,M,z){var $,te,re=d(m,M);return re?re.v=z:(m._l=re={i:te=fe(M,!0),k:M,v:z,p:$=m._l,n:void 0,r:!1},m._f||(m._f=re),$&&($.n=re),m[_e]++,"F"!==te&&(m._i[te]=re)),m},getEntry:d,setStrong:function(m,M,z){ae(m,M,(function(m,z){this._t=he(m,M),this._k=z,this._l=void 0}),(function(){for(var m=this._k,M=this._l;M&&M.r;)M=M.p;return this._t&&(this._l=M=M?M.n:this._t._f)?ue(0,"keys"==m?M.k:"values"==m?M.v:[M.k,M.v]):(this._t=void 0,ue(1))}),z?"entries":"values",!z,!0),ce(M)}}},function(m,M,z){"use strict";var $=z(26);m.exports.f=function(m){return new function(m){var M,z;this.promise=new m((function(m,$){if(void 0!==M||void 0!==z)throw TypeError("Bad Promise constructor");M=m,z=$})),this.resolve=$(M),this.reject=$(z)}(m)}},function(m,M,z){var $,te,re,ie=z(27),oe=z(141),se=z(89),ae=z(95),ue=z(6),ce=ue.process,le=ue.setImmediate,fe=ue.clearImmediate,he=ue.MessageChannel,_e=ue.Dispatch,ye=0,pe={},v=function(){var m=+this;if(pe.hasOwnProperty(m)){var M=pe[m];delete pe[m],M()}},b=function(m){v.call(m.data)};le&&fe||(le=function(m){for(var M=[],z=1;arguments.length>z;)M.push(arguments[z++]);return pe[++ye]=function(){oe("function"==typeof m?m:Function(m),M)},$(ye),ye},fe=function(m){delete pe[m]},"process"==z(25)(ce)?$=function(m){ce.nextTick(ie(v,m,1))}:_e&&_e.now?$=function(m){_e.now(ie(v,m,1))}:he?(re=(te=new he).port2,te.port1.onmessage=b,$=ie(re.postMessage,re,1)):ue.addEventListener&&"function"==typeof postMessage&&!ue.importScripts?($=function(m){ue.postMessage(m+"","*")},ue.addEventListener("message",b,!1)):$="onreadystatechange"in ae("script")?function(m){se.appendChild(ae("script")).onreadystatechange=function(){se.removeChild(this),v.call(m)}}:function(m){setTimeout(ie(v,m,1),0)}),m.exports={set:le,clear:fe}},function(m,M,z){z(11)&&"g"!=/./g.flags&&z(9).f(RegExp.prototype,"flags",{configurable:!0,get:z(76)})},function(m,M){m.exports=function(m,M){return{value:M,done:!!m}}},function(m,M,z){"use strict";var $=z(52),te=z(127),re=z(53),ie=z(21);m.exports=z(83)(Array,"Array",(function(m,M){this._t=ie(m),this._i=0,this._k=M}),(function(){var m=this._t,M=this._k,z=this._i++;return!m||z>=m.length?(this._t=void 0,te(1)):te(0,"keys"==M?z:"values"==M?m[z]:[z,m[z]])}),"values"),re.Arguments=re.Array,$("keys"),$("values"),$("entries")},function(m,M,z){"use strict";var $=z(14),te=z(34),re=z(12);m.exports=[].copyWithin||function(m,M){var z=$(this),ie=re(z.length),oe=te(m,ie),se=te(M,ie),ae=arguments.length>2?arguments[2]:void 0,ue=Math.min((void 0===ae?ie:te(ae,ie))-se,ie-oe),ce=1;for(se<oe&&oe<se+ue&&(ce=-1,se+=ue-1,oe+=ue-1);ue-- >0;)se in z?z[oe]=z[se]:delete z[oe],oe+=ce,se+=ce;return z}},function(m,M,z){var $=z(26),te=z(14),re=z(54),ie=z(12);m.exports=function(m,M,z,oe,se){$(M);var ae=te(m),ue=re(ae),ce=ie(ae.length),le=se?ce-1:0,fe=se?-1:1;if(z<2)for(;;){if(le in ue){oe=ue[le],le+=fe;break}if(le+=fe,se?le<0:ce<=le)throw TypeError("Reduce of empty array with no initial value")}for(;se?le>=0:ce>le;le+=fe)le in ue&&(oe=M(oe,ue[le],le,ae));return oe}},function(m,M,z){"use strict";var $=z(9),te=z(36);m.exports=function(m,M,z){M in m?$.f(m,M,te(0,z)):m[M]=z}},function(m,M,z){var $=z(5);m.exports=function(m,M,z,te){try{return te?M($(z)[0],z[1]):M(z)}catch(M){var re=m.return;throw void 0!==re&&$(re.call(m)),M}}},function(m,M,z){"use strict";var $=z(33),te=z(36),re=z(44),ie={};z(18)(ie,z(7)("iterator"),(function(){return this})),m.exports=function(m,M,z){m.prototype=$(ie,{next:te(1,z)}),re(m,M+" Iterator")}},function(m,M,z){var $=z(24),te=z(28);m.exports=function(m){return function(M,z){var re,ie,oe=String(te(M)),se=$(z),ae=oe.length;return se<0||se>=ae?m?"":void 0:(re=oe.charCodeAt(se))<55296||re>56319||se+1===ae||(ie=oe.charCodeAt(se+1))<56320||ie>57343?m?oe.charAt(se):re:m?oe.slice(se,se+2):ie-56320+(re-55296<<10)+65536}}},function(m,M){m.exports=Math.log1p||function(m){return(m=+m)>-1e-8&&m<1e-8?m-m*m/2:Math.log(1+m)}},function(m,M,z){var $=z(4),te=Math.floor;m.exports=function(m){return!$(m)&&isFinite(m)&&te(m)===m}},function(m,M,z){"use strict";var $=z(24),te=z(28);m.exports=function(m){var M=String(te(this)),z="",re=$(m);if(re<0||re==1/0)throw RangeError("Count can't be negative");for(;re>0;(re>>>=1)&&(M+=M))1&re&&(z+=M);return z}},function(m,M,z){var $=z(25);m.exports=function(m,M){if("number"!=typeof m&&"Number"!=$(m))throw TypeError(M);return+m}},function(m,M,z){var $=z(6).parseFloat,te=z(64).trim;m.exports=1/$(z(87)+"-0")!=-1/0?function(m){var M=te(String(m),3),z=$(M);return 0===z&&"-"==M.charAt(0)?-0:z}:$},function(m,M,z){var $=z(6).parseInt,te=z(64).trim,re=z(87),ie=/^[-+]?0[xX]/;m.exports=8!==$(re+"08")||22!==$(re+"0x16")?function(m,M){var z=te(String(m),3);return $(z,M>>>0||(ie.test(z)?16:10))}:$},function(m,M){m.exports=function(m,M,z){var $=void 0===z;switch(M.length){case 0:return $?m():m.call(z);case 1:return $?m(M[0]):m.call(z,M[0]);case 2:return $?m(M[0],M[1]):m.call(z,M[0],M[1]);case 3:return $?m(M[0],M[1],M[2]):m.call(z,M[0],M[1],M[2]);case 4:return $?m(M[0],M[1],M[2],M[3]):m.call(z,M[0],M[1],M[2],M[3])}return m.apply(z,M)}},function(m,M,z){"use strict";var $=z(26),te=z(4),re=z(141),ie=[].slice,oe={};m.exports=Function.bind||function(m){var M=$(this),z=ie.call(arguments,1),u=function(){var $=z.concat(ie.call(arguments));return this instanceof u?function(m,M,z){if(!(M in oe)){for(var $=[],te=0;te<M;te++)$[te]="a["+te+"]";oe[M]=Function("F,a","return new F("+$.join(",")+")")}return oe[M](m,z)}(M,$.length,$):re(M,$,m)};return te(M.prototype)&&(u.prototype=M.prototype),u}},function(m,M,z){"use strict";var $=z(55),te=z(67),re=z(66),ie=z(14),oe=z(54),se=Object.assign;m.exports=!se||z(3)((function(){var m={},M={},z=Symbol(),$="abcdefghijklmnopqrst";return m[z]=7,$.split("").forEach((function(m){M[m]=m})),7!=se({},m)[z]||Object.keys(se({},M)).join("")!=$}))?function(m,M){for(var z=ie(m),se=arguments.length,ae=1,ue=te.f,ce=re.f;se>ae;)for(var le,fe=oe(arguments[ae++]),he=ue?$(fe).concat(ue(fe)):$(fe),_e=he.length,ye=0;_e>ye;)ce.call(fe,le=he[ye++])&&(z[le]=fe[le]);return z}:se},function(m,M,z){var $=z(21),te=z(32).f,re={}.toString,ie="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];m.exports.f=function(m){return ie&&"[object Window]"==re.call(m)?function(m){try{return te(m)}catch(m){return ie.slice()}}(m):te($(m))}},function(m,M,z){var $=z(9),te=z(5),re=z(55);m.exports=z(11)?Object.defineProperties:function(m,M){te(m);for(var z,ie=re(M),oe=ie.length,se=0;oe>se;)$.f(m,z=ie[se++],M[z]);return m}},function(m,M,z){var $=z(16),te=z(21),re=z(93)(!1),ie=z(92)("IE_PROTO");m.exports=function(m,M){var z,oe=te(m),se=0,ae=[];for(z in oe)z!=ie&&$(oe,z)&&ae.push(z);for(;M.length>se;)$(oe,z=M[se++])&&(~re(ae,z)||ae.push(z));return ae}},function(m,M,z){M.f=z(7)},function(m,M,z){m.exports=!z(11)&&!z(3)((function(){return 7!=Object.defineProperty(z(95)("div"),"a",{get:function(){return 7}}).a}))},function(m,M,z){"use strict";Number.MAX_SAFE_INTEGER||(Number.MAX_SAFE_INTEGER=9007199254740991),Number.isInteger=Number.isInteger||function(m){return"number"==typeof m&&isFinite(m)&&Math.floor(m)===m},Number.isSafeInteger=Number.isSafeInteger||function(m){return Number.isInteger(m)&&Math.abs(m)<=Number.MAX_SAFE_INTEGER},Number.isFinite=Number.isFinite||function(m){return"number"==typeof m&&isFinite(m)},Array.prototype.find||Object.defineProperty(Array.prototype,"find",{value:function(m){if(null==this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof m)throw new TypeError("predicate must be a function");for(var M=Object(this),z=M.length>>>0,$=arguments[1],te=0;te!==z;te++)if(m.call($,this[te],te,M))return this[te]}})},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.BuddyMessageRequest=void 0;var $=z(69),te=z(1),re=z(57),ie=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var ie=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));if(null!=M&&!(M instanceof re.SFSBuddy))throw new te.SFSError("Target buddy must be an instance of SFSBuddy class");return ie._type=$.GenericMessageType.BUDDY_MSG,ie._message=m,ie._recipient=null!=M?M.id:-1,ie._params=z,Object.seal(ie),ie}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,$.GenericMessageRequest),t}();M.BuddyMessageRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.QuickJoinGameRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=z(45),se=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.QuickJoinGame));return $._matchExpression=m,$._whereToSearch=M,$._roomToLeave=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM_LIST",get:function(){return"rl"}},{key:"KEY_GROUP_LIST",get:function(){return"gl"}},{key:"KEY_ROOM_TO_LEAVE",get:function(){return"tl"}},{key:"KEY_MATCH_EXPRESSION",get:function(){return"me"}},{key:"MAX_ROOMS",get:function(){return 32}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._matchExpression||this._matchExpression instanceof oe.MatchExpression||M.push("Match expression must be an instance of MatchExpression class"),null==this._whereToSearch||this._whereToSearch.length<1?M.push("Missing list of Rooms or Group names where to search the game to join"):this._whereToSearch.length>t.MAX_ROOMS&&M.push("Too many Rooms specified in list where to search the game to join; client limit is: "+t.MAX_ROOMS),null==this._roomToLeave||this._roomToLeave instanceof ie.SFSRoom||M.push("Room to leave must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("CreateSFSGameRequest Error",M)}},{key:"execute",value:function(m){if("string"==typeof this._whereToSearch[0])this._reqObj.putUtfStringArray(t.KEY_GROUP_LIST,this._whereToSearch);else{if(!(this._whereToSearch[0]instanceof ie.SFSRoom))throw new re.SFSError("Invalid type in whereToSearch parameter");var M=[],z=!0,$=!1,te=void 0;try{for(var oe,se=this._whereToSearch[Symbol.iterator]();!(z=(oe=se.next()).done);z=!0){var ae=oe.value;ae instanceof ie.SFSRoom&&M.push(ae.id)}}catch(m){$=!0,te=m}finally{try{!z&&se.return&&se.return()}finally{if($)throw te}}this._reqObj.putIntArray(t.KEY_ROOM_LIST,M)}null!=this._roomToLeave&&this._reqObj.putInt(t.KEY_ROOM_TO_LEAVE,this._roomToLeave.id),null!=this._matchExpression&&this._reqObj.putSFSArray(t.KEY_MATCH_EXPRESSION,this._matchExpression.toSFSArray())}}]),t}();M.QuickJoinGameRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.JoinRoomInvitationRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=z(8),se=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:30,re=arguments.length>4&&void 0!==arguments[4]&&arguments[4];!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var ie=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.JoinRoomInvite));return ie._targetRoom=m,ie._invitedUserNames=M,ie._params=z,ie._expirySeconds=$,ie._asSpectator=re,Object.seal(ie),ie}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM_ID",get:function(){return"r"}},{key:"KEY_EXPIRY_SECONDS",get:function(){return"es"}},{key:"KEY_INVITED_NAMES",get:function(){return"in"}},{key:"KEY_AS_SPECT",get:function(){return"as"}},{key:"KEY_OPTIONAL_PARAMS",get:function(){return"op"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._targetRoom&&M.push("Missing target room"),null==this._targetRoom||this._targetRoom instanceof ie.SFSRoom||M.push("Target room must be an instance of SFSRoom class"),null==this._invitedUserNames?M.push("No invitees provided"):this._invitedUserNames instanceof Array?this._invitedUserNames.length<1&&M.push("No invitees provided"):M.push("Invited user names must be passed in an array"),null==this._params||this._params instanceof oe.SFSObject||M.push("Custom invitation parameters must be set in a SFSObject class instance"),M.length>0)throw new re.SFSValidationError("JoinRoomInvitationRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_ROOM_ID,this._targetRoom.id),this._reqObj.putUtfStringArray(t.KEY_INVITED_NAMES,this._invitedUserNames),this._reqObj.putInt(t.KEY_EXPIRY_SECONDS,this._expirySeconds),this._reqObj.putBool(t.KEY_AS_SPECT,this._asSpectator),null!=this._params&&this._reqObj.putSFSObject(t.KEY_OPTIONAL_PARAMS,this._params)}}]),t}();M.JoinRoomInvitationRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.InvitationReplyRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(8),oe=z(71),se=function(m){function t(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.InvitationReply));return $._invitation=m,$._reply=M,$._params=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_INVITATION_ID",get:function(){return"i"}},{key:"KEY_INVITATION_REPLY",get:function(){return"r"}},{key:"KEY_INVITATION_PARAMS",get:function(){return"p"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(null==this._invitation?M.push("Missing invitation object"):this._invitation instanceof oe.SFSInvitation||M.push("Invitation object must be an instance of Invitation class"),null==this._params||this._params instanceof ie.SFSObject||M.push("Custom invitation parameters must be set in a SFSObject class instance"),M.length>0)throw new re.SFSValidationError("InvitationReplyRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_INVITATION_ID,this._invitation.id),this._reqObj.putByte(t.KEY_INVITATION_REPLY,this._reply),null!=this._params&&this._reqObj.putSFSObject(t.KEY_INVITATION_PARAMS,this._params)}}]),t}();M.InvitationReplyRequest=se},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.CreateSFSGameRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(56),oe=z(70),se=z(68),ae=z(47),ue=z(57),ce=z(8),le=z(45),fe=function(m){function t(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.CreateSFSGame));return M._settings=m,M._createRoomRequest=new oe.CreateRoomRequest(m,!1,null),Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_IS_PUBLIC",get:function(){return"gip"}},{key:"KEY_MIN_PLAYERS",get:function(){return"gmp"}},{key:"KEY_INVITED_PLAYERS",get:function(){return"ginp"}},{key:"KEY_SEARCHABLE_ROOMS",get:function(){return"gsr"}},{key:"KEY_PLAYER_MATCH_EXP",get:function(){return"gpme"}},{key:"KEY_SPECTATOR_MATCH_EXP",get:function(){return"gsme"}},{key:"KEY_INVITATION_EXPIRY",get:function(){return"gie"}},{key:"KEY_LEAVE_ROOM",get:function(){return"glr"}},{key:"KEY_NOTIFY_GAME_STARTED",get:function(){return"gns"}},{key:"KEY_INVITATION_PARAMS",get:function(){return"ip"}}]),$(t,[{key:"validate",value:function(m){if(!(this._settings instanceof ie.SFSGameSettings))throw new re.SFSValidationError("CreateSFSGameRequest Error",["Room configuration must be an instance of SFSGameSettings class"]);var M=[];try{this._createRoomRequest.validate(m)}catch(m){M=m.getErrors()}if(this._settings.minPlayersToStartGame>this._settings.maxUsers&&M.push("Minimum number of players to start the game can't be greater than the Room's maximum number of users"),(this._settings.invitationExpiryTime<se.InviteUsersRequest.MIN_EXPIRY_TIME||this._settings.invitationExpiryTime>se.InviteUsersRequest.MAX_EXPIRY_TIME)&&M.push("Invitation expiration time value is out of range (min: "+se.InviteUsersRequest.MIN_EXPIRY_TIME+"; max: "+se.InviteUsersRequest.MAX_EXPIRY_TIME+")"),null!=this._settings.invitedPlayers&&(this._settings.invitedPlayers instanceof Array?(this._settings.invitedPlayers.length>se.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE&&M.push("Can't invite more than "+se.InviteUsersRequest.MAX_INVITATIONS_FROM_CLIENT_SIDE+" players from client side"),this._settings.invitedPlayers.every((function(m){return m instanceof ae.SFSUser||m instanceof ue.SFSBuddy}))||M.push("Each invited player must be an instance of SFSUser or SFSBuddy classes")):M.push("Invited players must be passed in an array")),null==this._settings.playerMatchExpression||this._settings.playerMatchExpression instanceof le.MatchExpression||M.push("Player match expression must be an instance of MatchExpression class"),null==this._settings.spectatorMatchExpression||this._settings.spectatorMatchExpression instanceof le.MatchExpression||M.push("Spectator match expression must be an instance of MatchExpression class"),null==this._settings.invitationParams||this._settings.invitationParams instanceof ce.SFSObject||M.push("Custom invitation parameters must be set in a SFSObject class instance"),M.length>0)throw new re.SFSValidationError("CreateSFSGameRequest Error",M)}},{key:"execute",value:function(m){if(this._createRoomRequest.execute(m),this._reqObj=this._createRoomRequest._reqObj,this._reqObj.putBool(t.KEY_IS_PUBLIC,this._settings.isPublic),this._reqObj.putShort(t.KEY_MIN_PLAYERS,this._settings.minPlayersToStartGame),this._reqObj.putShort(t.KEY_INVITATION_EXPIRY,this._settings.invitationExpiryTime),this._reqObj.putBool(t.KEY_LEAVE_ROOM,this._settings.leaveLastJoinedRoom),this._reqObj.putBool(t.KEY_NOTIFY_GAME_STARTED,this._settings.notifyGameStarted),null!=this._settings.playerMatchExpression&&this._reqObj.putSFSArray(t.KEY_PLAYER_MATCH_EXP,this._settings.playerMatchExpression.toSFSArray()),null!=this._settings.spectatorMatchExpression&&this._reqObj.putSFSArray(t.KEY_SPECTATOR_MATCH_EXP,this._settings.spectatorMatchExpression.toSFSArray()),null!=this._settings.invitedPlayers){var M=[],z=!0,$=!1,te=void 0;try{for(var re,ie=this._settings.invitedPlayers[Symbol.iterator]();!(z=(re=ie.next()).done);z=!0){var oe=re.value;M.push(oe.id)}}catch(m){$=!0,te=m}finally{try{!z&&ie.return&&ie.return()}finally{if($)throw te}}this._reqObj.putIntArray(t.KEY_INVITED_PLAYERS,M)}null!=this._settings.searchableRooms&&this._reqObj.putUtfStringArray(t.KEY_SEARCHABLE_ROOMS,this._settings.searchableRooms),null!=this._settings.invitationParams&&this._reqObj.putSFSObject(t.KEY_INVITATION_PARAMS,this._settings.invitationParams)}}]),t}();M.CreateSFSGameRequest=fe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.BanUserRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1,$=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5,re=arguments.length>4&&void 0!==arguments[4]?arguments[4]:24;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var ie=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.BanUser));return ie._userId=m,ie._message=M,ie._banMode=z,ie._delay=$,ie._durationHours=re,Object.seal(ie),ie}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_USER_ID",get:function(){return"u"}},{key:"KEY_MESSAGE",get:function(){return"m"}},{key:"KEY_DELAY",get:function(){return"d"}},{key:"KEY_BAN_MODE",get:function(){return"b"}},{key:"KEY_BAN_DURATION_HOURS",get:function(){return"dh"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(M.length>0)throw new re.SFSValidationError("BanUserRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_USER_ID,this._userId),this._reqObj.putInt(t.KEY_DELAY,this._delay),this._reqObj.putInt(t.KEY_BAN_MODE,this._banMode),this._reqObj.putInt(t.KEY_BAN_DURATION_HOURS,this._durationHours),null!=this._message&&this._message.length>0&&this._reqObj.putUtfString(t.KEY_MESSAGE,this._message)}}]),t}();M.BanUserRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.KickUserRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=function(m){function t(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var $=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.KickUser));return z<0&&(z=0),$._userId=m,$._message=M,$._delay=z,Object.seal($),$}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_USER_ID",get:function(){return"u"}},{key:"KEY_MESSAGE",get:function(){return"m"}},{key:"KEY_DELAY",get:function(){return"d"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(M.length>0)throw new re.SFSValidationError("KickUserRequest Error",M)}},{key:"execute",value:function(m){this._reqObj.putInt(t.KEY_USER_ID,this._userId),this._reqObj.putInt(t.KEY_DELAY,this._delay),null!=this._message&&this._message.length>0&&this._reqObj.putUtfString(t.KEY_MESSAGE,this._message)}}]),t}();M.KickUserRequest=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.LeaveRoomRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(1),ie=z(10),oe=function(m){function t(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.LeaveRoom));return M._room=m,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_ROOM_ID",get:function(){return"r"}}]),$(t,[{key:"validate",value:function(m){var M=[];if(m.getJoinedRooms().length<1&&M.push("You are not joined in any Room"),null==this._room||this._room instanceof ie.SFSRoom||M.push("Room must be an instance of SFSRoom class"),M.length>0)throw new re.SFSValidationError("LeaveRoomRequest Error",M)}},{key:"execute",value:function(m){null!=this._room&&this._reqObj.putInt(t.KEY_ROOM_ID,this._room.id)}}]),t}();M.LeaveRoomRequest=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=Object.freeze({NAME:"${N}",GROUP_ID:"${G}",MAX_USERS:"${MXU}",MAX_SPECTATORS:"${MXS}",USER_COUNT:"${UC}",SPECTATOR_COUNT:"${SC}",IS_GAME:"${ISG}",IS_PRIVATE:"${ISP}",HAS_FREE_PLAYER_SLOTS:"${HFP}",IS_TYPE_SFSGAME:"${IST}"}),te=Object.freeze({NAME:"${N}",IS_PLAYER:"${ISP}",IS_SPECTATOR:"${ISS}",IS_NPC:"${ISN}",PRIVILEGE_ID:"${PRID}",IS_IN_ANY_ROOM:"${IAR}"});M.RoomProperties=$,M.UserProperties=te},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}();function i(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}function o(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}function s(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var te=function(){function e(m,M){s(this,e),this._type=m,this._symbol=M,Object.freeze(this)}return $(e,[{key:"type",get:function(){return this._type}},{key:"symbol",get:function(){return this._symbol}}]),e}(),re=function(m){function t(m){s(this,t);var M=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,0,m));return Object.freeze(M),M}return o(t,te),$(t,null,[{key:"EQUALS",get:function(){return new t("==")}},{key:"NOT_EQUALS",get:function(){return new t("!=")}}]),t}(),ie=function(m){function t(m){s(this,t);var M=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,1,m));return Object.freeze(M),M}return o(t,te),$(t,null,[{key:"EQUALS",get:function(){return new t("==")}},{key:"NOT_EQUALS",get:function(){return new t("!=")}},{key:"GREATER_THAN",get:function(){return new t(">")}},{key:"GREATER_THAN_OR_EQUAL_TO",get:function(){return new t(">=")}},{key:"LESS_THAN",get:function(){return new t("<")}},{key:"LESS_THAN_OR_EQUAL_TO",get:function(){return new t("<=")}}]),t}(),oe=function(m){function t(m){s(this,t);var M=i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,2,m));return Object.freeze(M),M}return o(t,te),$(t,null,[{key:"EQUALS",get:function(){return new t("==")}},{key:"NOT_EQUALS",get:function(){return new t("!=")}},{key:"CONTAINS",get:function(){return new t("contains")}},{key:"STARTS_WITH",get:function(){return new t("startsWith")}},{key:"ENDS_WITH",get:function(){return new t("endsWith")}}]),t}();M.BoolMatch=re,M.NumberMatch=ie,M.StringMatch=oe},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.PingPongRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=function(m){function t(){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var m=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.PingPong));return Object.seal(m),m}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,[{key:"validate",value:function(m){}},{key:"execute",value:function(m){}}]),t}();M.PingPongRequest=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.LagMonitor=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(160),re=function(){function e(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._sfs=m,this._valueQueue=[],this._interval=M,this._queueSize=z,this._thread=null,this._lastReqTime=-1}return $(e,[{key:"start",value:function(){this.isRunning||null==this._sfs||(this._thread=setInterval(this._threadRunner,1e3*this._interval,this))}},{key:"stop",value:function(){this.isRunning&&(clearInterval(this._thread),this._thread=null,this._valueQueue=[])}},{key:"destroy",value:function(){this.stop(),this._sfs=null}},{key:"getLastPingTime",value:function(){return this._valueQueue.length>0?this._valueQueue[this._valueQueue.length-1]:0}},{key:"_threadRunner",value:function(m){m._lastReqTime=(new Date).getTime(),m._sfs.send(new te.PingPongRequest)}},{key:"_onPingPong",value:function(){var m=(new Date).getTime()-this._lastReqTime;return this._valueQueue.length>=this._queueSize&&this._valueQueue.shift(),this._valueQueue.push(m),this._getAveragePingTime()}},{key:"_getAveragePingTime",value:function(){if(0==this._valueQueue.length)return 0;for(var m=0,M=0;M<this._valueQueue.length;M++)m+=this._valueQueue[M];return m/this._valueQueue.length}},{key:"isRunning",get:function(){return null!=this._thread}}]),e}();M.LagMonitor=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.HandshakeRequest=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=function(m){function t(m,M){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var z=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,te.Requests.Handshake));return z._apiVersion=m,z._clientDetails=M,Object.seal(z),z}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,te.BaseRequest),$(t,null,[{key:"KEY_SESSION_TOKEN",get:function(){return"tk"}},{key:"KEY_API",get:function(){return"api"}},{key:"KEY_COMPRESSION_THRESHOLD",get:function(){return"ct"}},{key:"KEY_CLIENT_TYPE",get:function(){return"cl"}},{key:"KEY_MAX_MESSAGE_SIZE",get:function(){return"ms"}}]),$(t,[{key:"validate",value:function(m){}},{key:"execute",value:function(m){this._reqObj.putUtfString(t.KEY_API,this._apiVersion),this._reqObj.putUtfString(t.KEY_CLIENT_TYPE,this._clientDetails)}}]),t}();M.HandshakeRequest=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SFSBuddyManager=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(46),re=function(){function e(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._sfs=m,this._buddiesByName=new Map,this._myVariables=new Map,this._inited=!1,this._buddyStates=new Set,Object.seal(this)}return $(e,[{key:"containsBuddy",value:function(m){return this._buddiesByName.has(m)}},{key:"getBuddyById",value:function(m){return this.getBuddyList().find((function(M){return M.id===m}))}},{key:"getBuddyByName",value:function(m){return this._buddiesByName.get(m)}},{key:"getBuddyByNickName",value:function(m){return this.getBuddyList().find((function(M){return M.nickName===m}))}},{key:"getOfflineBuddies",value:function(){return this.getBuddyList().filter((function(m){return!m.isOnline}))}},{key:"getOnlineBuddies",value:function(){return this.getBuddyList().filter((function(m){return m.isOnline}))}},{key:"getBuddyList",value:function(){return Array.from(this._buddiesByName.values())}},{key:"getMyVariable",value:function(m){return this._myVariables.get(m)}},{key:"getMyVariables",value:function(){return Array.from(this._myVariables.values())}},{key:"getMyOnlineState",value:function(){if(!this._inited)return!1;var m=this.getMyVariable(te.ReservedBuddyVariables.BV_ONLINE);return null==m||m.value}},{key:"getMyNickName",value:function(){var m=this.getMyVariable(te.ReservedBuddyVariables.BV_NICKNAME);return null!=m?m.value:null}},{key:"getMyState",value:function(){var m=this.getMyVariable(te.ReservedBuddyVariables.BV_STATE);return null!=m?m.value:null}},{key:"getBuddyStates",value:function(){return Array.from(this._buddyStates.values())}},{key:"_setInited",value:function(){this._inited=!0}},{key:"_addBuddy",value:function(m){this._buddiesByName.set(m.name,m)}},{key:"_clearAll",value:function(){this._buddiesByName.clear()}},{key:"_removeBuddyById",value:function(m){var M=this.getBuddyById(m);return null!=M&&this._buddiesByName.delete(M.name),M}},{key:"_removeBuddyByName",value:function(m){var M=this.getBuddyByName(m);return null!=M&&this._buddiesByName.delete(m),M}},{key:"_setMyVariables",value:function(m){var M=!0,z=!1,$=void 0;try{for(var te,re=m[Symbol.iterator]();!(M=(te=re.next()).done);M=!0){var ie=te.value;this._setMyVariable(ie)}}catch(m){z=!0,$=m}finally{try{!M&&re.return&&re.return()}finally{if(z)throw $}}}},{key:"_setMyVariable",value:function(m){m.isNull?this._myVariables.delete(m.name):this._myVariables.set(m.name,m)}},{key:"_setMyOnlineState",value:function(m){this._setMyVariable(new te.SFSBuddyVariable(te.ReservedBuddyVariables.BV_ONLINE,m))}},{key:"_setMyNickName",value:function(m){this._setMyVariable(new te.SFSBuddyVariable(te.ReservedBuddyVariables.BV_NICKNAME,m))}},{key:"_setMyState",value:function(m){this._setMyVariable(new te.SFSBuddyVariable(te.ReservedBuddyVariables.BV_STATE,m))}},{key:"_setBuddyStates",value:function(m){this._buddyStates=new Set(m)}},{key:"isInited",get:function(){return this._inited}}]),e}();M.SFSBuddyManager=re},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SFSRoomManager=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(10),re=function(){function e(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._sfs=m,this._groups=new Set,this._roomsById=new Map,this._roomsByName=new Map,Object.seal(this)}return $(e,[{key:"getRoomGroups",value:function(){return Array.from(this._groups)}},{key:"containsGroup",value:function(m){return this._groups.has(m)}},{key:"containsRoom",value:function(m){return"number"==typeof m?this._roomsById.has(m):this._roomsByName.has(m)}},{key:"containsRoomInGroup",value:function(m,M){var z=this.getRoomListFromGroup(M);return"number"==typeof m?z.some((function(M){return M.id===m})):z.some((function(M){return M.name===m}))}},{key:"getRoomById",value:function(m){return this._roomsById.get(m)}},{key:"getRoomByName",value:function(m){return this._roomsByName.get(m)}},{key:"getRoomList",value:function(){return Array.from(this._roomsById.values())}},{key:"getRoomCount",value:function(){return this._roomsById.size}},{key:"getRoomListFromGroup",value:function(m){return this.getRoomList().filter((function(M){return M.groupId===m}))}},{key:"getJoinedRooms",value:function(){return this.getRoomList().filter((function(m){return m.isJoined}))}},{key:"getUserRooms",value:function(m){return this.getRoomList().filter((function(M){return M.containsUser(m)}))}},{key:"_addRoom",value:function(m){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this._roomsById.set(m.id,m),this._roomsByName.set(m.name,m),m._setRoomManager(this),M?this._addGroup(m.groupId):m._isManaged=!1}},{key:"_replaceRoom",value:function(m){var M=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],z=this.getRoomById(m.id);return null!=z?(z._merge(m),z):(this._addRoom(m,M),m)}},{key:"_removeRoom",value:function(m){this._roomsById.delete(m.id),this._roomsByName.delete(m.name)}},{key:"_removeRoomById",value:function(m){var M=this.getRoomById(m);null!=M&&this._removeRoom(M)}},{key:"_removeRoomByName",value:function(m){var M=this.getRoomByName(m);null!=M&&this._removeRoom(M)}},{key:"_changeRoomName",value:function(m,M){var z=m.name;m._name=M,this._roomsByName.set(M,m),this._roomsByName.delete(z)}},{key:"_changeRoomPasswordState",value:function(m,M){m._isPasswordProtected=M}},{key:"_changeRoomCapacity",value:function(m,M,z){m._maxUsers=M,m._maxSpectators=z}},{key:"_addGroup",value:function(m){this.containsGroup(m)||this._groups.add(m)}},{key:"_removeGroup",value:function(m){this._groups.delete(m);var M=this.getRoomListFromGroup(m),z=!0,$=!1,te=void 0;try{for(var re,ie=M[Symbol.iterator]();!(z=(re=ie.next()).done);z=!0){var oe=re.value;oe.isJoined?oe._isManaged=!1:this._removeRoom(oe)}}catch(m){$=!0,te=m}finally{try{!z&&ie.return&&ie.return()}finally{if($)throw te}}}},{key:"_removeUser",value:function(m){var M=!0,z=!1,$=void 0;try{for(var re,ie=this.getUserRooms(m)[Symbol.iterator]();!(M=(re=ie.next()).done);M=!0){var oe=re.value;oe instanceof te.MMORoom||oe._removeUser(m)}}catch(m){z=!0,$=m}finally{try{!M&&ie.return&&ie.return()}finally{if(z)throw $}}}}]),e}();M.SFSRoomManager=re},function(m,M){
/** @license zlib.js 2012 - imaya [ https://github.com/imaya/zlib.js ] The MIT License */(function(){"use strict";function e(m){throw m}var m=void 0,M=!0,z=this;function i(M,$){var te,re=M.split("."),ie=z;!(re[0]in ie)&&ie.execScript&&ie.execScript("var "+re[0]);for(;re.length&&(te=re.shift());)re.length||$===m?ie=ie[te]?ie[te]:ie[te]={}:ie[te]=$}var $="undefined"!=typeof Uint8Array&&"undefined"!=typeof Uint16Array&&"undefined"!=typeof Uint32Array&&"undefined"!=typeof DataView;function s(m,M){this.index="number"==typeof M?M:0,this.i=0,this.buffer=m instanceof($?Uint8Array:Array)?m:new($?Uint8Array:Array)(32768),2*this.buffer.length<=this.index&&e(Error("invalid index")),this.buffer.length<=this.index&&this.f()}s.prototype.f=function(){var m,M=this.buffer,z=M.length,te=new($?Uint8Array:Array)(z<<1);if($)te.set(M);else for(m=0;m<z;++m)te[m]=M[m];return this.buffer=te},s.prototype.d=function(m,M,z){var $,te=this.buffer,re=this.index,ie=this.i,oe=te[re];if(z&&1<M&&(m=8<M?(ae[255&m]<<24|ae[m>>>8&255]<<16|ae[m>>>16&255]<<8|ae[m>>>24&255])>>32-M:ae[m]>>8-M),8>M+ie)oe=oe<<M|m,ie+=M;else for($=0;$<M;++$)oe=oe<<1|m>>M-$-1&1,8==++ie&&(ie=0,te[re++]=ae[oe],oe=0,re===te.length&&(te=this.f()));te[re]=oe,this.buffer=te,this.i=ie,this.index=re},s.prototype.finish=function(){var m,M=this.buffer,z=this.index;return 0<this.i&&(M[z]<<=8-this.i,M[z]=ae[M[z]],z++),$?m=M.subarray(0,z):(M.length=z,m=M),m};var te,re=new($?Uint8Array:Array)(256);for(te=0;256>te;++te){for(var ie=se=te,oe=7,se=se>>>1;se;se>>>=1)ie<<=1,ie|=1&se,--oe;re[te]=(ie<<oe&255)>>>0}var ae=re;function _(m){this.buffer=new($?Uint16Array:Array)(2*m),this.length=0}function y(m){var M,z,te,re,ie,oe,se,ae,ue,ce,le=m.length,fe=0,he=Number.POSITIVE_INFINITY;for(ae=0;ae<le;++ae)m[ae]>fe&&(fe=m[ae]),m[ae]<he&&(he=m[ae]);for(M=1<<fe,z=new($?Uint32Array:Array)(M),te=1,re=0,ie=2;te<=fe;){for(ae=0;ae<le;++ae)if(m[ae]===te){for(oe=0,se=re,ue=0;ue<te;++ue)oe=oe<<1|1&se,se>>=1;for(ce=te<<16|ae,ue=oe;ue<M;ue+=ie)z[ue]=ce;++re}++te,re<<=1,ie<<=1}return[z,fe,he]}function p(m,M){this.h=ce,this.w=0,this.input=$&&m instanceof Array?new Uint8Array(m):m,this.b=0,M&&(M.lazy&&(this.w=M.lazy),"number"==typeof M.compressionType&&(this.h=M.compressionType),M.outputBuffer&&(this.a=$&&M.outputBuffer instanceof Array?new Uint8Array(M.outputBuffer):M.outputBuffer),"number"==typeof M.outputIndex&&(this.b=M.outputIndex)),this.a||(this.a=new($?Uint8Array:Array)(32768))}_.prototype.getParent=function(m){return 2*((m-2)/4|0)},_.prototype.push=function(m,M){var z,$,te,re=this.buffer;for(z=this.length,re[this.length++]=M,re[this.length++]=m;0<z&&($=this.getParent(z),re[z]>re[$]);)te=re[z],re[z]=re[$],re[$]=te,te=re[z+1],re[z+1]=re[$+1],re[$+1]=te,z=$;return this.length},_.prototype.pop=function(){var m,M,z,$,te,re=this.buffer;for(M=re[0],m=re[1],this.length-=2,re[0]=re[this.length],re[1]=re[this.length+1],te=0;!(($=2*te+2)>=this.length)&&($+2<this.length&&re[$+2]>re[$]&&($+=2),re[$]>re[te]);)z=re[te],re[te]=re[$],re[$]=z,z=re[te+1],re[te+1]=re[$+1],re[$+1]=z,te=$;return{index:m,value:M,length:this.length}};var ue,ce=2,le={NONE:0,r:1,k:ce,O:3},fe=[];for(ue=0;288>ue;ue++)switch(M){case 143>=ue:fe.push([ue+48,8]);break;case 255>=ue:fe.push([ue-144+400,9]);break;case 279>=ue:fe.push([ue-256+0,7]);break;case 287>=ue:fe.push([ue-280+192,8]);break;default:e("invalid literal: "+ue)}p.prototype.j=function(){var z,te,re,ie,oe=this.input;switch(this.h){case 0:for(re=0,ie=oe.length;re<ie;){var se,ae,ue,le=te=$?oe.subarray(re,re+65535):oe.slice(re,re+65535),he=(re+=te.length)===ie,_e=m,ye=m,pe=this.a,de=this.b;if($){for(pe=new Uint8Array(this.a.buffer);pe.length<=de+le.length+5;)pe=new Uint8Array(pe.length<<1);pe.set(this.a)}if(se=he?1:0,pe[de++]=0|se,ue=65536+~(ae=le.length)&65535,pe[de++]=255&ae,pe[de++]=ae>>>8&255,pe[de++]=255&ue,pe[de++]=ue>>>8&255,$)pe.set(le,de),de+=le.length,pe=pe.subarray(0,de);else{for(_e=0,ye=le.length;_e<ye;++_e)pe[de++]=le[_e];pe.length=de}this.b=de,this.a=pe}break;case 1:var ge=new s($?new Uint8Array(this.a.buffer):this.a,this.b);ge.d(1,1,M),ge.d(1,2,M);var ve,be,me,Se=E(this,oe);for(ve=0,be=Se.length;ve<be;ve++)if(me=Se[ve],s.prototype.d.apply(ge,fe[me]),256<me)ge.d(Se[++ve],Se[++ve],M),ge.d(Se[++ve],5),ge.d(Se[++ve],Se[++ve],M);else if(256===me)break;this.a=ge.finish(),this.b=this.a.length;break;case ce:var Ee,Re,Fe,je,Le,xe,qe,Ve,Ke,Ge,ze,He,Je,We,Xe,Ze=new s($?new Uint8Array(this.a.buffer):this.a,this.b),Qe=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],$e=Array(19);for(Ee=ce,Ze.d(1,1,M),Ze.d(Ee,2,M),Re=E(this,oe),qe=A(xe=O(this.M,15)),Ke=A(Ve=O(this.L,7)),Fe=286;257<Fe&&0===xe[Fe-1];Fe--);for(je=30;1<je&&0===Ve[je-1];je--);var et,tt,nt,rt,it,ot,st=Fe,at=je,ut=new($?Uint32Array:Array)(st+at),ct=new($?Uint32Array:Array)(316),lt=new($?Uint8Array:Array)(19);for(et=tt=0;et<st;et++)ut[tt++]=xe[et];for(et=0;et<at;et++)ut[tt++]=Ve[et];if(!$)for(et=0,rt=lt.length;et<rt;++et)lt[et]=0;for(et=it=0,rt=ut.length;et<rt;et+=tt){for(tt=1;et+tt<rt&&ut[et+tt]===ut[et];++tt);if(nt=tt,0===ut[et])if(3>nt)for(;0<nt--;)ct[it++]=0,lt[0]++;else for(;0<nt;)(ot=138>nt?nt:138)>nt-3&&ot<nt&&(ot=nt-3),10>=ot?(ct[it++]=17,ct[it++]=ot-3,lt[17]++):(ct[it++]=18,ct[it++]=ot-11,lt[18]++),nt-=ot;else if(ct[it++]=ut[et],lt[ut[et]]++,3>--nt)for(;0<nt--;)ct[it++]=ut[et],lt[ut[et]]++;else for(;0<nt;)(ot=6>nt?nt:6)>nt-3&&ot<nt&&(ot=nt-3),ct[it++]=16,ct[it++]=ot-3,lt[16]++,nt-=ot}for(z=$?ct.subarray(0,it):ct.slice(0,it),Ge=O(lt,7),We=0;19>We;We++)$e[We]=Ge[Qe[We]];for(Le=19;4<Le&&0===$e[Le-1];Le--);for(ze=A(Ge),Ze.d(Fe-257,5,M),Ze.d(je-1,5,M),Ze.d(Le-4,4,M),We=0;We<Le;We++)Ze.d($e[We],3,M);for(We=0,Xe=z.length;We<Xe;We++)if(He=z[We],Ze.d(ze[He],Ge[He],M),16<=He){switch(We++,He){case 16:Je=2;break;case 17:Je=3;break;case 18:Je=7;break;default:e("invalid code: "+He)}Ze.d(z[We],Je,M)}var ft,ht,_t,yt,pt,dt,gt,vt,bt=[qe,xe],mt=[Ke,Ve];for(pt=bt[0],dt=bt[1],gt=mt[0],vt=mt[1],ft=0,ht=Re.length;ft<ht;++ft)if(_t=Re[ft],Ze.d(pt[_t],dt[_t],M),256<_t)Ze.d(Re[++ft],Re[++ft],M),yt=Re[++ft],Ze.d(gt[yt],vt[yt],M),Ze.d(Re[++ft],Re[++ft],M);else if(256===_t)break;this.a=Ze.finish(),this.b=this.a.length;break;default:e("invalid compression type")}return this.a};var he=function(){function t(m){switch(M){case 3===m:return[257,m-3,0];case 4===m:return[258,m-4,0];case 5===m:return[259,m-5,0];case 6===m:return[260,m-6,0];case 7===m:return[261,m-7,0];case 8===m:return[262,m-8,0];case 9===m:return[263,m-9,0];case 10===m:return[264,m-10,0];case 12>=m:return[265,m-11,1];case 14>=m:return[266,m-13,1];case 16>=m:return[267,m-15,1];case 18>=m:return[268,m-17,1];case 22>=m:return[269,m-19,2];case 26>=m:return[270,m-23,2];case 30>=m:return[271,m-27,2];case 34>=m:return[272,m-31,2];case 42>=m:return[273,m-35,3];case 50>=m:return[274,m-43,3];case 58>=m:return[275,m-51,3];case 66>=m:return[276,m-59,3];case 82>=m:return[277,m-67,4];case 98>=m:return[278,m-83,4];case 114>=m:return[279,m-99,4];case 130>=m:return[280,m-115,4];case 162>=m:return[281,m-131,5];case 194>=m:return[282,m-163,5];case 226>=m:return[283,m-195,5];case 257>=m:return[284,m-227,5];case 258===m:return[285,m-258,0];default:e("invalid length: "+m)}}var m,z,$=[];for(m=3;258>=m;m++)z=t(m),$[m]=z[2]<<24|z[1]<<16|z[0];return $}(),_e=$?new Uint32Array(he):he;function E(z,te){function s(m,z){var $,te,re,ie,oe=m.H,se=[],ae=0;switch($=_e[m.length],se[ae++]=65535&$,se[ae++]=$>>16&255,se[ae++]=$>>24,M){case 1===oe:te=[0,oe-1,0];break;case 2===oe:te=[1,oe-2,0];break;case 3===oe:te=[2,oe-3,0];break;case 4===oe:te=[3,oe-4,0];break;case 6>=oe:te=[4,oe-5,1];break;case 8>=oe:te=[5,oe-7,1];break;case 12>=oe:te=[6,oe-9,2];break;case 16>=oe:te=[7,oe-13,2];break;case 24>=oe:te=[8,oe-17,3];break;case 32>=oe:te=[9,oe-25,3];break;case 48>=oe:te=[10,oe-33,4];break;case 64>=oe:te=[11,oe-49,4];break;case 96>=oe:te=[12,oe-65,5];break;case 128>=oe:te=[13,oe-97,5];break;case 192>=oe:te=[14,oe-129,6];break;case 256>=oe:te=[15,oe-193,6];break;case 384>=oe:te=[16,oe-257,7];break;case 512>=oe:te=[17,oe-385,7];break;case 768>=oe:te=[18,oe-513,8];break;case 1024>=oe:te=[19,oe-769,8];break;case 1536>=oe:te=[20,oe-1025,9];break;case 2048>=oe:te=[21,oe-1537,9];break;case 3072>=oe:te=[22,oe-2049,10];break;case 4096>=oe:te=[23,oe-3073,10];break;case 6144>=oe:te=[24,oe-4097,11];break;case 8192>=oe:te=[25,oe-6145,11];break;case 12288>=oe:te=[26,oe-8193,12];break;case 16384>=oe:te=[27,oe-12289,12];break;case 24576>=oe:te=[28,oe-16385,13];break;case 32768>=oe:te=[29,oe-24577,13];break;default:e("invalid distance")}for($=te,se[ae++]=$[0],se[ae++]=$[1],se[ae++]=$[2],re=0,ie=se.length;re<ie;++re)ye[pe++]=se[re];ge[se[0]]++,ve[se[3]]++,de=m.length+z-1,le=null}var re,ie,oe,se,ae,ue,ce,le,fe,he={},ye=$?new Uint16Array(2*te.length):[],pe=0,de=0,ge=new($?Uint32Array:Array)(286),ve=new($?Uint32Array:Array)(30),be=z.w;if(!$){for(oe=0;285>=oe;)ge[oe++]=0;for(oe=0;29>=oe;)ve[oe++]=0}for(ge[256]=1,re=0,ie=te.length;re<ie;++re){for(oe=ae=0,se=3;oe<se&&re+oe!==ie;++oe)ae=ae<<8|te[re+oe];if(he[ae]===m&&(he[ae]=[]),ue=he[ae],!(0<de--)){for(;0<ue.length&&32768<re-ue[0];)ue.shift();if(re+3>=ie){for(le&&s(le,-1),oe=0,se=ie-re;oe<se;++oe)fe=te[re+oe],ye[pe++]=fe,++ge[fe];break}0<ue.length?(ce=R(te,re,ue),le?le.length<ce.length?(fe=te[re-1],ye[pe++]=fe,++ge[fe],s(ce,0)):s(le,-1):ce.length<be?le=ce:s(ce,0)):le?s(le,-1):(fe=te[re],ye[pe++]=fe,++ge[fe])}ue.push(re)}return ye[pe++]=256,ge[256]++,z.M=ge,z.L=ve,$?ye.subarray(0,pe):ye}function R(m,M,z){var $,te,re,ie,oe,se,ae=0,ue=m.length;ie=0,se=z.length;e:for(;ie<se;ie++){if($=z[se-ie-1],re=3,3<ae){for(oe=ae;3<oe;oe--)if(m[$+oe-1]!==m[M+oe-1])continue e;re=ae}for(;258>re&&M+re<ue&&m[$+re]===m[M+re];)++re;if(re>ae&&(te=$,ae=re),258===re)break}return new function(m,M){this.length=m,this.H=M}(ae,M-te)}function O(m,M){var z,te,re,ie,oe,se=m.length,ae=new _(572),ue=new($?Uint8Array:Array)(se);if(!$)for(ie=0;ie<se;ie++)ue[ie]=0;for(ie=0;ie<se;++ie)0<m[ie]&&ae.push(ie,m[ie]);if(z=Array(ae.length/2),te=new($?Uint32Array:Array)(ae.length/2),1===z.length)return ue[ae.pop().index]=1,ue;for(ie=0,oe=ae.length/2;ie<oe;++ie)z[ie]=ae.pop(),te[ie]=z[ie].value;for(re=function(m,M,z){function r(m){var z=fe[m][he[m]];z===M?(r(m+1),r(m+1)):--ce[z],++he[m]}var te,re,ie,oe,se,ae=new($?Uint16Array:Array)(z),ue=new($?Uint8Array:Array)(z),ce=new($?Uint8Array:Array)(M),le=Array(z),fe=Array(z),he=Array(z),_e=(1<<z)-M,ye=1<<z-1;for(ae[z-1]=M,re=0;re<z;++re)_e<ye?ue[re]=0:(ue[re]=1,_e-=ye),_e<<=1,ae[z-2-re]=(ae[z-1-re]/2|0)+M;for(ae[0]=ue[0],le[0]=Array(ae[0]),fe[0]=Array(ae[0]),re=1;re<z;++re)ae[re]>2*ae[re-1]+ue[re]&&(ae[re]=2*ae[re-1]+ue[re]),le[re]=Array(ae[re]),fe[re]=Array(ae[re]);for(te=0;te<M;++te)ce[te]=z;for(ie=0;ie<ae[z-1];++ie)le[z-1][ie]=m[ie],fe[z-1][ie]=ie;for(te=0;te<z;++te)he[te]=0;for(1===ue[z-1]&&(--ce[0],++he[z-1]),re=z-2;0<=re;--re){for(oe=te=0,se=he[re+1],ie=0;ie<ae[re];ie++)(oe=le[re+1][se]+le[re+1][se+1])>m[te]?(le[re][ie]=oe,fe[re][ie]=M,se+=2):(le[re][ie]=m[te],fe[re][ie]=te,++te);he[re]=0,1===ue[re]&&r(re)}return ce}(te,te.length,M),ie=0,oe=z.length;ie<oe;++ie)ue[z[ie].index]=re[ie];return ue}function A(m){var M,z,te,re,ie=new($?Uint16Array:Array)(m.length),oe=[],se=[],ae=0;for(M=0,z=m.length;M<z;M++)oe[m[M]]=1+(0|oe[m[M]]);for(M=1,z=16;M<=z;M++)se[M]=ae,ae+=0|oe[M],ae<<=1;for(M=0,z=m.length;M<z;M++)for(ae=se[m[M]],se[m[M]]+=1,te=ie[M]=0,re=m[M];te<re;te++)ie[M]=ie[M]<<1|1&ae,ae>>>=1;return ie}function w(m,M){switch(this.l=[],this.m=32768,this.e=this.g=this.c=this.q=0,this.input=$?new Uint8Array(m):m,this.s=!1,this.n=pe,this.C=!1,!M&&(M={})||(M.index&&(this.c=M.index),M.bufferSize&&(this.m=M.bufferSize),M.bufferType&&(this.n=M.bufferType),M.resize&&(this.C=M.resize)),this.n){case ye:this.b=32768,this.a=new($?Uint8Array:Array)(32768+this.m+258);break;case pe:this.b=0,this.a=new($?Uint8Array:Array)(this.m),this.f=this.K,this.t=this.I,this.o=this.J;break;default:e(Error("invalid inflate mode"))}}var ye=0,pe=1,de={F:ye,D:pe};w.prototype.p=function(){for(;!this.s;){var z=J(this,3);switch(1&z&&(this.s=M),z>>>=1){case 0:var te=this.input,re=this.c,ie=this.a,oe=this.b,se=te.length,ae=m,ue=ie.length,ce=m;switch(this.e=this.g=0,re+1>=se&&e(Error("invalid uncompressed block header: LEN")),ae=te[re++]|te[re++]<<8,re+1>=se&&e(Error("invalid uncompressed block header: NLEN")),ae===~(te[re++]|te[re++]<<8)&&e(Error("invalid uncompressed block header: length verify")),re+ae>te.length&&e(Error("input buffer is broken")),this.n){case ye:for(;oe+ae>ie.length;){if(ae-=ce=ue-oe,$)ie.set(te.subarray(re,re+ce),oe),oe+=ce,re+=ce;else for(;ce--;)ie[oe++]=te[re++];this.b=oe,ie=this.f(),oe=this.b}break;case pe:for(;oe+ae>ie.length;)ie=this.f({v:2});break;default:e(Error("invalid inflate mode"))}if($)ie.set(te.subarray(re,re+ae),oe),oe+=ae,re+=ae;else for(;ae--;)ie[oe++]=te[re++];this.c=re,this.b=oe,this.a=ie;break;case 1:this.o(ze,Je);break;case 2:X(this);break;default:e(Error("unknown BTYPE: "+z))}}return this.t()};var ge,ve,be=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],me=$?new Uint16Array(be):be,Se=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],Ee=$?new Uint16Array(Se):Se,Re=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],Fe=$?new Uint8Array(Re):Re,je=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],Le=$?new Uint16Array(je):je,xe=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],qe=$?new Uint8Array(xe):xe,Ve=new($?Uint8Array:Array)(288);for(ge=0,ve=Ve.length;ge<ve;++ge)Ve[ge]=143>=ge?8:255>=ge?9:279>=ge?7:8;var Ke,Ge,ze=y(Ve),He=new($?Uint8Array:Array)(30);for(Ke=0,Ge=He.length;Ke<Ge;++Ke)He[Ke]=5;var Je=y(He);function J(m,M){for(var z,$=m.g,te=m.e,re=m.input,ie=m.c,oe=re.length;te<M;)ie>=oe&&e(Error("input buffer is broken")),$|=re[ie++]<<te,te+=8;return z=$&(1<<M)-1,m.g=$>>>M,m.e=te-M,m.c=ie,z}function W(m,M){for(var z,$,te=m.g,re=m.e,ie=m.input,oe=m.c,se=ie.length,ae=M[0],ue=M[1];re<ue&&!(oe>=se);)te|=ie[oe++]<<re,re+=8;return $=(z=ae[te&(1<<ue)-1])>>>16,m.g=te>>$,m.e=re-$,m.c=oe,65535&z}function X(m){function t(m,M,z){var $,te,re,ie=this.z;for(re=0;re<m;)switch($=W(this,M),$){case 16:for(te=3+J(this,2);te--;)z[re++]=ie;break;case 17:for(te=3+J(this,3);te--;)z[re++]=0;ie=0;break;case 18:for(te=11+J(this,7);te--;)z[re++]=0;ie=0;break;default:ie=z[re++]=$}return this.z=ie,z}var M,z,te,re,ie=J(m,5)+257,oe=J(m,5)+1,se=J(m,4)+4,ae=new($?Uint8Array:Array)(me.length);for(re=0;re<se;++re)ae[me[re]]=J(m,3);if(!$)for(re=se,se=ae.length;re<se;++re)ae[me[re]]=0;M=y(ae),z=new($?Uint8Array:Array)(ie),te=new($?Uint8Array:Array)(oe),m.z=0,m.o(y(t.call(m,ie,M,z)),y(t.call(m,oe,M,te)))}function Z(m){if("string"==typeof m){var M,z,$=m.split("");for(M=0,z=$.length;M<z;M++)$[M]=(255&$[M].charCodeAt(0))>>>0;m=$}for(var te,re=1,ie=0,oe=m.length,se=0;0<oe;){oe-=te=1024<oe?1024:oe;do{ie+=re+=m[se++]}while(--te);re%=65521,ie%=65521}return(ie<<16|re)>>>0}function Q(m,M){var z,$;if(this.input=m,this.c=0,!M&&(M={})||(M.index&&(this.c=M.index),M.verify&&(this.N=M.verify)),z=m[this.c++],$=m[this.c++],(15&z)===We)this.method=We;else e(Error("unsupported compression method"));0!=((z<<8)+$)%31&&e(Error("invalid fcheck flag:"+((z<<8)+$)%31)),32&$&&e(Error("fdict flag is not supported")),this.B=new w(m,{index:this.c,bufferSize:M.bufferSize,bufferType:M.bufferType,resize:M.resize})}w.prototype.o=function(m,M){var z=this.a,$=this.b;this.u=m;for(var te,re,ie,oe,se=z.length-258;256!==(te=W(this,m));)if(256>te)$>=se&&(this.b=$,z=this.f(),$=this.b),z[$++]=te;else for(oe=Ee[re=te-257],0<Fe[re]&&(oe+=J(this,Fe[re])),te=W(this,M),ie=Le[te],0<qe[te]&&(ie+=J(this,qe[te])),$>=se&&(this.b=$,z=this.f(),$=this.b);oe--;)z[$]=z[$++-ie];for(;8<=this.e;)this.e-=8,this.c--;this.b=$},w.prototype.J=function(m,M){var z=this.a,$=this.b;this.u=m;for(var te,re,ie,oe,se=z.length;256!==(te=W(this,m));)if(256>te)$>=se&&(se=(z=this.f()).length),z[$++]=te;else for(oe=Ee[re=te-257],0<Fe[re]&&(oe+=J(this,Fe[re])),te=W(this,M),ie=Le[te],0<qe[te]&&(ie+=J(this,qe[te])),$+oe>se&&(se=(z=this.f()).length);oe--;)z[$]=z[$++-ie];for(;8<=this.e;)this.e-=8,this.c--;this.b=$},w.prototype.f=function(){var m,M,z=new($?Uint8Array:Array)(this.b-32768),te=this.b-32768,re=this.a;if($)z.set(re.subarray(32768,z.length));else for(m=0,M=z.length;m<M;++m)z[m]=re[m+32768];if(this.l.push(z),this.q+=z.length,$)re.set(re.subarray(te,te+32768));else for(m=0;32768>m;++m)re[m]=re[te+m];return this.b=32768,re},w.prototype.K=function(m){var M,z,te,re=this.input.length/this.c+1|0,ie=this.input,oe=this.a;return m&&("number"==typeof m.v&&(re=m.v),"number"==typeof m.G&&(re+=m.G)),z=2>re?(te=(ie.length-this.c)/this.u[2]/2*258|0)<oe.length?oe.length+te:oe.length<<1:oe.length*re,$?(M=new Uint8Array(z)).set(oe):M=oe,this.a=M},w.prototype.t=function(){var m,M,z,te,re,ie=0,oe=this.a,se=this.l,ae=new($?Uint8Array:Array)(this.q+(this.b-32768));if(0===se.length)return $?this.a.subarray(32768,this.b):this.a.slice(32768,this.b);for(M=0,z=se.length;M<z;++M)for(te=0,re=(m=se[M]).length;te<re;++te)ae[ie++]=m[te];for(M=32768,z=this.b;M<z;++M)ae[ie++]=oe[M];return this.l=[],this.buffer=ae},w.prototype.I=function(){var m,M=this.b;return $?this.C?(m=new Uint8Array(M)).set(this.a.subarray(0,M)):m=this.a.subarray(0,M):(this.a.length>M&&(this.a.length=M),m=this.a),this.buffer=m},Q.prototype.p=function(){var m,M=this.input;return m=this.B.p(),this.c=this.B.c,this.N&&(M[this.c++]<<24|M[this.c++]<<16|M[this.c++]<<8|M[this.c++])>>>0!==Z(m)&&e(Error("invalid adler-32 checksum")),m};var We=8;function ee(m,M){this.input=m,this.a=new($?Uint8Array:Array)(32768),this.h=Xe.k;var z,te={};for(z in!M&&(M={})||"number"!=typeof M.compressionType||(this.h=M.compressionType),M)te[z]=M[z];te.outputBuffer=this.a,this.A=new p(this.input,te)}var Xe=le;function ne(m,M){var z,$,te,re;if(Object.keys)z=Object.keys(M);else for($ in z=[],te=0,M)z[te++]=$;for(te=0,re=z.length;te<re;++te)i(m+"."+($=z[te]),M[$])}ee.prototype.j=function(){var m,M,z,te,re,ie,oe,se=0;if(oe=this.a,(m=We)===We)M=Math.LOG2E*Math.log(32768)-8;else e(Error("invalid compression method"));if(z=M<<4|m,oe[se++]=z,m===We)switch(this.h){case Xe.NONE:re=0;break;case Xe.r:re=1;break;case Xe.k:re=2;break;default:e(Error("unsupported compression type"))}else e(Error("invalid compression method"));return te=re<<6|0,oe[se++]=te|31-(256*z+te)%31,ie=Z(this.input),this.A.b=se,se=(oe=this.A.j()).length,$&&((oe=new Uint8Array(oe.buffer)).length<=se+4&&(this.a=new Uint8Array(oe.length+4),this.a.set(oe),oe=this.a),oe=oe.subarray(0,se+4)),oe[se++]=ie>>24&255,oe[se++]=ie>>16&255,oe[se++]=ie>>8&255,oe[se++]=255&ie,oe},i("Zlib.Inflate",Q),i("Zlib.Inflate.prototype.decompress",Q.prototype.p),ne("Zlib.Inflate.BufferType",{ADAPTIVE:de.D,BLOCK:de.F}),i("Zlib.Deflate",ee),i("Zlib.Deflate.compress",(function(m,M){return new ee(m,M).j()})),i("Zlib.Deflate.prototype.compress",ee.prototype.j),ne("Zlib.Deflate.CompressionType",{NONE:Xe.NONE,FIXED:Xe.r,DYNAMIC:Xe.k})}).call(this)},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SocketEngine=M.SocketEvent=void 0;var $,te=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),re=($=z(120))&&$.__esModule?$:{default:$},ie=z(165),oe=z(38),se=z(8),ae=z(2),ue=z(50),ce=z(51),le=z(1);function y(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}var fe=Object.freeze({CONNECT:"socketConnect",DISCONNECT:"socketDisconnect",DATA:"socketData",IOERROR:"socketIOError"}),he=function(m){function t(m){y(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return M._sfs=m,M._logger=ue.Logger.instance,M._isConnected=!1,M._isConnecting=!1,M._socket=null,M._protocolCodec=new _e(m),M._disconnectionReason=ce.ClientDisconnectionReason.UNKNOWN,Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,oe.EventDispatcher),te(t,[{key:"connect",value:function(m,M,z){this._isConnecting=!0;var $="ws"+(z?"s":"");this._socket=new WebSocket($+"://"+m+":"+M+"/BlueBox/websocket"),this._socket.binaryType="arraybuffer",this._socket._scope=this,this._socket.onopen=this._onSocketConnect,this._socket.onclose=this._onSocketDisconnect,this._socket.onmessage=this._onSocketData,this._socket.onerror=this._onSocketError}},{key:"disconnect",value:function(m){this._disconnectionReason=m,this._socket.close()}},{key:"addController",value:function(m,M){null==this._controllers[m]&&(this._controllers[m]=M)}},{key:"removeController",value:function(m){delete this._controllers[m]}},{key:"send",value:function(m){this._sfs.debug&&this._logger.debug("OUTGOING MESSAGE: "+m.dump());var M=this._protocolCodec.onPacketWrite(m);this._socket.send(M)}},{key:"_onSocketConnect",value:function(){this._scope._sfs.debug&&this._scope._logger.debug("Socket connection established"),this._scope._isConnected=!0,this._scope._isConnecting=!1,this._scope.dispatchEvent(fe.CONNECT,{success:!0})}},{key:"_onSocketDisconnect",value:function(){this._scope._isConnected=!1,this._scope.isConnecting?(this._scope._sfs.debug&&this._scope._logger.debug("Can't establish socket connection"),this._scope._isConnecting=!1,this._scope.dispatchEvent(fe.CONNECT,{success:!1})):(this._scope._sfs.debug&&this._scope._logger.debug("Socket disconnection occurred"),this._scope.dispatchEvent(fe.DISCONNECT,{reason:this._scope._disconnectionReason}),this._scope._disconnectionReason=ce.ClientDisconnectionReason.UNKNOWN)}},{key:"_onSocketData",value:function(m){var M=this._scope._protocolCodec.onPacketRead(m.data);this._scope._sfs.debug&&this._scope._logger.debug("INCOMING MESSAGE: "+M.dump()),this._scope.dispatchEvent(fe.DATA,M)}},{key:"_onSocketError",value:function(m){this._scope.dispatchEvent(fe.IOERROR,m.data)}},{key:"isConnected",get:function(){return this._isConnected}},{key:"isConnecting",get:function(){return this._isConnecting}},{key:"maxMessageSize",get:function(){return this._protocolCodec.maxMessageSize},set:function(m){this._protocolCodec.maxMessageSize=m}},{key:"compressionThreshold",get:function(){return this._protocolCodec.compressionThreshold},set:function(m){this._protocolCodec.compressionThreshold=m}}]),t}(),_e=function(){function e(m){y(this,e),this.CONTROLLER_ID="c",this.ACTION_ID="a",this.PARAM_ID="p",this._maxMessageSize=1e4,this._compressionThreshold=1024,this._sfs=m,this._logger=ue.Logger.instance,Object.seal(this)}return te(e,[{key:"onPacketRead",value:function(m){if(0!==m.byteLength){var M=new re.default(m,0,re.default.BIG_ENDIAN),z=M.readUint8(),$=(32&z)>0,te=(8&z)>0?M.readUint32():M.readUint16(),ie=M.readUint8Array(te);$&&(ie=this.decompress(ie)),this._sfs.debug&&(m.byteLength>1024?this._logger.debug("DATA READ - Binary size > 1024; dump omitted"):this._logger.debug("DATA READ - "+ce.DumpFormatter.hexDump(ie)));var oe=se.SFSObject.newFromBinaryData(ie);return new ae.Message(oe.get(this.ACTION_ID),oe.get(this.CONTROLLER_ID),oe.get(this.PARAM_ID))}this._logger.error("Unexpected empty packet data: no readable bytes available!")}},{key:"onPacketWrite",value:function(m){var M=new se.SFSObject;M.put(this.CONTROLLER_ID,m.targetController,se.SFSDataType.BYTE),M.put(this.ACTION_ID,m.id,se.SFSDataType.SHORT),M.put(this.PARAM_ID,m.content,se.SFSDataType.SFS_OBJECT);var z=M.toBinary(),$=z.byteLength,te=new re.default(new ArrayBuffer(0),0,re.default.BIG_ENDIAN),ie=128;$>this.compressionThreshold&&(ie+=32,$=(z=this.compress(z)).byteLength);var oe=$>65335;oe&&(ie+=8),te.writeUint8(ie),oe?te.writeUint32($):te.writeUint16($),te.writeUint8Array(z);var ae=new Uint8Array(te.buffer);if(ae.byteLength>this.maxMessageSize)throw new le.SFSError("Message size is too big: "+ae.byteLength+"; the server limit is: "+this.maxMessageSize);return this._sfs.debug&&this._logger.debug("DATA WRITTEN - "+ce.DumpFormatter.hexDump(ae)),ae}},{key:"decompress",value:function(m){return new ie.Zlib.Inflate(m).decompress()}},{key:"compress",value:function(m){return new ie.Zlib.Deflate(m).compress()}},{key:"maxMessageSize",get:function(){return this._maxMessageSize},set:function(m){this._maxMessageSize=m}},{key:"compressionThreshold",get:function(){return this._compressionThreshold},set:function(m){this._compressionThreshold=m}}]),e}();M.SocketEvent=fe,M.SocketEngine=he},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.ExtensionController=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(38),re=z(96),ie=function(){function e(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._sfs=m,this._logger=m.logger,this._id=1,Object.freeze(this)}return $(e,[{key:"handleMessage",value:function(m,M){this._sfs.debug&&this._logger.info("Handling Extension response");var z={};z.cmd=m.get(re.ExtensionRequest.KEY_CMD),z.params=m.get(re.ExtensionRequest.KEY_PARAMS);var $=m.get(re.ExtensionRequest.KEY_ROOM);null!=$&&(z.room=this._sfs.roomManager.getRoomById($)),this._sfs.dispatchEvent(te.SFSEvent.EXTENSION_RESPONSE,z)}},{key:"id",get:function(){return this._id}}]),e}();M.ExtensionController=ie},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0});var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=function(){function e(){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e)}return $(e,null,[{key:"KEY_ROOM_ID",get:function(){return"r"}},{key:"KEY_ITEM_ID",get:function(){return"i"}},{key:"KEY_VAR_LIST",get:function(){return"v"}}]),e}();M.SetMMOItemVariables=te},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.MMOItem=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(72),re=function(){function e(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._id=m,this._aoiEntryPoint=null,this._variables=new Map,Object.seal(this)}return $(e,[{key:"toString",value:function(){return"[Item: "+this.id+"]"}},{key:"getVariable",value:function(m){return this._variables.get(m)}},{key:"containsVariable",value:function(m){return this._variables.has(m)}},{key:"getVariables",value:function(){return Array.from(this._variables.values())}},{key:"_setVariables",value:function(m){var M=!0,z=!1,$=void 0;try{for(var te,re=m[Symbol.iterator]();!(M=(te=re.next()).done);M=!0){var ie=te.value;this._setVariable(ie)}}catch(m){z=!0,$=m}finally{try{!M&&re.return&&re.return()}finally{if(z)throw $}}}},{key:"_setVariable",value:function(m){m.isNull?this._variables.delete(m.name):this._variables.set(m.name,m)}},{key:"id",get:function(){return this._id}},{key:"aoiEntryPoint",get:function(){return this._aoiEntryPoint}}],[{key:"fromSFSArray",value:function(m){var M=new e(m.get(0)),z=m.get(1);if(null!=z)for(var $=0;$<z.size();$++)M._setVariable(te.MMOItemVariable.fromSFSArray(z.get($)));return M}}]),e}();M.MMOItem=re},function(m,M){!function(m){"use strict";function t(m,M,z){return M<=m&&m<=z}function n(m,M){return Math.floor(m/M)}var M=-1,z=-1;function o(m,M){if(m)throw new Error("EncodingError");return M||65533}function s(m){throw new Error("EncodingError")}function a(m){if(m=String(m).trim().toLowerCase(),Object.prototype.hasOwnProperty.call(te,m))return te[m];throw new Error("EncodingError: Unknown encoding: "+m)}var $={},te={};function l(m,M){return(M||[])[m]||null}function f(m,M){var z=M.indexOf(m);return-1===z?null:z}[{encodings:[{labels:["unicode-1-1-utf-8","utf-8","utf8"],name:"utf-8"}],heading:"The Encoding"},{encodings:[{labels:["cp864","ibm864"],name:"ibm864"},{labels:["cp866","ibm866"],name:"ibm866"},{labels:["csisolatin2","iso-8859-2","iso-ir-101","iso8859-2","iso_8859-2","l2","latin2"],name:"iso-8859-2"},{labels:["csisolatin3","iso-8859-3","iso_8859-3","iso-ir-109","l3","latin3"],name:"iso-8859-3"},{labels:["csisolatin4","iso-8859-4","iso_8859-4","iso-ir-110","l4","latin4"],name:"iso-8859-4"},{labels:["csisolatincyrillic","cyrillic","iso-8859-5","iso_8859-5","iso-ir-144"],name:"iso-8859-5"},{labels:["arabic","csisolatinarabic","ecma-114","iso-8859-6","iso_8859-6","iso-ir-127"],name:"iso-8859-6"},{labels:["csisolatingreek","ecma-118","elot_928","greek","greek8","iso-8859-7","iso_8859-7","iso-ir-126"],name:"iso-8859-7"},{labels:["csisolatinhebrew","hebrew","iso-8859-8","iso-8859-8-i","iso-ir-138","iso_8859-8","visual"],name:"iso-8859-8"},{labels:["csisolatin6","iso-8859-10","iso-ir-157","iso8859-10","l6","latin6"],name:"iso-8859-10"},{labels:["iso-8859-13"],name:"iso-8859-13"},{labels:["iso-8859-14","iso8859-14"],name:"iso-8859-14"},{labels:["iso-8859-15","iso_8859-15"],name:"iso-8859-15"},{labels:["iso-8859-16"],name:"iso-8859-16"},{labels:["koi8-r","koi8_r"],name:"koi8-r"},{labels:["koi8-u"],name:"koi8-u"},{labels:["csmacintosh","mac","macintosh","x-mac-roman"],name:"macintosh"},{labels:["iso-8859-11","tis-620","windows-874"],name:"windows-874"},{labels:["windows-1250","x-cp1250"],name:"windows-1250"},{labels:["windows-1251","x-cp1251"],name:"windows-1251"},{labels:["ascii","ansi_x3.4-1968","csisolatin1","iso-8859-1","iso8859-1","iso_8859-1","l1","latin1","us-ascii","windows-1252"],name:"windows-1252"},{labels:["cp1253","windows-1253"],name:"windows-1253"},{labels:["csisolatin5","iso-8859-9","iso-ir-148","l5","latin5","windows-1254"],name:"windows-1254"},{labels:["cp1255","windows-1255"],name:"windows-1255"},{labels:["cp1256","windows-1256"],name:"windows-1256"},{labels:["windows-1257"],name:"windows-1257"},{labels:["cp1258","windows-1258"],name:"windows-1258"},{labels:["x-mac-cyrillic","x-mac-ukrainian"],name:"x-mac-cyrillic"}],heading:"Legacy single-byte encodings"},{encodings:[{labels:["chinese","csgb2312","csiso58gb231280","gb2312","gbk","gb_2312","gb_2312-80","iso-ir-58","x-gbk"],name:"gbk"},{labels:["gb18030"],name:"gb18030"},{labels:["hz-gb-2312"],name:"hz-gb-2312"}],heading:"Legacy multi-byte Chinese (simplified) encodings"},{encodings:[{labels:["big5","big5-hkscs","cn-big5","csbig5","x-x-big5"],name:"big5"}],heading:"Legacy multi-byte Chinese (traditional) encodings"},{encodings:[{labels:["cseucpkdfmtjapanese","euc-jp","x-euc-jp"],name:"euc-jp"},{labels:["csiso2022jp","iso-2022-jp"],name:"iso-2022-jp"},{labels:["csshiftjis","ms_kanji","shift-jis","shift_jis","sjis","windows-31j","x-sjis"],name:"shift_jis"}],heading:"Legacy multi-byte Japanese encodings"},{encodings:[{labels:["cseuckr","csksc56011987","euc-kr","iso-ir-149","korean","ks_c_5601-1987","ks_c_5601-1989","ksc5601","ksc_5601","windows-949"],name:"euc-kr"},{labels:["csiso2022kr","iso-2022-kr"],name:"iso-2022-kr"}],heading:"Legacy multi-byte Korean encodings"},{encodings:[{labels:["utf-16","utf-16le"],name:"utf-16"},{labels:["utf-16be"],name:"utf-16be"}],heading:"Legacy utf-16 encodings"}].forEach((function(m){m.encodings.forEach((function(m){$[m.name]=m,m.labels.forEach((function(M){te[M]=m}))}))}));var re=m["encoding-indexes"]||{};function _(m,$){var te=$.fatal,ie=0,oe=0,se=0;this.decode=function($){var ae,ue=$.get();if(ue===M&&0===ie&&0===oe&&0===se)return z;if(ue!==M||0===ie&&0===oe&&0===se||(ie=0,oe=0,se=0,o(te)),$.offset(1),0!==se)return ae=null,t(ue,48,57)&&(ae=function(m){if(m>39419&&m<189e3||m>1237575)return null;var M,z=0,$=0,te=re.gb18030;for(M=0;M<te.length;++M){var ie=te[M];if(!(ie[0]<=m))break;z=ie[0],$=ie[1]}return $+m-z}(10*(126*(10*(ie-129)+(oe-48))+(se-129))+ue-48)),ie=0,oe=0,se=0,null===ae?($.offset(-3),o(te)):ae;if(0!==oe)return t(ue,129,254)?(se=ue,null):($.offset(-2),ie=0,oe=0,o(te));if(0!==ie){if(t(ue,48,57)&&m)return oe=ue,null;var ce=ie,le=null;ie=0;var fe=ue<127?64:65;return(t(ue,64,126)||t(ue,128,254))&&(le=190*(ce-129)+(ue-fe)),ae=null===le?null:l(le,re.gbk),null===le&&$.offset(-1),null===ae?o(te):ae}return t(ue,0,127)?ue:128===ue?8364:t(ue,129,254)?(ie=ue,null):o(te)}}function y(m,$){$.fatal,this.encode=function($,te){var ie=te.get();if(ie===z)return M;if(te.offset(1),t(ie,0,127))return $.emit(ie);var oe=f(ie,re.gbk);if(null!==oe){var se=n(oe,190)+129,ae=oe%190,ue=ae<63?64:65;return $.emit(se,ae+ue)}if(null===oe&&!m)return s();var ce=n(n(n(oe=function(m){var M,z=0,$=0,te=re.gb18030;for(M=0;M<te.length;++M){var ie=te[M];if(!(ie[1]<=m))break;z=ie[1],$=ie[0]}return $+m-z}(ie),10),126),10),le=n(n(oe-=10*ce*126*10,10),126),fe=n(oe-=10*le*126,10),he=oe-10*fe;return $.emit(ce+129,le+48,fe+129,he+48)}}function p(m,$){var te=$.fatal,re=null,ie=null;this.decode=function($){var oe,se=$.get();if(se===M&&null===re&&null===ie)return z;if(se===M&&(null!==re||null!==ie))return o(te);if($.offset(1),null===re)return re=se,null;if(oe=m?(re<<8)+se:(se<<8)+re,re=null,null!==ie){var ae=ie;return ie=null,t(oe,56320,57343)?65536+1024*(ae-55296)+(oe-56320):($.offset(-2),o(te))}return t(oe,55296,56319)?(ie=oe,null):t(oe,56320,57343)?o(te):oe}}function d(m,$){$.fatal,this.encode=function($,te){function u(M){var z=M>>8,te=255&M;return m?$.emit(z,te):$.emit(te,z)}var re=te.get();if(re===z)return M;if(te.offset(1),t(re,55296,57343)&&s(),re<=65535)return u(re);var ie=(re-65536)%1024+56320;return u(n(re-65536,1024)+55296),u(ie)}}$["utf-8"].getEncoder=function(m){return new function(m){m.fatal,this.encode=function(m,$){var te,re,ie=$.get();if(ie===z)return M;if($.offset(1),t(ie,55296,57343))return s();if(t(ie,0,127))return m.emit(ie);t(ie,128,2047)?(te=1,re=192):t(ie,2048,65535)?(te=2,re=224):t(ie,65536,1114111)&&(te=3,re=240);for(var oe=m.emit(n(ie,Math.pow(64,te))+re);te>0;){var se=n(ie,Math.pow(64,te-1));oe=m.emit(128+se%64),te-=1}return oe}}(m)},$["utf-8"].getDecoder=function(m){return new function(m){var $=m.fatal,te=0,re=0,ie=0,oe=0;this.decode=function(m){var se=m.get();if(se===M)return 0!==re?o($):z;if(m.offset(1),0===re){if(t(se,0,127))return se;if(t(se,194,223))re=1,oe=128,te=se-192;else if(t(se,224,239))re=2,oe=2048,te=se-224;else{if(!t(se,240,244))return o($);re=3,oe=65536,te=se-240}return te*=Math.pow(64,re),null}if(!t(se,128,191))return te=0,re=0,ie=0,oe=0,m.offset(-1),o($);if(ie+=1,te+=(se-128)*Math.pow(64,re-ie),ie!==re)return null;var ae=te,ue=oe;return te=0,re=0,ie=0,oe=0,t(ae,ue,1114111)&&!t(ae,55296,57343)?ae:o($)}}(m)},["ibm864","ibm866","iso-8859-2","iso-8859-3","iso-8859-4","iso-8859-5","iso-8859-6","iso-8859-7","iso-8859-8","iso-8859-10","iso-8859-13","iso-8859-14","iso-8859-15","iso-8859-16","koi8-r","koi8-u","macintosh","windows-874","windows-1250","windows-1251","windows-1252","windows-1253","windows-1254","windows-1255","windows-1256","windows-1257","windows-1258","x-mac-cyrillic"].forEach((function(m){var te=$[m],ie=re[m];te.getDecoder=function(m){return new function(m,$){var te=$.fatal;this.decode=function($){var re=$.get();if(re===M)return z;if($.offset(1),t(re,0,127))return re;var ie=m[re-128];return null===ie?o(te):ie}}(ie,m)},te.getEncoder=function(m){return new function(m,$){$.fatal,this.encode=function($,te){var re=te.get();if(re===z)return M;if(te.offset(1),t(re,0,127))return $.emit(re);var ie=f(re,m);return null===ie&&s(),$.emit(ie+128)}}(ie,m)}})),$.gbk.getEncoder=function(m){return new y(!1,m)},$.gbk.getDecoder=function(m){return new _(!1,m)},$.gb18030.getEncoder=function(m){return new y(!0,m)},$.gb18030.getDecoder=function(m){return new _(!0,m)},$["hz-gb-2312"].getEncoder=function(m){return new function(m){m.fatal;var $=!1;this.encode=function(m,te){var ie=te.get();if(ie===z)return M;if(te.offset(1),t(ie,0,127)&&$)return te.offset(-1),$=!1,m.emit(126,125);if(126===ie)return m.emit(126,126);if(t(ie,0,127))return m.emit(ie);if(!$)return te.offset(-1),$=!0,m.emit(126,123);var oe=f(ie,re.gbk);if(null===oe)return s();var se=n(oe,190)+1,ae=oe%190-63;return t(se,33,126)&&t(ae,33,126)?m.emit(se,ae):s()}}(m)},$["hz-gb-2312"].getDecoder=function(m){return new function(m){var $=m.fatal,te=!1,ie=0;this.decode=function(m){var oe=m.get();if(oe===M&&0===ie)return z;if(oe===M&&0!==ie)return ie=0,o($);if(m.offset(1),126===ie)return ie=0,123===oe?(te=!0,null):125===oe?(te=!1,null):126===oe?126:10===oe?null:(m.offset(-1),o($));if(0!==ie){var se=ie;ie=0;var ae=null;return t(oe,33,126)&&(ae=l(190*(se-1)+(oe+63),re.gbk)),10===oe&&(te=!1),null===ae?o($):ae}return 126===oe?(ie=126,null):te?t(oe,32,127)?(ie=oe,null):(10===oe&&(te=!1),o($)):t(oe,0,127)?oe:o($)}}(m)},$.big5.getEncoder=function(m){return new function(m){m.fatal,this.encode=function(m,$){var te=$.get();if(te===z)return M;if($.offset(1),t(te,0,127))return m.emit(te);var ie=f(te,re.big5);if(null===ie)return s();var oe=n(ie,157)+129,se=ie%157,ae=se<63?64:98;return m.emit(oe,se+ae)}}(m)},$.big5.getDecoder=function(m){return new function(m){var $=m.fatal,te=0,ie=null;this.decode=function(m){if(null!==ie){var oe=ie;return ie=null,oe}var se=m.get();if(se===M&&0===te)return z;if(se===M&&0!==te)return te=0,o($);if(m.offset(1),0!==te){var ae=te,ue=null;te=0;var ce=se<127?64:98;if((t(se,64,126)||t(se,161,254))&&(ue=157*(ae-129)+(se-ce)),1133===ue)return ie=772,202;if(1135===ue)return ie=780,202;if(1164===ue)return ie=772,234;if(1166===ue)return ie=780,234;var le=null===ue?null:l(ue,re.big5);return null===ue&&m.offset(-1),null===le?o($):le}return t(se,0,127)?se:t(se,129,254)?(te=se,null):o($)}}(m)},$["euc-jp"].getEncoder=function(m){return new function(m){m.fatal,this.encode=function(m,$){var te=$.get();if(te===z)return M;if($.offset(1),t(te,0,127))return m.emit(te);if(165===te)return m.emit(92);if(8254===te)return m.emit(126);if(t(te,65377,65439))return m.emit(142,te-65377+161);var ie=f(te,re.jis0208);if(null===ie)return s();var oe=n(ie,94)+161,se=ie%94+161;return m.emit(oe,se)}}(m)},$["euc-jp"].getDecoder=function(m){return new function(m){var $=m.fatal,te=0,ie=0;this.decode=function(m){var oe,se,ae=m.get();return ae===M?0===te&&0===ie?z:(te=0,ie=0,o($)):(m.offset(1),0!==ie?(oe=ie,ie=0,se=null,t(oe,161,254)&&t(ae,161,254)&&(se=l(94*(oe-161)+ae-161,re.jis0212)),t(ae,161,254)||m.offset(-1),null===se?o($):se):142===te&&t(ae,161,223)?(te=0,65377+ae-161):143===te&&t(ae,161,254)?(te=0,ie=ae,null):0!==te?(oe=te,te=0,se=null,t(oe,161,254)&&t(ae,161,254)&&(se=l(94*(oe-161)+ae-161,re.jis0208)),t(ae,161,254)||m.offset(-1),null===se?o($):se):t(ae,0,127)?ae:142===ae||143===ae||t(ae,161,254)?(te=ae,null):o($))}}(m)},$["iso-2022-jp"].getEncoder=function(m){return new function(m){m.fatal;var $=0;this.encode=function(m,te){var ie=te.get();if(ie===z)return M;if(te.offset(1),(t(ie,0,127)||165===ie||8254===ie)&&0!==$)return te.offset(-1),$=0,m.emit(27,40,66);if(t(ie,0,127))return m.emit(ie);if(165===ie)return m.emit(92);if(8254===ie)return m.emit(126);if(t(ie,65377,65439)&&2!==$)return te.offset(-1),$=2,m.emit(27,40,73);if(t(ie,65377,65439))return m.emit(ie-65377-33);if(1!==$)return te.offset(-1),$=1,m.emit(27,36,66);var oe=f(ie,re.jis0208);if(null===oe)return s();var se=n(oe,94)+33,ae=oe%94+33;return m.emit(se,ae)}}(m)},$["iso-2022-jp"].getDecoder=function(m){return new function(m){var $=m.fatal,te=0,ie=!1,oe=0;this.decode=function(m){var se=m.get();switch(se!==M&&m.offset(1),te){default:case 0:return 27===se?(te=1,null):t(se,0,127)?se:se===M?z:o($);case 1:return 36===se||40===se?(oe=se,te=2,null):(se!==M&&m.offset(-1),te=0,o($));case 2:var ae=oe;return oe=0,36!==ae||64!==se&&66!==se?36===ae&&40===se?(te=3,null):40!==ae||66!==se&&74!==se?40===ae&&73===se?(te=6,null):(se===M?m.offset(-1):m.offset(-2),te=0,o($)):(te=0,null):(ie=!1,te=4,null);case 3:return 68===se?(ie=!0,te=4,null):(se===M?m.offset(-2):m.offset(-3),te=0,o($));case 4:return 10===se?(te=0,o($,10)):27===se?(te=1,null):se===M?z:(oe=se,te=5,null);case 5:if(te=4,se===M)return o($);var ue=null,ce=94*(oe-33)+se-33;return t(oe,33,126)&&t(se,33,126)&&(ue=l(ce,!1===ie?re.jis0208:re.jis0212)),null===ue?o($):ue;case 6:return 27===se?(te=1,null):t(se,33,95)?65377+se-33:se===M?z:o($)}}}(m)},$.shift_jis.getEncoder=function(m){return new function(m){m.fatal,this.encode=function(m,$){var te=$.get();if(te===z)return M;if($.offset(1),t(te,0,128))return m.emit(te);if(165===te)return m.emit(92);if(8254===te)return m.emit(126);if(t(te,65377,65439))return m.emit(te-65377+161);var ie=f(te,re.jis0208);if(null===ie)return s();var oe=n(ie,188),se=oe<31?129:193,ae=ie%188,ue=ae<63?64:65;return m.emit(oe+se,ae+ue)}}(m)},$.shift_jis.getDecoder=function(m){return new function(m){var $=m.fatal,te=0;this.decode=function(m){var ie=m.get();if(ie===M&&0===te)return z;if(ie===M&&0!==te)return te=0,o($);if(m.offset(1),0!==te){var oe=te;if(te=0,t(ie,64,126)||t(ie,128,252)){var se=l(188*(oe-(oe<160?129:193))+ie-(ie<127?64:65),re.jis0208);return null===se?o($):se}return m.offset(-1),o($)}return t(ie,0,128)?ie:t(ie,161,223)?65377+ie-161:t(ie,129,159)||t(ie,224,252)?(te=ie,null):o($)}}(m)},$["euc-kr"].getEncoder=function(m){return new function(m){m.fatal,this.encode=function(m,$){var te=$.get();if(te===z)return M;if($.offset(1),t(te,0,127))return m.emit(te);var ie,oe,se=f(te,re["euc-kr"]);if(null===se)return s();if(se<12460){ie=n(se,178)+129;var ae=(oe=se%178)<26?65:oe<52?71:77;return m.emit(ie,oe+ae)}return ie=n(se-=12460,94)+199,oe=se%94+161,m.emit(ie,oe)}}(m)},$["euc-kr"].getDecoder=function(m){return new function(m){var $=m.fatal,te=0;this.decode=function(m){var ie=m.get();if(ie===M&&0===te)return z;if(ie===M&&0!==te)return te=0,o($);if(m.offset(1),0!==te){var oe=te,se=null;if(te=0,t(oe,129,198)){var ae=178*(oe-129);t(ie,65,90)?se=ae+ie-65:t(ie,97,122)?se=ae+26+ie-97:t(ie,129,254)&&(se=ae+26+26+ie-129)}t(oe,199,253)&&t(ie,161,254)&&(se=12460+94*(oe-199)+(ie-161));var ue=null===se?null:l(se,re["euc-kr"]);return null===se&&m.offset(-1),null===ue?o($):ue}return t(ie,0,127)?ie:t(ie,129,253)?(te=ie,null):o($)}}(m)},$["iso-2022-kr"].getEncoder=function(m){return new function(m){m.fatal;var $=!1,te=0;this.encode=function(m,ie){var oe=ie.get();if(oe===z)return M;if($||($=!0,m.emit(27,36,41,67)),ie.offset(1),t(oe,0,127)&&0!==te)return ie.offset(-1),te=0,m.emit(15);if(t(oe,0,127))return m.emit(oe);if(1!==te)return ie.offset(-1),te=1,m.emit(14);var se,ae,ue=f(oe,re["euc-kr"]);return null===ue?s():ue<12460?(ae=ue%178-26-26+1,t(se=n(ue,178)+1,33,70)&&t(ae,33,126)?m.emit(se,ae):s()):(ae=(ue-=12460)%94+33,t(se=n(ue,94)+71,71,126)&&t(ae,33,126)?m.emit(se,ae):s())}}(m)},$["iso-2022-kr"].getDecoder=function(m){return new function(m){var $=m.fatal,te=0,ie=0;this.decode=function(m){var oe=m.get();switch(oe!==M&&m.offset(1),te){default:case 0:return 14===oe?(te=4,null):15===oe?null:27===oe?(te=1,null):t(oe,0,127)?oe:oe===M?z:o($);case 1:return 36===oe?(te=2,null):(oe!==M&&m.offset(-1),te=0,o($));case 2:return 41===oe?(te=3,null):(oe===M?m.offset(-1):m.offset(-2),te=0,o($));case 3:return 67===oe?(te=0,null):(oe===M?m.offset(-2):m.offset(-3),te=0,o($));case 4:return 10===oe?(te=0,o($,10)):14===oe?null:15===oe?(te=0,null):oe===M?z:(ie=oe,te=5,null);case 5:if(te=4,oe===M)return o($);var se=null;return t(ie,33,70)&&t(oe,33,126)?se=l(178*(ie-1)+26+26+oe-1,re["euc-kr"]):t(ie,71,126)&&t(oe,33,126)&&(se=l(12460+94*(ie-71)+(oe-33),re["euc-kr"])),null!==se?se:o($)}}}(m)},$["utf-16"].getEncoder=function(m){return new d(!1,m)},$["utf-16"].getDecoder=function(m){return new p(!1,m)},$["utf-16be"].getEncoder=function(m){return new d(!0,m)},$["utf-16be"].getDecoder=function(m){return new p(!0,m)};var ie="utf-8";function v(M,z){return this&&this!==m?(M=M?String(M):ie,z=Object(z),this._encoding=a(M),this._streaming=!1,this._encoder=null,this._options={fatal:Boolean(z.fatal)},Object.defineProperty?Object.defineProperty(this,"encoding",{get:function(){return this._encoding.name}}):this.encoding=this._encoding.name,this):new v(M,z)}function b(M,z){return this&&this!==m?(M=M?String(M):ie,z=Object(z),this._encoding=a(M),this._streaming=!1,this._decoder=null,this._options={fatal:Boolean(z.fatal)},Object.defineProperty?Object.defineProperty(this,"encoding",{get:function(){return this._encoding.name}}):this.encoding=this._encoding.name,this):new b(M,z)}v.prototype={encode:function(m,$){m=m?String(m):"",$=Object($),this._streaming||(this._encoder=this._encoding.getEncoder(this._options)),this._streaming=Boolean($.stream);for(var te=[],re=new function(m){var z=0;this.emit=function($){var te,re=M;for(te=0;te<arguments.length;++te)re=Number(arguments[te]),m[z++]=re;return re}}(te),ie=new function(m){var M=0,$=function(){for(var M=[],z=0,$=m.length;z<m.length;){var te=m.charCodeAt(z);if(t(te,55296,57343))if(t(te,56320,57343))M.push(65533);else if(z===$-1)M.push(65533);else{var re=m.charCodeAt(z+1);if(t(re,56320,57343)){var ie=1023&te,oe=1023&re;z+=1,M.push(65536+(ie<<10)+oe)}else M.push(65533)}else M.push(te);z+=1}return M}();this.offset=function(m){if((M+=m)<0)throw new Error("Seeking past start of the buffer");if(M>$.length)throw new Error("Seeking past EOF")},this.get=function(){return M>=$.length?z:$[M]}}(m);ie.get()!==z;)this._encoder.encode(re,ie);if(!this._streaming){var oe;do{oe=this._encoder.encode(re,ie)}while(oe!==M);this._encoder=null}return new Uint8Array(te)}},b.prototype={decode:function(m,$){if(m&&!("buffer"in m&&"byteOffset"in m&&"byteLength"in m))throw new TypeError("Expected ArrayBufferView");m||(m=new Uint8Array(0)),$=Object($),this._streaming||(this._decoder=this._encoding.getDecoder(this._options)),this._streaming=Boolean($.stream);var te=new function(m){var z=0;this.get=function(){return z>=m.length?M:Number(m[z])},this.offset=function(M){if((z+=M)<0)throw new Error("Seeking past start of the buffer");if(z>m.length)throw new Error("Seeking past EOF")},this.match=function(M){if(M.length>z+m.length)return!1;var $;for($=0;$<M.length;$+=1)if(Number(m[z+$])!==M[$])return!1;return!0}}(new Uint8Array(m.buffer,m.byteOffset,m.byteLength));if(a(function(m,M){return M.match([255,254])?(M.offset(2),"utf-16"):M.match([254,255])?(M.offset(2),"utf-16be"):M.match([239,187,191])?(M.offset(3),"utf-8"):m}(this._encoding.name,te))!==this._encoding)throw new Error("BOM mismatch");for(var re,ie=new function(){var m="";this.string=function(){return m},this.emit=function(M){M<=65535?m+=String.fromCharCode(M):(M-=65536,m+=String.fromCharCode(55296+(M>>10&1023)),m+=String.fromCharCode(56320+(1023&M)))}};te.get()!==M;)null!==(re=this._decoder.decode(te))&&re!==z&&ie.emit(re);if(!this._streaming){do{null!==(re=this._decoder.decode(te))&&re!==z&&ie.emit(re)}while(re!==z);this._decoder=null}return ie.string()}},m.TextEncoder=m.TextEncoder||v,m.TextDecoder=m.TextDecoder||b}(this)},function(m,M){m.exports=function(m){return m.webpackPolyfill||(m.deprecate=function(){},m.paths=[],m.children||(m.children=[]),Object.defineProperty(m,"loaded",{enumerable:!0,get:function(){return m.l}}),Object.defineProperty(m,"id",{enumerable:!0,get:function(){return m.i}}),m.webpackPolyfill=1),m}},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SFSDataSerializer=void 0;var $,te=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),re=($=z(120))&&$.__esModule?$:{default:$},ie=z(170),oe=z(8),se=Symbol(),ae=Symbol(),ue=function(){function e(m){if(function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),m!==ae)throw"SFSDataSerializer is a singleton class; you can't instantiate it"}return te(e,[{key:"object2binary",value:function(m){var M=new re.default(new ArrayBuffer(0),0,re.default.BIG_ENDIAN);return M.writeInt8(oe.SFSDataType.SFS_OBJECT),M.writeInt16(m.size()),this.obj2bin(m,M),new Uint8Array(M.buffer)}},{key:"obj2bin",value:function(m,M){var z=!0,$=!1,te=void 0;try{for(var re,ie=m.keys()[Symbol.iterator]();!(z=(re=ie.next()).done);z=!0){var oe=re.value,se=m.getWrappedItem(oe);this.encodeSFSObjectKey(M,oe),this.encodeObject(M,se)}}catch(m){$=!0,te=m}finally{try{!z&&ie.return&&ie.return()}finally{if($)throw te}}}},{key:"array2binary",value:function(m){var M=new re.default(new ArrayBuffer(0),0,re.default.BIG_ENDIAN);return M.writeInt8(oe.SFSDataType.SFS_ARRAY),M.writeInt16(m.size()),this.arr2bin(m,M),new Uint8Array(M.buffer)}},{key:"arr2bin",value:function(m,M){for(var z=0;z<m.size();z++){var $=m.getWrappedItem(z);this.encodeObject(M,$)}}},{key:"encodeSFSObjectKey",value:function(m,M){m.writeInt16(M.length),m.writeUint8Array(new ie.TextEncoder("utf-8").encode(M))}},{key:"encodeObject",value:function(m,M){var z=M.type;if(z===oe.SFSDataType.NULL)this.binEncode_NULL(m,M);else if(z===oe.SFSDataType.BOOL)this.binEncode_BOOL(m,M);else if(z===oe.SFSDataType.BOOL_ARRAY)this.binEncode_BOOL_ARRAY(m,M);else if(z===oe.SFSDataType.BYTE)this.binEncode_BYTE(m,M);else if(z===oe.SFSDataType.BYTE_ARRAY)this.binEncode_BYTE_ARRAY(m,M);else if(z===oe.SFSDataType.SHORT)this.binEncode_SHORT(m,M);else if(z===oe.SFSDataType.SHORT_ARRAY)this.binEncode_SHORT_ARRAY(m,M);else if(z===oe.SFSDataType.INT)this.binEncode_INT(m,M);else if(z===oe.SFSDataType.INT_ARRAY)this.binEncode_INT_ARRAY(m,M);else if(z===oe.SFSDataType.LONG)this.binEncode_LONG(m,M);else if(z===oe.SFSDataType.LONG_ARRAY)this.binEncode_LONG_ARRAY(m,M);else if(z===oe.SFSDataType.FLOAT)this.binEncode_FLOAT(m,M);else if(z===oe.SFSDataType.FLOAT_ARRAY)this.binEncode_FLOAT_ARRAY(m,M);else if(z===oe.SFSDataType.DOUBLE)this.binEncode_DOUBLE(m,M);else if(z===oe.SFSDataType.DOUBLE_ARRAY)this.binEncode_DOUBLE_ARRAY(m,M);else if(z===oe.SFSDataType.UTF_STRING)this.binEncode_UTF_STRING(m,M);else if(z===oe.SFSDataType.TEXT)this.binEncode_TEXT(m,M);else if(z===oe.SFSDataType.UTF_STRING_ARRAY)this.binEncode_UTF_STRING_ARRAY(m,M);else if(z===oe.SFSDataType.SFS_ARRAY)m.writeUint8Array(this.array2binary(M.value));else{if(z!==oe.SFSDataType.SFS_OBJECT)throw"Unknow SFSDataType ID: "+z;m.writeUint8Array(this.object2binary(M.value))}return m}},{key:"binEncode_NULL",value:function(m,M){m.writeUint8(M.type)}},{key:"binEncode_BOOL",value:function(m,M){m.writeUint8(M.type),m.writeUint8(M.value?1:0)}},{key:"binEncode_BOOL_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++)m.writeUint8(z[$]?1:0)}},{key:"binEncode_BYTE",value:function(m,M){m.writeUint8(M.type),m.writeUint8(M.value)}},{key:"binEncode_BYTE_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint32(z.length),m.writeUint8Array(z)}},{key:"binEncode_SHORT",value:function(m,M){m.writeUint8(M.type),m.writeUint16(M.value)}},{key:"binEncode_SHORT_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++)m.writeUint16(z[$])}},{key:"binEncode_INT",value:function(m,M){m.writeUint8(M.type),m.writeUint32(M.value)}},{key:"binEncode_INT_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++)m.writeUint32(z[$])}},{key:"binEncode_LONG",value:function(m,M){var z=M.value,$=Math.floor(z/Math.pow(2,32)),te=z%Math.pow(2,32);m.writeUint8(M.type),m.writeInt32($),m.writeInt32(te)}},{key:"binEncode_LONG_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++){var te=z[$],re=Math.floor(te/Math.pow(2,32)),ie=te%Math.pow(2,32);m.writeInt32(re),m.writeInt32(ie)}}},{key:"binEncode_FLOAT",value:function(m,M){m.writeUint8(M.type),m.writeFloat32(M.value)}},{key:"binEncode_FLOAT_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++)m.writeFloat32(z[$])}},{key:"binEncode_DOUBLE",value:function(m,M){m.writeUint8(M.type),m.writeFloat64(M.value)}},{key:"binEncode_DOUBLE_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++)m.writeFloat64(z[$])}},{key:"binEncode_UTF_STRING",value:function(m,M){var z=new ie.TextEncoder("utf-8").encode(M.value);m.writeUint8(M.type),m.writeUint16(z.length),m.writeUint8Array(z)}},{key:"binEncode_TEXT",value:function(m,M){var z=new ie.TextEncoder("utf-8").encode(M.value);m.writeUint8(M.type),m.writeUint32(z.length),m.writeUint8Array(z)}},{key:"binEncode_UTF_STRING_ARRAY",value:function(m,M){var z=M.value;m.writeUint8(M.type),m.writeUint16(z.length);for(var $=0;$<z.length;$++){var te=new ie.TextEncoder("utf-8").encode(z[$]);m.writeUint16(te.byteLength),m.writeUint8Array(te)}}},{key:"binary2object",value:function(m){if(m.byteLength<3)throw"Can't decode an SFSObject. Byte data is insufficient. Size: "+m.byteLength+" bytes";return this.decodeSFSObject(new re.default(m,0,re.default.BIG_ENDIAN))}},{key:"binary2array",value:function(m){if(m.byteLength<3)throw"Can't decode an SFSArray. Byte data is insufficient. Size: "+m.byteLength+" bytes";return this.decodeSFSArray(new re.default(m,0,re.default.BIG_ENDIAN))}},{key:"decodeSFSObject",value:function(m){var M=new oe.SFSObject,z=m.readUint8();if(z!==oe.SFSDataType.SFS_OBJECT)throw"Invalid SFSDataType. Expected: "+oe.SFSDataType.SFS_OBJECT+", found: "+z;var $=m.readUint16();if($<0)throw"Can't decode SFSObject. Size is negative: "+$;try{for(var te=0;te<$;te++){var re=m.readUint16();if(re<0||re>255)throw"Invalid SFSObject key length. Found: "+re;var ie=m.readUint8Array(re),se=String.fromCharCode.apply(String,ie),ae=this.decodeObject(m);if(null==ae)throw"Could not decode value for key: "+se;M.put(se,ae.value,ae.type,!0)}}catch(m){throw m}return M}},{key:"decodeSFSArray",value:function(m){var M=new oe.SFSArray,z=m.readUint8();if(z!==oe.SFSDataType.SFS_ARRAY)throw"Invalid SFSDataType. Expected: "+oe.SFSDataType.SFS_ARRAY+", found: "+z;var $=m.readInt16();if($<0)throw"Can't decode SFSArray. Size is negative: "+$;try{for(var te=0;te<$;te++){var re=this.decodeObject(m);if(null==re)throw"Could not decode value for index: "+te;M.add(re.value,re.type,!0)}}catch(m){throw m}return M}},{key:"decodeObject",value:function(m){var M=null,z=m.readUint8();if(z===oe.SFSDataType.NULL)M=this.binDecode_NULL(m);else if(z===oe.SFSDataType.BOOL)M=this.binDecode_BOOL(m);else if(z===oe.SFSDataType.BOOL_ARRAY)M=this.binDecode_BOOL_ARRAY(m);else if(z===oe.SFSDataType.BYTE)M=this.binDecode_BYTE(m);else if(z===oe.SFSDataType.BYTE_ARRAY)M=this.binDecode_BYTE_ARRAY(m);else if(z===oe.SFSDataType.SHORT)M=this.binDecode_SHORT(m);else if(z===oe.SFSDataType.SHORT_ARRAY)M=this.binDecode_SHORT_ARRAY(m);else if(z===oe.SFSDataType.INT)M=this.binDecode_INT(m);else if(z===oe.SFSDataType.INT_ARRAY)M=this.binDecode_INT_ARRAY(m);else if(z===oe.SFSDataType.LONG)M=this.binDecode_LONG(m);else if(z===oe.SFSDataType.LONG_ARRAY)M=this.binDecode_LONG_ARRAY(m);else if(z===oe.SFSDataType.FLOAT)M=this.binDecode_FLOAT(m);else if(z===oe.SFSDataType.FLOAT_ARRAY)M=this.binDecode_FLOAT_ARRAY(m);else if(z===oe.SFSDataType.DOUBLE)M=this.binDecode_DOUBLE(m);else if(z===oe.SFSDataType.DOUBLE_ARRAY)M=this.binDecode_DOUBLE_ARRAY(m);else if(z===oe.SFSDataType.UTF_STRING)M=this.binDecode_UTF_STRING(m);else if(z===oe.SFSDataType.TEXT)M=this.binDecode_TEXT(m);else if(z===oe.SFSDataType.UTF_STRING_ARRAY)M=this.binDecode_UTF_STRING_ARRAY(m);else if(z===oe.SFSDataType.SFS_ARRAY){m.seek(m.position-1);var $=this.decodeSFSArray(m);M=new oe.SFSDataWrapper(z,$)}else{if(z!==oe.SFSDataType.SFS_OBJECT)throw"Unknow SFSDataType ID: "+z;m.seek(m.position-1);var te=this.decodeSFSObject(m);M=new oe.SFSDataWrapper(z,te)}return M}},{key:"binDecode_NULL",value:function(m){return new oe.SFSDataWrapper(oe.SFSDataType.NULL,null)}},{key:"binDecode_BOOL",value:function(m){var M=m.readUint8(),z=null;if(0===M)z=!1;else{if(1!==M)throw"Error decoding Bool type. Illegal value: "+M;z=!0}return new oe.SFSDataWrapper(oe.SFSDataType.BOOL,z)}},{key:"binDecode_BOOL_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++){var te=m.readUint8(),re=null;if(0===te)re=!1;else{if(1!==te)throw"Error decoding Bool type. Illegal value: "+te;re=!0}z.push(re)}return new oe.SFSDataWrapper(oe.SFSDataType.BOOL_ARRAY,z)}},{key:"binDecode_BYTE",value:function(m){var M=m.readUint8();return new oe.SFSDataWrapper(oe.SFSDataType.BYTE,M)}},{key:"binDecode_BYTE_ARRAY",value:function(m){var M=m.readInt32();if(M<0)throw"Error decoding typed array size. Negative size: "+M;for(var z=new Uint8Array(M),$=0;$<M;$++)z[$]=m.readUint8();return new oe.SFSDataWrapper(oe.SFSDataType.BYTE_ARRAY,z)}},{key:"binDecode_SHORT",value:function(m){var M=m.readInt16();return new oe.SFSDataWrapper(oe.SFSDataType.SHORT,M)}},{key:"binDecode_SHORT_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++)z.push(m.readInt16());return new oe.SFSDataWrapper(oe.SFSDataType.SHORT_ARRAY,z)}},{key:"binDecode_INT",value:function(m){var M=m.readInt32();return new oe.SFSDataWrapper(oe.SFSDataType.INT,M)}},{key:"binDecode_INT_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++)z.push(m.readInt32());return new oe.SFSDataWrapper(oe.SFSDataType.INT_ARRAY,z)}},{key:"binDecode_LONG",value:function(m){var M=m.readInt32(),z=m.readUint32(),$=M*Math.pow(2,32)+z;return new oe.SFSDataWrapper(oe.SFSDataType.LONG,$)}},{key:"binDecode_LONG_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++){var te=m.readInt32(),re=m.readUint32(),ie=te*Math.pow(2,32)+re;z.push(ie)}return new oe.SFSDataWrapper(oe.SFSDataType.LONG_ARRAY,z)}},{key:"binDecode_FLOAT",value:function(m){var M=m.readFloat32();return new oe.SFSDataWrapper(oe.SFSDataType.FLOAT,M)}},{key:"binDecode_FLOAT_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++)z.push(m.readFloat32());return new oe.SFSDataWrapper(oe.SFSDataType.FLOAT_ARRAY,z)}},{key:"binDecode_DOUBLE",value:function(m){var M=m.readFloat64();return new oe.SFSDataWrapper(oe.SFSDataType.DOUBLE,M)}},{key:"binDecode_DOUBLE_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++)z.push(m.readFloat64());return new oe.SFSDataWrapper(oe.SFSDataType.DOUBLE_ARRAY,z)}},{key:"binDecode_UTF_STRING",value:function(m){var M=m.readInt16();if(M<0)throw"Error decoding UTF_STRING. Negative size: "+M;var z=m.readUint8Array(M),$=new ie.TextDecoder("utf-8").decode(z);return new oe.SFSDataWrapper(oe.SFSDataType.UTF_STRING,$)}},{key:"binDecode_UTF_STRING_ARRAY",value:function(m){for(var M=this.getTypedArraySize(m),z=[],$=0;$<M;$++){var te=m.readInt16();if(te<0)throw"Error decoding UTF_STRING. Negative size: "+te;var re=m.readUint8Array(te),se=new ie.TextDecoder("utf-8").decode(re);z.push(se)}return new oe.SFSDataWrapper(oe.SFSDataType.UTF_STRING_ARRAY,z)}},{key:"binDecode_TEXT",value:function(m){var M=m.readInt32();if(M<0)throw"Error decoding TEXT. Negative size: "+M;var z=m.readUint8Array(M),$=new ie.TextDecoder("utf-8").decode(z);return new oe.SFSDataWrapper(oe.SFSDataType.TEXT,$)}},{key:"getTypedArraySize",value:function(m){var M=m.readUint16();if(M<0)throw"Error decoding typed array size. Negative size: "+M;return M}}],[{key:"instance",get:function(){return this[se]||(this[se]=new e(ae)),Object.seal(this[se])}}]),e}();M.SFSDataSerializer=ue},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SystemController=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(2),re=z(38),ie=z(73),oe=z(8),se=z(10),ae=z(47),ue=z(169),ce=z(57),le=z(71),fe=z(58),he=z(49),_e=z(72),ye=z(46),pe=z(51),de=z(118),ge=z(116),ve=z(115),be=z(70),me=z(114),Se=z(113),Ee=z(112),Re=z(69),Fe=z(111),je=z(110),Le=z(109),xe=z(108),qe=z(107),Ve=z(106),Ke=z(105),Ge=z(104),ze=z(68),He=z(168),Je=z(103),We=z(102),Xe=z(101),Ze=z(100),Qe=z(99),$e=z(98),et=z(97),tt=function(){function e(m){!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,e),this._sfs=m,this._logger=m.logger,this._id=0,this._messageHandlers=new Map,this._initMessageHandlers(),Object.freeze(this)}return $(e,null,[{key:"KEY_ERROR_CODE",get:function(){return"ec"}},{key:"KEY_ERROR_PARAMS",get:function(){return"ep"}},{key:"ROOM_PARAM",get:function(){return"r"}},{key:"USER_PARAM",get:function(){return"u"}},{key:"USER_COUNT_PARAM",get:function(){return"uc"}},{key:"SPECT_COUNT_PARAM",get:function(){return"sc"}},{key:"DISCONNECTION_REASON_PARAM",get:function(){return"dr"}}]),$(e,[{key:"handleMessage",value:function(m,M){var z=this._messageHandlers.get(M);null!=z?(this._sfs.debug&&this._logger.info("Handling server event: "+z.name+" ("+M+")"),z.handler.call(this,m)):this._logger.warn("Unknown server event received; id: "+M)}},{key:"_initMessageHandlers",value:function(){this._setHandler(te.Requests.Handshake,this._fnHandshake),this._setHandler(te.Requests.Login,this._fnLogin),this._setHandler(te.Requests.Logout,this._fnLogout),this._setHandler(te.Requests.JoinRoom,this._fnJoinRoom),this._setHandler(te.Requests.CreateRoom,this._fnCreateRoom),this._setHandler(te.Requests.ChangeRoomName,this._fnChangeRoomName),this._setHandler(te.Requests.ChangeRoomPassword,this._fnChangeRoomPassword),this._setHandler(te.Requests.ChangeRoomCapacity,this._fnChangeRoomCapacity),this._setHandler(te.Requests.GenericMessage,this._fnGenericMessage),this._setHandler(te.Requests.SetRoomVariables,this._fnSetRoomVariables),this._setHandler(te.Requests.SetUserVariables,this._fnSetUserVariables),this._setHandler(te.Requests.SubscribeRoomGroup,this._fnSubscribeRoomGroup),this._setHandler(te.Requests.UnsubscribeRoomGroup,this._fnUnsubscribeRoomGroup),this._setHandler(te.Requests.SpectatorToPlayer,this._fnSpectatorToPlayer),this._setHandler(te.Requests.PlayerToSpectator,this._fnPlayerToSpectator),this._setHandler(te.Requests.FindRooms,this._fnFindRooms),this._setHandler(te.Requests.FindUsers,this._fnFindUsers),this._setHandler(te.Requests.PingPong,this._fnPingPong),this._setHandler(te.Requests.InitBuddyList,this._fnInitBuddyList),this._setHandler(te.Requests.AddBuddy,this._fnAddBuddy),this._setHandler(te.Requests.RemoveBuddy,this._fnRemoveBuddy),this._setHandler(te.Requests.BlockBuddy,this._fnBlockBuddy),this._setHandler(te.Requests.GoOnline,this._fnGoOnline),this._setHandler(te.Requests.SetBuddyVariables,this._fnSetBuddyVariables),this._setHandler(te.Requests.QuickJoinGame,this._fnQuickJoinGame),this._setHandler(te.Requests.InviteUsers,this._fnInviteUsers),this._setHandler(te.Requests.InvitationReply,this._fnInvitationReply),this._setHandler(te.Requests.SetUserPosition,this._fnSetUserPosition),this._setHandler(1e3,this._fnUserEnterRoom,"UserEnterRoom"),this._setHandler(1001,this._fnUserCountChange,"UserCountChange"),this._setHandler(1002,this._fnUserLost,"UserLost"),this._setHandler(1003,this._fnRoomLost,"RoomLost"),this._setHandler(1004,this._fnUserExitRoom,"UserExitRoom"),this._setHandler(1005,this._fnClientDisconnection,"ClientDisconnection"),this._setHandler(1007,this._fnSetMMOItemVariables,"SetMMOItemVariables")}},{key:"_setHandler",value:function(m,M){var z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;null==z&&(z=te.Requests.getNameFromId(m)),this._messageHandlers.set(m,{name:z,handler:M})}},{key:"_fnHandshake",value:function(m){this._sfs._handleHandShake(m)}},{key:"_fnLogin",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){this._populateRoomList(m.get(de.LoginRequest.KEY_ROOMLIST)),this._sfs._mySelf=new ae.SFSUser(m.get(de.LoginRequest.KEY_ID),m.get(de.LoginRequest.KEY_USER_NAME),!0),this._sfs.mySelf._setUserManager(this._sfs.userManager),this._sfs.mySelf._privilegeId=m.get(de.LoginRequest.KEY_PRIVILEGE_ID),this._sfs.userManager._addUser(this._sfs.mySelf);var M={};M.zone=m.get(de.LoginRequest.KEY_ZONE_NAME),M.user=this._sfs.mySelf,M.data=m.get(de.LoginRequest.KEY_PARAMS),this._sfs.dispatchEvent(re.SFSEvent.LOGIN,M)}else this._dispatchError(re.SFSEvent.LOGIN_ERROR,m)}},{key:"_fnLogout",value:function(m){this._sfs._handleLogout();var M={};M.zone=m.get(ge.LogoutRequest.KEY_ZONE_NAME),this._sfs.dispatchEvent(re.SFSEvent.LOGOUT,M)}},{key:"_fnJoinRoom",value:function(m){if(this._sfs._isJoining=!1,null==m.get(e.KEY_ERROR_CODE)){var M=m.get(ve.JoinRoomRequest.KEY_ROOM),z=m.get(ve.JoinRoomRequest.KEY_USER_LIST),$=this._sfs.roomManager,te=se.SFSRoom.fromSFSArray(M);te=$._replaceRoom(te,$.containsGroup(te.groupId));for(var ie=0;ie<z.size();ie++){var oe=z.get(ie),ae=this._getOrCreateUser(oe,!0,te);te._addUser(ae)}te._isJoined=!0,this._sfs._lastJoinedRoom=te;var ue={};ue.room=te,this._sfs.dispatchEvent(re.SFSEvent.ROOM_JOIN,ue)}else this._dispatchError(re.SFSEvent.ROOM_JOIN_ERROR,m)}},{key:"_fnCreateRoom",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=se.SFSRoom.fromSFSArray(m.get(be.CreateRoomRequest.KEY_ROOM));this._sfs.roomManager._addRoom(M);var z={};z.room=M,this._sfs.dispatchEvent(re.SFSEvent.ROOM_ADD,z)}else this._dispatchError(re.SFSEvent.ROOM_CREATION_ERROR,m)}},{key:"_fnChangeRoomName",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(me.ChangeRoomNameRequest.KEY_ROOM),z=this._sfs.roomManager.getRoomById(M);if(null!=z){var $=z.name;this._sfs.roomManager._changeRoomName(z,m.get(me.ChangeRoomNameRequest.KEY_NAME));var te={};te.oldName=$,te.room=z,this._sfs.dispatchEvent(re.SFSEvent.ROOM_NAME_CHANGE,te)}else this._logger.warn("Unexpected RoomNameChange event error; unknown Room id: "+M)}else this._dispatchError(re.SFSEvent.ROOM_NAME_CHANGE_ERROR,m)}},{key:"_fnChangeRoomPassword",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(Se.ChangeRoomPasswordStateRequest.KEY_ROOM),z=this._sfs.roomManager.getRoomById(M);if(null!=z){this._sfs.roomManager._changeRoomPasswordState(z,m.get(Se.ChangeRoomPasswordStateRequest.KEY_PASS));var $={};$.room=z,this._sfs.dispatchEvent(re.SFSEvent.ROOM_PASSWORD_STATE_CHANGE,$)}else this._logger.warn("Unexpected RoomPasswordChange event error; unknown Room id: "+M)}else this._dispatchError(re.SFSEvent.ROOM_PASSWORD_STATE_CHANGE_ERROR,m)}},{key:"_fnChangeRoomCapacity",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(Ee.ChangeRoomCapacityRequest.KEY_ROOM),z=this._sfs.roomManager.getRoomById(M);if(null!=z){this._sfs.roomManager._changeRoomCapacity(z,m.get(Ee.ChangeRoomCapacityRequest.KEY_USER_SIZE),m.get(Ee.ChangeRoomCapacityRequest.KEY_SPEC_SIZE));var $={};$.room=z,this._sfs.dispatchEvent(re.SFSEvent.ROOM_CAPACITY_CHANGE,$)}else this._logger.warn("Unexpected RoomCapacityChange event error; unknown Room id: "+M)}else this._dispatchError(re.SFSEvent.ROOM_CAPACITY_CHANGE_ERROR,m)}},{key:"_fnGenericMessage",value:function(m){switch(m.get(Re.GenericMessageRequest.KEY_MESSAGE_TYPE)){case Re.GenericMessageType.PUBLIC_MSG:this._handlePublicMessage(m);break;case Re.GenericMessageType.PRIVATE_MSG:this._handlePrivateMessage(m);break;case Re.GenericMessageType.BUDDY_MSG:this._handleBuddyMessage(m);break;case Re.GenericMessageType.MODERATOR_MSG:this._handleModMessage(m);break;case Re.GenericMessageType.ADMING_MSG:this._handleAdminMessage(m);break;case Re.GenericMessageType.OBJECT_MSG:this._handleObjectMessage(m)}}},{key:"_handlePublicMessage",value:function(m){var M=m.get(Re.GenericMessageRequest.KEY_ROOM_ID),z=this._sfs.roomManager.getRoomById(M);if(null!=z){var $={};$.room=z,$.sender=this._sfs.userManager.getUserById(m.get(Re.GenericMessageRequest.KEY_USER_ID)),$.message=m.get(Re.GenericMessageRequest.KEY_MESSAGE),$.data=m.get(Re.GenericMessageRequest.KEY_XTRA_PARAMS),this._sfs.dispatchEvent(re.SFSEvent.PUBLIC_MESSAGE,$)}else this._logger.warn("Unexpected PublicMessage event error; unknown Room id: "+M)}},{key:"_handlePrivateMessage",value:function(m){var M=m.get(Re.GenericMessageRequest.KEY_USER_ID),z=this._sfs.userManager.getUserById(M);if(null==z){if(null==m.get(Re.GenericMessageRequest.KEY_SENDER_DATA))return void this._logger.warn("Unexpected PublicMessage event error; missing sender details");z=ae.SFSUser.fromSFSArray(m.get(Re.GenericMessageRequest.KEY_SENDER_DATA))}var $={};$.sender=z,$.message=m.get(Re.GenericMessageRequest.KEY_MESSAGE),$.data=m.get(Re.GenericMessageRequest.KEY_XTRA_PARAMS),this._sfs.dispatchEvent(re.SFSEvent.PRIVATE_MESSAGE,$)}},{key:"_handleBuddyMessage",value:function(m){var M=m.get(Re.GenericMessageRequest.KEY_USER_ID),z=this._sfs.buddyManager.getBuddyById(M),$={};$.isItMe=this._sfs.mySelf.id===M,$.buddy=z,$.message=m.get(Re.GenericMessageRequest.KEY_MESSAGE),$.data=m.get(Re.GenericMessageRequest.KEY_XTRA_PARAMS),this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_MESSAGE,$)}},{key:"_handleObjectMessage",value:function(m){var M={};M.sender=this._sfs.userManager.getUserById(m.get(Re.GenericMessageRequest.KEY_USER_ID)),M.message=m.get(Re.GenericMessageRequest.KEY_XTRA_PARAMS),this._sfs.dispatchEvent(re.SFSEvent.OBJECT_MESSAGE,M)}},{key:"_handleModMessage",value:function(m){var M={};M.sender=ae.SFSUser.fromSFSArray(m.get(Re.GenericMessageRequest.KEY_SENDER_DATA)),M.message=m.get(Re.GenericMessageRequest.KEY_MESSAGE),M.data=m.get(Re.GenericMessageRequest.KEY_XTRA_PARAMS),this._sfs.dispatchEvent(re.SFSEvent.MODERATOR_MESSAGE,M)}},{key:"_handleAdminMessage",value:function(m){var M={};M.sender=ae.SFSUser.fromSFSArray(m.get(Re.GenericMessageRequest.KEY_SENDER_DATA)),M.message=m.get(Re.GenericMessageRequest.KEY_MESSAGE),M.data=m.get(Re.GenericMessageRequest.KEY_XTRA_PARAMS),this._sfs.dispatchEvent(re.SFSEvent.ADMIN_MESSAGE,M)}},{key:"_fnSetRoomVariables",value:function(m){var M=m.get(Fe.SetRoomVariablesRequest.KEY_VAR_ROOM),z=m.get(Fe.SetRoomVariablesRequest.KEY_VAR_LIST),$=this._sfs.roomManager.getRoomById(M),te=new Set;if(null!=$){for(var ie=0;ie<z.size();ie++){var oe=he.SFSRoomVariable.fromSFSArray(z.get(ie));$._setVariable(oe),te.add(oe.name)}var se={};se.changedVars=Array.from(te),se.room=$,this._sfs.dispatchEvent(re.SFSEvent.ROOM_VARIABLES_UPDATE,se)}else this._logger.warn("Unexpected RoomVariablesUpdate event error; unknown Room id: "+M)}},{key:"_fnSetUserVariables",value:function(m){var M=m.get(je.SetUserVariablesRequest.KEY_USER),z=m.get(je.SetUserVariablesRequest.KEY_VAR_LIST),$=this._sfs.userManager.getUserById(M),te=new Set;if(null!=$){for(var ie=0;ie<z.size();ie++){var oe=fe.SFSUserVariable.fromSFSArray(z.get(ie));$._setVariable(oe),te.add(oe.name)}var se={};se.changedVars=Array.from(te),se.user=$,this._sfs.dispatchEvent(re.SFSEvent.USER_VARIABLES_UPDATE,se)}else this._logger.warn("Unexpected UserVariablesUpdate event error; unknown User id: "+M)}},{key:"_fnSubscribeRoomGroup",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(Le.SubscribeRoomGroupRequest.KEY_GROUP_ID),z=m.get(Le.SubscribeRoomGroupRequest.KEY_ROOM_LIST);this._sfs.roomManager.containsGroup(M)&&this._logger.warn("Unexpected SubscribeRoomGroup event error; group already subscribed: "+M),this._sfs.roomManager._addGroup(M),this._populateRoomList(z);var $={};$.groupId=M,$.newRooms=this._sfs.roomManager.getRoomListFromGroup(M),this._sfs.dispatchEvent(re.SFSEvent.ROOM_GROUP_SUBSCRIBE,$)}else this._dispatchError(re.SFSEvent.ROOM_GROUP_SUBSCRIBE_ERROR,m)}},{key:"_fnUnsubscribeRoomGroup",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(xe.UnsubscribeRoomGroupRequest.KEY_GROUP_ID);this._sfs.roomManager.containsGroup(M)||this._logger.warn("Unexpected UnsubscribeRoomGroup event error; group not found: "+M+" (maybe never subscribed, or the Room Manager doesn't contain Rooms belonging to that Group)"),this._sfs.roomManager._removeGroup(M);var z={};z.groupId=M,this._sfs.dispatchEvent(re.SFSEvent.ROOM_GROUP_UNSUBSCRIBE,z)}else this._dispatchError(re.SFSEvent.ROOM_GROUP_UNSUBSCRIBE_ERROR,m)}},{key:"_fnSpectatorToPlayer",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(qe.SpectatorToPlayerRequest.KEY_ROOM_ID),z=m.get(qe.SpectatorToPlayerRequest.KEY_USER_ID),$=m.get(qe.SpectatorToPlayerRequest.KEY_PLAYER_ID),te=this._sfs.userManager.getUserById(z),ie=this._sfs.roomManager.getRoomById(M);if(null!=ie)if(null!=te)if(te.isJoinedInRoom(ie)){te._setPlayerId($,ie);var oe={};oe.room=ie,oe.user=te,oe.playerId=$,this._sfs.dispatchEvent(re.SFSEvent.SPECTATOR_TO_PLAYER,oe)}else this._logger.warn("Unexpected SpectatorToPlayer event error; User "+te+" not in Room "+ie);else this._logger.warn("Unexpected SpectatorToPlayer event error; unknown User id: "+z);else this._logger.warn("Unexpected SpectatorToPlayer event error; unknown Room id: "+M)}else this._dispatchError(re.SFSEvent.SPECTATOR_TO_PLAYER_ERROR,m)}},{key:"_fnPlayerToSpectator",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(Ve.PlayerToSpectatorRequest.KEY_ROOM_ID),z=m.get(Ve.PlayerToSpectatorRequest.KEY_USER_ID),$=this._sfs.userManager.getUserById(z),te=this._sfs.roomManager.getRoomById(M);if(null!=te)if(null!=$)if($.isJoinedInRoom(te)){$._setPlayerId(-1,te);var ie={};ie.room=te,ie.user=$,this._sfs.dispatchEvent(re.SFSEvent.PLAYER_TO_SPECTATOR,ie)}else this._logger.warn("Unexpected PlayerToSpectator event error; User "+$+" not in Room "+te);else this._logger.warn("Unexpected SpectatorToPlayer event error; unknown User id: "+z);else this._logger.warn("Unexpected SpectatorToPlayer event error; unknown Room id: "+M)}else this._dispatchError(re.SFSEvent.PLAYER_TO_SPECTATOR_ERROR,m)}},{key:"_fnPingPong",value:function(m){var M={};M.lagValue=this._sfs._lagMonitor._onPingPong(),this._sfs.dispatchEvent(re.SFSEvent.PING_PONG,M)}},{key:"_fnFindRooms",value:function(m){for(var M=m.get(Ke.FindRoomsRequest.KEY_FILTERED_ROOMS),z=[],$=0;$<M.size();$++){var te=M.get($),ie=se.SFSRoom.fromSFSArray(te),oe=this._sfs.roomManager.getRoomById(ie.id);null!=oe&&(ie._isJoined=oe._isJoined),z.push(ie)}var ae={};ae.rooms=z,this._sfs.dispatchEvent(re.SFSEvent.ROOM_FIND_RESULT,ae)}},{key:"_fnFindUsers",value:function(m){for(var M=m.get(Ge.FindUsersRequest.KEY_FILTERED_USERS),z=[],$=this._sfs.mySelf,te=0;te<M.size();te++){var ie=M.get(te),oe=ae.SFSUser.fromSFSArray(ie);oe.id===$.id&&(oe=$),z.push(oe)}var se={};se.users=z,this._sfs.dispatchEvent(re.SFSEvent.USER_FIND_RESULT,se)}},{key:"_fnQuickJoinGame",value:function(m){null!=m.get(e.KEY_ERROR_CODE)&&this._dispatchError(re.SFSEvent.ROOM_JOIN_ERROR,m)}},{key:"_fnInviteUsers",value:function(m){var M;M=null!=m.get(ze.InviteUsersRequest.KEY_USER_ID)?this._sfs.userManager.getUserById(m.get(ze.InviteUsersRequest.KEY_USER_ID)):ae.SFSUser.fromSFSArray(m.get(ze.InviteUsersRequest.KEY_USER));var z=m.get(ze.InviteUsersRequest.KEY_TIME),$=m.get(ze.InviteUsersRequest.KEY_INVITATION_ID),te=m.get(ze.InviteUsersRequest.KEY_PARAMS),ie=new le.SFSInvitation(M,this._sfs.mySelf,z,te);ie._id=$;var oe={};oe.invitation=ie,this._sfs.dispatchEvent(re.SFSEvent.INVITATION,oe)}},{key:"_fnInvitationReply",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M;M=null!=m.get(ze.InviteUsersRequest.KEY_USER_ID)?this._sfs.userManager.getUserById(m.get(ze.InviteUsersRequest.KEY_USER_ID)):ae.SFSUser.fromSFSArray(m.get(ze.InviteUsersRequest.KEY_USER));var z=m.get(ze.InviteUsersRequest.KEY_REPLY_ID),$=m.get(ze.InviteUsersRequest.KEY_PARAMS),te={};te.invitee=M,te.reply=z,te.data=$,this._sfs.dispatchEvent(re.SFSEvent.INVITATION_REPLY,te)}else this._dispatchError(re.SFSEvent.INVITATION_REPLY_ERROR,m)}},{key:"_fnSetUserPosition",value:function(m){var M=m.get(Je.SetUserPositionRequest.KEY_ROOM),z=this._sfs.roomManager.getRoomById(M),$=m.get(Je.SetUserPositionRequest.KEY_MINUS_USER_LIST),te=m.get(Je.SetUserPositionRequest.KEY_PLUS_USER_LIST),ie=m.get(Je.SetUserPositionRequest.KEY_MINUS_ITEM_LIST),se=m.get(Je.SetUserPositionRequest.KEY_PLUS_ITEM_LIST),ae=[],ce=[],le=[],fe=[];if(null!=$){var he=!0,_e=!1,ye=void 0;try{for(var pe,de=$[Symbol.iterator]();!(he=(pe=de.next()).done);he=!0){var ge=pe.value,ve=z.getUserById(ge);null!=ve&&(z._removeUser(ve),ce.push(ve))}}catch(m){_e=!0,ye=m}finally{try{!he&&de.return&&de.return()}finally{if(_e)throw ye}}}if(null!=te)for(var be=0;be<te.size();be++){var me=te.get(be),Se=this._getOrCreateUser(me,!0,z);ae.push(Se),z._addUser(Se);var Ee=me.get(5);null!=Ee&&(Se._aoiEntryPoint=oe.Vec3D.fromArray(Ee))}if(null!=ie){var Re=!0,Fe=!1,je=void 0;try{for(var Le,xe=ie[Symbol.iterator]();!(Re=(Le=xe.next()).done);Re=!0){var qe=Le.value,Ve=z.getMMOItem(qe);null!=Ve&&(z._removeItem(Ve.id),fe.push(Ve))}}catch(m){Fe=!0,je=m}finally{try{!Re&&xe.return&&xe.return()}finally{if(Fe)throw je}}}if(null!=se)for(var Ke=0;Ke<se.size();Ke++){var Ge=se.get(Ke),ze=ue.MMOItem.fromSFSArray(Ge);le.push(ze),z._addMMOItem(ze);var He=Ge.get(2);null!=He&&(ze._aoiEntryPoint=oe.Vec3D.fromArray(He))}var We={};We.addedItems=le,We.removedItems=fe,We.removedUsers=ce,We.addedUsers=ae,We.room=z,this._sfs.dispatchEvent(re.SFSEvent.PROXIMITY_LIST_UPDATE,We)}},{key:"_fnInitBuddyList",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(We.InitBuddyListRequest.KEY_BLIST),z=m.get(We.InitBuddyListRequest.KEY_MY_VARS),$=m.get(We.InitBuddyListRequest.KEY_BUDDY_STATES);this._sfs.buddyManager._clearAll();for(var te=0;te<M.size();te++){var ie=ce.SFSBuddy.fromSFSArray(M.get(te));this._sfs.buddyManager._addBuddy(ie)}null!=$&&this._sfs.buddyManager._setBuddyStates($);for(var oe=[],se=0;se<z.size();se++){var ae=ye.SFSBuddyVariable.fromSFSArray(z.get(se));oe.push(ae)}this._sfs.buddyManager._setMyVariables(oe),this._sfs.buddyManager._setInited();var ue={};ue.buddyList=this._sfs.buddyManager.getBuddyList(),ue.myVariables=this._sfs.buddyManager.getMyVariables(),this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_LIST_INIT,ue)}else this._dispatchError(re.SFSBuddyEvent.BUDDY_ERROR,m)}},{key:"_fnAddBuddy",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=ce.SFSBuddy.fromSFSArray(m.get(Xe.AddBuddyRequest.KEY_BUDDY_NAME));this._sfs.buddyManager._addBuddy(M);var z={};z.buddy=M,this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_ADD,z)}else this._dispatchError(re.SFSBuddyEvent.BUDDY_ERROR,m)}},{key:"_fnRemoveBuddy",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(Ze.RemoveBuddyRequest.KEY_BUDDY_NAME),z=this._sfs.buddyManager._removeBuddyByName(M);if(null!=z){var $={};$.buddy=z,this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_REMOVE,$)}else this._logger.warn("Unexpected RemoveBuddy event error; can't find "+M+" in local buddy list")}else this._dispatchError(re.SFSBuddyEvent.BUDDY_ERROR,m)}},{key:"_fnBlockBuddy",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get(Qe.BlockBuddyRequest.KEY_BUDDY_NAME),z=this._sfs.buddyManager.getBuddyByName(M);null!=m.get(Qe.BlockBuddyRequest.KEY_BUDDY)?(z=ce.SFSBuddy.fromSFSArray(m.get(Qe.BlockBuddyRequest.KEY_BUDDY)),this._sfs.buddyManager._addBuddy(z)):null!=z?z._isBlocked=m.get(Qe.BlockBuddyRequest.KEY_BUDDY_BLOCK_STATE):this._logger.warn("Unexpected BlockBuddy event error; can't find "+M+" in local buddy list");var $={};$.buddy=z,this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_BLOCK,$)}else this._dispatchError(re.SFSBuddyEvent.BUDDY_ERROR,m)}},{key:"_fnGoOnline",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){var M=m.get($e.GoOnlineRequest.KEY_BUDDY_NAME),z=this._sfs.buddyManager.getBuddyByName(M),$=M===this._sfs.mySelf.name,te=m.get($e.GoOnlineRequest.KEY_ONLINE),ie=te===ce.BuddyOnlineState.ONLINE,oe=!0;if($)this._sfs.buddyManager.getMyOnlineState()!=ie&&(this._logger.warn("Unexpected GoOnline event error; current user's online state is not in synch with the server; resynching to: "+ie),this._sfs.buddyManager._setMyOnlineState(ie));else{if(null==z)return void this._logger.warn("Unexpected GoOnline event error; can't find "+M+" in local buddy list");z._id=m.get($e.GoOnlineRequest.KEY_BUDDY_ID),z._setVariable(new ye.SFSBuddyVariable(ye.ReservedBuddyVariables.BV_ONLINE,ie)),te===ce.BuddyOnlineState.LEFT_THE_SERVER&&z._clearVolatileVariables(),oe=this._sfs.buddyManager.getMyOnlineState()}if(oe){var se={};se.buddy=z,se.isItMe=$,this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_ONLINE_STATE_CHANGE,se)}}else this._dispatchError(re.SFSBuddyEvent.BUDDY_ERROR,m)}},{key:"_fnSetBuddyVariables",value:function(m){if(null==m.get(e.KEY_ERROR_CODE)){for(var M=m.get(et.SetBuddyVariablesRequest.KEY_BUDDY_NAME),z=m.get(et.SetBuddyVariablesRequest.KEY_BUDDY_VARS),$=this._sfs.buddyManager.getBuddyByName(M),te=M===this._sfs.mySelf.name,ie=[],oe=[],se=!0,ae=0;ae<z.size();ae++){var ue=ye.SFSBuddyVariable.fromSFSArray(z.get(ae));oe.push(ue),ie.push(ue.name)}if(te)this._sfs.buddyManager._setMyVariables(oe);else{if(null==$)return void this._logger.warn("Unexpected SetBuddyVariables event error; can't find "+M+" in local buddy list");$._setVariables(oe),se=this._sfs.buddyManager.getMyOnlineState()}if(se){var ce={};ce.buddy=$,ce.isItMe=te,ce.changedVars=ie,this._sfs.dispatchEvent(re.SFSBuddyEvent.BUDDY_VARIABLES_UPDATE,ce)}}else this._dispatchError(re.SFSBuddyEvent.BUDDY_ERROR,m)}},{key:"_fnUserEnterRoom",value:function(m){var M=this._sfs.roomManager.getRoomById(m.get(e.ROOM_PARAM));if(null!=M){var z=m.get(e.USER_PARAM),$=this._getOrCreateUser(z,!0,M);M._addUser($);var te={};te.user=$,te.room=M,this._sfs.dispatchEvent(re.SFSEvent.USER_ENTER_ROOM,te)}}},{key:"_fnUserCountChange",value:function(m){var M=this._sfs.roomManager.getRoomById(m.get(e.ROOM_PARAM));if(null!=M){var z=m.get(e.USER_COUNT_PARAM),$=null!=m.get(e.SPECT_COUNT_PARAM)?m.get(e.SPECT_COUNT_PARAM):0;M._userCount=z,M._specCount=$;var te={};te.room=M,te.uCount=z,te.sCount=$,this._sfs.dispatchEvent(re.SFSEvent.USER_COUNT_CHANGE,te)}}},{key:"_fnUserLost",value:function(m){var M=this._sfs.userManager.getUserById(m.get(e.USER_PARAM));if(null!=M){var z=this._sfs.roomManager.getUserRooms(M);this._sfs.roomManager._removeUser(M),this._sfs.userManager._removeUserReference(M,!0);var $=!0,te=!1,ie=void 0;try{for(var oe,se=z[Symbol.iterator]();!($=(oe=se.next()).done);$=!0){var ae=oe.value,ue={};ue.user=M,ue.room=ae,this._sfs.dispatchEvent(re.SFSEvent.USER_EXIT_ROOM,ue)}}catch(m){te=!0,ie=m}finally{try{!$&&se.return&&se.return()}finally{if(te)throw ie}}}}},{key:"_fnRoomLost",value:function(m){var M=this._sfs.roomManager.getRoomById(m.get(e.ROOM_PARAM));if(null!=M){this._sfs.roomManager._removeRoom(M);var z=!0,$=!1,te=void 0;try{for(var ie,oe=M.getUserList()[Symbol.iterator]();!(z=(ie=oe.next()).done);z=!0){var se=ie.value;this._sfs.userManager._removeUser(se)}}catch(m){$=!0,te=m}finally{try{!z&&oe.return&&oe.return()}finally{if($)throw te}}var ae={};ae.room=M,this._sfs.dispatchEvent(re.SFSEvent.ROOM_REMOVE,ae)}}},{key:"_fnUserExitRoom",value:function(m){var M=this._sfs.roomManager.getRoomById(m.get(e.ROOM_PARAM)),z=this._sfs.userManager.getUserById(m.get(e.USER_PARAM));if(null!=M&&null!=z){M._removeUser(z),this._sfs.userManager._removeUser(z),z.isItMe&&M.isJoined&&(M._isJoined=!1,0!==this._sfs.roomManager.getJoinedRooms().length&&this._sfs._lastJoinedRoom!==M||(this._sfs._lastJoinedRoom=null),M._isManaged||this._sfs.roomManager._removeRoom(M));var $={};$.user=z,$.room=M,this._sfs.dispatchEvent(re.SFSEvent.USER_EXIT_ROOM,$)}else this._logger.debug("Failed to handle UserExit event; Room: "+M+", User: "+z)}},{key:"_fnClientDisconnection",value:function(m){var M=m.get(e.DISCONNECTION_REASON_PARAM);this._sfs._handleClientDisconnection(pe.ClientDisconnectionReason.getReason(M))}},{key:"_fnSetMMOItemVariables",value:function(m){var M=m.get(He.SetMMOItemVariables.KEY_ROOM_ID),z=m.get(He.SetMMOItemVariables.KEY_ITEM_ID),$=m.get(He.SetMMOItemVariables.KEY_VAR_LIST),te=this._sfs.roomManager.getRoomById(M),ie=new Set;if(null!=te){var oe=te.getMMOItem(z);if(null!=oe){for(var se=0;se<$.size();se++){var ae=_e.MMOItemVariable.fromSFSArray($.get(se));oe._setVariable(ae),ie.add(ae.name)}var ue={};ue.changedVars=Array.from(ie),ue.mmoItem=oe,ue.room=te,this._sfs.dispatchEvent(re.SFSEvent.MMOITEM_VARIABLES_UPDATE,ue)}else this._logger.warn("Unexpected MMOItemVariablesUpdate event error; unknown MMOItem id: "+z)}else this._logger.warn("Unexpected MMOItemVariablesUpdate event error; unknown MMORoom id: "+M)}},{key:"_dispatchError",value:function(m,M){var z={};z.errorCode=M.get(e.KEY_ERROR_CODE),z.errorMessage=ie.SFSErrorCodes.getErrorMessage(z.errorCode,M.get(e.KEY_ERROR_PARAMS)),this._sfs.dispatchEvent(m,z)}},{key:"_populateRoomList",value:function(m){for(var M=0;M<m.size();M++){var z=se.SFSRoom.fromSFSArray(m.get(M));this._sfs.roomManager._replaceRoom(z)}}},{key:"_getOrCreateUser",value:function(m,M,z){var $=m.get(0),te=this._sfs.userManager.getUserById($);if(null==te)(te=ae.SFSUser.fromSFSArray(m,z))._setUserManager(this._sfs.userManager);else{te._setPlayerId(m.get(3),z);var re=m.get(4);if(null!=re)for(var ie=0;ie<re.size();ie++)te._setVariable(fe.SFSUserVariable.fromSFSArray(re.get(ie)))}return M&&this._sfs.userManager._addUser(te),te}},{key:"id",get:function(){return this._id}}]),e}();M.SystemController=tt},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.SmartFox=void 0;var $=function(){function e(m,M){for(var z=0;z<M.length;z++){var $=M[z];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(m,$.key,$)}}return function(m,M,z){return M&&e(m.prototype,M),z&&e(m,z),m}}(),te=z(173),re=z(167),ie=z(38),oe=z(1),se=z(166),ae=z(119),ue=z(164),ce=z(163),le=z(2),fe=z(162),he=z(73),_e=z(50),ye=z(161),pe=z(51),de=function(m){function t(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;!function(m,M){if(!(m instanceof M))throw new TypeError("Cannot call a class as a function")}(this,t);var M=function(m,M){if(!m)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!M||"object"!=typeof M&&"function"!=typeof M?m:M}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return M._majVersion=1,M._minVersion=7,M._subVersion=17,M._configData=m,M._logger=_e.Logger.instance,M._sessionToken=null,M._socketEngine=new se.SocketEngine(M),M._socketEngine.addEventListener(se.SocketEvent.CONNECT,M._onSocketConnect,M),M._socketEngine.addEventListener(se.SocketEvent.DISCONNECT,M._onSocketDisconnect,M),M._socketEngine.addEventListener(se.SocketEvent.DATA,M._onSocketData,M),M._socketEngine.addEventListener(se.SocketEvent.IOERROR,M._onSocketIOError,M),M._controllers={},M._controllers[0]=new te.SystemController(M),M._controllers[1]=new re.ExtensionController(M),M._reset(),M._clientDetails="JavaScript",M.debug=null!=M.config&&M.config.debug,M.debug&&(M._logger.info("SmartFox instance ready"),M._logger.info("SFS2X JavaScript API v"+M.version)),Object.seal(M),M}return function(m,M){if("function"!=typeof M&&null!==M)throw new TypeError("Super expression must either be null or a function, not "+typeof M);m.prototype=Object.create(M&&M.prototype,{constructor:{value:m,enumerable:!1,writable:!0,configurable:!0}}),M&&(Object.setPrototypeOf?Object.setPrototypeOf(m,M):m.__proto__=M)}(t,ie.EventDispatcher),$(t,[{key:"setClientDetails",value:function(m,M){this.isConnected?this._logger.warn("Method setClientDetails must be called before the connection is started"):(m=null!=m?m.replace(":"," "):"",M=null!=M?M.replace(":"," "):"",this._clientDetails=m+":"+M)}},{key:"connect",value:function(){var m=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;if(this.debug&&this._logger.info("Attempting connection to server"),this.isConnected)this._logger.warn("Connection attempt interrupted: already connected");else if(this._socketEngine.isConnecting)this._logger.warn("Connection attempt interrupted: another attempt is already in progress");else{var $=null!=this.config&&null!=this.config.host?this.config.host:null,te=null!=this.config&&null!=this.config.port?this.config.port:null,re=null!=this.config&&this.config.useSSL;null!=m&&($=m),M>-1&&(te=M),null!=z&&(re=z),null!=$&&"string"==typeof $&&0!==$.length?"number"!=typeof te||te<0||te>65535?this._logger.error("Invalid TCP connection port: "+te):("boolean"!=typeof re&&(re=!1),this._socketEngine.connect($,te,re)):this._logger.error("Invalid connection host/address")}}},{key:"disconnect",value:function(){this.isConnected&&this._handleClientDisconnection(pe.ClientDisconnectionReason.MANUAL)}},{key:"enableLagMonitor",value:function(m){var M=arguments.length>1&&void 0!==arguments[1]?arguments[1]:4,z=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10;null!=this.mySelf?(null!=this._lagMonitor&&this._lagMonitor.destroy(),m&&(this._lagMonitor=new ye.LagMonitor(this,M,z),this._lagMonitor.start())):this._logger.warn("Lag monitoring requires that you are logged in a Zone; please retry after completing the login process")}},{key:"send",value:function(m){if(this.isConnected){if(null!=m.validate&&null!=m.execute){this.debug&&this._logger.info("Sending request '"+le.Requests.getNameFromId(m.id)+"' to server");try{m.validate(this),m.execute(this)}catch(m){if(!(m instanceof oe.SFSValidationError&&null!=m.message))throw m;var M=m.message;if(null!=m.errors){M+=":";for(var z=0;z<m.errors.length;z++)m.errors.length>1&&(M+=" "+(z+1)+")"),M+=" "+m.errors[z]}return this._logger.error("Request failed | "+M),!1}return this._socketEngine.send(m.getMessage()),!0}this._logger.error("An invalid request was passed: "+m)}else this._logger.error("You are not connected. Request cannot be sent: "+le.Requests.getNameFromId(m.id))}},{key:"getRoomById",value:function(m){return this.roomManager.getRoomById(m)}},{key:"getRoomByName",value:function(m){return this.roomManager.getRoomByName(m)}},{key:"getRoomList",value:function(){return this.roomManager.getRoomList()}},{key:"getRoomListFromGroup",value:function(m){return this.roomManager.getRoomListFromGroup(m)}},{key:"getJoinedRooms",value:function(){return this.roomManager.getJoinedRooms()}},{key:"_reset",value:function(){var m=arguments.length>0&&void 0!==arguments[0]&&arguments[0];null!=this._buddyManager&&(this._buddyManager._clearAll(),this._buddyManager._inited=!1),this._userManager=new ae.GlobalUserManager(this),this._roomManager=new ue.SFSRoomManager(this),this._buddyManager=new ce.SFSBuddyManager(this),null!=this._lagMonitor&&this._lagMonitor.destroy(),this._lagMonitor=null,this._isJoining=!1,this._currentZone=null,this._lastJoinedRoom=null,this._mySelf=null,m&&(this._sessionToken=null)}},{key:"_onSocketConnect",value:function(m){m.success?this.send(new fe.HandshakeRequest(this.version,this._clientDetails)):this.dispatchEvent(ie.SFSEvent.CONNECTION,{success:!1})}},{key:"_onSocketDisconnect",value:function(m){this.dispatchEvent(ie.SFSEvent.CONNECTION_LOST,{reason:m.reason}),this._reset(!0)}},{key:"_onSocketData",value:function(m){var M=m.targetController,z=m.id,$=m.content;null!=M?null!=z?this._controllers[M].handleMessage($,z):this._logger.error("Incoming message rejected: Command ID is missing"):this._logger.error("Incoming message rejected: Controller ID is missing")}},{key:"_onSocketIOError",value:function(m){this.dispatchEvent(ie.SFSEvent.SOCKET_ERROR,{message:m})}},{key:"_handleHandShake",value:function(m){var M=m.get(le.BaseRequest.KEY_ERROR_CODE);if(null==M)this._sessionToken=m.get(fe.HandshakeRequest.KEY_SESSION_TOKEN),this._socketEngine.maxMessageSize=m.get(fe.HandshakeRequest.KEY_MAX_MESSAGE_SIZE),this._socketEngine.compressionThreshold=m.get(fe.HandshakeRequest.KEY_COMPRESSION_THRESHOLD),this.dispatchEvent(ie.SFSEvent.CONNECTION,{success:!0});else{var z={success:!1,errorMessage:he.SFSErrorCodes.getErrorMessage(M,m.get(le.BaseRequest.KEY_ERROR_PARAMS)),errorCode:M};this.dispatchEvent(ie.SFSEvent.CONNECTION,z)}}},{key:"_handleLogout",value:function(){this._reset()}},{key:"_handleClientDisconnection",value:function(m){this.isConnected&&this._socketEngine.disconnect(m)}},{key:"version",get:function(){return this._majVersion+"."+this._minVersion+"."+this._subVersion}},{key:"config",get:function(){return this._configData}},{key:"logger",get:function(){return this._logger}},{key:"sessionToken",get:function(){return this._sessionToken}},{key:"roomManager",get:function(){return this._roomManager}},{key:"userManager",get:function(){return this._userManager}},{key:"buddyManager",get:function(){return this._buddyManager}},{key:"mySelf",get:function(){return this._mySelf}},{key:"lastJoinedRoom",get:function(){return this._lastJoinedRoom}},{key:"isConnected",get:function(){return null!=this._socketEngine&&this._socketEngine.isConnected}},{key:"maxMessageSize",get:function(){return null!=this._socketEngine?this._socketEngine.maxMessageSize:0}}]),t}();M.SmartFox=de},function(m,M,z){var $=z(0),te=z(88);te&&$($.S,"Reflect",{setPrototypeOf:function(m,M){te.check(m,M);try{return te.set(m,M),!0}catch(m){return!1}}})},function(m,M,z){var $=z(9),te=z(23),re=z(31),ie=z(16),oe=z(0),se=z(36),ae=z(5),ue=z(4);oe(oe.S,"Reflect",{set:function e(m,M,z){var oe,ce,le=arguments.length<4?m:arguments[3],fe=te.f(ae(m),M);if(!fe){if(ue(ce=re(m)))return e(ce,M,z,le);fe=se(0)}return ie(fe,"value")?!(!1===fe.writable||!ue(le)||((oe=te.f(le,M)||se(0)).value=z,$.f(le,M,oe),0)):void 0!==fe.set&&(fe.set.call(le,z),!0)}})},function(m,M,z){var $=z(0),te=z(5),re=Object.preventExtensions;$($.S,"Reflect",{preventExtensions:function(m){te(m);try{return re&&re(m),!0}catch(m){return!1}}})},function(m,M,z){var $=z(32),te=z(67),re=z(5),ie=z(6).Reflect;m.exports=ie&&ie.ownKeys||function(m){var M=$.f(re(m)),z=te.f;return z?M.concat(z(m)):M}},function(m,M,z){var $=z(0);$($.S,"Reflect",{ownKeys:z(178)})},function(m,M,z){var $=z(0),te=z(5),re=Object.isExtensible;$($.S,"Reflect",{isExtensible:function(m){return te(m),!re||re(m)}})},function(m,M,z){var $=z(0);$($.S,"Reflect",{has:function(m,M){return M in m}})},function(m,M,z){var $=z(0),te=z(31),re=z(5);$($.S,"Reflect",{getPrototypeOf:function(m){return te(re(m))}})},function(m,M,z){var $=z(23),te=z(0),re=z(5);te(te.S,"Reflect",{getOwnPropertyDescriptor:function(m,M){return $.f(re(m),M)}})},function(m,M,z){var $=z(23),te=z(31),re=z(16),ie=z(0),oe=z(4),se=z(5);ie(ie.S,"Reflect",{get:function e(m,M){var z,ie,ae=arguments.length<3?m:arguments[2];return se(m)===ae?m[M]:(z=$.f(m,M))?re(z,"value")?z.value:void 0!==z.get?z.get.call(ae):void 0:oe(ie=te(m))?e(ie,M,ae):void 0}})},function(m,M,z){"use strict";var $=z(0),te=z(5),o=function(m){this._t=te(m),this._i=0;var M,z=this._k=[];for(M in m)z.push(M)};z(133)(o,"Object",(function(){var m,M=this._k;do{if(this._i>=M.length)return{value:void 0,done:!0}}while(!((m=M[this._i++])in this._t));return{value:m,done:!1}})),$($.S,"Reflect",{enumerate:function(m){return new o(m)}})},function(m,M,z){var $=z(0),te=z(23).f,re=z(5);$($.S,"Reflect",{deleteProperty:function(m,M){var z=te(re(m),M);return!(z&&!z.configurable)&&delete m[M]}})},function(m,M,z){var $=z(9),te=z(0),re=z(5),ie=z(30);te(te.S+te.F*z(3)((function(){Reflect.defineProperty($.f({},1,{value:1}),1,{value:2})})),"Reflect",{defineProperty:function(m,M,z){re(m),M=ie(M,!0),re(z);try{return $.f(m,M,z),!0}catch(m){return!1}}})},function(m,M,z){var $=z(0),te=z(33),re=z(26),ie=z(5),oe=z(4),se=z(3),ae=z(142),ue=(z(6).Reflect||{}).construct,ce=se((function(){function e(){}return!(ue((function(){}),[],e)instanceof e)})),le=!se((function(){ue((function(){}))}));$($.S+$.F*(ce||le),"Reflect",{construct:function(m,M){re(m),ie(M);var z=arguments.length<3?m:re(arguments[2]);if(le&&!ce)return ue(m,M,z);if(m==z){switch(M.length){case 0:return new m;case 1:return new m(M[0]);case 2:return new m(M[0],M[1]);case 3:return new m(M[0],M[1],M[2]);case 4:return new m(M[0],M[1],M[2],M[3])}var $=[null];return $.push.apply($,M),new(ae.apply(m,$))}var se=z.prototype,fe=te(oe(se)?se:Object.prototype),he=Function.apply.call(m,fe,M);return oe(he)?he:fe}})},function(m,M,z){var $=z(0),te=z(26),re=z(5),ie=(z(6).Reflect||{}).apply,oe=Function.apply;$($.S+$.F*!z(3)((function(){ie((function(){}))})),"Reflect",{apply:function(m,M,z){var $=te(m),se=re(z);return ie?ie($,M,se):oe.call($,M,se)}})},function(m,M,z){z(22)("Float64",8,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Float32",4,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Uint32",4,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Int32",4,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Uint16",2,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Int16",2,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Uint8",1,(function(m){return function(M,z,$){return m(this,M,z,$)}}),!0)},function(m,M,z){z(22)("Uint8",1,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){z(22)("Int8",1,(function(m){return function(M,z,$){return m(this,M,z,$)}}))},function(m,M,z){var $=z(0);$($.G+$.W+$.F*!z(59).ABV,{DataView:z(74).DataView})},function(m,M,z){"use strict";var $=z(0),te=z(59),re=z(74),ie=z(5),oe=z(34),se=z(12),ae=z(4),ue=z(6).ArrayBuffer,ce=z(75),le=re.ArrayBuffer,fe=re.DataView,he=te.ABV&&ue.isView,_e=le.prototype.slice,ye=te.VIEW;$($.G+$.W+$.F*(ue!==le),{ArrayBuffer:le}),$($.S+$.F*!te.CONSTR,"ArrayBuffer",{isView:function(m){return he&&he(m)||ae(m)&&ye in m}}),$($.P+$.U+$.F*z(3)((function(){return!new le(2).slice(1,void 0).byteLength})),"ArrayBuffer",{slice:function(m,M){if(void 0!==_e&&void 0===M)return _e.call(ie(this),m);for(var z=ie(this).byteLength,$=oe(m,z),te=oe(void 0===M?z:M,z),re=new(ce(this,le))(se(te-$)),ae=new fe(this),ue=new fe(re),he=0;$<te;)ue.setUint8(he++,ae.getUint8($++));return re}}),z(42)("ArrayBuffer")},function(m,M,z){"use strict";var $=z(122),te=z(39);z(60)("WeakSet",(function(m){return function(){return m(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(m){return $.def(te(this,"WeakSet"),m,!0)}},$,!1,!0)},function(m,M,z){"use strict";var $,te=z(19)(0),re=z(15),ie=z(29),oe=z(143),se=z(122),ae=z(4),ue=z(3),ce=z(39),le=ie.getWeak,fe=Object.isExtensible,he=se.ufstore,_e={},d=function(m){return function(){return m(this,arguments.length>0?arguments[0]:void 0)}},ye={get:function(m){if(ae(m)){var M=le(m);return!0===M?he(ce(this,"WeakMap")).get(m):M?M[this._i]:void 0}},set:function(m,M){return se.def(ce(this,"WeakMap"),m,M)}},pe=m.exports=z(60)("WeakMap",d,ye,se,!0,!0);ue((function(){return 7!=(new pe).set((Object.freeze||Object)(_e),7).get(_e)}))&&(oe(($=se.getConstructor(d,"WeakMap")).prototype,ye),ie.NEED=!0,te(["delete","has","get","set"],(function(m){var M=pe.prototype,z=M[m];re(M,m,(function(M,te){if(ae(M)&&!fe(M)){this._f||(this._f=new $);var re=this._f[m](M,te);return"set"==m?this:re}return z.call(this,M,te)}))})))},function(m,M,z){"use strict";var $=z(123),te=z(39);m.exports=z(60)("Set",(function(m){return function(){return m(this,arguments.length>0?arguments[0]:void 0)}}),{add:function(m){return $.def(te(this,"Set"),m=0===m?0:m,m)}},$)},function(m,M,z){"use strict";var $=z(123),te=z(39);m.exports=z(60)("Map",(function(m){return function(){return m(this,arguments.length>0?arguments[0]:void 0)}}),{get:function(m){var M=$.getEntry(te(this,"Map"),m);return M&&M.v},set:function(m,M){return $.def(te(this,"Map"),0===m?0:m,M)}},$,!0)},function(m,M,z){var $=z(5),te=z(4),re=z(124);m.exports=function(m,M){if($(m),te(M)&&M.constructor===m)return M;var z=re.f(m);return(0,z.resolve)(M),z.promise}},function(m,M){m.exports=function(m){try{return{e:!1,v:m()}}catch(m){return{e:!0,v:m}}}},function(m,M,z){var $=z(6),te=z(125).set,re=$.MutationObserver||$.WebKitMutationObserver,ie=$.process,oe=$.Promise,se="process"==z(25)(ie);m.exports=function(){var m,M,z,c=function(){var $,te;for(se&&($=ie.domain)&&$.exit();m;){te=m.fn,m=m.next;try{te()}catch($){throw m?z():M=void 0,$}}M=void 0,$&&$.enter()};if(se)z=function(){ie.nextTick(c)};else if(!re||$.navigator&&$.navigator.standalone)if(oe&&oe.resolve){var ae=oe.resolve();z=function(){ae.then(c)}}else z=function(){te.call($,c)};else{var ue=!0,ce=document.createTextNode("");new re(c).observe(ce,{characterData:!0}),z=function(){ce.data=ue=!ue}}return function($){var te={fn:$,next:void 0};M&&(M.next=te),m||(m=te,z()),M=te}}},function(m,M,z){"use strict";var $,te,re,ie,oe=z(43),se=z(6),ae=z(27),ue=z(65),ce=z(0),le=z(4),fe=z(26),he=z(41),_e=z(61),ye=z(75),pe=z(125).set,de=z(207)(),ge=z(124),ve=z(206),be=z(205),me=se.TypeError,Se=se.process,Ee=se.Promise,Re="process"==ue(Se),w=function(){},Fe=te=ge.f,je=!!function(){try{var m=Ee.resolve(1),M=(m.constructor={})[z(7)("species")]=function(m){m(w,w)};return(Re||"function"==typeof PromiseRejectionEvent)&&m.then(w)instanceof M}catch(m){}}(),T=function(m){var M;return!(!le(m)||"function"!=typeof(M=m.then))&&M},k=function(m,M){if(!m._n){m._n=!0;var z=m._c;de((function(){for(var $=m._v,te=1==m._s,re=0,s=function(M){var z,re,ie,oe=te?M.ok:M.fail,se=M.resolve,ae=M.reject,ue=M.domain;try{oe?(te||(2==m._h&&N(m),m._h=1),!0===oe?z=$:(ue&&ue.enter(),z=oe($),ue&&(ue.exit(),ie=!0)),z===M.promise?ae(me("Promise-chain cycle")):(re=T(z))?re.call(z,se,ae):se(z)):ae($)}catch(m){ue&&!ie&&ue.exit(),ae(m)}};z.length>re;)s(z[re++]);m._c=[],m._n=!1,M&&!m._h&&P(m)}))}},P=function(m){pe.call(se,(function(){var M,z,$,te=m._v,re=F(m);if(re&&(M=ve((function(){Re?Se.emit("unhandledRejection",te,m):(z=se.onunhandledrejection)?z({promise:m,reason:te}):($=se.console)&&$.error&&$.error("Unhandled promise rejection",te)})),m._h=Re||F(m)?2:1),m._a=void 0,re&&M.e)throw M.v}))},F=function(m){return 1!==m._h&&0===(m._a||m._c).length},N=function(m){pe.call(se,(function(){var M;Re?Se.emit("rejectionHandled",m):(M=se.onrejectionhandled)&&M({promise:m,reason:m._v})}))},j=function(m){var M=this;M._d||(M._d=!0,(M=M._w||M)._v=m,M._s=2,M._a||(M._a=M._c.slice()),k(M,!0))},U=function(m){var M,z=this;if(!z._d){z._d=!0,z=z._w||z;try{if(z===m)throw me("Promise can't be resolved itself");(M=T(m))?de((function(){var $={_w:z,_d:!1};try{M.call(m,ae(U,$,1),ae(j,$,1))}catch(m){j.call($,m)}})):(z._v=m,z._s=1,k(z,!1))}catch(m){j.call({_w:z,_d:!1},m)}}};je||(Ee=function(m){he(this,Ee,"Promise","_h"),fe(m),$.call(this);try{m(ae(U,this,1),ae(j,this,1))}catch(m){j.call(this,m)}},($=function(m){this._c=[],this._a=void 0,this._s=0,this._d=!1,this._v=void 0,this._h=0,this._n=!1}).prototype=z(40)(Ee.prototype,{then:function(m,M){var z=Fe(ye(this,Ee));return z.ok="function"!=typeof m||m,z.fail="function"==typeof M&&M,z.domain=Re?Se.domain:void 0,this._c.push(z),this._a&&this._a.push(z),this._s&&k(this,!1),z.promise},catch:function(m){return this.then(void 0,m)}}),re=function(){var m=new $;this.promise=m,this.resolve=ae(U,m,1),this.reject=ae(j,m,1)},ge.f=Fe=function(m){return m===Ee||m===ie?new re(m):te(m)}),ce(ce.G+ce.W+ce.F*!je,{Promise:Ee}),z(44)(Ee,"Promise"),z(42)("Promise"),ie=z(37).Promise,ce(ce.S+ce.F*!je,"Promise",{reject:function(m){var M=Fe(this);return(0,M.reject)(m),M.promise}}),ce(ce.S+ce.F*(oe||!je),"Promise",{resolve:function(m){return be(oe&&this===ie?Ee:this,m)}}),ce(ce.S+ce.F*!(je&&z(63)((function(m){Ee.all(m).catch(w)}))),"Promise",{all:function(m){var M=this,z=Fe(M),$=z.resolve,te=z.reject,re=ve((function(){var z=[],re=0,ie=1;_e(m,!1,(function(m){var oe=re++,se=!1;z.push(void 0),ie++,M.resolve(m).then((function(m){se||(se=!0,z[oe]=m,--ie||$(z))}),te)})),--ie||$(z)}));return re.e&&te(re.v),z.promise},race:function(m){var M=this,z=Fe(M),$=z.reject,te=ve((function(){_e(m,!1,(function(m){M.resolve(m).then(z.resolve,$)}))}));return te.e&&$(te.v),z.promise}})},function(m,M,z){z(62)("split",2,(function(m,M,$){"use strict";var te=z(81),re=$,ie=[].push;if("c"=="abbc".split(/(b)*/)[1]||4!="test".split(/(?:)/,-1).length||2!="ab".split(/(?:ab)*/).length||4!=".".split(/(.?)(.?)/).length||".".split(/()()/).length>1||"".split(/.?/).length){var oe=void 0===/()??/.exec("")[1];$=function(m,M){var z=String(this);if(void 0===m&&0===M)return[];if(!te(m))return re.call(z,m,M);var $,se,ae,ue,ce,le=[],fe=(m.ignoreCase?"i":"")+(m.multiline?"m":"")+(m.unicode?"u":"")+(m.sticky?"y":""),he=0,_e=void 0===M?4294967295:M>>>0,ye=new RegExp(m.source,fe+"g");for(oe||($=new RegExp("^"+ye.source+"$(?!\\s)",fe));(se=ye.exec(z))&&!((ae=se.index+se[0].length)>he&&(le.push(z.slice(he,se.index)),!oe&&se.length>1&&se[0].replace($,(function(){for(ce=1;ce<arguments.length-2;ce++)void 0===arguments[ce]&&(se[ce]=void 0)})),se.length>1&&se.index<z.length&&ie.apply(le,se.slice(1)),ue=se[0].length,he=ae,le.length>=_e));)ye.lastIndex===se.index&&ye.lastIndex++;return he===z.length?!ue&&ye.test("")||le.push(""):le.push(z.slice(he)),le.length>_e?le.slice(0,_e):le}}else"0".split(void 0,0).length&&($=function(m,M){return void 0===m&&0===M?[]:re.call(this,m,M)});return[function(z,te){var re=m(this),ie=null==z?void 0:z[M];return void 0!==ie?ie.call(z,re,te):$.call(String(re),z,te)},$]}))},function(m,M,z){z(62)("search",1,(function(m,M,z){return[function(z){"use strict";var $=m(this),te=null==z?void 0:z[M];return void 0!==te?te.call(z,$):new RegExp(z)[M](String($))},z]}))},function(m,M,z){z(62)("replace",2,(function(m,M,z){return[function($,te){"use strict";var re=m(this),ie=null==$?void 0:$[M];return void 0!==ie?ie.call($,re,te):z.call(String(re),$,te)},z]}))},function(m,M,z){z(62)("match",1,(function(m,M,z){return[function(z){"use strict";var $=m(this),te=null==z?void 0:z[M];return void 0!==te?te.call(z,$):new RegExp(z)[M](String($))},z]}))},function(m,M,z){"use strict";z(126);var $=z(5),te=z(76),re=z(11),ie=/./.toString,a=function(m){z(15)(RegExp.prototype,"toString",m,!0)};z(3)((function(){return"/a/b"!=ie.call({source:"a",flags:"b"})}))?a((function(){var m=$(this);return"/".concat(m.source,"/","flags"in m?m.flags:!re&&m instanceof RegExp?te.call(m):void 0)})):"toString"!=ie.name&&a((function(){return ie.call(this)}))},function(m,M,z){var $=z(6),te=z(86),re=z(9).f,ie=z(32).f,oe=z(81),se=z(76),ae=$.RegExp,ue=ae,ce=ae.prototype,le=/a/g,fe=/a/g,he=new ae(le)!==le;if(z(11)&&(!he||z(3)((function(){return fe[z(7)("match")]=!1,ae(le)!=le||ae(fe)==fe||"/a/i"!=ae(le,"i")})))){ae=function(m,M){var z=this instanceof ae,$=oe(m),re=void 0===M;return!z&&$&&m.constructor===ae&&re?m:te(he?new ue($&&!re?m.source:m,M):ue(($=m instanceof ae)?m.source:m,$&&re?se.call(m):M),z?this:ce,ae)};for(var p=function(m){m in ae||re(ae,m,{configurable:!0,get:function(){return ue[m]},set:function(M){ue[m]=M}})},_e=ie(ue),ye=0;_e.length>ye;)p(_e[ye++]);ce.constructor=ae,ae.prototype=ce,z(15)($,"RegExp",ae)}z(42)("RegExp")},function(m,M,z){z(42)("Array")},function(m,M,z){"use strict";var $=z(0),te=z(19)(6),re="findIndex",ie=!0;re in[]&&Array(1)[re]((function(){ie=!1})),$($.P+$.F*ie,"Array",{findIndex:function(m){return te(this,m,arguments.length>1?arguments[1]:void 0)}}),z(52)(re)},function(m,M,z){"use strict";var $=z(0),te=z(19)(5),re=!0;"find"in[]&&Array(1).find((function(){re=!1})),$($.P+$.F*re,"Array",{find:function(m){return te(this,m,arguments.length>1?arguments[1]:void 0)}}),z(52)("find")},function(m,M,z){var $=z(0);$($.P,"Array",{fill:z(77)}),z(52)("fill")},function(m,M,z){var $=z(0);$($.P,"Array",{copyWithin:z(129)}),z(52)("copyWithin")},function(m,M,z){"use strict";var $=z(0),te=z(21),re=z(24),ie=z(12),oe=[].lastIndexOf,se=!!oe&&1/[1].lastIndexOf(1,-0)<0;$($.P+$.F*(se||!z(17)(oe)),"Array",{lastIndexOf:function(m){if(se)return oe.apply(this,arguments)||0;var M=te(this),z=ie(M.length),$=z-1;for(arguments.length>1&&($=Math.min($,re(arguments[1]))),$<0&&($=z+$);$>=0;$--)if($ in M&&M[$]===m)return $||0;return-1}})},function(m,M,z){"use strict";var $=z(0),te=z(93)(!1),re=[].indexOf,ie=!!re&&1/[1].indexOf(1,-0)<0;$($.P+$.F*(ie||!z(17)(re)),"Array",{indexOf:function(m){return ie?re.apply(this,arguments)||0:te(this,m,arguments[1])}})},function(m,M,z){"use strict";var $=z(0),te=z(130);$($.P+$.F*!z(17)([].reduceRight,!0),"Array",{reduceRight:function(m){return te(this,m,arguments.length,arguments[1],!0)}})},function(m,M,z){"use strict";var $=z(0),te=z(130);$($.P+$.F*!z(17)([].reduce,!0),"Array",{reduce:function(m){return te(this,m,arguments.length,arguments[1],!1)}})},function(m,M,z){"use strict";var $=z(0),te=z(19)(4);$($.P+$.F*!z(17)([].every,!0),"Array",{every:function(m){return te(this,m,arguments[1])}})},function(m,M,z){"use strict";var $=z(0),te=z(19)(3);$($.P+$.F*!z(17)([].some,!0),"Array",{some:function(m){return te(this,m,arguments[1])}})},function(m,M,z){"use strict";var $=z(0),te=z(19)(2);$($.P+$.F*!z(17)([].filter,!0),"Array",{filter:function(m){return te(this,m,arguments[1])}})},function(m,M,z){"use strict";var $=z(0),te=z(19)(1);$($.P+$.F*!z(17)([].map,!0),"Array",{map:function(m){return te(this,m,arguments[1])}})},function(m,M,z){var $=z(4),te=z(90),re=z(7)("species");m.exports=function(m){var M;return te(m)&&("function"!=typeof(M=m.constructor)||M!==Array&&!te(M.prototype)||(M=void 0),$(M)&&null===(M=M[re])&&(M=void 0)),void 0===M?Array:M}},function(m,M,z){var $=z(228);m.exports=function(m,M){return new($(m))(M)}},function(m,M,z){"use strict";var $=z(0),te=z(19)(0),re=z(17)([].forEach,!0);$($.P+$.F*!re,"Array",{forEach:function(m){return te(this,m,arguments[1])}})},function(m,M,z){"use strict";var $=z(0),te=z(26),re=z(14),ie=z(3),oe=[].sort,se=[1,2,3];$($.P+$.F*(ie((function(){se.sort(void 0)}))||!ie((function(){se.sort(null)}))||!z(17)(oe)),"Array",{sort:function(m){return void 0===m?oe.call(re(this)):oe.call(re(this),te(m))}})},function(m,M,z){"use strict";var $=z(0),te=z(89),re=z(25),ie=z(34),oe=z(12),se=[].slice;$($.P+$.F*z(3)((function(){te&&se.call(te)})),"Array",{slice:function(m,M){var z=oe(this.length),$=re(this);if(M=void 0===M?z:M,"Array"==$)return se.call(this,m,M);for(var te=ie(m,z),ae=ie(M,z),ue=oe(ae-te),ce=new Array(ue),le=0;le<ue;le++)ce[le]="String"==$?this.charAt(te+le):this[te+le];return ce}})},function(m,M,z){"use strict";var $=z(0),te=z(21),re=[].join;$($.P+$.F*(z(54)!=Object||!z(17)(re)),"Array",{join:function(m){return re.call(te(this),void 0===m?",":m)}})},function(m,M,z){"use strict";var $=z(0),te=z(131);$($.S+$.F*z(3)((function(){function e(){}return!(Array.of.call(e)instanceof e)})),"Array",{of:function(){for(var m=0,M=arguments.length,z=new("function"==typeof this?this:Array)(M);M>m;)te(z,m,arguments[m++]);return z.length=M,z}})},function(m,M,z){"use strict";var $=z(27),te=z(0),re=z(14),ie=z(132),oe=z(79),se=z(12),ae=z(131),ue=z(78);te(te.S+te.F*!z(63)((function(m){Array.from(m)})),"Array",{from:function(m){var M,z,te,ce,le=re(m),fe="function"==typeof this?this:Array,he=arguments.length,_e=he>1?arguments[1]:void 0,ye=void 0!==_e,pe=0,de=ue(le);if(ye&&(_e=$(_e,he>2?arguments[2]:void 0,2)),null==de||fe==Array&&oe(de))for(z=new fe(M=se(le.length));M>pe;pe++)ae(z,pe,ye?_e(le[pe],pe):le[pe]);else for(ce=de.call(le),z=new fe;!(te=ce.next()).done;pe++)ae(z,pe,ye?ie(ce,_e,[te.value,pe],!0):te.value);return z.length=pe,z}})},function(m,M,z){var $=z(0);$($.S,"Array",{isArray:z(90)})},function(m,M,z){"use strict";var $=z(5),te=z(30);m.exports=function(m){if("string"!==m&&"number"!==m&&"default"!==m)throw TypeError("Incorrect hint");return te($(this),"number"!=m)}},function(m,M,z){var $=z(7)("toPrimitive"),te=Date.prototype;$ in te||z(18)(te,$,z(237))},function(m,M,z){var $=Date.prototype,te=$.toString,re=$.getTime;new Date(NaN)+""!="Invalid Date"&&z(15)($,"toString",(function(){var m=re.call(this);return m==m?te.call(this):"Invalid Date"}))},function(m,M,z){"use strict";var $=z(3),te=Date.prototype.getTime,re=Date.prototype.toISOString,s=function(m){return m>9?m:"0"+m};m.exports=$((function(){return"0385-07-25T07:06:39.999Z"!=re.call(new Date(-50000000000001))}))||!$((function(){re.call(new Date(NaN))}))?function(){if(!isFinite(te.call(this)))throw RangeError("Invalid time value");var m=this,M=m.getUTCFullYear(),z=m.getUTCMilliseconds(),$=M<0?"-":M>9999?"+":"";return $+("00000"+Math.abs(M)).slice($?-6:-4)+"-"+s(m.getUTCMonth()+1)+"-"+s(m.getUTCDate())+"T"+s(m.getUTCHours())+":"+s(m.getUTCMinutes())+":"+s(m.getUTCSeconds())+"."+(z>99?z:"0"+s(z))+"Z"}:re},function(m,M,z){var $=z(0),te=z(240);$($.P+$.F*(Date.prototype.toISOString!==te),"Date",{toISOString:te})},function(m,M,z){"use strict";var $=z(0),te=z(14),re=z(30);$($.P+$.F*z(3)((function(){return null!==new Date(NaN).toJSON()||1!==Date.prototype.toJSON.call({toISOString:function(){return 1}})})),"Date",{toJSON:function(m){var M=te(this),z=re(M);return"number"!=typeof z||isFinite(z)?M.toISOString():null}})},function(m,M,z){var $=z(0);$($.S,"Date",{now:function(){return(new Date).getTime()}})},function(m,M,z){"use strict";z(13)("sup",(function(m){return function(){return m(this,"sup","","")}}))},function(m,M,z){"use strict";z(13)("sub",(function(m){return function(){return m(this,"sub","","")}}))},function(m,M,z){"use strict";z(13)("strike",(function(m){return function(){return m(this,"strike","","")}}))},function(m,M,z){"use strict";z(13)("small",(function(m){return function(){return m(this,"small","","")}}))},function(m,M,z){"use strict";z(13)("link",(function(m){return function(M){return m(this,"a","href",M)}}))},function(m,M,z){"use strict";z(13)("italics",(function(m){return function(){return m(this,"i","","")}}))},function(m,M,z){"use strict";z(13)("fontsize",(function(m){return function(M){return m(this,"font","size",M)}}))},function(m,M,z){"use strict";z(13)("fontcolor",(function(m){return function(M){return m(this,"font","color",M)}}))},function(m,M,z){"use strict";z(13)("fixed",(function(m){return function(){return m(this,"tt","","")}}))},function(m,M,z){"use strict";z(13)("bold",(function(m){return function(){return m(this,"b","","")}}))},function(m,M,z){"use strict";z(13)("blink",(function(m){return function(){return m(this,"blink","","")}}))},function(m,M,z){"use strict";z(13)("big",(function(m){return function(){return m(this,"big","","")}}))},function(m,M,z){"use strict";z(13)("anchor",(function(m){return function(M){return m(this,"a","name",M)}}))},function(m,M,z){"use strict";var $=z(0),te=z(12),re=z(82),ie="".startsWith;$($.P+$.F*z(80)("startsWith"),"String",{startsWith:function(m){var M=re(this,m,"startsWith"),z=te(Math.min(arguments.length>1?arguments[1]:void 0,M.length)),$=String(m);return ie?ie.call(M,$,z):M.slice(z,z+$.length)===$}})},function(m,M,z){var $=z(0);$($.P,"String",{repeat:z(137)})},function(m,M,z){"use strict";var $=z(0),te=z(82);$($.P+$.F*z(80)("includes"),"String",{includes:function(m){return!!~te(this,m,"includes").indexOf(m,arguments.length>1?arguments[1]:void 0)}})},function(m,M,z){"use strict";var $=z(0),te=z(12),re=z(82),ie="".endsWith;$($.P+$.F*z(80)("endsWith"),"String",{endsWith:function(m){var M=re(this,m,"endsWith"),z=arguments.length>1?arguments[1]:void 0,$=te(M.length),oe=void 0===z?$:Math.min(te(z),$),se=String(m);return ie?ie.call(M,se,oe):M.slice(oe-se.length,oe)===se}})},function(m,M,z){"use strict";var $=z(0),te=z(134)(!1);$($.P,"String",{codePointAt:function(m){return te(this,m)}})},function(m,M,z){"use strict";var $=z(134)(!0);z(83)(String,"String",(function(m){this._t=String(m),this._i=0}),(function(){var m,M=this._t,z=this._i;return z>=M.length?{value:void 0,done:!0}:(m=$(M,z),this._i+=m.length,{value:m,done:!1})}))},function(m,M,z){"use strict";z(64)("trim",(function(m){return function(){return m(this,3)}}))},function(m,M,z){var $=z(0),te=z(21),re=z(12);$($.S,"String",{raw:function(m){for(var M=te(m.raw),z=re(M.length),$=arguments.length,ie=[],oe=0;z>oe;)ie.push(String(M[oe++])),oe<$&&ie.push(String(arguments[oe]));return ie.join("")}})},function(m,M,z){var $=z(0),te=z(34),re=String.fromCharCode,ie=String.fromCodePoint;$($.S+$.F*(!!ie&&1!=ie.length),"String",{fromCodePoint:function(m){for(var M,z=[],$=arguments.length,ie=0;$>ie;){if(M=+arguments[ie++],te(M,1114111)!==M)throw RangeError(M+" is not a valid code point");z.push(M<65536?re(M):re(55296+((M-=65536)>>10),M%1024+56320))}return z.join("")}})},function(m,M,z){var $=z(0);$($.S,"Math",{trunc:function(m){return(m>0?Math.floor:Math.ceil)(m)}})},function(m,M,z){var $=z(0),te=z(84),re=Math.exp;$($.S,"Math",{tanh:function(m){var M=te(m=+m),z=te(-m);return M==1/0?1:z==1/0?-1:(M-z)/(re(m)+re(-m))}})},function(m,M,z){var $=z(0),te=z(84),re=Math.exp;$($.S+$.F*z(3)((function(){return-2e-17!=!Math.sinh(-2e-17)})),"Math",{sinh:function(m){return Math.abs(m=+m)<1?(te(m)-te(-m))/2:(re(m-1)-re(-m-1))*(Math.E/2)}})},function(m,M,z){var $=z(0);$($.S,"Math",{sign:z(85)})},function(m,M,z){var $=z(0);$($.S,"Math",{log2:function(m){return Math.log(m)/Math.LN2}})},function(m,M,z){var $=z(0);$($.S,"Math",{log1p:z(135)})},function(m,M,z){var $=z(0);$($.S,"Math",{log10:function(m){return Math.log(m)*Math.LOG10E}})},function(m,M,z){var $=z(0),te=Math.imul;$($.S+$.F*z(3)((function(){return-5!=te(4294967295,5)||2!=te.length})),"Math",{imul:function(m,M){var z=+m,$=+M,te=65535&z,re=65535&$;return 0|te*re+((65535&z>>>16)*re+te*(65535&$>>>16)<<16>>>0)}})},function(m,M,z){var $=z(0),te=Math.abs;$($.S,"Math",{hypot:function(m,M){for(var z,$,re=0,ie=0,oe=arguments.length,se=0;ie<oe;)se<(z=te(arguments[ie++]))?(re=re*($=se/z)*$+1,se=z):re+=z>0?($=z/se)*$:z;return se===1/0?1/0:se*Math.sqrt(re)}})},function(m,M,z){var $=z(85),te=Math.pow,re=te(2,-52),ie=te(2,-23),oe=te(2,127)*(2-ie),se=te(2,-126);m.exports=Math.fround||function(m){var M,z,te=Math.abs(m),ae=$(m);return te<se?ae*(te/se/ie+1/re-1/re)*se*ie:(z=(M=(1+ie/re)*te)-(M-te))>oe||z!=z?ae*(1/0):ae*z}},function(m,M,z){var $=z(0);$($.S,"Math",{fround:z(275)})},function(m,M,z){var $=z(0),te=z(84);$($.S+$.F*(te!=Math.expm1),"Math",{expm1:te})},function(m,M,z){var $=z(0),te=Math.exp;$($.S,"Math",{cosh:function(m){return(te(m=+m)+te(-m))/2}})},function(m,M,z){var $=z(0);$($.S,"Math",{clz32:function(m){return(m>>>=0)?31-Math.floor(Math.log(m+.5)*Math.LOG2E):32}})},function(m,M,z){var $=z(0),te=z(85);$($.S,"Math",{cbrt:function(m){return te(m=+m)*Math.pow(Math.abs(m),1/3)}})},function(m,M,z){var $=z(0),te=Math.atanh;$($.S+$.F*!(te&&1/te(-0)<0),"Math",{atanh:function(m){return 0==(m=+m)?m:Math.log((1+m)/(1-m))/2}})},function(m,M,z){var $=z(0),te=Math.asinh;$($.S+$.F*!(te&&1/te(0)>0),"Math",{asinh:function e(m){return isFinite(m=+m)&&0!=m?m<0?-e(-m):Math.log(m+Math.sqrt(m*m+1)):m}})},function(m,M,z){var $=z(0),te=z(135),re=Math.sqrt,ie=Math.acosh;$($.S+$.F*!(ie&&710==Math.floor(ie(Number.MAX_VALUE))&&ie(1/0)==1/0),"Math",{acosh:function(m){return(m=+m)<1?NaN:m>94906265.62425156?Math.log(m)+Math.LN2:te(m-1+re(m-1)*re(m+1))}})},function(m,M,z){var $=z(0),te=z(140);$($.S+$.F*(Number.parseInt!=te),"Number",{parseInt:te})},function(m,M,z){var $=z(0),te=z(139);$($.S+$.F*(Number.parseFloat!=te),"Number",{parseFloat:te})},function(m,M,z){var $=z(0);$($.S,"Number",{MIN_SAFE_INTEGER:-9007199254740991})},function(m,M,z){var $=z(0);$($.S,"Number",{MAX_SAFE_INTEGER:9007199254740991})},function(m,M,z){var $=z(0),te=z(136),re=Math.abs;$($.S,"Number",{isSafeInteger:function(m){return te(m)&&re(m)<=9007199254740991}})},function(m,M,z){var $=z(0);$($.S,"Number",{isNaN:function(m){return m!=m}})},function(m,M,z){var $=z(0);$($.S,"Number",{isInteger:z(136)})},function(m,M,z){var $=z(0),te=z(6).isFinite;$($.S,"Number",{isFinite:function(m){return"number"==typeof m&&te(m)}})},function(m,M,z){var $=z(0);$($.S,"Number",{EPSILON:Math.pow(2,-52)})},function(m,M,z){"use strict";var $=z(0),te=z(3),re=z(138),ie=1..toPrecision;$($.P+$.F*(te((function(){return"1"!==ie.call(1,void 0)}))||!te((function(){ie.call({})}))),"Number",{toPrecision:function(m){var M=re(this,"Number#toPrecision: incorrect invocation!");return void 0===m?ie.call(M):ie.call(M,m)}})},function(m,M,z){"use strict";var $=z(0),te=z(24),re=z(138),ie=z(137),oe=1..toFixed,se=Math.floor,ae=[0,0,0,0,0,0],ue="Number.toFixed: incorrect invocation!",f=function(m,M){for(var z=-1,$=M;++z<6;)$+=m*ae[z],ae[z]=$%1e7,$=se($/1e7)},h=function(m){for(var M=6,z=0;--M>=0;)z+=ae[M],ae[M]=se(z/m),z=z%m*1e7},_=function(){for(var m=6,M="";--m>=0;)if(""!==M||0===m||0!==ae[m]){var z=String(ae[m]);M=""===M?z:M+ie.call("0",7-z.length)+z}return M},y=function(m,M,z){return 0===M?z:M%2==1?y(m,M-1,z*m):y(m*m,M/2,z)};$($.P+$.F*(!!oe&&("0.000"!==8e-5.toFixed(3)||"1"!==.9.toFixed(0)||"1.25"!==1.255.toFixed(2)||"1000000000000000128"!==(0xde0b6b3a7640080).toFixed(0))||!z(3)((function(){oe.call({})}))),"Number",{toFixed:function(m){var M,z,$,oe,se=re(this,ue),ae=te(m),ce="",le="0";if(ae<0||ae>20)throw RangeError(ue);if(se!=se)return"NaN";if(se<=-1e21||se>=1e21)return String(se);if(se<0&&(ce="-",se=-se),se>1e-21)if(z=(M=function(m){for(var M=0,z=m;z>=4096;)M+=12,z/=4096;for(;z>=2;)M+=1,z/=2;return M}(se*y(2,69,1))-69)<0?se*y(2,-M,1):se/y(2,M,1),z*=4503599627370496,(M=52-M)>0){for(f(0,z),$=ae;$>=7;)f(1e7,0),$-=7;for(f(y(10,$,1),0),$=M-1;$>=23;)h(1<<23),$-=23;h(1<<$),f(1,1),h(2),le=_()}else f(0,z),f(1<<-M,0),le=_()+ie.call("0",ae);return ae>0?ce+((oe=le.length)<=ae?"0."+ie.call("0",ae-oe)+le:le.slice(0,oe-ae)+"."+le.slice(oe-ae)):ce+le}})},function(m,M,z){"use strict";var $=z(6),te=z(16),re=z(25),ie=z(86),oe=z(30),se=z(3),ae=z(32).f,ue=z(23).f,ce=z(9).f,le=z(64).trim,fe=$.Number,he=fe,_e=fe.prototype,ye="Number"==re(z(33)(_e)),pe="trim"in String.prototype,v=function(m){var M=oe(m,!1);if("string"==typeof M&&M.length>2){var z,$,te,re=(M=pe?M.trim():le(M,3)).charCodeAt(0);if(43===re||45===re){if(88===(z=M.charCodeAt(2))||120===z)return NaN}else if(48===re){switch(M.charCodeAt(1)){case 66:case 98:$=2,te=49;break;case 79:case 111:$=8,te=55;break;default:return+M}for(var ie,se=M.slice(2),ae=0,ue=se.length;ae<ue;ae++)if((ie=se.charCodeAt(ae))<48||ie>te)return NaN;return parseInt(se,$)}}return+M};if(!fe(" 0o1")||!fe("0b1")||fe("+0x1")){fe=function(m){var M=arguments.length<1?0:m,z=this;return z instanceof fe&&(ye?se((function(){_e.valueOf.call(z)})):"Number"!=re(z))?ie(new he(v(M)),z,fe):v(M)};for(var de,ge=z(11)?ae(he):"MAX_VALUE,MIN_VALUE,NaN,NEGATIVE_INFINITY,POSITIVE_INFINITY,EPSILON,isFinite,isInteger,isNaN,isSafeInteger,MAX_SAFE_INTEGER,MIN_SAFE_INTEGER,parseFloat,parseInt,isInteger".split(","),ve=0;ge.length>ve;ve++)te(he,de=ge[ve])&&!te(fe,de)&&ce(fe,de,ue(he,de));fe.prototype=_e,_e.constructor=fe,z(15)($,"Number",fe)}},function(m,M,z){var $=z(0),te=z(139);$($.G+$.F*(parseFloat!=te),{parseFloat:te})},function(m,M,z){var $=z(0),te=z(140);$($.G+$.F*(parseInt!=te),{parseInt:te})},function(m,M,z){"use strict";var $=z(4),te=z(31),re=z(7)("hasInstance"),ie=Function.prototype;re in ie||z(9).f(ie,re,{value:function(m){if("function"!=typeof this||!$(m))return!1;if(!$(this.prototype))return m instanceof this;for(;m=te(m);)if(this.prototype===m)return!0;return!1}})},function(m,M,z){var $=z(9).f,te=Function.prototype,re=/^\s*function ([^ (]*)/;"name"in te||z(11)&&$(te,"name",{configurable:!0,get:function(){try{return(""+this).match(re)[1]}catch(m){return""}}})},function(m,M,z){var $=z(0);$($.P,"Function",{bind:z(142)})},function(m,M,z){"use strict";var $=z(65),te={};te[z(7)("toStringTag")]="z",te+""!="[object z]"&&z(15)(Object.prototype,"toString",(function(){return"[object "+$(this)+"]"}),!0)},function(m,M,z){var $=z(0);$($.S,"Object",{setPrototypeOf:z(88).set})},function(m,M){m.exports=Object.is||function(m,M){return m===M?0!==m||1/m==1/M:m!=m&&M!=M}},function(m,M,z){var $=z(0);$($.S,"Object",{is:z(303)})},function(m,M,z){var $=z(0);$($.S+$.F,"Object",{assign:z(143)})},function(m,M,z){var $=z(4);z(20)("isExtensible",(function(m){return function(M){return!!$(M)&&(!m||m(M))}}))},function(m,M,z){var $=z(4);z(20)("isSealed",(function(m){return function(M){return!$(M)||!!m&&m(M)}}))},function(m,M,z){var $=z(4);z(20)("isFrozen",(function(m){return function(M){return!$(M)||!!m&&m(M)}}))},function(m,M,z){var $=z(4),te=z(29).onFreeze;z(20)("preventExtensions",(function(m){return function(M){return m&&$(M)?m(te(M)):M}}))},function(m,M,z){var $=z(4),te=z(29).onFreeze;z(20)("seal",(function(m){return function(M){return m&&$(M)?m(te(M)):M}}))},function(m,M,z){var $=z(4),te=z(29).onFreeze;z(20)("freeze",(function(m){return function(M){return m&&$(M)?m(te(M)):M}}))},function(m,M,z){z(20)("getOwnPropertyNames",(function(){return z(144).f}))},function(m,M,z){var $=z(14),te=z(55);z(20)("keys",(function(){return function(m){return te($(m))}}))},function(m,M,z){var $=z(14),te=z(31);z(20)("getPrototypeOf",(function(){return function(m){return te($(m))}}))},function(m,M,z){var $=z(21),te=z(23).f;z(20)("getOwnPropertyDescriptor",(function(){return function(m,M){return te($(m),M)}}))},function(m,M,z){var $=z(0);$($.S+$.F*!z(11),"Object",{defineProperties:z(145)})},function(m,M,z){var $=z(0);$($.S+$.F*!z(11),"Object",{defineProperty:z(9).f})},function(m,M,z){var $=z(0);$($.S,"Object",{create:z(33)})},function(m,M,z){var $=z(55),te=z(67),re=z(66);m.exports=function(m){var M=$(m),z=te.f;if(z)for(var ie,oe=z(m),se=re.f,ae=0;oe.length>ae;)se.call(m,ie=oe[ae++])&&M.push(ie);return M}},function(m,M,z){var $=z(6),te=z(37),re=z(43),ie=z(147),oe=z(9).f;m.exports=function(m){var M=te.Symbol||(te.Symbol=re?{}:$.Symbol||{});"_"==m.charAt(0)||m in M||oe(M,m,{value:ie.f(m)})}},function(m,M,z){"use strict";var $=z(6),te=z(16),re=z(11),ie=z(0),oe=z(15),se=z(29).KEY,ae=z(3),ue=z(94),ce=z(44),le=z(35),fe=z(7),he=z(147),_e=z(320),ye=z(319),pe=z(90),de=z(5),ge=z(4),ve=z(21),be=z(30),me=z(36),Se=z(33),Ee=z(144),Re=z(23),Fe=z(9),je=z(55),Le=Re.f,xe=Fe.f,qe=Ee.f,Ve=$.Symbol,Ke=$.JSON,Ge=Ke&&Ke.stringify,ze=fe("_hidden"),He=fe("toPrimitive"),Je={}.propertyIsEnumerable,We=ue("symbol-registry"),Xe=ue("symbols"),Ze=ue("op-symbols"),Qe=Object.prototype,$e="function"==typeof Ve,et=$.QObject,tt=!et||!et.prototype||!et.prototype.findChild,nt=re&&ae((function(){return 7!=Se(xe({},"a",{get:function(){return xe(this,"a",{value:7}).a}})).a}))?function(m,M,z){var $=Le(Qe,M);$&&delete Qe[M],xe(m,M,z),$&&m!==Qe&&xe(Qe,M,$)}:xe,G=function(m){var M=Xe[m]=Se(Ve.prototype);return M._k=m,M},rt=$e&&"symbol"==typeof Ve.iterator?function(m){return"symbol"==typeof m}:function(m){return m instanceof Ve},H=function(m,M,z){return m===Qe&&H(Ze,M,z),de(m),M=be(M,!0),de(z),te(Xe,M)?(z.enumerable?(te(m,ze)&&m[ze][M]&&(m[ze][M]=!1),z=Se(z,{enumerable:me(0,!1)})):(te(m,ze)||xe(m,ze,me(1,{})),m[ze][M]=!0),nt(m,M,z)):xe(m,M,z)},J=function(m,M){de(m);for(var z,$=ye(M=ve(M)),te=0,re=$.length;re>te;)H(m,z=$[te++],M[z]);return m},W=function(m){var M=Je.call(this,m=be(m,!0));return!(this===Qe&&te(Xe,m)&&!te(Ze,m))&&(!(M||!te(this,m)||!te(Xe,m)||te(this,ze)&&this[ze][m])||M)},X=function(m,M){if(m=ve(m),M=be(M,!0),m!==Qe||!te(Xe,M)||te(Ze,M)){var z=Le(m,M);return!z||!te(Xe,M)||te(m,ze)&&m[ze][M]||(z.enumerable=!0),z}},Z=function(m){for(var M,z=qe(ve(m)),$=[],re=0;z.length>re;)te(Xe,M=z[re++])||M==ze||M==se||$.push(M);return $},Q=function(m){for(var M,z=m===Qe,$=qe(z?Ze:ve(m)),re=[],ie=0;$.length>ie;)!te(Xe,M=$[ie++])||z&&!te(Qe,M)||re.push(Xe[M]);return re};$e||(oe((Ve=function(){if(this instanceof Ve)throw TypeError("Symbol is not a constructor!");var m=le(arguments.length>0?arguments[0]:void 0),t=function(M){this===Qe&&t.call(Ze,M),te(this,ze)&&te(this[ze],m)&&(this[ze][m]=!1),nt(this,m,me(1,M))};return re&&tt&&nt(Qe,m,{configurable:!0,set:t}),G(m)}).prototype,"toString",(function(){return this._k})),Re.f=X,Fe.f=H,z(32).f=Ee.f=Z,z(66).f=W,z(67).f=Q,re&&!z(43)&&oe(Qe,"propertyIsEnumerable",W,!0),he.f=function(m){return G(fe(m))}),ie(ie.G+ie.W+ie.F*!$e,{Symbol:Ve});for(var it="hasInstance,isConcatSpreadable,iterator,match,replace,search,species,split,toPrimitive,toStringTag,unscopables".split(","),ot=0;it.length>ot;)fe(it[ot++]);for(var st=je(fe.store),at=0;st.length>at;)_e(st[at++]);ie(ie.S+ie.F*!$e,"Symbol",{for:function(m){return te(We,m+="")?We[m]:We[m]=Ve(m)},keyFor:function(m){if(!rt(m))throw TypeError(m+" is not a symbol!");for(var M in We)if(We[M]===m)return M},useSetter:function(){tt=!0},useSimple:function(){tt=!1}}),ie(ie.S+ie.F*!$e,"Object",{create:function(m,M){return void 0===M?Se(m):J(Se(m),M)},defineProperty:H,defineProperties:J,getOwnPropertyDescriptor:X,getOwnPropertyNames:Z,getOwnPropertySymbols:Q}),Ke&&ie(ie.S+ie.F*(!$e||ae((function(){var m=Ve();return"[null]"!=Ge([m])||"{}"!=Ge({a:m})||"{}"!=Ge(Object(m))}))),"JSON",{stringify:function(m){for(var M,z,$=[m],te=1;arguments.length>te;)$.push(arguments[te++]);if(z=M=$[1],(ge(M)||void 0!==m)&&!rt(m))return pe(M)||(M=function(m,M){if("function"==typeof z&&(M=z.call(this,m,M)),!rt(M))return M}),$[1]=M,Ge.apply(Ke,$)}}),Ve.prototype[He]||z(18)(Ve.prototype,He,Ve.prototype.valueOf),ce(Ve,"Symbol"),ce(Math,"Math",!0),ce($.JSON,"JSON",!0)},function(m,M,z){z(321),z(318),z(317),z(316),z(315),z(314),z(313),z(312),z(311),z(310),z(309),z(308),z(307),z(306),z(305),z(304),z(302),z(301),z(300),z(299),z(298),z(297),z(296),z(295),z(294),z(293),z(292),z(291),z(290),z(289),z(288),z(287),z(286),z(285),z(284),z(283),z(282),z(281),z(280),z(279),z(278),z(277),z(276),z(274),z(273),z(272),z(271),z(270),z(269),z(268),z(267),z(266),z(265),z(264),z(263),z(262),z(261),z(260),z(259),z(258),z(257),z(256),z(255),z(254),z(253),z(252),z(251),z(250),z(249),z(248),z(247),z(246),z(245),z(244),z(243),z(242),z(241),z(239),z(238),z(236),z(235),z(234),z(233),z(232),z(231),z(230),z(227),z(226),z(225),z(224),z(223),z(222),z(221),z(220),z(219),z(218),z(217),z(216),z(215),z(128),z(214),z(213),z(126),z(212),z(211),z(210),z(209),z(208),z(204),z(203),z(202),z(201),z(200),z(199),z(198),z(197),z(196),z(195),z(194),z(193),z(192),z(191),z(190),z(189),z(188),z(187),z(186),z(185),z(184),z(183),z(182),z(181),z(180),z(179),z(177),z(176),z(175),m.exports=z(37)},function(m,M,z){"use strict";Object.defineProperty(M,"__esModule",{value:!0}),M.MD5=M.SFSRoom=M.SetBuddyVariablesRequest=M.RemoveBuddyRequest=M.InitBuddyListRequest=M.GoOnlineRequest=M.BuddyMessageRequest=M.BlockBuddyRequest=M.AddBuddyRequest=M.SetUserPositionRequest=M.QuickJoinGameRequest=M.JoinRoomInvitationRequest=M.InviteUsersRequest=M.InvitationReplyRequest=M.CreateSFSGameRequest=M.BanUserRequest=M.KickUserRequest=M.ExtensionRequest=M.FindUsersRequest=M.FindRoomsRequest=M.PlayerToSpectatorRequest=M.SpectatorToPlayerRequest=M.UnsubscribeRoomGroupRequest=M.SubscribeRoomGroupRequest=M.SetUserVariablesRequest=M.SetRoomVariablesRequest=M.AdminMessageRequest=M.ModeratorMessageRequest=M.ObjectMessageRequest=M.PrivateMessageRequest=M.PublicMessageRequest=M.ChangeRoomCapacityRequest=M.ChangeRoomPasswordStateRequest=M.ChangeRoomNameRequest=M.LeaveRoomRequest=M.CreateRoomRequest=M.JoinRoomRequest=M.LogoutRequest=M.LoginRequest=M.ClientDisconnectionReason=M.LoggerEvent=M.LogLevel=M.SFSErrorCodes=M.MessageRecipientMode=M.BanMode=M.MapLimits=M.RoomExtension=M.RoomEvents=M.RoomPermissions=M.MMORoomSettings=M.SFSGameSettings=M.RoomSettings=M.UserProperties=M.RoomProperties=M.StringMatch=M.NumberMatch=M.BoolMatch=M.LogicOperator=M.MatchExpression=M.MMOItemVariable=M.ReservedBuddyVariables=M.SFSBuddyVariable=M.ReservedRoomVariables=M.SFSRoomVariable=M.SFSUserVariable=M.VariableType=M.UserPrivileges=M.InvitationReply=M.Vec3D=M.SFSArray=M.SFSObject=M.SFSDataType=M.SFSBuddyEvent=M.SFSEvent=M.SmartFox=void 0;var $=z(322);Object.keys($).forEach((function(m){"default"!==m&&"__esModule"!==m&&Object.defineProperty(M,m,{enumerable:!0,get:function(){return $[m]}})}));var te=z(174);Object.defineProperty(M,"SmartFox",{enumerable:!0,get:function(){return te.SmartFox}});var re=z(38);Object.defineProperty(M,"SFSEvent",{enumerable:!0,get:function(){return re.SFSEvent}}),Object.defineProperty(M,"SFSBuddyEvent",{enumerable:!0,get:function(){return re.SFSBuddyEvent}});var ie=z(8);Object.defineProperty(M,"SFSDataType",{enumerable:!0,get:function(){return ie.SFSDataType}}),Object.defineProperty(M,"SFSObject",{enumerable:!0,get:function(){return ie.SFSObject}}),Object.defineProperty(M,"SFSArray",{enumerable:!0,get:function(){return ie.SFSArray}}),Object.defineProperty(M,"Vec3D",{enumerable:!0,get:function(){return ie.Vec3D}});var oe=z(71);Object.defineProperty(M,"InvitationReply",{enumerable:!0,get:function(){return oe.InvitationReply}});var se=z(47);Object.defineProperty(M,"UserPrivileges",{enumerable:!0,get:function(){return se.UserPrivileges}});var ae=z(48);Object.defineProperty(M,"VariableType",{enumerable:!0,get:function(){return ae.VariableType}});var ue=z(58);Object.defineProperty(M,"SFSUserVariable",{enumerable:!0,get:function(){return ue.SFSUserVariable}});var ce=z(49);Object.defineProperty(M,"SFSRoomVariable",{enumerable:!0,get:function(){return ce.SFSRoomVariable}}),Object.defineProperty(M,"ReservedRoomVariables",{enumerable:!0,get:function(){return ce.ReservedRoomVariables}});var le=z(46);Object.defineProperty(M,"SFSBuddyVariable",{enumerable:!0,get:function(){return le.SFSBuddyVariable}}),Object.defineProperty(M,"ReservedBuddyVariables",{enumerable:!0,get:function(){return le.ReservedBuddyVariables}});var fe=z(72);Object.defineProperty(M,"MMOItemVariable",{enumerable:!0,get:function(){return fe.MMOItemVariable}});var he=z(45);Object.defineProperty(M,"MatchExpression",{enumerable:!0,get:function(){return he.MatchExpression}}),Object.defineProperty(M,"LogicOperator",{enumerable:!0,get:function(){return he.LogicOperator}});var _e=z(159);Object.defineProperty(M,"BoolMatch",{enumerable:!0,get:function(){return _e.BoolMatch}}),Object.defineProperty(M,"NumberMatch",{enumerable:!0,get:function(){return _e.NumberMatch}}),Object.defineProperty(M,"StringMatch",{enumerable:!0,get:function(){return _e.StringMatch}});var ye=z(158);Object.defineProperty(M,"RoomProperties",{enumerable:!0,get:function(){return ye.RoomProperties}}),Object.defineProperty(M,"UserProperties",{enumerable:!0,get:function(){return ye.UserProperties}});var pe=z(56);Object.defineProperty(M,"RoomSettings",{enumerable:!0,get:function(){return pe.RoomSettings}}),Object.defineProperty(M,"SFSGameSettings",{enumerable:!0,get:function(){return pe.SFSGameSettings}}),Object.defineProperty(M,"MMORoomSettings",{enumerable:!0,get:function(){return pe.MMORoomSettings}}),Object.defineProperty(M,"RoomPermissions",{enumerable:!0,get:function(){return pe.RoomPermissions}}),Object.defineProperty(M,"RoomEvents",{enumerable:!0,get:function(){return pe.RoomEvents}}),Object.defineProperty(M,"RoomExtension",{enumerable:!0,get:function(){return pe.RoomExtension}}),Object.defineProperty(M,"MapLimits",{enumerable:!0,get:function(){return pe.MapLimits}}),Object.defineProperty(M,"BanMode",{enumerable:!0,get:function(){return pe.BanMode}}),Object.defineProperty(M,"MessageRecipientMode",{enumerable:!0,get:function(){return pe.MessageRecipientMode}});var de=z(73);Object.defineProperty(M,"SFSErrorCodes",{enumerable:!0,get:function(){return de.SFSErrorCodes}});var ge=z(50);Object.defineProperty(M,"LogLevel",{enumerable:!0,get:function(){return ge.LogLevel}}),Object.defineProperty(M,"LoggerEvent",{enumerable:!0,get:function(){return ge.LoggerEvent}});var ve=z(51);Object.defineProperty(M,"ClientDisconnectionReason",{enumerable:!0,get:function(){return ve.ClientDisconnectionReason}});var be=z(118);Object.defineProperty(M,"LoginRequest",{enumerable:!0,get:function(){return be.LoginRequest}});var me=z(116);Object.defineProperty(M,"LogoutRequest",{enumerable:!0,get:function(){return me.LogoutRequest}});var Se=z(115);Object.defineProperty(M,"JoinRoomRequest",{enumerable:!0,get:function(){return Se.JoinRoomRequest}});var Ee=z(70);Object.defineProperty(M,"CreateRoomRequest",{enumerable:!0,get:function(){return Ee.CreateRoomRequest}});var Re=z(157);Object.defineProperty(M,"LeaveRoomRequest",{enumerable:!0,get:function(){return Re.LeaveRoomRequest}});var Fe=z(114);Object.defineProperty(M,"ChangeRoomNameRequest",{enumerable:!0,get:function(){return Fe.ChangeRoomNameRequest}});var je=z(113);Object.defineProperty(M,"ChangeRoomPasswordStateRequest",{enumerable:!0,get:function(){return je.ChangeRoomPasswordStateRequest}});var Le=z(112);Object.defineProperty(M,"ChangeRoomCapacityRequest",{enumerable:!0,get:function(){return Le.ChangeRoomCapacityRequest}});var xe=z(69);Object.defineProperty(M,"PublicMessageRequest",{enumerable:!0,get:function(){return xe.PublicMessageRequest}}),Object.defineProperty(M,"PrivateMessageRequest",{enumerable:!0,get:function(){return xe.PrivateMessageRequest}}),Object.defineProperty(M,"ObjectMessageRequest",{enumerable:!0,get:function(){return xe.ObjectMessageRequest}}),Object.defineProperty(M,"ModeratorMessageRequest",{enumerable:!0,get:function(){return xe.ModeratorMessageRequest}}),Object.defineProperty(M,"AdminMessageRequest",{enumerable:!0,get:function(){return xe.AdminMessageRequest}});var qe=z(111);Object.defineProperty(M,"SetRoomVariablesRequest",{enumerable:!0,get:function(){return qe.SetRoomVariablesRequest}});var Ve=z(110);Object.defineProperty(M,"SetUserVariablesRequest",{enumerable:!0,get:function(){return Ve.SetUserVariablesRequest}});var Ke=z(109);Object.defineProperty(M,"SubscribeRoomGroupRequest",{enumerable:!0,get:function(){return Ke.SubscribeRoomGroupRequest}});var Ge=z(108);Object.defineProperty(M,"UnsubscribeRoomGroupRequest",{enumerable:!0,get:function(){return Ge.UnsubscribeRoomGroupRequest}});var ze=z(107);Object.defineProperty(M,"SpectatorToPlayerRequest",{enumerable:!0,get:function(){return ze.SpectatorToPlayerRequest}});var He=z(106);Object.defineProperty(M,"PlayerToSpectatorRequest",{enumerable:!0,get:function(){return He.PlayerToSpectatorRequest}});var Je=z(105);Object.defineProperty(M,"FindRoomsRequest",{enumerable:!0,get:function(){return Je.FindRoomsRequest}});var We=z(104);Object.defineProperty(M,"FindUsersRequest",{enumerable:!0,get:function(){return We.FindUsersRequest}});var Xe=z(96);Object.defineProperty(M,"ExtensionRequest",{enumerable:!0,get:function(){return Xe.ExtensionRequest}});var Ze=z(156);Object.defineProperty(M,"KickUserRequest",{enumerable:!0,get:function(){return Ze.KickUserRequest}});var Qe=z(155);Object.defineProperty(M,"BanUserRequest",{enumerable:!0,get:function(){return Qe.BanUserRequest}});var $e=z(154);Object.defineProperty(M,"CreateSFSGameRequest",{enumerable:!0,get:function(){return $e.CreateSFSGameRequest}});var et=z(153);Object.defineProperty(M,"InvitationReplyRequest",{enumerable:!0,get:function(){return et.InvitationReplyRequest}});var tt=z(68);Object.defineProperty(M,"InviteUsersRequest",{enumerable:!0,get:function(){return tt.InviteUsersRequest}});var nt=z(152);Object.defineProperty(M,"JoinRoomInvitationRequest",{enumerable:!0,get:function(){return nt.JoinRoomInvitationRequest}});var rt=z(151);Object.defineProperty(M,"QuickJoinGameRequest",{enumerable:!0,get:function(){return rt.QuickJoinGameRequest}});var it=z(103);Object.defineProperty(M,"SetUserPositionRequest",{enumerable:!0,get:function(){return it.SetUserPositionRequest}});var ot=z(101);Object.defineProperty(M,"AddBuddyRequest",{enumerable:!0,get:function(){return ot.AddBuddyRequest}});var st=z(99);Object.defineProperty(M,"BlockBuddyRequest",{enumerable:!0,get:function(){return st.BlockBuddyRequest}});var at=z(150);Object.defineProperty(M,"BuddyMessageRequest",{enumerable:!0,get:function(){return at.BuddyMessageRequest}});var ut=z(98);Object.defineProperty(M,"GoOnlineRequest",{enumerable:!0,get:function(){return ut.GoOnlineRequest}});var ct=z(102);Object.defineProperty(M,"InitBuddyListRequest",{enumerable:!0,get:function(){return ct.InitBuddyListRequest}});var lt=z(100);Object.defineProperty(M,"RemoveBuddyRequest",{enumerable:!0,get:function(){return lt.RemoveBuddyRequest}});var ft=z(97);Object.defineProperty(M,"SetBuddyVariablesRequest",{enumerable:!0,get:function(){return ft.SetBuddyVariablesRequest}});var ht=z(10);Object.defineProperty(M,"SFSRoom",{enumerable:!0,get:function(){return ht.SFSRoom}});var _t=z(117);Object.defineProperty(M,"MD5",{enumerable:!0,get:function(){return _t.MD5}}),z(149)}])}));var GetServerRooms=pc.createScript("getServerRooms");GetServerRooms.attributes.add("ip",{type:"string"}),GetServerRooms.prototype.initialize=function(){console.log("Start connection, IP: "+this.ip),this.SmartFoxServer=this.app.root.findByName("SmartFoxServer").script.smartFoxServer,this.sfs=null,this.GetRooms()},GetServerRooms.prototype.GetRooms=function(){var t={};t.host=this.ip,t.port=8443,t.zone="BT_PC_v3",t.debug=!1,t.useSSL=!0,this.sfs=new SFS2X.SmartFox(t),this.sfs.addEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnection,this),this.sfs.addEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLost,this),this.sfs.addEventListener(SFS2X.SFSEvent.LOGIN,this.onLogin,this),this.sfs.addEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginError,this),this.sfs.connect()},GetServerRooms.prototype.onConnection=function(t){if(t.success){let t=new SFS2X.SFSObject;t.putUtfString("pass",""),this.sfs.send(new SFS2X.LoginRequest("","",t))}else this.remove()},GetServerRooms.prototype.onConnectionLost=function(t){},GetServerRooms.prototype.onLogin=function(t){var e=this.sfs.roomManager.getRoomList();e.sort(this.SortRooms),this.SmartFoxServer.PrintRooms(e,this.ip),this.sfs.disconnect(),this.remove()},GetServerRooms.prototype.SortRooms=function(t,e){return e.userCount-t.userCount},GetServerRooms.prototype.onLoginError=function(t){this.sfs.disconnect(),this.remove()},GetServerRooms.prototype.remove=function(){this.reset(),this.sfs=null,this.entity.destroy()},GetServerRooms.prototype.reset=function(){this.sfs&&(this.sfs.removeEventListener(SFS2X.SFSEvent.CONNECTION,this.onConnection),this.sfs.removeEventListener(SFS2X.SFSEvent.CONNECTION_LOST,this.onConnectionLost),this.sfs.removeEventListener(SFS2X.SFSEvent.LOGIN,this.onLogin),this.sfs.removeEventListener(SFS2X.SFSEvent.LOGIN_ERROR,this.onLoginError))};var RoomInfo=pc.createScript("roomInfo");RoomInfo.prototype.initialize=function(){this.roomid=null,this.ip=null,this.currentPlayers=0};var RemotePlayer=pc.createScript("remotePlayer");RemotePlayer.attributes.add("Model",{type:"entity",default:null}),RemotePlayer.prototype.CheckPackets=function(){0===this.packets&&this.Model&&(this.Model.enabled=!1),this.packets=0},RemotePlayer.prototype.initialize=function(){this.GameManager=this.app.root.findByName("GameManager").script.gameManager,this.receivedamage=!0,this.receivedamage2=!0,this.timer=0,this.timer2=0,this.timer2_=!1,this.timer3=0,this.timer3_=!1,this.timer4=0,this.timer4_=!1,this.packets=0,this.pos=new pc.Vec3,this.lerpedPos=new pc.Vec3,this.rot_Y=new pc.Quat,this.lerpedRot_Y=new pc.Quat,this.MovementAnimation="",this.currentAnimation="Idle Rifle",this.currentweapon="Null",this.prevWeap="Null",this.currentactiveweapon=null,this.health=100,this.fake_health=100,this.shooting=!1,this.reloading=!1,this.footstepTimer=0,this.SetupWeapons(),this.alive=!0,this.stopShotAllowedAt=0,this.projectileAllowedAt=0,this.EnableCollider(!1),this.lastDeathPos=new pc.Vec3,this.lastDeathPosTemp=new pc.Vec3,this.testdyingpos=new pc.Vec3,this.isdying=!1,this.weapAxeDis=null,this.isJetpackFire=!1,this.jetpackparticletimer=0,this.jetpackflametimer=0,this.jetpackflame_first=!1},RemotePlayer.attributes.add("Collider",{type:"entity"}),RemotePlayer.prototype.EnableCollider=function(t){this.Collider.enabled=t},RemotePlayer.prototype.update=function(t){if(!0===this.isJetpackFire?(this.jetpackparticletimer>=0?(this.jetpackparticletimer=-.5,this.JetpackFlameParticle1.particlesystem.reset(),this.JetpackFlameParticle1.particlesystem.play(),this.JetpackFlameParticle2.particlesystem.reset(),this.JetpackFlameParticle2.particlesystem.play()):this.jetpackparticletimer+=t,this.jetpackflametimer>=0?(this.jetpackflametimer=-.25,!1===this.jetpackflame_first?(this.entity.sound.play("Flame"),this.jetpackflame_first=!0):this.entity.sound.play("Flame2")):this.jetpackflametimer+=t):(this.jetpackparticletimer=0,this.jetpackflametimer=0,this.jetpackflame_first=!1),this.receivedamage2=!0,0===this.lastDeathPos.x&&0===this.lastDeathPos.y&&0===this.lastDeathPos.z||(this.entity.getEulerAngles().round().equals(this.lastDeathPos)?this.receivedamage2=!1:this.lastDeathPos=new pc.Vec3),this.isdying=!1,0===this.testdyingpos.x&&0===this.testdyingpos.y&&0===this.testdyingpos.z);else{var e=this.entity.getPosition(),i=this.testdyingpos;e.distance(i)>=.5?(this.isdying=!1,this.testdyingpos=new pc.Vec3):this.isdying=!0}!0===this.isdying&&(this.receivedamage2=!1),!0===this.alive&&this.health<=0&&(this.alive=!1,this.receivedamage=!1,this.timer2=0,this.timer2_=!0,setTimeout(function(){this.lastDeathPos=new pc.Vec3(this.entity.getEulerAngles().x,this.entity.getEulerAngles().y,this.entity.getEulerAngles().z),this.lastDeathPos.round(),this.testdyingpos=new pc.Vec3(this.entity.getPosition().x,this.entity.getPosition().y,this.entity.getPosition().z)}.bind(this),1e3),this.fake_health=0),!1===this.alive&&this.health>=1&&(this.alive=!0,this.timer3=0,this.timer3_=!0,this.timer4=0,this.timer4_=!0,this.fake_health=100),this.Model.children[0].animation.loop=!0,"Dying"===this.MovementAnimation&&(this.Model.children[0].animation.loop=!1),this.MovementAnimation!==this.currentAnimation&&(this.MovementAnimation=this.currentAnimation,this.Model.children[0].animation.play(this.MovementAnimation,.2),"Axe"===this.MovementAnimation?!1===this.Axe.enabled&&(this.Axe.enabled=!0,this.currentactiveweapon&&(this.weapAxeDis=this.currentactiveweapon,this.weapAxeDis.enabled=!1)):!0===this.Axe.enabled&&(this.Axe.enabled=!1,this.weapAxeDis&&(this.weapAxeDis.enabled=!0,this.weapAxeDis=null))),!0===this.isdying?this.entity.setPosition(this.pos):(this.lerpedPos.lerp(this.entity.getPosition(),this.pos,7*t),this.entity.setPosition(this.lerpedPos)),this.lerpedRot_Y.slerp(this.entity.getRotation(),this.rot_Y,7*t),this.entity.setRotation(0,this.lerpedRot_Y.y,0,this.lerpedRot_Y.w),this.prevWeap!==this.currentweapon&&"Null"!==this.currentweapon&&(this.prevWeap=this.currentweapon,this.SetWeapon(this.prevWeap)),this.currentactiveweapon&&!1===this.Axe.enabled&&("AWP"===this.currentactiveweapon.name||"Barrett"===this.currentactiveweapon.name||"M3"===this.currentactiveweapon.name||"XM1014"===this.currentactiveweapon.name||this.currentactiveweapon&&this.currentactiveweapon.script&&(this.currentactiveweapon.script.weaponSync.shooting=this.shooting)),!1===this.reloading&&this.currentactiveweapon&&!0===this.MovementAnimation.includes("Reload")&&(this.currentactiveweapon&&this.currentactiveweapon.script&&this.currentactiveweapon.script.weaponSync.reload(),this.reloading=!0,setTimeout(function(){this.reloading=!1}.bind(this),1800));let s=0;!0===this.currentAnimation.includes("Run Forward")?s=.3:!0===this.currentAnimation.includes("Fast Run")&&(s=.28),0!==s&&(this.footstepspeed=s,this.footstepTimer+=t,this.footstepTimer>this.footstepspeed&&(this.soundname="Footstep01",this.ran=random(1,3),1===this.ran?this.soundname="Footstep01":2===this.ran?this.soundname="Footstep02":3===this.ran&&(this.soundname="Footstep03"),this.entity.sound.play(this.soundname),this.footstepTimer=0)),this.timer+=t,this.timer>=6&&(this.CheckPackets(),this.timer=0),!0===this.timer2_&&(this.timer2+=t,this.timer2>=3&&(this.timer2=0,this.timer2_=!1)),!0===this.timer3_&&(this.timer3+=t,this.timer3>=2.2&&(this.timer3=0,this.timer3_=!1)),!0===this.timer4_&&(this.timer4+=t,this.timer4>=5&&(this.receivedamage=!0,this.timer4=0,this.timer4_=!1)),this.Model&&this.packets>=11&&!1===this.Model.enabled&&!1===this.timer2_&&!1===this.timer3_&&(this.Model.enabled=!0,this.Model.children[0].animation.play(this.MovementAnimation,.2))},RemotePlayer.prototype.SingleShot=function(){this.currentactiveweapon&&(this.currentactiveweapon.script&&pc.now()-this.stopShotAllowedAt>40&&(this.currentactiveweapon.script.weaponSync.shoot(),this.stopShotAllowedAt=pc.now()+40))},RemotePlayer.prototype.GrenadeLauncher_=function(t,e,i,s,a,n,h,r,o,l,p){this.currentactiveweapon&&(pc.now()-this.projectileAllowedAt>800&&(this.GameManager.GrenadeLauncher_(t,e,i,s,a,n,h,r,o,l,p,!1),this.projectileAllowedAt=pc.now()+800))},RemotePlayer.prototype.Grenade_=function(t,e,i,s,a,n,h,r,o,l,p,d){this.currentactiveweapon&&(pc.now()-this.projectileAllowedAt>800&&(this.GameManager.Grenade_(t,e,i,s,a,n,h,r,o,l,p,d,!1),this.projectileAllowedAt=pc.now()+800))},RemotePlayer.attributes.add("Axe",{type:"entity"}),RemotePlayer.attributes.add("G36C",{type:"entity"}),RemotePlayer.attributes.add("AUG",{type:"entity"}),RemotePlayer.attributes.add("P90",{type:"entity"}),RemotePlayer.attributes.add("AWP",{type:"entity"}),RemotePlayer.attributes.add("Barrett",{type:"entity"}),RemotePlayer.attributes.add("SCAR",{type:"entity"}),RemotePlayer.attributes.add("M110",{type:"entity"}),RemotePlayer.attributes.add("M3",{type:"entity"}),RemotePlayer.attributes.add("M4",{type:"entity"}),RemotePlayer.attributes.add("M249",{type:"entity"}),RemotePlayer.attributes.add("MP5",{type:"entity"}),RemotePlayer.attributes.add("XM1014",{type:"entity"}),RemotePlayer.attributes.add("RPG",{type:"entity"}),RemotePlayer.attributes.add("Jetpack",{type:"entity"}),RemotePlayer.attributes.add("JetpackFlameParticle1",{type:"entity"}),RemotePlayer.attributes.add("JetpackFlameParticle2",{type:"entity"}),RemotePlayer.prototype.SetupWeapons=function(){this.RightHand=this.entity.findByName("mixamorig:RightHand"),this.G36C.reparent(this.RightHand),this.AUG.reparent(this.RightHand),this.P90.reparent(this.RightHand),this.AWP.reparent(this.RightHand),this.Barrett.reparent(this.RightHand),this.SCAR.reparent(this.RightHand),this.M110.reparent(this.RightHand),this.M3.reparent(this.RightHand),this.M4.reparent(this.RightHand),this.M249.reparent(this.RightHand),this.MP5.reparent(this.RightHand),this.XM1014.reparent(this.RightHand),this.Axe.reparent(this.RightHand),this.RPG.reparent(this.RightHand),this.Spine=this.entity.findByName("mixamorig:Spine"),this.Jetpack.reparent(this.Spine),this.G36C.enabled=!1,this.AUG.enabled=!1,this.P90.enabled=!1,this.AWP.enabled=!1,this.Barrett.enabled=!1,this.SCAR.enabled=!1,this.M110.enabled=!1,this.M3.enabled=!1,this.M4.enabled=!1,this.M249.enabled=!1,this.MP5.enabled=!1,this.XM1014.enabled=!1,this.Axe.enabled=!1,this.RPG.enabled=!1},RemotePlayer.prototype.SetWeapon=function(t){this.G36C.enabled=!1,this.AUG.enabled=!1,this.P90.enabled=!1,this.AWP.enabled=!1,this.Barrett.enabled=!1,this.SCAR.enabled=!1,this.M110.enabled=!1,this.M3.enabled=!1,this.M4.enabled=!1,this.M249.enabled=!1,this.MP5.enabled=!1,this.XM1014.enabled=!1,this.Axe.enabled=!1,this.RPG.enabled=!1,"G36C"===t?(this.G36C.enabled=!0,this.currentactiveweapon=this.G36C):"AUG"===t?(this.AUG.enabled=!0,this.currentactiveweapon=this.AUG):"P90"===t?(this.P90.enabled=!0,this.currentactiveweapon=this.P90):"AWP"===t?(this.AWP.enabled=!0,this.currentactiveweapon=this.AWP):"Barrett"===t?(this.Barrett.enabled=!0,this.currentactiveweapon=this.Barrett):"SCAR"===t?(this.SCAR.enabled=!0,this.currentactiveweapon=this.SCAR):"M110"===t?(this.M110.enabled=!0,this.currentactiveweapon=this.M110):"M3"===t?(this.M3.enabled=!0,this.currentactiveweapon=this.M3):"M4"===t?(this.M4.enabled=!0,this.currentactiveweapon=this.M4):"M249"===t?(this.M249.enabled=!0,this.currentactiveweapon=this.M249):"MP5"===t?(this.MP5.enabled=!0,this.currentactiveweapon=this.MP5):"XM1014"===t?(this.XM1014.enabled=!0,this.currentactiveweapon=this.XM1014):"RPG"===t&&(this.RPG.enabled=!0,this.currentactiveweapon=this.RPG)};var WeaponSync=pc.createScript("weaponSync");WeaponSync.prototype.initialize=function(){this.shooting=!1,this.nextShootAllowedAt=0,this.tempSoundDistance=this.entity.sound.maxDistance,this.onStateChanged(),this.on("state",this.onStateChanged,this),this.enableaudioin=0,this.waitingEnableSound=!0,this.entity.sound.volume=0,this.fireRate=1.25*this.fireRate},WeaponSync.prototype.onStateChanged=function(t){this.entity.sound.stop("Fire")},WeaponSync.attributes.add("fireRate",{type:"number",default:.2}),WeaponSync.prototype.update=function(t){!0===this.waitingEnableSound&&(this.enableaudioin+=t,this.enableaudioin>=2&&(this.entity.sound.volume=.2,this.waitingEnableSound=!1)),!0===this.shooting&&(this.nextShootAllowedAt-=t,this.nextShootAllowedAt<0&&(this.shoot(),this.nextShootAllowedAt=this.fireRate))},WeaponSync.prototype.shoot=function(){this.entity.sound.maxDistance=this.tempSoundDistance,this.entity.sound.play("Fire"),this.MuzzleFlash()},WeaponSync.prototype.reload=function(){this.entity.sound.maxDistance=10,this.entity.sound.play("Reload")},WeaponSync.attributes.add("muzzle",{type:"entity",default:null}),WeaponSync.prototype.MuzzleFlash=function(){if(this.muzzle){var t=random(-90,90);this.muzzle.setLocalEulerAngles(t,0,0),this.muzzle.enabled=!0,setTimeout(function(){this.muzzle.enabled=!1}.bind(this),30)}};var TouchCameraMovement=pc.createScript("touchCameraMovement");TouchCameraMovement.attributes.add("touchSensitivity",{type:"number",default:5,description:"Touch Sensitivity"}),TouchCameraMovement.prototype.initialize=function(){this.playerMovement=this.entity.script.playerMovement,this.eulers=new pc.Vec3,this.touchCoords=new pc.Vec2;var t=this.app;this.canvas=t.graphicsDevice,this.lastRTouchPoint=new pc.Vec2,this.Rid=-1,this.dx=null,this.dy=null,t.touch&&(t.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),t.touch.on(pc.EVENT_TOUCHEND,this.onTouchEndCancel,this),t.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchEndCancel,this),t.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.touchSensitivityTemp=this.touchSensitivity,this.holder=this.entity.children[1].screen,this.xspace=.5,this.x=0,this.y=0},TouchCameraMovement.prototype.onTouchStart=function(t){t.changedTouches.forEach((function(t){t.x>this.canvas.width/2/this.app.renderer.device.maxPixelRatio&&-1==this.Rid&&(this.Rid=t.id,this.lastRTouchPoint.set(t.x,t.y))}),this)},TouchCameraMovement.prototype.onTouchEndCancel=function(t){t.changedTouches.forEach((function(t){t.id==this.Rid&&(this.Rid=-1),t.x>this.canvas.width/2/this.app.renderer.device.maxPixelRatio&&-1==this.Rid&&this.DisableButtonsPressed()}),this)},TouchCameraMovement.prototype.onTouchMove=function(t){this.x=0,this.y=0,this.RTouch=t.getTouchById(this.Rid,t.touches);let e=this.touchSensitivity;this.playerMovement.entity.script.weaponManager.currentweapon&&!0===this.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.isAiming&&(!0===this.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.sniper?e*=.5:e*=.72),this.RTouch&&(this.dx=(this.RTouch.x-this.lastRTouchPoint.x)*e,this.dy=(this.RTouch.y-this.lastRTouchPoint.y)*e,this.x=this.dx,this.y=this.dy,this.eulers.x-=e*this.dx/60%360,this.eulers.y-=e*this.dy/60%360,this.eulers.x<0&&(this.eulers.x+=360),this.eulers.x>360&&(this.eulers.x=0),this.eulers.y<0&&(this.eulers.y+=360),this.eulers.y<272&&(this.eulers.y=272),this.eulers.y>448&&(this.eulers.y=448),this.lastRTouchPoint.set(this.RTouch.x,this.RTouch.y))},TouchCameraMovement.prototype.getRes=function(){return this.holder.resolution.clone().scale(1/this.app.renderer.device.maxPixelRatio)},TouchCameraMovement.prototype.DisableButtonsPressed=function(){let t=this.playerMovement.entity.script.weaponManager.currentweapon;!0===this.playerMovement.aimingPressed&&t&&(!0!==t.script.gunBehaviour.sniper&&!0!==t.script.gunBehaviour.rpg||this.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.firesingleshot()),t.script.gunBehaviour.autoshot=!1,this.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting=!1,this.playerMovement.shootingPressed=!1,this.playerMovement.aimingPressed=!1,this.playerMovement.jumpingPressed=!1};var TouchPlayerMovement=pc.createScript("touchPlayerMovement");TouchPlayerMovement.prototype.initialize=function(){this.playerMovement=this.entity.script.playerMovement,this.canvas=this.app.graphicsDevice,this.lastLTouchPoint=new pc.Vec2,this.LTouchStartPoint=new pc.Vec2,this.Lid=-1,this.LTouch=null,this.velZ=0,this.velX=0,this.Force=new pc.Vec3,this.forceX=new pc.Vec3,this.forceZ=new pc.Vec3,this.direction="Idle",this.app.touch&&(this.app.touch.on(pc.EVENT_TOUCHSTART,this.onTouchStart,this),this.app.touch.on(pc.EVENT_TOUCHEND,this.onTouchEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHCANCEL,this.onTouchEndCancel,this),this.app.touch.on(pc.EVENT_TOUCHMOVE,this.onTouchMove,this)),this.holder=this.entity.children[1].screen,this.xspace=-.5},TouchPlayerMovement.prototype.onTouchStart=function(t){t.changedTouches.forEach((function(t){t.x<this.canvas.width/2/this.app.renderer.device.maxPixelRatio&&-1==this.Lid&&(this.Lid=t.id,this.LTouchStartPoint.set(t.x,t.y),this.lastLTouchPoint.set(t.x,t.y))}),this)},TouchPlayerMovement.prototype.onTouchEndCancel=function(t){t.changedTouches.forEach((function(t){t.id==this.Lid&&(this.Lid=-1),t.x<this.canvas.width/2/this.app.renderer.device.maxPixelRatio&&-1==this.Lid&&this.DisableButtonsPressed()}),this)},TouchPlayerMovement.prototype.onTouchMove=function(t){this.LTouch=t.getTouchById(this.Lid,t.touches),this.LTouch&&this.lastLTouchPoint.set(this.LTouch.x,this.LTouch.y)},TouchPlayerMovement.prototype.update=function(t){this.app.touch&&(this.velZ=-1!=this.Lid?this.lastLTouchPoint.y-this.LTouchStartPoint.y:0,this.velX=-1!=this.Lid?this.lastLTouchPoint.x-this.LTouchStartPoint.x:0)},TouchPlayerMovement.prototype.getRes=function(){return this.holder.resolution.clone().scale(1/this.app.renderer.device.maxPixelRatio)},TouchPlayerMovement.prototype.DisableButtonsPressed=function(){this.playerMovement.isrunning=!1};var TouchGamePadParent=pc.createScript("touchGamePadParent");TouchGamePadParent.prototype.initialize=function(){this._init()},TouchGamePadParent.prototype._isinit=!1,TouchGamePadParent.prototype._init=function(){return null===this.pads&&(this.pads={}),this._isinit?(console.log("Already initialized"),!1):(this._isinit=!0,this._enMouse&&this._initMouse(),this._enTouch&&this._initTouches(),this.on("attr:_enTouch",this._initTouches,this),this.on("attr:_enMouse",this._initMouse,this),this.once("destroy",(()=>{this.off("attr:_enTouch",this._initTouches,this),this.off("attr:_enMouse",this._initMouse,this)})),!0)},TouchGamePadParent.prototype._initTouches=function(){if(!this.app.touch)return!1;var t=this.entity.script.touchGamePadParent.gamePads,start_=e=>{if(this.enabled){for(var o,s=-1;++s<e.changedTouches.length;)for(o=-1;++o<t.length&&(!t[o].enabled||!t[o].script.touchGamePad.use(e.changedTouches[s])););e.event.preventDefault()}},end_=e=>{for(var o,s=-1;++s<e.changedTouches.length;)for(o=-1;++o<t.length&&!t[o].script.touchGamePad.end(e.changedTouches[s]););this.enabled&&e.event.preventDefault()},move_=e=>{if(this.enabled){for(var o,s=-1;++s<e.changedTouches.length;)for(o=-1;++o<t.length&&!t[o].script.touchGamePad.move(e.changedTouches[s]););e.event.preventDefault()}};return this.fire("destroyTouches"),!this._enTouch||(this.app.touch.on(pc.EVENT_TOUCHSTART,start_),this.app.touch.on(pc.EVENT_TOUCHEND,end_),this.app.touch.on(pc.EVENT_TOUCHCANCEL,end_),this.app.touch.on(pc.EVENT_TOUCHMOVE,move_),this.once("destroyTouches",(()=>{this.app.touch.off(pc.EVENT_TOUCHSTART,start_),this.app.touch.off(pc.EVENT_TOUCHMOVE,move_),this.app.touch.off(pc.EVENT_TOUCHEND,end_),this.app.touch.off(pc.EVENT_TOUCHCANCEL,end_)})),this.once("destroy",(()=>{this.fire("destroyTouches")})),!0)},TouchGamePadParent.prototype._destMouse=null,TouchGamePadParent.prototype._initMouse=function(){var t=this.entity.script.touchGamePadParent.gamePads;this._destMouse&&this._destMouse();var start_=e=>{var o;if(0===e.button)for(e.id=-2,o=-1;++o<t.length&&(!t[o].enabled||!t[o].script.touchGamePad.use(e)););},move_=e=>{var o;if(this.enabled)for(e.id=-2,o=-1;++o<t.length&&!t[o].script.touchGamePad.move(e););},end_=e=>{var o;if(0===e.button&&this.enabled)for(e.id=-2,o=-1;++o<t.length&&!t[o].script.touchGamePad.end(e););};this._destMouse=()=>{this.app.mouse.off(pc.EVENT_MOUSEDOWN,start_,this),this.app.mouse.off(pc.EVENT_MOUSEMOVE,move_,this),this.app.mouse.off(pc.EVENT_MOUSEUP,end_,this),document.removeEventListener("mouseout",end_)},this._enMouse&&(1==this._enMouse&&this.app.touch&&this._enTouch||(this.app.mouse.on(pc.EVENT_MOUSEDOWN,start_,this),this.app.mouse.on(pc.EVENT_MOUSEMOVE,move_,this),this.app.mouse.on(pc.EVENT_MOUSEUP,end_,this),document.addEventListener("mouseout",end_),this.once("destroy",this._destMouse)))},TouchGamePadParent.prototype.update=function(t){},TouchGamePadParent.prototype.pads=null,TouchGamePadParent.prototype.push=function(t,e){this.pads[t.entity.name]=t,e?this.gamePads.unshift(t.entity):this.gamePads.push(t.entity)},TouchGamePadParent.attributes.add("_enTouch",{title:"Enable Touch",type:"boolean",default:!0,description:"Use touch events."}),TouchGamePadParent.attributes.add("_enMouse",{title:"Enable Mouse",type:"number",default:1,description:"Use mouse events.",enum:[{Disabled:0},{Enabled:2},{Fallback:1}]}),TouchGamePadParent.attributes.add("gamePads",{title:"Game Pads",type:"entity",array:!0});var TouchGamePad=pc.createScript("touchGamePad");TouchGamePad.prototype.isPressed=function(){return-1!=this.id},TouchGamePad.prototype.getRaw=function(){return this.stick.getLocalPosition().clone().scale(2/this.entity.element.width)},TouchGamePad.prototype.get=function(){var t=this.getRaw();return this.isPressed(),this.onehot&&(t.x=t.x<this.actd?-t.x<this.actd?0:-1:1,t.y=t.y<this.actd?-t.y<this.actd?0:-1:1),t},TouchGamePad.prototype.tick=-1,TouchGamePad.prototype.timer=0,TouchGamePad.prototype.sleeping=!0,TouchGamePad.prototype.sleepingAutoback=0,TouchGamePad.prototype._justPressed=!1,TouchGamePad.prototype._initposition=null,TouchGamePad.prototype.holder=null,TouchGamePad.prototype.opacity=[0,0],TouchGamePad.prototype.id=-1,TouchGamePad.prototype.limit_=1,TouchGamePad.prototype._tmpv3=new pc.Vec3,TouchGamePad.attributes.add("prior",{title:"Top Priority",type:"boolean",default:!1,description:"Check for this before all others."}),TouchGamePad.attributes.add("dir",{title:"Direction",type:"string",enum:[{Both:"b"},{Horizontal:"h"},{Vertical:"v"},{Button:"c"}],description:"Type of the pad/button. Full stick, vertical only, horizontal only or act only as a button",default:"b"}),TouchGamePad.attributes.add("xspace",{title:"Horizontal Space",type:"number",min:-.9,max:.9,description:"How much to ignore from left or right side of screen. -0.5 to ignore right half and +0.5 to ignore left half",default:0}),TouchGamePad.attributes.add("yspace",{title:"Vertical Space",type:"number",min:-.9,max:.9,description:"How much to ignore from top or bottom side of screen. -0.5 to ignore bottom half and +0.5 to ignore top half",default:0}),TouchGamePad.attributes.add("rspace",{title:"Touch Radius",type:"number",min:0,max:1,description:"How far the touch from the button to ignore it. 1 is full screen size and will never be ignored.",default:1}),TouchGamePad.attributes.add("adjust",{title:"Adjustability",type:"string",enum:[{Fixed:"fixed"},{Float:"float"},{Follow:"follow"}],description:"The method to get close to where the touch is.",default:"float"}),TouchGamePad.attributes.add("actopacity",{title:"Active Opacity",type:"number",default:1,min:-.01,max:1,description:"The opacity to use when held. Stick will use same opacity + delta"}),TouchGamePad.attributes.add("autoback",{title:"Move Back",type:"number",default:1,min:0,max:1,description:"When touch ends, button goes back to where it was. 0 to never go back."}),TouchGamePad.attributes.add("autohide",{title:"Auto Hide",type:"number",default:0,min:0,max:1,description:"Set opacity to zero"}),TouchGamePad.attributes.add("onehot",{title:"Return one hot",type:"boolean",description:"If set, returned value will be either zero or one instead of a float."}),TouchGamePad.attributes.add("actd",{title:"Activation Distance",type:"number",min:0,max:1,default:.5,description:"How far to considor one hot. 0.5 for middle distance"}),TouchGamePad.attributes.add("deadzone",{title:"Dead Zone",min:0,max:1,type:"number",description:"How far the touch should move away from center before activation. The distance is in percentage of the element width and height."}),TouchGamePad.attributes.add("autozero",{title:"Reset",type:"number",default:0,min:0,max:1,description:"When touch moves, it gradually goes back to zero. Use 0 to diactivate. (Note: If not set to zero, limit will break)"}),TouchGamePad.attributes.add("stick",{title:"Stick",type:"entity",description:"The stick to follow finger. If not specified, first child will be used. (Make sure to have at least one child)"}),TouchGamePad.prototype.autoZero=function(){if(0!==this.autozero){var t=this.autozero/this.holder.referenceResolution.x,e=this.stick.getLocalPosition().clone().scale(t);"follow"!=this.adjust?-1==this.id&&this.stick.translate(e.scale(-1)):(this.entity.translate(e),this.stick.translate(e.scale(-1)))}},TouchGamePad.prototype.initialize=function(){var t;this.entity.parent.script||this.entity.parent.addComponent("script"),(t=this.entity.parent.script).touchGamePadParent||t.create("touchGamePadParent"),this.playerMovement=this.entity.parent.parent.script.playerMovement,t.touchGamePadParent.push(this,this.prior),this.holder=this.entity.parent.screen,this._initposition=this.entity.getPosition().clone(),this.stick||(this.stick=this.entity.children[0]),this.opacity=[this.entity.element.opacity,this.stick.element.opacity]},TouchGamePad.prototype.update=function(t){if(!1===this.playerMovement.shootingPressed&&this.stick.getLocalPosition().y>=50&&(this.playerMovement.isrunning=!0),this.sleepingAutoback>0&&0!==this.autoback&&-1==this.id){var e=this._tmpv3.sub2(this._initposition,this.entity.getPosition()).scale(this.autoback);this.entity.translate(e),this.sleeping&&--this.sleepingAutoback<=0&&this.entity.setPosition(this._initposition)}this.autoZero(),-1!=this.id?(this.tick++,this.timer+=t):this.sleeping||(0!==this.autohide?(this.entity.element.opacity*=1-this.autohide,this.stick.element.opacity*=1-this.autohide,this.entity.element.opacity<.01&&(this.sleeping=!0,this.entity.element.opacity=0,this.stick.element.opacity=0)):this.actopacity>=0&&(this.entity.element.opacity=(this.entity.element.opacity+this.opacity[0])/2,this.stick.element.opacity=(this.stick.element.opacity+this.opacity[1])/2,Math.abs(this.entity.element.opacity)-Math.abs(this.opacity[0])<.01&&Math.abs(this.stick.element.opacity)-Math.abs(this.opacity[1])<.01&&(this.sleeping=!0,[this.entity.element.opacity,this.stick.element.opacity]=this.opacity)))},TouchGamePad.prototype._startPosition={x:0,y:0},TouchGamePad.prototype.use=function(t){if(-1==this.id&&this.enabled){if(0!==this.xspace)if(this.xspace<0){if(t.x/this.getRes().x>1+this.xspace)return!1}else if(t.x/this.getRes().x<this.xspace)return!1;if(0!==this.yspace)if(this.yspace<0){if(t.y/this.getRes().x>1+this.yspace)return!1}else if(t.y/this.getRes().y<this.yspace)return!1;if(1!=this.rspace){var e=this.mapPos_(t,!0),i=this.getRes(),o=1/(i.x+i.y);e=this._tmpv3.set(e[0],e[1],0);var a=this.entity.getPosition();if(a.x*=i.x*o,a.y*=i.y*o,e.x*=i.x*o,e.y*=i.y*o,.5*e.distance(a)>this.rspace)return!1}return this.id=t.id,"fixed"!=this.adjust&&this.drawAt(t),"c"!=this.dir&&this.drawAt(t,this.stick),"fixed"==this.adjust&&this._limit(this.stick),this.sleeping&&0!==this.autohide&&(this.opacity=[this.entity.element.opacity,this.stick.element.opacity]),[this.entity.element.opacity,this.stick.element.opacity]=this.opacity,this.actopacity>=0&&(this.entity.element.opacity=this.actopacity,this.stick.element.opacity=this.actopacity+this.opacity[1]-this.opacity[0]),this._startPosition={x:t.x,y:t.y},this.sleeping=!1,this.sleepingAutoback=15,!0}return!1},TouchGamePad.prototype.end=function(t){return this.tick=-1,this.timer=0,this.id==t.id&&(this.id=-1,0===this.autozero&&this.stick.setLocalPosition(0,0,0),!0)},TouchGamePad.prototype.move=function(t){return this.id==t.id&&(this.move_(t),!0)},TouchGamePad.prototype.move_=function(t){"b"!=this.dir&&"c"!=this.dir&&("h"==this.dir?t.y=this._startPosition.y:t.x=this._startPosition.x),"c"!=this.dir&&(this.drawAt(t,this.stick),0===this.autozero&&this._limit(this.stick,0!==this.deadzone))},TouchGamePad.prototype.drawAt=function(t,e){void 0===e&&(e=this.entity);var i=this.holder,o=(i.referenceResolution,i.scaleBlend,this.getRes()),a=2*(t.x/o.x-.5),s=-2*(t.y/o.y-.5);e.setPosition(a,s,0)},TouchGamePad.prototype.limitv0=function(t){var e=t.getLocalPosition().clone(),i=this.entity.getScale(),o=e.x*e.x+e.y*e.y,a=Math.sqrt(i.x*i.x+i.y*i.y);o>a*a&&(o=Math.sqrt(o),e.x=a*e.x/o,e.y=a*e.y/o,"follow"==this.adjust?this.entity.translate(e):isNaN(e.x)||t.setLocalPosition(e))},TouchGamePad.prototype._limit=function(t,e=!1){var i=t.getLocalPosition().clone(),o=this.entity.getScale().clone();o.scale(.5*this.entity.element.width);var a=i.length(),s=o.length();a>s?(i.normalize().scale(s),t.setLocalPosition(i),"follow"==this.adjust&&a>2*s&&this.entity.translate(i.clone().normalize().scale(a/this.holder.referenceResolution.length()/3))):e&&a/s<this.deadzone&&this.stick.setLocalPosition(0,0,0)},TouchGamePad.prototype.limitv2=function(t){var e=t.getLocalPosition().clone(),i=this.entity.getScale().clone();i.scale(.5*this.entity.element.width);var o=e.length();e.x*=this.entity.element.width/Math.abs(this.entity.element.width+this.entity.element.height),e.y*=this.entity.element.height/Math.abs(this.entity.element.width+this.entity.element.height);var a=i.length();o>a&&(e.normalize().scale(a),t.setLocalPosition(e),e.scale(1/a),"follow"==this.adjust&&e.length()>2*a&&this.entity.translate(e.scale(o/this.holder.referenceResolution.length()/3)))},TouchGamePad.prototype.mapPos_=function(t,e=!1){var i=this.getRes(),o=[t.x/i.x,t.y/i.y];return e&&(o[0]=2*(o[0]-.5),o[1]=-2*(o[1]-.5)),o},TouchGamePad.prototype.getRes=function(){return this.holder.resolution.clone().scale(1/this.app.renderer.device.maxPixelRatio)};var ButtonTouch=pc.createScript("buttonTouch");ButtonTouch.prototype.initialize=function(){if(this.isTouch=this.app.touch,null===this.app.touch)return!0===this.entity.parent.screen.enabled&&(this.entity.parent.screen.enabled=!1),this.entity.element.enabled=!1,void(this.entity.children[0].enabled=!1);this.GameUI=this.app.root.findByName("GameManager").script.gameUi,this.playerMovement=this.entity.parent.parent.script.playerMovement,this.button=this.entity.button,this.touchPlayerMovement=this.entity.parent.parent.script.touchPlayerMovement,this.touchCameraMovement=this.entity.parent.parent.script.touchCameraMovement,this.button.on("pressedstart",this.onPresseStart,this),this.button.on("touchend",this.onPressedEnd,this)},ButtonTouch.prototype.onPresseStart=function(t){if("Jump"===this.entity.name&&(this.playerMovement.Jump_(),this.playerMovement.jumpingPressed=!0),"ShotR"===this.entity.name){let t=this.playerMovement.entity.script.weaponManager.currentweapon;this.playerMovement.isrunning=!1,this.playerMovement.shootingPressed=!0,this.playerMovement.aimingPressed=!0,t&&("AWP"===t.name||"Barrett"===t.name||"RPG"===t.name||(this.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.isShooting=!0))}"Pause"===this.entity.name&&this.GameUI.Pause_(),"Grenade"===this.entity.name&&this.playerMovement.entity.script.weaponManager.Grenade_(),"Reload"===this.entity.name&&this.playerMovement.entity.script.weaponManager.currentweapon.script.gunBehaviour.reload(),"Slide"===this.entity.name&&this.playerMovement.onMousewheel(),"Axe"===this.entity.name&&this.playerMovement.entity.script.weaponManager.Axe_()};var TouchCurrentPickUp=pc.createScript("touchCurrentPickUp");TouchCurrentPickUp.prototype.initialize=function(){this.entity.button.on("click",function(){var t=this.app.root.findByName("GameManager");null!==t&&null!==t.script.gameManager.player&&t.script.gameManager.player.script.weaponManager.PickUp_()}.bind(this))};var Fixuitablet=pc.createScript("fixuitablet");Fixuitablet.prototype.initialize=function(){this.heightInnerTemp=0,this.width=this.entity.screen.referenceResolution.x,this.height=this.entity.screen.referenceResolution.y,this.isMobile=!1,this.app.touch&&(this.isMobile=!0)},Fixuitablet.prototype.update=function(){!0===this.isMobile&&this.fix()},Fixuitablet.prototype.fix=function(){let i=this.height,t=window.innerHeight;this.heightInnerTemp!==t&&(this.heightInnerTemp=t,t>=360&&(t>=660?i=1.56*this.height:t>=610?i=1.48*this.height:t>=560?i=1.4*this.height:t>=510?i=1.32*this.height:t>=460?i=1.24*this.height:t>=410?i=1.16*this.height:t>=360&&(i=1.08*this.height)),this.entity.screen.referenceResolution=new pc.Vec2(this.width,i))};